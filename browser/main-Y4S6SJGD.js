var hA=Object.defineProperty,pA=Object.defineProperties;var mA=Object.getOwnPropertyDescriptors;var mx=Object.getOwnPropertySymbols;var gA=Object.prototype.hasOwnProperty,vA=Object.prototype.propertyIsEnumerable;var gx=(e,n,t)=>n in e?hA(e,n,{enumerable:!0,configurable:!0,writable:!0,value:t}):e[n]=t,de=(e,n)=>{for(var t in n||={})gA.call(n,t)&&gx(e,t,n[t]);if(mx)for(var t of mx(n))vA.call(n,t)&&gx(e,t,n[t]);return e},gt=(e,n)=>pA(e,mA(n));var Z=(e,n,t)=>new Promise((r,i)=>{var s=c=>{try{a(t.next(c))}catch(l){i(l)}},o=c=>{try{a(t.throw(c))}catch(l){i(l)}},a=c=>c.done?r(c.value):Promise.resolve(c.value).then(s,o);a((t=t.apply(e,n)).next())});var vx=null;var Bh=1,_x=Symbol("SIGNAL");function Ze(e){let n=vx;return vx=e,n}var xx={version:0,lastCleanEpoch:0,dirty:!1,producerNode:void 0,producerLastReadVersion:void 0,producerIndexOfThis:void 0,nextProducerIndex:0,liveConsumerNode:void 0,liveConsumerIndexOfThis:void 0,consumerAllowSignalWrites:!1,consumerIsAlwaysLive:!1,producerMustRecompute:()=>!1,producerRecomputeValue:()=>{},consumerMarkedDirty:()=>{},consumerOnSignalRead:()=>{}};function _A(e){if(!(Vh(e)&&!e.dirty)&&!(!e.dirty&&e.lastCleanEpoch===Bh)){if(!e.producerMustRecompute(e)&&!Uh(e)){e.dirty=!1,e.lastCleanEpoch=Bh;return}e.producerRecomputeValue(e),e.dirty=!1,e.lastCleanEpoch=Bh}}function yx(e){return e&&(e.nextProducerIndex=0),Ze(e)}function wx(e,n){if(Ze(n),!(!e||e.producerNode===void 0||e.producerIndexOfThis===void 0||e.producerLastReadVersion===void 0)){if(Vh(e))for(let t=e.nextProducerIndex;t<e.producerNode.length;t++)jh(e.producerNode[t],e.producerIndexOfThis[t]);for(;e.producerNode.length>e.nextProducerIndex;)e.producerNode.pop(),e.producerLastReadVersion.pop(),e.producerIndexOfThis.pop()}}function Uh(e){iu(e);for(let n=0;n<e.producerNode.length;n++){let t=e.producerNode[n],r=e.producerLastReadVersion[n];if(r!==t.version||(_A(t),r!==t.version))return!0}return!1}function Ex(e){if(iu(e),Vh(e))for(let n=0;n<e.producerNode.length;n++)jh(e.producerNode[n],e.producerIndexOfThis[n]);e.producerNode.length=e.producerLastReadVersion.length=e.producerIndexOfThis.length=0,e.liveConsumerNode&&(e.liveConsumerNode.length=e.liveConsumerIndexOfThis.length=0)}function jh(e,n){if(xA(e),iu(e),e.liveConsumerNode.length===1)for(let r=0;r<e.producerNode.length;r++)jh(e.producerNode[r],e.producerIndexOfThis[r]);let t=e.liveConsumerNode.length-1;if(e.liveConsumerNode[n]=e.liveConsumerNode[t],e.liveConsumerIndexOfThis[n]=e.liveConsumerIndexOfThis[t],e.liveConsumerNode.length--,e.liveConsumerIndexOfThis.length--,n<e.liveConsumerNode.length){let r=e.liveConsumerIndexOfThis[n],i=e.liveConsumerNode[n];iu(i),i.producerIndexOfThis[r]=n}}function Vh(e){return e.consumerIsAlwaysLive||(e?.liveConsumerNode?.length??0)>0}function iu(e){e.producerNode??=[],e.producerIndexOfThis??=[],e.producerLastReadVersion??=[]}function xA(e){e.liveConsumerNode??=[],e.liveConsumerIndexOfThis??=[]}function yA(){throw new Error}var wA=yA;function Tx(e){wA=e}function Se(e){return typeof e=="function"}function ao(e){let t=e(r=>{Error.call(r),r.stack=new Error().stack});return t.prototype=Object.create(Error.prototype),t.prototype.constructor=t,t}var su=ao(e=>function(t){e(this),this.message=t?`${t.length} errors occurred during unsubscription:
${t.map((r,i)=>`${i+1}) ${r.toString()}`).join(`
  `)}`:"",this.name="UnsubscriptionError",this.errors=t});function hs(e,n){if(e){let t=e.indexOf(n);0<=t&&e.splice(t,1)}}var wt=class e{constructor(n){this.initialTeardown=n,this.closed=!1,this._parentage=null,this._finalizers=null}unsubscribe(){let n;if(!this.closed){this.closed=!0;let{_parentage:t}=this;if(t)if(this._parentage=null,Array.isArray(t))for(let s of t)s.remove(this);else t.remove(this);let{initialTeardown:r}=this;if(Se(r))try{r()}catch(s){n=s instanceof su?s.errors:[s]}let{_finalizers:i}=this;if(i){this._finalizers=null;for(let s of i)try{Ix(s)}catch(o){n=n??[],o instanceof su?n=[...n,...o.errors]:n.push(o)}}if(n)throw new su(n)}}add(n){var t;if(n&&n!==this)if(this.closed)Ix(n);else{if(n instanceof e){if(n.closed||n._hasParent(this))return;n._addParent(this)}(this._finalizers=(t=this._finalizers)!==null&&t!==void 0?t:[]).push(n)}}_hasParent(n){let{_parentage:t}=this;return t===n||Array.isArray(t)&&t.includes(n)}_addParent(n){let{_parentage:t}=this;this._parentage=Array.isArray(t)?(t.push(n),t):t?[t,n]:n}_removeParent(n){let{_parentage:t}=this;t===n?this._parentage=null:Array.isArray(t)&&hs(t,n)}remove(n){let{_finalizers:t}=this;t&&hs(t,n),n instanceof e&&n._removeParent(this)}};wt.EMPTY=(()=>{let e=new wt;return e.closed=!0,e})();var Hh=wt.EMPTY;function ou(e){return e instanceof wt||e&&"closed"in e&&Se(e.remove)&&Se(e.add)&&Se(e.unsubscribe)}function Ix(e){Se(e)?e():e.unsubscribe()}var ar={onUnhandledError:null,onStoppedNotification:null,Promise:void 0,useDeprecatedSynchronousErrorHandling:!1,useDeprecatedNextContext:!1};var co={setTimeout(e,n,...t){let{delegate:r}=co;return r?.setTimeout?r.setTimeout(e,n,...t):setTimeout(e,n,...t)},clearTimeout(e){let{delegate:n}=co;return(n?.clearTimeout||clearTimeout)(e)},delegate:void 0};function au(e){co.setTimeout(()=>{let{onUnhandledError:n}=ar;if(n)n(e);else throw e})}function La(){}var Cx=$h("C",void 0,void 0);function Sx(e){return $h("E",void 0,e)}function Dx(e){return $h("N",e,void 0)}function $h(e,n,t){return{kind:e,value:n,error:t}}var ps=null;function lo(e){if(ar.useDeprecatedSynchronousErrorHandling){let n=!ps;if(n&&(ps={errorThrown:!1,error:null}),e(),n){let{errorThrown:t,error:r}=ps;if(ps=null,t)throw r}}else e()}function bx(e){ar.useDeprecatedSynchronousErrorHandling&&ps&&(ps.errorThrown=!0,ps.error=e)}var ms=class extends wt{constructor(n){super(),this.isStopped=!1,n?(this.destination=n,ou(n)&&n.add(this)):this.destination=IA}static create(n,t,r){return new uo(n,t,r)}next(n){this.isStopped?zh(Dx(n),this):this._next(n)}error(n){this.isStopped?zh(Sx(n),this):(this.isStopped=!0,this._error(n))}complete(){this.isStopped?zh(Cx,this):(this.isStopped=!0,this._complete())}unsubscribe(){this.closed||(this.isStopped=!0,super.unsubscribe(),this.destination=null)}_next(n){this.destination.next(n)}_error(n){try{this.destination.error(n)}finally{this.unsubscribe()}}_complete(){try{this.destination.complete()}finally{this.unsubscribe()}}},EA=Function.prototype.bind;function Wh(e,n){return EA.call(e,n)}var Gh=class{constructor(n){this.partialObserver=n}next(n){let{partialObserver:t}=this;if(t.next)try{t.next(n)}catch(r){cu(r)}}error(n){let{partialObserver:t}=this;if(t.error)try{t.error(n)}catch(r){cu(r)}else cu(n)}complete(){let{partialObserver:n}=this;if(n.complete)try{n.complete()}catch(t){cu(t)}}},uo=class extends ms{constructor(n,t,r){super();let i;if(Se(n)||!n)i={next:n??void 0,error:t??void 0,complete:r??void 0};else{let s;this&&ar.useDeprecatedNextContext?(s=Object.create(n),s.unsubscribe=()=>this.unsubscribe(),i={next:n.next&&Wh(n.next,s),error:n.error&&Wh(n.error,s),complete:n.complete&&Wh(n.complete,s)}):i=n}this.destination=new Gh(i)}};function cu(e){ar.useDeprecatedSynchronousErrorHandling?bx(e):au(e)}function TA(e){throw e}function zh(e,n){let{onStoppedNotification:t}=ar;t&&co.setTimeout(()=>t(e,n))}var IA={closed:!0,next:La,error:TA,complete:La};var fo=typeof Symbol=="function"&&Symbol.observable||"@@observable";function Fn(e){return e}function qh(...e){return Kh(e)}function Kh(e){return e.length===0?Fn:e.length===1?e[0]:function(t){return e.reduce((r,i)=>i(r),t)}}var Ve=(()=>{class e{constructor(t){t&&(this._subscribe=t)}lift(t){let r=new e;return r.source=this,r.operator=t,r}subscribe(t,r,i){let s=SA(t)?t:new uo(t,r,i);return lo(()=>{let{operator:o,source:a}=this;s.add(o?o.call(s,a):a?this._subscribe(s):this._trySubscribe(s))}),s}_trySubscribe(t){try{return this._subscribe(t)}catch(r){t.error(r)}}forEach(t,r){return r=Ax(r),new r((i,s)=>{let o=new uo({next:a=>{try{t(a)}catch(c){s(c),o.unsubscribe()}},error:s,complete:i});this.subscribe(o)})}_subscribe(t){var r;return(r=this.source)===null||r===void 0?void 0:r.subscribe(t)}[fo](){return this}pipe(...t){return Kh(t)(this)}toPromise(t){return t=Ax(t),new t((r,i)=>{let s;this.subscribe(o=>s=o,o=>i(o),()=>r(s))})}}return e.create=n=>new e(n),e})();function Ax(e){var n;return(n=e??ar.Promise)!==null&&n!==void 0?n:Promise}function CA(e){return e&&Se(e.next)&&Se(e.error)&&Se(e.complete)}function SA(e){return e&&e instanceof ms||CA(e)&&ou(e)}function Yh(e){return Se(e?.lift)}function He(e){return n=>{if(Yh(n))return n.lift(function(t){try{return e(t,this)}catch(r){this.error(r)}});throw new TypeError("Unable to lift unknown Observable type")}}function $e(e,n,t,r,i){return new Xh(e,n,t,r,i)}var Xh=class extends ms{constructor(n,t,r,i,s,o){super(n),this.onFinalize=s,this.shouldUnsubscribe=o,this._next=t?function(a){try{t(a)}catch(c){n.error(c)}}:super._next,this._error=i?function(a){try{i(a)}catch(c){n.error(c)}finally{this.unsubscribe()}}:super._error,this._complete=r?function(){try{r()}catch(a){n.error(a)}finally{this.unsubscribe()}}:super._complete}unsubscribe(){var n;if(!this.shouldUnsubscribe||this.shouldUnsubscribe()){let{closed:t}=this;super.unsubscribe(),!t&&((n=this.onFinalize)===null||n===void 0||n.call(this))}}};function ho(){return He((e,n)=>{let t=null;e._refCount++;let r=$e(n,void 0,void 0,void 0,()=>{if(!e||e._refCount<=0||0<--e._refCount){t=null;return}let i=e._connection,s=t;t=null,i&&(!s||i===s)&&i.unsubscribe(),n.unsubscribe()});e.subscribe(r),r.closed||(t=e.connect())})}var po=class extends Ve{constructor(n,t){super(),this.source=n,this.subjectFactory=t,this._subject=null,this._refCount=0,this._connection=null,Yh(n)&&(this.lift=n.lift)}_subscribe(n){return this.getSubject().subscribe(n)}getSubject(){let n=this._subject;return(!n||n.isStopped)&&(this._subject=this.subjectFactory()),this._subject}_teardown(){this._refCount=0;let{_connection:n}=this;this._subject=this._connection=null,n?.unsubscribe()}connect(){let n=this._connection;if(!n){n=this._connection=new wt;let t=this.getSubject();n.add(this.source.subscribe($e(t,void 0,()=>{this._teardown(),t.complete()},r=>{this._teardown(),t.error(r)},()=>this._teardown()))),n.closed&&(this._connection=null,n=wt.EMPTY)}return n}refCount(){return ho()(this)}};var kx=ao(e=>function(){e(this),this.name="ObjectUnsubscribedError",this.message="object unsubscribed"});var Lt=(()=>{class e extends Ve{constructor(){super(),this.closed=!1,this.currentObservers=null,this.observers=[],this.isStopped=!1,this.hasError=!1,this.thrownError=null}lift(t){let r=new lu(this,this);return r.operator=t,r}_throwIfClosed(){if(this.closed)throw new kx}next(t){lo(()=>{if(this._throwIfClosed(),!this.isStopped){this.currentObservers||(this.currentObservers=Array.from(this.observers));for(let r of this.currentObservers)r.next(t)}})}error(t){lo(()=>{if(this._throwIfClosed(),!this.isStopped){this.hasError=this.isStopped=!0,this.thrownError=t;let{observers:r}=this;for(;r.length;)r.shift().error(t)}})}complete(){lo(()=>{if(this._throwIfClosed(),!this.isStopped){this.isStopped=!0;let{observers:t}=this;for(;t.length;)t.shift().complete()}})}unsubscribe(){this.isStopped=this.closed=!0,this.observers=this.currentObservers=null}get observed(){var t;return((t=this.observers)===null||t===void 0?void 0:t.length)>0}_trySubscribe(t){return this._throwIfClosed(),super._trySubscribe(t)}_subscribe(t){return this._throwIfClosed(),this._checkFinalizedStatuses(t),this._innerSubscribe(t)}_innerSubscribe(t){let{hasError:r,isStopped:i,observers:s}=this;return r||i?Hh:(this.currentObservers=null,s.push(t),new wt(()=>{this.currentObservers=null,hs(s,t)}))}_checkFinalizedStatuses(t){let{hasError:r,thrownError:i,isStopped:s}=this;r?t.error(i):s&&t.complete()}asObservable(){let t=new Ve;return t.source=this,t}}return e.create=(n,t)=>new lu(n,t),e})(),lu=class extends Lt{constructor(n,t){super(),this.destination=n,this.source=t}next(n){var t,r;(r=(t=this.destination)===null||t===void 0?void 0:t.next)===null||r===void 0||r.call(t,n)}error(n){var t,r;(r=(t=this.destination)===null||t===void 0?void 0:t.error)===null||r===void 0||r.call(t,n)}complete(){var n,t;(t=(n=this.destination)===null||n===void 0?void 0:n.complete)===null||t===void 0||t.call(n)}_subscribe(n){var t,r;return(r=(t=this.source)===null||t===void 0?void 0:t.subscribe(n))!==null&&r!==void 0?r:Hh}};var qt=class extends Lt{constructor(n){super(),this._value=n}get value(){return this.getValue()}_subscribe(n){let t=super._subscribe(n);return!t.closed&&n.next(this._value),t}getValue(){let{hasError:n,thrownError:t,_value:r}=this;if(n)throw t;return this._throwIfClosed(),r}next(n){super.next(this._value=n)}};var Ba={now(){return(Ba.delegate||Date).now()},delegate:void 0};var Ua=class extends Lt{constructor(n=1/0,t=1/0,r=Ba){super(),this._bufferSize=n,this._windowTime=t,this._timestampProvider=r,this._buffer=[],this._infiniteTimeWindow=!0,this._infiniteTimeWindow=t===1/0,this._bufferSize=Math.max(1,n),this._windowTime=Math.max(1,t)}next(n){let{isStopped:t,_buffer:r,_infiniteTimeWindow:i,_timestampProvider:s,_windowTime:o}=this;t||(r.push(n),!i&&r.push(s.now()+o)),this._trimBuffer(),super.next(n)}_subscribe(n){this._throwIfClosed(),this._trimBuffer();let t=this._innerSubscribe(n),{_infiniteTimeWindow:r,_buffer:i}=this,s=i.slice();for(let o=0;o<s.length&&!n.closed;o+=r?1:2)n.next(s[o]);return this._checkFinalizedStatuses(n),t}_trimBuffer(){let{_bufferSize:n,_timestampProvider:t,_buffer:r,_infiniteTimeWindow:i}=this,s=(i?1:2)*n;if(n<1/0&&s<r.length&&r.splice(0,r.length-s),!i){let o=t.now(),a=0;for(let c=1;c<r.length&&r[c]<=o;c+=2)a=c;a&&r.splice(0,a+1)}}};var uu=class extends wt{constructor(n,t){super()}schedule(n,t=0){return this}};var ja={setInterval(e,n,...t){let{delegate:r}=ja;return r?.setInterval?r.setInterval(e,n,...t):setInterval(e,n,...t)},clearInterval(e){let{delegate:n}=ja;return(n?.clearInterval||clearInterval)(e)},delegate:void 0};var mo=class extends uu{constructor(n,t){super(n,t),this.scheduler=n,this.work=t,this.pending=!1}schedule(n,t=0){var r;if(this.closed)return this;this.state=n;let i=this.id,s=this.scheduler;return i!=null&&(this.id=this.recycleAsyncId(s,i,t)),this.pending=!0,this.delay=t,this.id=(r=this.id)!==null&&r!==void 0?r:this.requestAsyncId(s,this.id,t),this}requestAsyncId(n,t,r=0){return ja.setInterval(n.flush.bind(n,this),r)}recycleAsyncId(n,t,r=0){if(r!=null&&this.delay===r&&this.pending===!1)return t;t!=null&&ja.clearInterval(t)}execute(n,t){if(this.closed)return new Error("executing a cancelled action");this.pending=!1;let r=this._execute(n,t);if(r)return r;this.pending===!1&&this.id!=null&&(this.id=this.recycleAsyncId(this.scheduler,this.id,null))}_execute(n,t){let r=!1,i;try{this.work(n)}catch(s){r=!0,i=s||new Error("Scheduled action threw falsy error")}if(r)return this.unsubscribe(),i}unsubscribe(){if(!this.closed){let{id:n,scheduler:t}=this,{actions:r}=t;this.work=this.state=this.scheduler=null,this.pending=!1,hs(r,this),n!=null&&(this.id=this.recycleAsyncId(t,n,null)),this.delay=null,super.unsubscribe()}}};var go=class e{constructor(n,t=e.now){this.schedulerActionCtor=n,this.now=t}schedule(n,t=0,r){return new this.schedulerActionCtor(this,n).schedule(r,t)}};go.now=Ba.now;var vo=class extends go{constructor(n,t=go.now){super(n,t),this.actions=[],this._active=!1}flush(n){let{actions:t}=this;if(this._active){t.push(n);return}let r;this._active=!0;do if(r=n.execute(n.state,n.delay))break;while(n=t.shift());if(this._active=!1,r){for(;n=t.shift();)n.unsubscribe();throw r}}};var Qh=new vo(mo);var fu=class extends mo{constructor(n,t){super(n,t),this.scheduler=n,this.work=t}schedule(n,t=0){return t>0?super.schedule(n,t):(this.delay=t,this.state=n,this.scheduler.flush(this),this)}execute(n,t){return t>0||this.closed?super.execute(n,t):this._execute(n,t)}requestAsyncId(n,t,r=0){return r!=null&&r>0||r==null&&this.delay>0?super.requestAsyncId(n,t,r):(n.flush(this),0)}};var du=class extends vo{};var Zh=new du(fu);var Pn=new Ve(e=>e.complete());function Nx(e){return e&&Se(e.schedule)}function Rx(e){return e[e.length-1]}function Mx(e){return Se(Rx(e))?e.pop():void 0}function Ci(e){return Nx(Rx(e))?e.pop():void 0}function Jh(e,n){var t={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&n.indexOf(r)<0&&(t[r]=e[r]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(e);i<r.length;i++)n.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(t[r[i]]=e[r[i]]);return t}function Fx(e,n,t,r){function i(s){return s instanceof t?s:new t(function(o){o(s)})}return new(t||(t=Promise))(function(s,o){function a(u){try{l(r.next(u))}catch(f){o(f)}}function c(u){try{l(r.throw(u))}catch(f){o(f)}}function l(u){u.done?s(u.value):i(u.value).then(a,c)}l((r=r.apply(e,n||[])).next())})}function Ox(e){var n=typeof Symbol=="function"&&Symbol.iterator,t=n&&e[n],r=0;if(t)return t.call(e);if(e&&typeof e.length=="number")return{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}};throw new TypeError(n?"Object is not iterable.":"Symbol.iterator is not defined.")}function gs(e){return this instanceof gs?(this.v=e,this):new gs(e)}function Px(e,n,t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var r=t.apply(e,n||[]),i,s=[];return i=Object.create((typeof AsyncIterator=="function"?AsyncIterator:Object).prototype),a("next"),a("throw"),a("return",o),i[Symbol.asyncIterator]=function(){return this},i;function o(h){return function(m){return Promise.resolve(m).then(h,f)}}function a(h,m){r[h]&&(i[h]=function(p){return new Promise(function(g,w){s.push([h,p,g,w])>1||c(h,p)})},m&&(i[h]=m(i[h])))}function c(h,m){try{l(r[h](m))}catch(p){d(s[0][3],p)}}function l(h){h.value instanceof gs?Promise.resolve(h.value.v).then(u,f):d(s[0][2],h)}function u(h){c("next",h)}function f(h){c("throw",h)}function d(h,m){h(m),s.shift(),s.length&&c(s[0][0],s[0][1])}}function Lx(e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var n=e[Symbol.asyncIterator],t;return n?n.call(e):(e=typeof Ox=="function"?Ox(e):e[Symbol.iterator](),t={},r("next"),r("throw"),r("return"),t[Symbol.asyncIterator]=function(){return this},t);function r(s){t[s]=e[s]&&function(o){return new Promise(function(a,c){o=e[s](o),i(a,c,o.done,o.value)})}}function i(s,o,a,c){Promise.resolve(c).then(function(l){s({value:l,done:a})},o)}}var hu=e=>e&&typeof e.length=="number"&&typeof e!="function";function pu(e){return Se(e?.then)}function mu(e){return Se(e[fo])}function gu(e){return Symbol.asyncIterator&&Se(e?.[Symbol.asyncIterator])}function vu(e){return new TypeError(`You provided ${e!==null&&typeof e=="object"?"an invalid object":`'${e}'`} where a stream was expected. You can provide an Observable, Promise, ReadableStream, Array, AsyncIterable, or Iterable.`)}function DA(){return typeof Symbol!="function"||!Symbol.iterator?"@@iterator":Symbol.iterator}var _u=DA();function xu(e){return Se(e?.[_u])}function yu(e){return Px(this,arguments,function*(){let t=e.getReader();try{for(;;){let{value:r,done:i}=yield gs(t.read());if(i)return yield gs(void 0);yield yield gs(r)}}finally{t.releaseLock()}})}function wu(e){return Se(e?.getReader)}function Bt(e){if(e instanceof Ve)return e;if(e!=null){if(mu(e))return bA(e);if(hu(e))return AA(e);if(pu(e))return kA(e);if(gu(e))return Bx(e);if(xu(e))return NA(e);if(wu(e))return RA(e)}throw vu(e)}function bA(e){return new Ve(n=>{let t=e[fo]();if(Se(t.subscribe))return t.subscribe(n);throw new TypeError("Provided object does not correctly implement Symbol.observable")})}function AA(e){return new Ve(n=>{for(let t=0;t<e.length&&!n.closed;t++)n.next(e[t]);n.complete()})}function kA(e){return new Ve(n=>{e.then(t=>{n.closed||(n.next(t),n.complete())},t=>n.error(t)).then(null,au)})}function NA(e){return new Ve(n=>{for(let t of e)if(n.next(t),n.closed)return;n.complete()})}function Bx(e){return new Ve(n=>{MA(e,n).catch(t=>n.error(t))})}function RA(e){return Bx(yu(e))}function MA(e,n){var t,r,i,s;return Fx(this,void 0,void 0,function*(){try{for(t=Lx(e);r=yield t.next(),!r.done;){let o=r.value;if(n.next(o),n.closed)return}}catch(o){i={error:o}}finally{try{r&&!r.done&&(s=t.return)&&(yield s.call(t))}finally{if(i)throw i.error}}n.complete()})}function Cn(e,n,t,r=0,i=!1){let s=n.schedule(function(){t(),i?e.add(this.schedule(null,r)):this.unsubscribe()},r);if(e.add(s),!i)return s}function Si(e,n=0){return He((t,r)=>{t.subscribe($e(r,i=>Cn(r,e,()=>r.next(i),n),()=>Cn(r,e,()=>r.complete(),n),i=>Cn(r,e,()=>r.error(i),n)))})}function Di(e,n=0){return He((t,r)=>{r.add(e.schedule(()=>t.subscribe(r),n))})}function Ux(e,n){return Bt(e).pipe(Di(n),Si(n))}function jx(e,n){return Bt(e).pipe(Di(n),Si(n))}function Vx(e,n){return new Ve(t=>{let r=0;return n.schedule(function(){r===e.length?t.complete():(t.next(e[r++]),t.closed||this.schedule())})})}function Hx(e,n){return new Ve(t=>{let r;return Cn(t,n,()=>{r=e[_u](),Cn(t,n,()=>{let i,s;try{({value:i,done:s}=r.next())}catch(o){t.error(o);return}s?t.complete():t.next(i)},0,!0)}),()=>Se(r?.return)&&r.return()})}function Eu(e,n){if(!e)throw new Error("Iterable cannot be null");return new Ve(t=>{Cn(t,n,()=>{let r=e[Symbol.asyncIterator]();Cn(t,n,()=>{r.next().then(i=>{i.done?t.complete():t.next(i.value)})},0,!0)})})}function $x(e,n){return Eu(yu(e),n)}function Wx(e,n){if(e!=null){if(mu(e))return Ux(e,n);if(hu(e))return Vx(e,n);if(pu(e))return jx(e,n);if(gu(e))return Eu(e,n);if(xu(e))return Hx(e,n);if(wu(e))return $x(e,n)}throw vu(e)}function ht(e,n){return n?Wx(e,n):Bt(e)}function xe(...e){let n=Ci(e);return ht(e,n)}function _o(e,n){let t=Se(e)?e:()=>e,r=i=>i.error(t());return new Ve(n?i=>n.schedule(r,0,i):r)}function e0(e){return!!e&&(e instanceof Ve||Se(e.lift)&&Se(e.subscribe))}var ni=ao(e=>function(){e(this),this.name="EmptyError",this.message="no elements in sequence"});function be(e,n){return He((t,r)=>{let i=0;t.subscribe($e(r,s=>{r.next(e.call(n,s,i++))}))})}var{isArray:OA}=Array;function FA(e,n){return OA(n)?e(...n):e(n)}function zx(e){return be(n=>FA(e,n))}var{isArray:PA}=Array,{getPrototypeOf:LA,prototype:BA,keys:UA}=Object;function Gx(e){if(e.length===1){let n=e[0];if(PA(n))return{args:n,keys:null};if(jA(n)){let t=UA(n);return{args:t.map(r=>n[r]),keys:t}}}return{args:e,keys:null}}function jA(e){return e&&typeof e=="object"&&LA(e)===BA}function qx(e,n){return e.reduce((t,r,i)=>(t[r]=n[i],t),{})}function Va(...e){let n=Ci(e),t=Mx(e),{args:r,keys:i}=Gx(e);if(r.length===0)return ht([],n);let s=new Ve(VA(r,n,i?o=>qx(i,o):Fn));return t?s.pipe(zx(t)):s}function VA(e,n,t=Fn){return r=>{Kx(n,()=>{let{length:i}=e,s=new Array(i),o=i,a=i;for(let c=0;c<i;c++)Kx(n,()=>{let l=ht(e[c],n),u=!1;l.subscribe($e(r,f=>{s[c]=f,u||(u=!0,a--),a||r.next(t(s.slice()))},()=>{--o||r.complete()}))},r)},r)}}function Kx(e,n,t){e?Cn(t,e,n):n()}function Yx(e,n,t,r,i,s,o,a){let c=[],l=0,u=0,f=!1,d=()=>{f&&!c.length&&!l&&n.complete()},h=p=>l<r?m(p):c.push(p),m=p=>{s&&n.next(p),l++;let g=!1;Bt(t(p,u++)).subscribe($e(n,w=>{i?.(w),s?h(w):n.next(w)},()=>{g=!0},void 0,()=>{if(g)try{for(l--;c.length&&l<r;){let w=c.shift();o?Cn(n,o,()=>m(w)):m(w)}d()}catch(w){n.error(w)}}))};return e.subscribe($e(n,h,()=>{f=!0,d()})),()=>{a?.()}}function Ct(e,n,t=1/0){return Se(n)?Ct((r,i)=>be((s,o)=>n(r,s,i,o))(Bt(e(r,i))),t):(typeof n=="number"&&(t=n),He((r,i)=>Yx(r,i,e,t)))}function xo(e=1/0){return Ct(Fn,e)}function Xx(){return xo(1)}function yo(...e){return Xx()(ht(e,Ci(e)))}function Tu(e){return new Ve(n=>{Bt(e()).subscribe(n)})}function Sn(e,n){return He((t,r)=>{let i=0;t.subscribe($e(r,s=>e.call(n,s,i++)&&r.next(s)))})}function bi(e){return He((n,t)=>{let r=null,i=!1,s;r=n.subscribe($e(t,void 0,void 0,o=>{s=Bt(e(o,bi(e)(n))),r?(r.unsubscribe(),r=null,s.subscribe(t)):i=!0})),i&&(r.unsubscribe(),r=null,s.subscribe(t))})}function Qx(e,n,t,r,i){return(s,o)=>{let a=t,c=n,l=0;s.subscribe($e(o,u=>{let f=l++;c=a?e(c,u,f):(a=!0,u),r&&o.next(c)},i&&(()=>{a&&o.next(c),o.complete()})))}}function ri(e,n){return Se(n)?Ct(e,n,1):Ct(e,1)}function Ai(e){return He((n,t)=>{let r=!1;n.subscribe($e(t,i=>{r=!0,t.next(i)},()=>{r||t.next(e),t.complete()}))})}function ii(e){return e<=0?()=>Pn:He((n,t)=>{let r=0;n.subscribe($e(t,i=>{++r<=e&&(t.next(i),e<=r&&t.complete())}))})}function t0(e){return be(()=>e)}function Iu(e=HA){return He((n,t)=>{let r=!1;n.subscribe($e(t,i=>{r=!0,t.next(i)},()=>r?t.complete():t.error(e())))})}function HA(){return new ni}function ki(e){return He((n,t)=>{try{n.subscribe(t)}finally{t.add(e)}})}function Ar(e,n){let t=arguments.length>=2;return r=>r.pipe(e?Sn((i,s)=>e(i,s,r)):Fn,ii(1),t?Ai(n):Iu(()=>new ni))}function wo(e){return e<=0?()=>Pn:He((n,t)=>{let r=[];n.subscribe($e(t,i=>{r.push(i),e<r.length&&r.shift()},()=>{for(let i of r)t.next(i);t.complete()},void 0,()=>{r=null}))})}function n0(e,n){let t=arguments.length>=2;return r=>r.pipe(e?Sn((i,s)=>e(i,s,r)):Fn,wo(1),t?Ai(n):Iu(()=>new ni))}function r0(e,n){return He(Qx(e,n,arguments.length>=2,!0))}function i0(...e){let n=Ci(e);return He((t,r)=>{(n?yo(e,t,n):yo(e,t)).subscribe(r)})}function Dn(e,n){return He((t,r)=>{let i=null,s=0,o=!1,a=()=>o&&!i&&r.complete();t.subscribe($e(r,c=>{i?.unsubscribe();let l=0,u=s++;Bt(e(c,u)).subscribe(i=$e(r,f=>r.next(n?n(c,f,u,l++):f),()=>{i=null,a()}))},()=>{o=!0,a()}))})}function s0(e){return He((n,t)=>{Bt(e).subscribe($e(t,()=>t.complete(),La)),!t.closed&&n.subscribe(t)})}function St(e,n,t){let r=Se(e)||n||t?{next:e,error:n,complete:t}:e;return r?He((i,s)=>{var o;(o=r.subscribe)===null||o===void 0||o.call(r);let a=!0;i.subscribe($e(s,c=>{var l;(l=r.next)===null||l===void 0||l.call(r,c),s.next(c)},()=>{var c;a=!1,(c=r.complete)===null||c===void 0||c.call(r),s.complete()},c=>{var l;a=!1,(l=r.error)===null||l===void 0||l.call(r,c),s.error(c)},()=>{var c,l;a&&((c=r.unsubscribe)===null||c===void 0||c.call(r)),(l=r.finalize)===null||l===void 0||l.call(r)}))}):Fn}var Ly="https://g.co/ng/security#xss",ve=class extends Error{constructor(n,t){super(nf(n,t)),this.code=n}};function nf(e,n){return`${`NG0${Math.abs(e)}`}${n?": "+n:""}`}function nc(e){return{toString:e}.toString()}var Cu="__parameters__";function $A(e){return function(...t){if(e){let r=e(...t);for(let i in r)this[i]=r[i]}}}function By(e,n,t){return nc(()=>{let r=$A(n);function i(...s){if(this instanceof i)return r.apply(this,s),this;let o=new i(...s);return a.annotation=o,a;function a(c,l,u){let f=c.hasOwnProperty(Cu)?c[Cu]:Object.defineProperty(c,Cu,{value:[]})[Cu];for(;f.length<=u;)f.push(null);return(f[u]=f[u]||[]).push(o),c}}return t&&(i.prototype=Object.create(t.prototype)),i.prototype.ngMetadataName=e,i.annotationCls=i,i})}var vn=globalThis;function ot(e){for(let n in e)if(e[n]===ot)return n;throw Error("Could not find renamed property on target object.")}function _n(e){if(typeof e=="string")return e;if(Array.isArray(e))return"["+e.map(_n).join(", ")+"]";if(e==null)return""+e;if(e.overriddenName)return`${e.overriddenName}`;if(e.name)return`${e.name}`;let n=e.toString();if(n==null)return""+n;let t=n.indexOf(`
`);return t===-1?n:n.substring(0,t)}function Zx(e,n){return e==null||e===""?n===null?"":n:n==null||n===""?e:e+" "+n}var WA=ot({__forward_ref__:ot});function Uy(e){return e.__forward_ref__=Uy,e.toString=function(){return _n(this())},e}function zn(e){return jy(e)?e():e}function jy(e){return typeof e=="function"&&e.hasOwnProperty(WA)&&e.__forward_ref__===Uy}function he(e){return{token:e.token,providedIn:e.providedIn||null,factory:e.factory,value:void 0}}function Yt(e){return{providers:e.providers||[],imports:e.imports||[]}}function rf(e){return Jx(e,Hy)||Jx(e,$y)}function Vy(e){return rf(e)!==null}function Jx(e,n){return e.hasOwnProperty(n)?e[n]:null}function zA(e){let n=e&&(e[Hy]||e[$y]);return n||null}function ey(e){return e&&(e.hasOwnProperty(ty)||e.hasOwnProperty(GA))?e[ty]:null}var Hy=ot({\u0275prov:ot}),ty=ot({\u0275inj:ot}),$y=ot({ngInjectableDef:ot}),GA=ot({ngInjectorDef:ot}),ge=class{constructor(n,t){this._desc=n,this.ngMetadataName="InjectionToken",this.\u0275prov=void 0,typeof t=="number"?this.__NG_ELEMENT_ID__=t:t!==void 0&&(this.\u0275prov=he({token:this,providedIn:t.providedIn||"root",factory:t.factory}))}get multi(){return this}toString(){return`InjectionToken ${this._desc}`}};function Wy(e){return e&&!!e.\u0275providers}var qA=ot({\u0275cmp:ot}),KA=ot({\u0275dir:ot}),YA=ot({\u0275pipe:ot}),XA=ot({\u0275mod:ot}),Ou=ot({\u0275fac:ot}),Ha=ot({__NG_ELEMENT_ID__:ot}),ny=ot({__NG_ENV_ID__:ot});function bo(e){return typeof e=="string"?e:e==null?"":String(e)}function QA(e){return typeof e=="function"?e.name||e.toString():typeof e=="object"&&e!=null&&typeof e.type=="function"?e.type.name||e.type.toString():bo(e)}function ZA(e,n){let t=n?`. Dependency path: ${n.join(" > ")} > ${e}`:"";throw new ve(-200,e)}function rp(e,n){throw new ve(-201,!1)}var Me=function(e){return e[e.Default=0]="Default",e[e.Host=1]="Host",e[e.Self=2]="Self",e[e.SkipSelf=4]="SkipSelf",e[e.Optional=8]="Optional",e}(Me||{}),_0;function zy(){return _0}function Wn(e){let n=_0;return _0=e,n}function Gy(e,n,t){let r=rf(e);if(r&&r.providedIn=="root")return r.value===void 0?r.value=r.factory():r.value;if(t&Me.Optional)return null;if(n!==void 0)return n;rp(e,"Injector")}var JA={},Wa=JA,x0="__NG_DI_FLAG__",Fu="ngTempTokenPath",ek="ngTokenPath",tk=/\n/gm,nk="\u0275",ry="__source",So;function rk(){return So}function Ni(e){let n=So;return So=e,n}function ik(e,n=Me.Default){if(So===void 0)throw new ve(-203,!1);return So===null?Gy(e,void 0,n):So.get(e,n&Me.Optional?null:void 0,n)}function ue(e,n=Me.Default){return(zy()||ik)(zn(e),n)}function te(e,n=Me.Default){return ue(e,sf(n))}function sf(e){return typeof e>"u"||typeof e=="number"?e:0|(e.optional&&8)|(e.host&&1)|(e.self&&2)|(e.skipSelf&&4)}function y0(e){let n=[];for(let t=0;t<e.length;t++){let r=zn(e[t]);if(Array.isArray(r)){if(r.length===0)throw new ve(900,!1);let i,s=Me.Default;for(let o=0;o<r.length;o++){let a=r[o],c=sk(a);typeof c=="number"?c===-1?i=a.token:s|=c:i=a}n.push(ue(i,s))}else n.push(ue(r))}return n}function qy(e,n){return e[x0]=n,e.prototype[x0]=n,e}function sk(e){return e[x0]}function ok(e,n,t,r){let i=e[Fu];throw n[ry]&&i.unshift(n[ry]),e.message=ak(`
`+e.message,i,t,r),e[ek]=i,e[Fu]=null,e}function ak(e,n,t,r=null){e=e&&e.charAt(0)===`
`&&e.charAt(1)==nk?e.slice(2):e;let i=_n(n);if(Array.isArray(n))i=n.map(_n).join(" -> ");else if(typeof n=="object"){let s=[];for(let o in n)if(n.hasOwnProperty(o)){let a=n[o];s.push(o+":"+(typeof a=="string"?JSON.stringify(a):_n(a)))}i=`{${s.join(", ")}}`}return`${t}${r?"("+r+")":""}[${i}]: ${e.replace(tk,`
  `)}`}var qn=qy(By("Optional"),8);var ip=qy(By("SkipSelf"),4);function Ao(e,n){let t=e.hasOwnProperty(Ou);return t?e[Ou]:null}function sp(e,n){e.forEach(t=>Array.isArray(t)?sp(t,n):n(t))}function Ky(e,n,t){n>=e.length?e.push(t):e.splice(n,0,t)}function Pu(e,n){return n>=e.length-1?e.pop():e.splice(n,1)[0]}function ck(e,n,t,r){let i=e.length;if(i==n)e.push(t,r);else if(i===1)e.push(r,e[0]),e[0]=t;else{for(i--,e.push(e[i-1],e[i]);i>n;){let s=i-2;e[i]=e[s],i--}e[n]=t,e[n+1]=r}}function lk(e,n,t){let r=rc(e,n);return r>=0?e[r|1]=t:(r=~r,ck(e,r,n,t)),r}function o0(e,n){let t=rc(e,n);if(t>=0)return e[t|1]}function rc(e,n){return uk(e,n,1)}function uk(e,n,t){let r=0,i=e.length>>t;for(;i!==r;){let s=r+(i-r>>1),o=e[s<<t];if(n===o)return s<<t;o>n?i=s:r=s+1}return~(i<<t)}var za={},lr=[],ko=new ge(""),Yy=new ge("",-1),Xy=new ge(""),Lu=class{get(n,t=Wa){if(t===Wa){let r=new Error(`NullInjectorError: No provider for ${_n(n)}!`);throw r.name="NullInjectorError",r}return t}},Qy=function(e){return e[e.OnPush=0]="OnPush",e[e.Default=1]="Default",e}(Qy||{}),Rr=function(e){return e[e.Emulated=0]="Emulated",e[e.None=2]="None",e[e.ShadowDom=3]="ShadowDom",e}(Rr||{}),fr=function(e){return e[e.None=0]="None",e[e.SignalBased=1]="SignalBased",e[e.HasDecoratorInputTransform=2]="HasDecoratorInputTransform",e}(fr||{});function fk(e,n,t){let r=e.length;for(;;){let i=e.indexOf(n,t);if(i===-1)return i;if(i===0||e.charCodeAt(i-1)<=32){let s=n.length;if(i+s===r||e.charCodeAt(i+s)<=32)return i}t=i+1}}function w0(e,n,t){let r=0;for(;r<t.length;){let i=t[r];if(typeof i=="number"){if(i!==0)break;r++;let s=t[r++],o=t[r++],a=t[r++];e.setAttribute(n,o,a,s)}else{let s=i,o=t[++r];dk(s)?e.setProperty(n,s,o):e.setAttribute(n,s,o),r++}}return r}function Zy(e){return e===3||e===4||e===6}function dk(e){return e.charCodeAt(0)===64}function op(e,n){if(!(n===null||n.length===0))if(e===null||e.length===0)e=n.slice();else{let t=-1;for(let r=0;r<n.length;r++){let i=n[r];typeof i=="number"?t=i:t===0||(t===-1||t===2?iy(e,t,i,null,n[++r]):iy(e,t,i,null,null))}}return e}function iy(e,n,t,r,i){let s=0,o=e.length;if(n===-1)o=-1;else for(;s<e.length;){let a=e[s++];if(typeof a=="number"){if(a===n){o=-1;break}else if(a>n){o=s-1;break}}}for(;s<e.length;){let a=e[s];if(typeof a=="number")break;if(a===t){if(r===null){i!==null&&(e[s+1]=i);return}else if(r===e[s+1]){e[s+2]=i;return}}s++,r!==null&&s++,i!==null&&s++}o!==-1&&(e.splice(o,0,n),s=o+1),e.splice(s++,0,t),r!==null&&e.splice(s++,0,r),i!==null&&e.splice(s++,0,i)}var Jy="ng-template";function hk(e,n,t,r){let i=0;if(r){for(;i<n.length&&typeof n[i]=="string";i+=2)if(n[i]==="class"&&fk(n[i+1].toLowerCase(),t,0)!==-1)return!0}else if(ap(e))return!1;if(i=n.indexOf(1,i),i>-1){let s;for(;++i<n.length&&typeof(s=n[i])=="string";)if(s.toLowerCase()===t)return!0}return!1}function ap(e){return e.type===4&&e.value!==Jy}function pk(e,n,t){let r=e.type===4&&!t?Jy:e.value;return n===r}function mk(e,n,t){let r=4,i=e.attrs,s=i!==null?_k(i):0,o=!1;for(let a=0;a<n.length;a++){let c=n[a];if(typeof c=="number"){if(!o&&!cr(r)&&!cr(c))return!1;if(o&&cr(c))continue;o=!1,r=c|r&1;continue}if(!o)if(r&4){if(r=2|r&1,c!==""&&!pk(e,c,t)||c===""&&n.length===1){if(cr(r))return!1;o=!0}}else if(r&8){if(i===null||!hk(e,i,c,t)){if(cr(r))return!1;o=!0}}else{let l=n[++a],u=gk(c,i,ap(e),t);if(u===-1){if(cr(r))return!1;o=!0;continue}if(l!==""){let f;if(u>s?f="":f=i[u+1].toLowerCase(),r&2&&l!==f){if(cr(r))return!1;o=!0}}}}return cr(r)||o}function cr(e){return(e&1)===0}function gk(e,n,t,r){if(n===null)return-1;let i=0;if(r||!t){let s=!1;for(;i<n.length;){let o=n[i];if(o===e)return i;if(o===3||o===6)s=!0;else if(o===1||o===2){let a=n[++i];for(;typeof a=="string";)a=n[++i];continue}else{if(o===4)break;if(o===0){i+=4;continue}}i+=s?1:2}return-1}else return xk(n,e)}function vk(e,n,t=!1){for(let r=0;r<n.length;r++)if(mk(e,n[r],t))return!0;return!1}function _k(e){for(let n=0;n<e.length;n++){let t=e[n];if(Zy(t))return n}return e.length}function xk(e,n){let t=e.indexOf(4);if(t>-1)for(t++;t<e.length;){let r=e[t];if(typeof r=="number")return-1;if(r===n)return t;t++}return-1}function sy(e,n){return e?":not("+n.trim()+")":n}function yk(e){let n=e[0],t=1,r=2,i="",s=!1;for(;t<e.length;){let o=e[t];if(typeof o=="string")if(r&2){let a=e[++t];i+="["+o+(a.length>0?'="'+a+'"':"")+"]"}else r&8?i+="."+o:r&4&&(i+=" "+o);else i!==""&&!cr(o)&&(n+=sy(s,i),i=""),r=o,s=s||!cr(r);t++}return i!==""&&(n+=sy(s,i)),n}function wk(e){return e.map(yk).join(",")}function Ek(e){let n=[],t=[],r=1,i=2;for(;r<e.length;){let s=e[r];if(typeof s=="string")i===2?s!==""&&n.push(s,e[++r]):i===8&&t.push(s);else{if(!cr(i))break;i=s}r++}return{attrs:n,classes:t}}function bn(e){return nc(()=>{let n=i1(e),t=gt(de({},n),{decls:e.decls,vars:e.vars,template:e.template,consts:e.consts||null,ngContentSelectors:e.ngContentSelectors,onPush:e.changeDetection===Qy.OnPush,directiveDefs:null,pipeDefs:null,dependencies:n.standalone&&e.dependencies||null,getStandaloneInjector:null,signals:e.signals??!1,data:e.data||{},encapsulation:e.encapsulation||Rr.Emulated,styles:e.styles||lr,_:null,schemas:e.schemas||null,tView:null,id:""});s1(t);let r=e.dependencies;return t.directiveDefs=ay(r,!1),t.pipeDefs=ay(r,!0),t.id=Ck(t),t})}function Tk(e){return Mi(e)||e1(e)}function Ik(e){return e!==null}function Xt(e){return nc(()=>({type:e.type,bootstrap:e.bootstrap||lr,declarations:e.declarations||lr,imports:e.imports||lr,exports:e.exports||lr,transitiveCompileScopes:null,schemas:e.schemas||null,id:e.id||null}))}function oy(e,n){if(e==null)return za;let t={};for(let r in e)if(e.hasOwnProperty(r)){let i=e[r],s,o,a=fr.None;Array.isArray(i)?(a=i[0],s=i[1],o=i[2]??s):(s=i,o=i),n?(t[s]=a!==fr.None?[r,a]:r,n[s]=o):t[s]=r}return t}function Po(e){return nc(()=>{let n=i1(e);return s1(n),n})}function Mi(e){return e[qA]||null}function e1(e){return e[KA]||null}function t1(e){return e[YA]||null}function n1(e){let n=Mi(e)||e1(e)||t1(e);return n!==null?n.standalone:!1}function r1(e,n){let t=e[XA]||null;if(!t&&n===!0)throw new Error(`Type ${_n(e)} does not have '\u0275mod' property.`);return t}function i1(e){let n={};return{type:e.type,providersResolver:null,factory:null,hostBindings:e.hostBindings||null,hostVars:e.hostVars||0,hostAttrs:e.hostAttrs||null,contentQueries:e.contentQueries||null,declaredInputs:n,inputTransforms:null,inputConfig:e.inputs||za,exportAs:e.exportAs||null,standalone:e.standalone===!0,signals:e.signals===!0,selectors:e.selectors||lr,viewQuery:e.viewQuery||null,features:e.features||null,setInput:null,findHostDirectiveDefs:null,hostDirectives:null,inputs:oy(e.inputs,n),outputs:oy(e.outputs),debugInfo:null}}function s1(e){e.features?.forEach(n=>n(e))}function ay(e,n){if(!e)return null;let t=n?t1:Tk;return()=>(typeof e=="function"?e():e).map(r=>t(r)).filter(Ik)}function Ck(e){let n=0,t=[e.selectors,e.ngContentSelectors,e.hostVars,e.hostAttrs,e.consts,e.vars,e.decls,e.encapsulation,e.standalone,e.signals,e.exportAs,JSON.stringify(e.inputs),JSON.stringify(e.outputs),Object.getOwnPropertyNames(e.type.prototype),!!e.contentQueries,!!e.viewQuery].join("|");for(let i of t)n=Math.imul(31,n)+i.charCodeAt(0)<<0;return n+=2147483648,"c"+n}function of(e){return{\u0275providers:e}}function Sk(...e){return{\u0275providers:o1(!0,e),\u0275fromNgModule:!0}}function o1(e,...n){let t=[],r=new Set,i,s=o=>{t.push(o)};return sp(n,o=>{let a=o;E0(a,s,[],r)&&(i||=[],i.push(a))}),i!==void 0&&a1(i,s),t}function a1(e,n){for(let t=0;t<e.length;t++){let{ngModule:r,providers:i}=e[t];cp(i,s=>{n(s,r)})}}function E0(e,n,t,r){if(e=zn(e),!e)return!1;let i=null,s=ey(e),o=!s&&Mi(e);if(!s&&!o){let c=e.ngModule;if(s=ey(c),s)i=c;else return!1}else{if(o&&!o.standalone)return!1;i=e}let a=r.has(i);if(o){if(a)return!1;if(r.add(i),o.dependencies){let c=typeof o.dependencies=="function"?o.dependencies():o.dependencies;for(let l of c)E0(l,n,t,r)}}else if(s){if(s.imports!=null&&!a){r.add(i);let l;try{sp(s.imports,u=>{E0(u,n,t,r)&&(l||=[],l.push(u))})}finally{}l!==void 0&&a1(l,n)}if(!a){let l=Ao(i)||(()=>new i);n({provide:i,useFactory:l,deps:lr},i),n({provide:Xy,useValue:i,multi:!0},i),n({provide:ko,useValue:()=>ue(i),multi:!0},i)}let c=s.providers;if(c!=null&&!a){let l=e;cp(c,u=>{n(u,l)})}}else return!1;return i!==e&&e.providers!==void 0}function cp(e,n){for(let t of e)Wy(t)&&(t=t.\u0275providers),Array.isArray(t)?cp(t,n):n(t)}var Dk=ot({provide:String,useValue:ot});function c1(e){return e!==null&&typeof e=="object"&&Dk in e}function bk(e){return!!(e&&e.useExisting)}function Ak(e){return!!(e&&e.useFactory)}function T0(e){return typeof e=="function"}var af=new ge(""),Au={},kk={},a0;function lp(){return a0===void 0&&(a0=new Lu),a0}var nn=class{},Ga=class extends nn{get destroyed(){return this._destroyed}constructor(n,t,r,i){super(),this.parent=t,this.source=r,this.scopes=i,this.records=new Map,this._ngOnDestroyHooks=new Set,this._onDestroyHooks=[],this._destroyed=!1,C0(n,o=>this.processProvider(o)),this.records.set(Yy,Eo(void 0,this)),i.has("environment")&&this.records.set(nn,Eo(void 0,this));let s=this.records.get(af);s!=null&&typeof s.value=="string"&&this.scopes.add(s.value),this.injectorDefTypes=new Set(this.get(Xy,lr,Me.Self))}destroy(){this.assertNotDestroyed(),this._destroyed=!0;let n=Ze(null);try{for(let r of this._ngOnDestroyHooks)r.ngOnDestroy();let t=this._onDestroyHooks;this._onDestroyHooks=[];for(let r of t)r()}finally{this.records.clear(),this._ngOnDestroyHooks.clear(),this.injectorDefTypes.clear(),Ze(n)}}onDestroy(n){return this.assertNotDestroyed(),this._onDestroyHooks.push(n),()=>this.removeOnDestroy(n)}runInContext(n){this.assertNotDestroyed();let t=Ni(this),r=Wn(void 0),i;try{return n()}finally{Ni(t),Wn(r)}}get(n,t=Wa,r=Me.Default){if(this.assertNotDestroyed(),n.hasOwnProperty(ny))return n[ny](this);r=sf(r);let i,s=Ni(this),o=Wn(void 0);try{if(!(r&Me.SkipSelf)){let c=this.records.get(n);if(c===void 0){let l=Pk(n)&&rf(n);l&&this.injectableDefInScope(l)?c=Eo(I0(n),Au):c=null,this.records.set(n,c)}if(c!=null)return this.hydrate(n,c)}let a=r&Me.Self?lp():this.parent;return t=r&Me.Optional&&t===Wa?null:t,a.get(n,t)}catch(a){if(a.name==="NullInjectorError"){if((a[Fu]=a[Fu]||[]).unshift(_n(n)),s)throw a;return ok(a,n,"R3InjectorError",this.source)}else throw a}finally{Wn(o),Ni(s)}}resolveInjectorInitializers(){let n=Ze(null),t=Ni(this),r=Wn(void 0),i;try{let s=this.get(ko,lr,Me.Self);for(let o of s)o()}finally{Ni(t),Wn(r),Ze(n)}}toString(){let n=[],t=this.records;for(let r of t.keys())n.push(_n(r));return`R3Injector[${n.join(", ")}]`}assertNotDestroyed(){if(this._destroyed)throw new ve(205,!1)}processProvider(n){n=zn(n);let t=T0(n)?n:zn(n&&n.provide),r=Rk(n);if(!T0(n)&&n.multi===!0){let i=this.records.get(t);i||(i=Eo(void 0,Au,!0),i.factory=()=>y0(i.multi),this.records.set(t,i)),t=n,i.multi.push(n)}this.records.set(t,r)}hydrate(n,t){let r=Ze(null);try{return t.value===Au&&(t.value=kk,t.value=t.factory()),typeof t.value=="object"&&t.value&&Fk(t.value)&&this._ngOnDestroyHooks.add(t.value),t.value}finally{Ze(r)}}injectableDefInScope(n){if(!n.providedIn)return!1;let t=zn(n.providedIn);return typeof t=="string"?t==="any"||this.scopes.has(t):this.injectorDefTypes.has(t)}removeOnDestroy(n){let t=this._onDestroyHooks.indexOf(n);t!==-1&&this._onDestroyHooks.splice(t,1)}};function I0(e){let n=rf(e),t=n!==null?n.factory:Ao(e);if(t!==null)return t;if(e instanceof ge)throw new ve(204,!1);if(e instanceof Function)return Nk(e);throw new ve(204,!1)}function Nk(e){if(e.length>0)throw new ve(204,!1);let t=zA(e);return t!==null?()=>t.factory(e):()=>new e}function Rk(e){if(c1(e))return Eo(void 0,e.useValue);{let n=Mk(e);return Eo(n,Au)}}function Mk(e,n,t){let r;if(T0(e)){let i=zn(e);return Ao(i)||I0(i)}else if(c1(e))r=()=>zn(e.useValue);else if(Ak(e))r=()=>e.useFactory(...y0(e.deps||[]));else if(bk(e))r=()=>ue(zn(e.useExisting));else{let i=zn(e&&(e.useClass||e.provide));if(Ok(e))r=()=>new i(...y0(e.deps));else return Ao(i)||I0(i)}return r}function Eo(e,n,t=!1){return{factory:e,value:n,multi:t?[]:void 0}}function Ok(e){return!!e.deps}function Fk(e){return e!==null&&typeof e=="object"&&typeof e.ngOnDestroy=="function"}function Pk(e){return typeof e=="function"||typeof e=="object"&&e instanceof ge}function C0(e,n){for(let t of e)Array.isArray(t)?C0(t,n):t&&Wy(t)?C0(t.\u0275providers,n):n(t)}function pr(e,n){e instanceof Ga&&e.assertNotDestroyed();let t,r=Ni(e),i=Wn(void 0);try{return n()}finally{Ni(r),Wn(i)}}function l1(){return zy()!==void 0||rk()!=null}function Lk(e){if(!l1())throw new ve(-203,!1)}function Bk(e){let n=vn.ng;if(n&&n.\u0275compilerFacade)return n.\u0275compilerFacade;throw new Error("JIT compiler unavailable")}function Uk(e){return typeof e=="function"}var oi=0,We=1,Te=2,rn=3,ur=4,mr=5,Bu=6,qa=7,dr=8,No=9,hr=10,Kt=11,Ka=12,cy=13,Lo=14,Mr=15,cf=16,To=17,Ro=18,lf=19,u1=20,Ri=21,c0=22,xs=23,Oi=25,f1=1;var ys=7,Uu=8,ju=9,Gn=10,up=function(e){return e[e.None=0]="None",e[e.HasTransplantedViews=2]="HasTransplantedViews",e}(up||{});function vs(e){return Array.isArray(e)&&typeof e[f1]=="object"}function ai(e){return Array.isArray(e)&&e[f1]===!0}function d1(e){return(e.flags&4)!==0}function uf(e){return e.componentOffset>-1}function fp(e){return(e.flags&1)===1}function ic(e){return!!e.template}function jk(e){return(e[Te]&512)!==0}var S0=class{constructor(n,t,r){this.previousValue=n,this.currentValue=t,this.firstChange=r}isFirstChange(){return this.firstChange}};function h1(e,n,t,r){n!==null?n.applyValueToInputSignal(n,r):e[t]=r}function sc(){return p1}function p1(e){return e.type.prototype.ngOnChanges&&(e.setInput=Hk),Vk}sc.ngInherit=!0;function Vk(){let e=g1(this),n=e?.current;if(n){let t=e.previous;if(t===za)e.previous=n;else for(let r in n)t[r]=n[r];e.current=null,this.ngOnChanges(n)}}function Hk(e,n,t,r,i){let s=this.declaredInputs[r],o=g1(e)||$k(e,{previous:za,current:null}),a=o.current||(o.current={}),c=o.previous,l=c[s];a[s]=new S0(l&&l.currentValue,t,c===za),h1(e,n,i,t)}var m1="__ngSimpleChanges__";function g1(e){return e[m1]||null}function $k(e,n){return e[m1]=n}var ly=null;var kr=function(e,n,t){ly?.(e,n,t)},Wk="svg",zk="math",Gk=!1;function qk(){return Gk}function Or(e){for(;Array.isArray(e);)e=e[oi];return e}function v1(e,n){return Or(n[e])}function Kn(e,n){return Or(n[e.index])}function _1(e,n){return e.data[n]}function Li(e,n){let t=n[e];return vs(t)?t:t[oi]}function dp(e){return(e[Te]&128)===128}function Kk(e){return ai(e[rn])}function Vu(e,n){return n==null?null:e[n]}function x1(e){e[To]=0}function Yk(e){e[Te]&1024||(e[Te]|=1024,dp(e)&&Ya(e))}function Xk(e,n){for(;e>0;)n=n[Lo],e--;return n}function hp(e){return!!(e[Te]&9216||e[xs]?.dirty)}function D0(e){e[hr].changeDetectionScheduler?.notify(1),hp(e)?Ya(e):e[Te]&64&&(qk()?(e[Te]|=1024,Ya(e)):e[hr].changeDetectionScheduler?.notify())}function Ya(e){e[hr].changeDetectionScheduler?.notify();let n=Xa(e);for(;n!==null&&!(n[Te]&8192||(n[Te]|=8192,!dp(n)));)n=Xa(n)}function y1(e,n){if((e[Te]&256)===256)throw new ve(911,!1);e[Ri]===null&&(e[Ri]=[]),e[Ri].push(n)}function Qk(e,n){if(e[Ri]===null)return;let t=e[Ri].indexOf(n);t!==-1&&e[Ri].splice(t,1)}function Xa(e){let n=e[rn];return ai(n)?n[rn]:n}var Le={lFrame:b1(null),bindingsEnabled:!0,skipHydrationRootTNode:null};function Zk(){return Le.lFrame.elementDepthCount}function Jk(){Le.lFrame.elementDepthCount++}function e2(){Le.lFrame.elementDepthCount--}function w1(){return Le.bindingsEnabled}function t2(){return Le.skipHydrationRootTNode!==null}function n2(e){return Le.skipHydrationRootTNode===e}function r2(){Le.skipHydrationRootTNode=null}function pt(){return Le.lFrame.lView}function ci(){return Le.lFrame.tView}function Bo(e){return Le.lFrame.contextLView=e,e[dr]}function Uo(e){return Le.lFrame.contextLView=null,e}function Yn(){let e=E1();for(;e!==null&&e.type===64;)e=e.parent;return e}function E1(){return Le.lFrame.currentTNode}function i2(){let e=Le.lFrame,n=e.currentTNode;return e.isParent?n:n.parent}function oc(e,n){let t=Le.lFrame;t.currentTNode=e,t.isParent=n}function T1(){return Le.lFrame.isParent}function s2(){Le.lFrame.isParent=!1}function o2(){return Le.lFrame.bindingIndex}function a2(e){return Le.lFrame.bindingIndex=e}function pp(){return Le.lFrame.bindingIndex++}function I1(e){let n=Le.lFrame,t=n.bindingIndex;return n.bindingIndex=n.bindingIndex+e,t}function c2(){return Le.lFrame.inI18n}function l2(e,n){let t=Le.lFrame;t.bindingIndex=t.bindingRootIndex=e,b0(n)}function u2(){return Le.lFrame.currentDirectiveIndex}function b0(e){Le.lFrame.currentDirectiveIndex=e}function f2(e){let n=Le.lFrame.currentDirectiveIndex;return n===-1?null:e[n]}function C1(e){Le.lFrame.currentQueryIndex=e}function d2(e){let n=e[We];return n.type===2?n.declTNode:n.type===1?e[mr]:null}function S1(e,n,t){if(t&Me.SkipSelf){let i=n,s=e;for(;i=i.parent,i===null&&!(t&Me.Host);)if(i=d2(s),i===null||(s=s[Lo],i.type&10))break;if(i===null)return!1;n=i,e=s}let r=Le.lFrame=D1();return r.currentTNode=n,r.lView=e,!0}function mp(e){let n=D1(),t=e[We];Le.lFrame=n,n.currentTNode=t.firstChild,n.lView=e,n.tView=t,n.contextLView=e,n.bindingIndex=t.bindingStartIndex,n.inI18n=!1}function D1(){let e=Le.lFrame,n=e===null?null:e.child;return n===null?b1(e):n}function b1(e){let n={currentTNode:null,isParent:!0,lView:null,tView:null,selectedIndex:-1,contextLView:null,elementDepthCount:0,currentNamespace:null,currentDirectiveIndex:-1,bindingRootIndex:-1,bindingIndex:-1,currentQueryIndex:0,parent:e,child:null,inI18n:!1};return e!==null&&(e.child=n),n}function A1(){let e=Le.lFrame;return Le.lFrame=e.parent,e.currentTNode=null,e.lView=null,e}var k1=A1;function gp(){let e=A1();e.isParent=!0,e.tView=null,e.selectedIndex=-1,e.contextLView=null,e.elementDepthCount=0,e.currentDirectiveIndex=-1,e.currentNamespace=null,e.bindingRootIndex=-1,e.bindingIndex=-1,e.currentQueryIndex=0}function h2(e){return(Le.lFrame.contextLView=Xk(e,Le.lFrame.contextLView))[dr]}function Cs(){return Le.lFrame.selectedIndex}function ws(e){Le.lFrame.selectedIndex=e}function N1(){let e=Le.lFrame;return _1(e.tView,e.selectedIndex)}function p2(){return Le.lFrame.currentNamespace}var R1=!0;function vp(){return R1}function _p(e){R1=e}function m2(e,n,t){let{ngOnChanges:r,ngOnInit:i,ngDoCheck:s}=n.type.prototype;if(r){let o=p1(n);(t.preOrderHooks??=[]).push(e,o),(t.preOrderCheckHooks??=[]).push(e,o)}i&&(t.preOrderHooks??=[]).push(0-e,i),s&&((t.preOrderHooks??=[]).push(e,s),(t.preOrderCheckHooks??=[]).push(e,s))}function xp(e,n){for(let t=n.directiveStart,r=n.directiveEnd;t<r;t++){let s=e.data[t].type.prototype,{ngAfterContentInit:o,ngAfterContentChecked:a,ngAfterViewInit:c,ngAfterViewChecked:l,ngOnDestroy:u}=s;o&&(e.contentHooks??=[]).push(-t,o),a&&((e.contentHooks??=[]).push(t,a),(e.contentCheckHooks??=[]).push(t,a)),c&&(e.viewHooks??=[]).push(-t,c),l&&((e.viewHooks??=[]).push(t,l),(e.viewCheckHooks??=[]).push(t,l)),u!=null&&(e.destroyHooks??=[]).push(t,u)}}function ku(e,n,t){M1(e,n,3,t)}function Nu(e,n,t,r){(e[Te]&3)===t&&M1(e,n,t,r)}function l0(e,n){let t=e[Te];(t&3)===n&&(t&=16383,t+=1,e[Te]=t)}function M1(e,n,t,r){let i=r!==void 0?e[To]&65535:0,s=r??-1,o=n.length-1,a=0;for(let c=i;c<o;c++)if(typeof n[c+1]=="number"){if(a=n[c],r!=null&&a>=r)break}else n[c]<0&&(e[To]+=65536),(a<s||s==-1)&&(g2(e,t,n,c),e[To]=(e[To]&4294901760)+c+2),c++}function uy(e,n){kr(4,e,n);let t=Ze(null);try{n.call(e)}finally{Ze(t),kr(5,e,n)}}function g2(e,n,t,r){let i=t[r]<0,s=t[r+1],o=i?-t[r]:t[r],a=e[o];i?e[Te]>>14<e[To]>>16&&(e[Te]&3)===n&&(e[Te]+=16384,uy(a,s)):uy(a,s)}var Do=-1,Qa=class{constructor(n,t,r){this.factory=n,this.resolving=!1,this.canSeeViewProviders=t,this.injectImpl=r}};function v2(e){return e instanceof Qa}function _2(e){return(e.flags&8)!==0}function x2(e){return(e.flags&16)!==0}function O1(e){return e!==Do}function Hu(e){return e&32767}function y2(e){return e>>16}function $u(e,n){let t=y2(e),r=n;for(;t>0;)r=r[Lo],t--;return r}var A0=!0;function fy(e){let n=A0;return A0=e,n}var w2=256,F1=w2-1,P1=5,E2=0,Nr={};function T2(e,n,t){let r;typeof t=="string"?r=t.charCodeAt(0)||0:t.hasOwnProperty(Ha)&&(r=t[Ha]),r==null&&(r=t[Ha]=E2++);let i=r&F1,s=1<<i;n.data[e+(i>>P1)]|=s}function L1(e,n){let t=B1(e,n);if(t!==-1)return t;let r=n[We];r.firstCreatePass&&(e.injectorIndex=n.length,u0(r.data,e),u0(n,null),u0(r.blueprint,null));let i=yp(e,n),s=e.injectorIndex;if(O1(i)){let o=Hu(i),a=$u(i,n),c=a[We].data;for(let l=0;l<8;l++)n[s+l]=a[o+l]|c[o+l]}return n[s+8]=i,s}function u0(e,n){e.push(0,0,0,0,0,0,0,0,n)}function B1(e,n){return e.injectorIndex===-1||e.parent&&e.parent.injectorIndex===e.injectorIndex||n[e.injectorIndex+8]===null?-1:e.injectorIndex}function yp(e,n){if(e.parent&&e.parent.injectorIndex!==-1)return e.parent.injectorIndex;let t=0,r=null,i=n;for(;i!==null;){if(r=$1(i),r===null)return Do;if(t++,i=i[Lo],r.injectorIndex!==-1)return r.injectorIndex|t<<16}return Do}function I2(e,n,t){T2(e,n,t)}function C2(e,n){if(n==="class")return e.classes;if(n==="style")return e.styles;let t=e.attrs;if(t){let r=t.length,i=0;for(;i<r;){let s=t[i];if(Zy(s))break;if(s===0)i=i+2;else if(typeof s=="number")for(i++;i<r&&typeof t[i]=="string";)i++;else{if(s===n)return t[i+1];i=i+2}}}return null}function U1(e,n,t){if(t&Me.Optional||e!==void 0)return e;rp(n,"NodeInjector")}function j1(e,n,t,r){if(t&Me.Optional&&r===void 0&&(r=null),!(t&(Me.Self|Me.Host))){let i=e[No],s=Wn(void 0);try{return i?i.get(n,r,t&Me.Optional):Gy(n,r,t&Me.Optional)}finally{Wn(s)}}return U1(r,n,t)}function V1(e,n,t,r=Me.Default,i){if(e!==null){if(n[Te]&2048&&!(r&Me.Self)){let o=k2(e,n,t,r,Nr);if(o!==Nr)return o}let s=H1(e,n,t,r,Nr);if(s!==Nr)return s}return j1(n,t,r,i)}function H1(e,n,t,r,i){let s=b2(t);if(typeof s=="function"){if(!S1(n,e,r))return r&Me.Host?U1(i,t,r):j1(n,t,r,i);try{let o;if(o=s(r),o==null&&!(r&Me.Optional))rp(t);else return o}finally{k1()}}else if(typeof s=="number"){let o=null,a=B1(e,n),c=Do,l=r&Me.Host?n[Mr][mr]:null;for((a===-1||r&Me.SkipSelf)&&(c=a===-1?yp(e,n):n[a+8],c===Do||!hy(r,!1)?a=-1:(o=n[We],a=Hu(c),n=$u(c,n)));a!==-1;){let u=n[We];if(dy(s,a,u.data)){let f=S2(a,n,t,o,r,l);if(f!==Nr)return f}c=n[a+8],c!==Do&&hy(r,n[We].data[a+8]===l)&&dy(s,a,n)?(o=u,a=Hu(c),n=$u(c,n)):a=-1}}return i}function S2(e,n,t,r,i,s){let o=n[We],a=o.data[e+8],c=r==null?uf(a)&&A0:r!=o&&(a.type&3)!==0,l=i&Me.Host&&s===a,u=D2(a,o,t,c,l);return u!==null?Za(n,o,u,a):Nr}function D2(e,n,t,r,i){let s=e.providerIndexes,o=n.data,a=s&1048575,c=e.directiveStart,l=e.directiveEnd,u=s>>20,f=r?a:a+u,d=i?a+u:l;for(let h=f;h<d;h++){let m=o[h];if(h<c&&t===m||h>=c&&m.type===t)return h}if(i){let h=o[c];if(h&&ic(h)&&h.type===t)return c}return null}function Za(e,n,t,r){let i=e[t],s=n.data;if(v2(i)){let o=i;o.resolving&&ZA(QA(s[t]));let a=fy(o.canSeeViewProviders);o.resolving=!0;let c,l=o.injectImpl?Wn(o.injectImpl):null,u=S1(e,r,Me.Default);try{i=e[t]=o.factory(void 0,s,e,r),n.firstCreatePass&&t>=r.directiveStart&&m2(t,s[t],n)}finally{l!==null&&Wn(l),fy(a),o.resolving=!1,k1()}}return i}function b2(e){if(typeof e=="string")return e.charCodeAt(0)||0;let n=e.hasOwnProperty(Ha)?e[Ha]:void 0;return typeof n=="number"?n>=0?n&F1:A2:n}function dy(e,n,t){let r=1<<e;return!!(t[n+(e>>P1)]&r)}function hy(e,n){return!(e&Me.Self)&&!(e&Me.Host&&n)}var _s=class{constructor(n,t){this._tNode=n,this._lView=t}get(n,t,r){return V1(this._tNode,this._lView,n,sf(r),t)}};function A2(){return new _s(Yn(),pt())}function wp(e){return nc(()=>{let n=e.prototype.constructor,t=n[Ou]||k0(n),r=Object.prototype,i=Object.getPrototypeOf(e.prototype).constructor;for(;i&&i!==r;){let s=i[Ou]||k0(i);if(s&&s!==t)return s;i=Object.getPrototypeOf(i)}return s=>new s})}function k0(e){return jy(e)?()=>{let n=k0(zn(e));return n&&n()}:Ao(e)}function k2(e,n,t,r,i){let s=e,o=n;for(;s!==null&&o!==null&&o[Te]&2048&&!(o[Te]&512);){let a=H1(s,o,t,r|Me.Self,Nr);if(a!==Nr)return a;let c=s.parent;if(!c){let l=o[u1];if(l){let u=l.get(t,Nr,r);if(u!==Nr)return u}c=$1(o),o=o[Lo]}s=c}return i}function $1(e){let n=e[We],t=n.type;return t===2?n.declTNode:t===1?e[mr]:null}function Ep(e){return C2(Yn(),e)}function py(e,n=null,t=null,r){let i=W1(e,n,t,r);return i.resolveInjectorInitializers(),i}function W1(e,n=null,t=null,r,i=new Set){let s=[t||lr,Sk(e)];return r=r||(typeof e=="object"?void 0:_n(e)),new Ga(s,n||lp(),r||null,i)}var An=(()=>{class e{static{this.THROW_IF_NOT_FOUND=Wa}static{this.NULL=new Lu}static create(t,r){if(Array.isArray(t))return py({name:""},r,t,"");{let i=t.name??"";return py({name:i},t.parent,t.providers,i)}}static{this.\u0275prov=he({token:e,providedIn:"any",factory:()=>ue(Yy)})}static{this.__NG_ELEMENT_ID__=-1}}return e})();var N2="ngOriginalError";function f0(e){return e[N2]}var Fr=class{constructor(){this._console=console}handleError(n){let t=this._findOriginalError(n);this._console.error("ERROR",n),t&&this._console.error("ORIGINAL ERROR",t)}_findOriginalError(n){let t=n&&f0(n);for(;t&&f0(t);)t=f0(t);return t||null}},z1=new ge("",{providedIn:"root",factory:()=>te(Fr).handleError.bind(void 0)}),Tp=(()=>{class e{static{this.__NG_ELEMENT_ID__=R2}static{this.__NG_ENV_ID__=t=>t}}return e})(),N0=class extends Tp{constructor(n){super(),this._lView=n}onDestroy(n){return y1(this._lView,n),()=>Qk(this._lView,n)}};function R2(){return new N0(pt())}function M2(){return ff(Yn(),pt())}function ff(e,n){return new ac(Kn(e,n))}var ac=(()=>{class e{constructor(t){this.nativeElement=t}static{this.__NG_ELEMENT_ID__=M2}}return e})();var R0=class extends Lt{constructor(n=!1){super(),this.destroyRef=void 0,this.__isAsync=n,l1()&&(this.destroyRef=te(Tp,{optional:!0})??void 0)}emit(n){let t=Ze(null);try{super.next(n)}finally{Ze(t)}}subscribe(n,t,r){let i=n,s=t||(()=>null),o=r;if(n&&typeof n=="object"){let c=n;i=c.next?.bind(c),s=c.error?.bind(c),o=c.complete?.bind(c)}this.__isAsync&&(s=d0(s),i&&(i=d0(i)),o&&(o=d0(o)));let a=super.subscribe({next:i,error:s,complete:o});return n instanceof wt&&n.add(a),a}};function d0(e){return n=>{setTimeout(e,void 0,n)}}var gn=R0;function G1(e){return(e.flags&128)===128}var q1=new Map,O2=0;function F2(){return O2++}function P2(e){q1.set(e[lf],e)}function L2(e){q1.delete(e[lf])}var my="__ngContext__";function Es(e,n){vs(n)?(e[my]=n[lf],P2(n)):e[my]=n}function K1(e){return X1(e[Ka])}function Y1(e){return X1(e[ur])}function X1(e){for(;e!==null&&!ai(e);)e=e[ur];return e}var M0;function Q1(e){M0=e}function B2(){if(M0!==void 0)return M0;if(typeof document<"u")return document;throw new ve(210,!1)}var df=new ge("",{providedIn:"root",factory:()=>U2}),U2="ng",Ip=new ge(""),Xn=new ge("",{providedIn:"platform",factory:()=>"unknown"});var Cp=new ge("",{providedIn:"root",factory:()=>B2().body?.querySelector("[ngCspNonce]")?.getAttribute("ngCspNonce")||null});var j2="h",V2="b";var H2=()=>null;function Sp(e,n,t=!1){return H2(e,n,t)}var Z1=!1,$2=new ge("",{providedIn:"root",factory:()=>Z1});var Su;function W2(){if(Su===void 0&&(Su=null,vn.trustedTypes))try{Su=vn.trustedTypes.createPolicy("angular#unsafe-bypass",{createHTML:e=>e,createScript:e=>e,createScriptURL:e=>e})}catch{}return Su}function gy(e){return W2()?.createScriptURL(e)||e}var Wu=class{constructor(n){this.changingThisBreaksApplicationSecurity=n}toString(){return`SafeValue must use [property]=binding: ${this.changingThisBreaksApplicationSecurity} (see ${Ly})`}};function cc(e){return e instanceof Wu?e.changingThisBreaksApplicationSecurity:e}function Dp(e,n){let t=z2(e);if(t!=null&&t!==n){if(t==="ResourceURL"&&n==="URL")return!0;throw new Error(`Required a safe ${n}, got a ${t} (see ${Ly})`)}return t===n}function z2(e){return e instanceof Wu&&e.getTypeName()||null}var G2=/^(?!javascript:)(?:[a-z0-9+.-]+:|[^&:\/?#]*(?:[\/?#]|$))/i;function J1(e){return e=String(e),e.match(G2)?e:"unsafe:"+e}var hf=function(e){return e[e.NONE=0]="NONE",e[e.HTML=1]="HTML",e[e.STYLE=2]="STYLE",e[e.SCRIPT=3]="SCRIPT",e[e.URL=4]="URL",e[e.RESOURCE_URL=5]="RESOURCE_URL",e}(hf||{});function q2(e){let n=tw();return n?n.sanitize(hf.URL,e)||"":Dp(e,"URL")?cc(e):J1(bo(e))}function K2(e){let n=tw();if(n)return gy(n.sanitize(hf.RESOURCE_URL,e)||"");if(Dp(e,"ResourceURL"))return gy(cc(e));throw new ve(904,!1)}function Y2(e,n){return n==="src"&&(e==="embed"||e==="frame"||e==="iframe"||e==="media"||e==="script")||n==="href"&&(e==="base"||e==="link")?K2:q2}function ew(e,n,t){return Y2(n,t)(e)}function tw(){let e=pt();return e&&e[hr].sanitizer}function nw(e){return e instanceof Function?e():e}function X2(e){return(e??te(An)).get(Xn)==="browser"}var si=function(e){return e[e.Important=1]="Important",e[e.DashCase=2]="DashCase",e}(si||{}),Q2;function bp(e,n){return Q2(e,n)}function Io(e,n,t,r,i){if(r!=null){let s,o=!1;ai(r)?s=r:vs(r)&&(o=!0,r=r[oi]);let a=Or(r);e===0&&t!==null?i==null?aw(n,t,a):zu(n,t,a,i||null,!0):e===1&&t!==null?zu(n,t,a,i||null,!0):e===2?pN(n,a,o):e===3&&n.destroyNode(a),s!=null&&gN(n,e,s,t,i)}}function Z2(e,n){return e.createText(n)}function J2(e,n,t){e.setValue(n,t)}function rw(e,n,t){return e.createElement(n,t)}function eN(e,n){iw(e,n),n[oi]=null,n[mr]=null}function tN(e,n,t,r,i,s){r[oi]=i,r[mr]=n,pf(e,r,t,1,i,s)}function iw(e,n){n[hr].changeDetectionScheduler?.notify(1),pf(e,n,n[Kt],2,null,null)}function nN(e){let n=e[Ka];if(!n)return h0(e[We],e);for(;n;){let t=null;if(vs(n))t=n[Ka];else{let r=n[Gn];r&&(t=r)}if(!t){for(;n&&!n[ur]&&n!==e;)vs(n)&&h0(n[We],n),n=n[rn];n===null&&(n=e),vs(n)&&h0(n[We],n),t=n&&n[ur]}n=t}}function rN(e,n,t,r){let i=Gn+r,s=t.length;r>0&&(t[i-1][ur]=n),r<s-Gn?(n[ur]=t[i],Ky(t,Gn+r,n)):(t.push(n),n[ur]=null),n[rn]=t;let o=n[cf];o!==null&&t!==o&&iN(o,n);let a=n[Ro];a!==null&&a.insertView(e),D0(n),n[Te]|=128}function iN(e,n){let t=e[ju],i=n[rn][rn][Mr];n[Mr]!==i&&(e[Te]|=up.HasTransplantedViews),t===null?e[ju]=[n]:t.push(n)}function sw(e,n){let t=e[ju],r=t.indexOf(n);t.splice(r,1)}function O0(e,n){if(e.length<=Gn)return;let t=Gn+n,r=e[t];if(r){let i=r[cf];i!==null&&i!==e&&sw(i,r),n>0&&(e[t-1][ur]=r[ur]);let s=Pu(e,Gn+n);eN(r[We],r);let o=s[Ro];o!==null&&o.detachView(s[We]),r[rn]=null,r[ur]=null,r[Te]&=-129}return r}function ow(e,n){if(!(n[Te]&256)){let t=n[Kt];t.destroyNode&&pf(e,n,t,3,null,null),nN(n)}}function h0(e,n){if(n[Te]&256)return;let t=Ze(null);try{n[Te]&=-129,n[Te]|=256,n[xs]&&Ex(n[xs]),oN(e,n),sN(e,n),n[We].type===1&&n[Kt].destroy();let r=n[cf];if(r!==null&&ai(n[rn])){r!==n[rn]&&sw(r,n);let i=n[Ro];i!==null&&i.detachView(e)}L2(n)}finally{Ze(t)}}function sN(e,n){let t=e.cleanup,r=n[qa];if(t!==null)for(let s=0;s<t.length-1;s+=2)if(typeof t[s]=="string"){let o=t[s+3];o>=0?r[o]():r[-o].unsubscribe(),s+=2}else{let o=r[t[s+1]];t[s].call(o)}r!==null&&(n[qa]=null);let i=n[Ri];if(i!==null){n[Ri]=null;for(let s=0;s<i.length;s++){let o=i[s];o()}}}function oN(e,n){let t;if(e!=null&&(t=e.destroyHooks)!=null)for(let r=0;r<t.length;r+=2){let i=n[t[r]];if(!(i instanceof Qa)){let s=t[r+1];if(Array.isArray(s))for(let o=0;o<s.length;o+=2){let a=i[s[o]],c=s[o+1];kr(4,a,c);try{c.call(a)}finally{kr(5,a,c)}}else{kr(4,i,s);try{s.call(i)}finally{kr(5,i,s)}}}}}function aN(e,n,t){return cN(e,n.parent,t)}function cN(e,n,t){let r=n;for(;r!==null&&r.type&40;)n=r,r=n.parent;if(r===null)return t[oi];{let{componentOffset:i}=r;if(i>-1){let{encapsulation:s}=e.data[r.directiveStart+i];if(s===Rr.None||s===Rr.Emulated)return null}return Kn(r,t)}}function zu(e,n,t,r,i){e.insertBefore(n,t,r,i)}function aw(e,n,t){e.appendChild(n,t)}function vy(e,n,t,r,i){r!==null?zu(e,n,t,r,i):aw(e,n,t)}function lN(e,n,t,r){e.removeChild(n,t,r)}function Ap(e,n){return e.parentNode(n)}function uN(e,n){return e.nextSibling(n)}function fN(e,n,t){return hN(e,n,t)}function dN(e,n,t){return e.type&40?Kn(e,t):null}var hN=dN,_y;function kp(e,n,t,r){let i=aN(e,r,n),s=n[Kt],o=r.parent||n[mr],a=fN(o,r,n);if(i!=null)if(Array.isArray(t))for(let c=0;c<t.length;c++)vy(s,i,t[c],a,!1);else vy(s,i,t,a,!1);_y!==void 0&&_y(s,r,n,t,i)}function Ru(e,n){if(n!==null){let t=n.type;if(t&3)return Kn(n,e);if(t&4)return F0(-1,e[n.index]);if(t&8){let r=n.child;if(r!==null)return Ru(e,r);{let i=e[n.index];return ai(i)?F0(-1,i):Or(i)}}else{if(t&32)return bp(n,e)()||Or(e[n.index]);{let r=cw(e,n);if(r!==null){if(Array.isArray(r))return r[0];let i=Xa(e[Mr]);return Ru(i,r)}else return Ru(e,n.next)}}}return null}function cw(e,n){if(n!==null){let r=e[Mr][mr],i=n.projection;return r.projection[i]}return null}function F0(e,n){let t=Gn+e+1;if(t<n.length){let r=n[t],i=r[We].firstChild;if(i!==null)return Ru(r,i)}return n[ys]}function pN(e,n,t){let r=Ap(e,n);r&&lN(e,r,n,t)}function Np(e,n,t,r,i,s,o){for(;t!=null;){let a=r[t.index],c=t.type;if(o&&n===0&&(a&&Es(Or(a),r),t.flags|=2),(t.flags&32)!==32)if(c&8)Np(e,n,t.child,r,i,s,!1),Io(n,e,i,a,s);else if(c&32){let l=bp(t,r),u;for(;u=l();)Io(n,e,i,u,s);Io(n,e,i,a,s)}else c&16?mN(e,n,r,t,i,s):Io(n,e,i,a,s);t=o?t.projectionNext:t.next}}function pf(e,n,t,r,i,s){Np(t,r,e.firstChild,n,i,s,!1)}function mN(e,n,t,r,i,s){let o=t[Mr],c=o[mr].projection[r.projection];if(Array.isArray(c))for(let l=0;l<c.length;l++){let u=c[l];Io(n,e,i,u,s)}else{let l=c,u=o[rn];G1(r)&&(l.flags|=128),Np(e,n,l,u,i,s,!0)}}function gN(e,n,t,r,i){let s=t[ys],o=Or(t);s!==o&&Io(n,e,r,s,i);for(let a=Gn;a<t.length;a++){let c=t[a];pf(c[We],c,e,n,r,s)}}function vN(e,n,t,r,i){if(n)i?e.addClass(t,r):e.removeClass(t,r);else{let s=r.indexOf("-")===-1?void 0:si.DashCase;i==null?e.removeStyle(t,r,s):(typeof i=="string"&&i.endsWith("!important")&&(i=i.slice(0,-10),s|=si.Important),e.setStyle(t,r,i,s))}}function _N(e,n,t){e.setAttribute(n,"style",t)}function lw(e,n,t){t===""?e.removeAttribute(n,"class"):e.setAttribute(n,"class",t)}function uw(e,n,t){let{mergedAttrs:r,classes:i,styles:s}=t;r!==null&&w0(e,n,r),i!==null&&lw(e,n,i),s!==null&&_N(e,n,s)}var Bi={};function ke(e=1){fw(ci(),pt(),Cs()+e,!1)}function fw(e,n,t,r){if(!r)if((n[Te]&3)===3){let s=e.preOrderCheckHooks;s!==null&&ku(n,s,t)}else{let s=e.preOrderHooks;s!==null&&Nu(n,s,0,t)}ws(t)}function at(e,n=Me.Default){let t=pt();if(t===null)return ue(e,n);let r=Yn();return V1(r,t,zn(e),n)}function dw(){let e="invalid";throw new Error(e)}function hw(e,n,t,r,i,s){let o=Ze(null);try{let a=null;i&fr.SignalBased&&(a=n[r][_x]),a!==null&&a.transformFn!==void 0&&(s=a.transformFn(s)),i&fr.HasDecoratorInputTransform&&(s=e.inputTransforms[r].call(n,s)),e.setInput!==null?e.setInput(n,a,s,t,r):h1(n,a,r,s)}finally{Ze(o)}}function xN(e,n){let t=e.hostBindingOpCodes;if(t!==null)try{for(let r=0;r<t.length;r++){let i=t[r];if(i<0)ws(~i);else{let s=i,o=t[++r],a=t[++r];l2(o,s);let c=n[s];a(2,c)}}}finally{ws(-1)}}function mf(e,n,t,r,i,s,o,a,c,l,u){let f=n.blueprint.slice();return f[oi]=i,f[Te]=r|4|128|8|64,(l!==null||e&&e[Te]&2048)&&(f[Te]|=2048),x1(f),f[rn]=f[Lo]=e,f[dr]=t,f[hr]=o||e&&e[hr],f[Kt]=a||e&&e[Kt],f[No]=c||e&&e[No]||null,f[mr]=s,f[lf]=F2(),f[Bu]=u,f[u1]=l,f[Mr]=n.type==2?e[Mr]:f,f}function gf(e,n,t,r,i){let s=e.data[n];if(s===null)s=yN(e,n,t,r,i),c2()&&(s.flags|=32);else if(s.type&64){s.type=t,s.value=r,s.attrs=i;let o=i2();s.injectorIndex=o===null?-1:o.injectorIndex}return oc(s,!0),s}function yN(e,n,t,r,i){let s=E1(),o=T1(),a=o?s:s&&s.parent,c=e.data[n]=CN(e,a,t,n,r,i);return e.firstChild===null&&(e.firstChild=c),s!==null&&(o?s.child==null&&c.parent!==null&&(s.child=c):s.next===null&&(s.next=c,c.prev=s)),c}function pw(e,n,t,r){if(t===0)return-1;let i=n.length;for(let s=0;s<t;s++)n.push(r),e.blueprint.push(r),e.data.push(null);return i}function mw(e,n,t,r,i){let s=Cs(),o=r&2;try{ws(-1),o&&n.length>Oi&&fw(e,n,Oi,!1),kr(o?2:0,i),t(r,i)}finally{ws(s),kr(o?3:1,i)}}function gw(e,n,t){if(d1(n)){let r=Ze(null);try{let i=n.directiveStart,s=n.directiveEnd;for(let o=i;o<s;o++){let a=e.data[o];if(a.contentQueries){let c=t[o];a.contentQueries(1,c,o)}}}finally{Ze(r)}}}function vw(e,n,t){w1()&&(RN(e,n,t,Kn(t,n)),(t.flags&64)===64&&Ew(e,n,t))}function _w(e,n,t=Kn){let r=n.localNames;if(r!==null){let i=n.index+1;for(let s=0;s<r.length;s+=2){let o=r[s+1],a=o===-1?t(n,e):e[o];e[i++]=a}}}function xw(e){let n=e.tView;return n===null||n.incompleteFirstPass?e.tView=Rp(1,null,e.template,e.decls,e.vars,e.directiveDefs,e.pipeDefs,e.viewQuery,e.schemas,e.consts,e.id):n}function Rp(e,n,t,r,i,s,o,a,c,l,u){let f=Oi+r,d=f+i,h=wN(f,d),m=typeof l=="function"?l():l;return h[We]={type:e,blueprint:h,template:t,queries:null,viewQuery:a,declTNode:n,data:h.slice().fill(null,f),bindingStartIndex:f,expandoStartIndex:d,hostBindingOpCodes:null,firstCreatePass:!0,firstUpdatePass:!0,staticViewQueries:!1,staticContentQueries:!1,preOrderHooks:null,preOrderCheckHooks:null,contentHooks:null,contentCheckHooks:null,viewHooks:null,viewCheckHooks:null,destroyHooks:null,cleanup:null,contentQueries:null,components:null,directiveRegistry:typeof s=="function"?s():s,pipeRegistry:typeof o=="function"?o():o,firstChild:null,schemas:c,consts:m,incompleteFirstPass:!1,ssrId:u}}function wN(e,n){let t=[];for(let r=0;r<n;r++)t.push(r<e?null:Bi);return t}function EN(e,n,t,r){let s=r.get($2,Z1)||t===Rr.ShadowDom,o=e.selectRootElement(n,s);return TN(o),o}function TN(e){IN(e)}var IN=()=>null;function CN(e,n,t,r,i,s){let o=n?n.injectorIndex:-1,a=0;return t2()&&(a|=128),{type:t,index:r,insertBeforeIndex:null,injectorIndex:o,directiveStart:-1,directiveEnd:-1,directiveStylingLast:-1,componentOffset:-1,propertyBindings:null,flags:a,providerIndexes:0,value:i,attrs:s,mergedAttrs:null,localNames:null,initialInputs:void 0,inputs:null,outputs:null,tView:null,next:null,prev:null,projectionNext:null,child:null,parent:n,projection:null,styles:null,stylesWithoutHost:null,residualStyles:void 0,classes:null,classesWithoutHost:null,residualClasses:void 0,classBindings:0,styleBindings:0}}function xy(e,n,t,r,i){for(let s in n){if(!n.hasOwnProperty(s))continue;let o=n[s];if(o===void 0)continue;r??={};let a,c=fr.None;Array.isArray(o)?(a=o[0],c=o[1]):a=o;let l=s;if(i!==null){if(!i.hasOwnProperty(s))continue;l=i[s]}e===0?yy(r,t,l,a,c):yy(r,t,l,a)}return r}function yy(e,n,t,r,i){let s;e.hasOwnProperty(t)?(s=e[t]).push(n,r):s=e[t]=[n,r],i!==void 0&&s.push(i)}function SN(e,n,t){let r=n.directiveStart,i=n.directiveEnd,s=e.data,o=n.attrs,a=[],c=null,l=null;for(let u=r;u<i;u++){let f=s[u],d=t?t.get(f):null,h=d?d.inputs:null,m=d?d.outputs:null;c=xy(0,f.inputs,u,c,h),l=xy(1,f.outputs,u,l,m);let p=c!==null&&o!==null&&!ap(n)?$N(c,u,o):null;a.push(p)}c!==null&&(c.hasOwnProperty("class")&&(n.flags|=8),c.hasOwnProperty("style")&&(n.flags|=16)),n.initialInputs=a,n.inputs=c,n.outputs=l}function DN(e){return e==="class"?"className":e==="for"?"htmlFor":e==="formaction"?"formAction":e==="innerHtml"?"innerHTML":e==="readonly"?"readOnly":e==="tabindex"?"tabIndex":e}function bN(e,n,t,r,i,s,o,a){let c=Kn(n,t),l=n.inputs,u;!a&&l!=null&&(u=l[r])?(Mp(e,t,u,r,i),uf(n)&&AN(t,n.index)):n.type&3?(r=DN(r),i=o!=null?o(i,n.value||"",r):i,s.setProperty(c,r,i)):n.type&12}function AN(e,n){let t=Li(n,e);t[Te]&16||(t[Te]|=64)}function yw(e,n,t,r){if(w1()){let i=r===null?null:{"":-1},s=ON(e,t),o,a;s===null?o=a=null:[o,a]=s,o!==null&&ww(e,n,t,o,i,a),i&&FN(t,r,i)}t.mergedAttrs=op(t.mergedAttrs,t.attrs)}function ww(e,n,t,r,i,s){for(let l=0;l<r.length;l++)I2(L1(t,n),e,r[l].type);LN(t,e.data.length,r.length);for(let l=0;l<r.length;l++){let u=r[l];u.providersResolver&&u.providersResolver(u)}let o=!1,a=!1,c=pw(e,n,r.length,null);for(let l=0;l<r.length;l++){let u=r[l];t.mergedAttrs=op(t.mergedAttrs,u.hostAttrs),BN(e,t,n,c,u),PN(c,u,i),u.contentQueries!==null&&(t.flags|=4),(u.hostBindings!==null||u.hostAttrs!==null||u.hostVars!==0)&&(t.flags|=64);let f=u.type.prototype;!o&&(f.ngOnChanges||f.ngOnInit||f.ngDoCheck)&&((e.preOrderHooks??=[]).push(t.index),o=!0),!a&&(f.ngOnChanges||f.ngDoCheck)&&((e.preOrderCheckHooks??=[]).push(t.index),a=!0),c++}SN(e,t,s)}function kN(e,n,t,r,i){let s=i.hostBindings;if(s){let o=e.hostBindingOpCodes;o===null&&(o=e.hostBindingOpCodes=[]);let a=~n.index;NN(o)!=a&&o.push(a),o.push(t,r,s)}}function NN(e){let n=e.length;for(;n>0;){let t=e[--n];if(typeof t=="number"&&t<0)return t}return 0}function RN(e,n,t,r){let i=t.directiveStart,s=t.directiveEnd;uf(t)&&UN(n,t,e.data[i+t.componentOffset]),e.firstCreatePass||L1(t,n),Es(r,n);let o=t.initialInputs;for(let a=i;a<s;a++){let c=e.data[a],l=Za(n,e,a,t);if(Es(l,n),o!==null&&HN(n,a-i,l,c,t,o),ic(c)){let u=Li(t.index,n);u[dr]=Za(n,e,a,t)}}}function Ew(e,n,t){let r=t.directiveStart,i=t.directiveEnd,s=t.index,o=u2();try{ws(s);for(let a=r;a<i;a++){let c=e.data[a],l=n[a];b0(a),(c.hostBindings!==null||c.hostVars!==0||c.hostAttrs!==null)&&MN(c,l)}}finally{ws(-1),b0(o)}}function MN(e,n){e.hostBindings!==null&&e.hostBindings(1,n)}function ON(e,n){let t=e.directiveRegistry,r=null,i=null;if(t)for(let s=0;s<t.length;s++){let o=t[s];if(vk(n,o.selectors,!1))if(r||(r=[]),ic(o))if(o.findHostDirectiveDefs!==null){let a=[];i=i||new Map,o.findHostDirectiveDefs(o,a,i),r.unshift(...a,o);let c=a.length;P0(e,n,c)}else r.unshift(o),P0(e,n,0);else i=i||new Map,o.findHostDirectiveDefs?.(o,r,i),r.push(o)}return r===null?null:[r,i]}function P0(e,n,t){n.componentOffset=t,(e.components??=[]).push(n.index)}function FN(e,n,t){if(n){let r=e.localNames=[];for(let i=0;i<n.length;i+=2){let s=t[n[i+1]];if(s==null)throw new ve(-301,!1);r.push(n[i],s)}}}function PN(e,n,t){if(t){if(n.exportAs)for(let r=0;r<n.exportAs.length;r++)t[n.exportAs[r]]=e;ic(n)&&(t[""]=e)}}function LN(e,n,t){e.flags|=1,e.directiveStart=n,e.directiveEnd=n+t,e.providerIndexes=n}function BN(e,n,t,r,i){e.data[r]=i;let s=i.factory||(i.factory=Ao(i.type,!0)),o=new Qa(s,ic(i),at);e.blueprint[r]=o,t[r]=o,kN(e,n,r,pw(e,t,i.hostVars,Bi),i)}function UN(e,n,t){let r=Kn(n,e),i=xw(t),s=e[hr].rendererFactory,o=16;t.signals?o=4096:t.onPush&&(o=64);let a=vf(e,mf(e,i,null,o,r,n,null,s.createRenderer(r,t),null,null,null));e[n.index]=a}function jN(e,n,t,r,i,s){let o=Kn(e,n);VN(n[Kt],o,s,e.value,t,r,i)}function VN(e,n,t,r,i,s,o){if(s==null)e.removeAttribute(n,i,t);else{let a=o==null?bo(s):o(s,r||"",i);e.setAttribute(n,i,a,t)}}function HN(e,n,t,r,i,s){let o=s[n];if(o!==null)for(let a=0;a<o.length;){let c=o[a++],l=o[a++],u=o[a++],f=o[a++];hw(r,t,c,l,u,f)}}function $N(e,n,t){let r=null,i=0;for(;i<t.length;){let s=t[i];if(s===0){i+=4;continue}else if(s===5){i+=2;continue}if(typeof s=="number")break;if(e.hasOwnProperty(s)){r===null&&(r=[]);let o=e[s];for(let a=0;a<o.length;a+=3)if(o[a]===n){r.push(s,o[a+1],o[a+2],t[i+1]);break}}i+=2}return r}function Tw(e,n,t,r){return[e,!0,0,n,null,r,null,t,null,null]}function Iw(e,n){let t=e.contentQueries;if(t!==null){let r=Ze(null);try{for(let i=0;i<t.length;i+=2){let s=t[i],o=t[i+1];if(o!==-1){let a=e.data[o];C1(s),a.contentQueries(2,n[o],o)}}}finally{Ze(r)}}}function vf(e,n){return e[Ka]?e[cy][ur]=n:e[Ka]=n,e[cy]=n,n}function L0(e,n,t){C1(0);let r=Ze(null);try{n(e,t)}finally{Ze(r)}}function WN(e){return e[qa]||(e[qa]=[])}function zN(e){return e.cleanup||(e.cleanup=[])}function Cw(e,n){let t=e[No],r=t?t.get(Fr,null):null;r&&r.handleError(n)}function Mp(e,n,t,r,i){for(let s=0;s<t.length;){let o=t[s++],a=t[s++],c=t[s++],l=n[o],u=e.data[o];hw(u,l,r,a,c,i)}}function Sw(e,n,t){let r=v1(n,e);J2(e[Kt],r,t)}function GN(e,n){let t=Li(n,e),r=t[We];qN(r,t);let i=t[oi];i!==null&&t[Bu]===null&&(t[Bu]=Sp(i,t[No])),Op(r,t,t[dr])}function qN(e,n){for(let t=n.length;t<e.blueprint.length;t++)n.push(e.blueprint[t])}function Op(e,n,t){mp(n);try{let r=e.viewQuery;r!==null&&L0(1,r,t);let i=e.template;i!==null&&mw(e,n,i,1,t),e.firstCreatePass&&(e.firstCreatePass=!1),n[Ro]?.finishViewCreation(e),e.staticContentQueries&&Iw(e,n),e.staticViewQueries&&L0(2,e.viewQuery,t);let s=e.components;s!==null&&KN(n,s)}catch(r){throw e.firstCreatePass&&(e.incompleteFirstPass=!0,e.firstCreatePass=!1),r}finally{n[Te]&=-5,gp()}}function KN(e,n){for(let t=0;t<n.length;t++)GN(e,n[t])}function YN(e,n,t,r){let i=Ze(null);try{let s=n.tView,a=e[Te]&4096?4096:16,c=mf(e,s,t,a,null,n,null,null,r?.injector??null,r?.embeddedViewInjector??null,r?.dehydratedView??null),l=e[n.index];c[cf]=l;let u=e[Ro];return u!==null&&(c[Ro]=u.createEmbeddedView(s)),Op(s,c,t),c}finally{Ze(i)}}function wy(e,n){return!n||n.firstChild===null||G1(e)}function XN(e,n,t,r=!0){let i=n[We];if(rN(i,n,e,t),r){let o=F0(t,e),a=n[Kt],c=Ap(a,e[ys]);c!==null&&tN(i,e[mr],a,n,c,o)}let s=n[Bu];s!==null&&s.firstChild!==null&&(s.firstChild=null)}function Gu(e,n,t,r,i=!1){for(;t!==null;){let s=n[t.index];s!==null&&r.push(Or(s)),ai(s)&&QN(s,r);let o=t.type;if(o&8)Gu(e,n,t.child,r);else if(o&32){let a=bp(t,n),c;for(;c=a();)r.push(c)}else if(o&16){let a=cw(n,t);if(Array.isArray(a))r.push(...a);else{let c=Xa(n[Mr]);Gu(c[We],c,a,r,!0)}}t=i?t.projectionNext:t.next}return r}function QN(e,n){for(let t=Gn;t<e.length;t++){let r=e[t],i=r[We].firstChild;i!==null&&Gu(r[We],r,i,n)}e[ys]!==e[oi]&&n.push(e[ys])}var Dw=[];function ZN(e){return e[xs]??JN(e)}function JN(e){let n=Dw.pop()??Object.create(tR);return n.lView=e,n}function eR(e){e.lView[xs]!==e&&(e.lView=null,Dw.push(e))}var tR=gt(de({},xx),{consumerIsAlwaysLive:!0,consumerMarkedDirty:e=>{Ya(e.lView)},consumerOnSignalRead(){this.lView[xs]=this}}),bw=100;function Aw(e,n=!0,t=0){let r=e[hr],i=r.rendererFactory,s=!1;s||i.begin?.();try{nR(e,t)}catch(o){throw n&&Cw(e,o),o}finally{s||(i.end?.(),r.inlineEffectRunner?.flush())}}function nR(e,n){B0(e,n);let t=0;for(;hp(e);){if(t===bw)throw new ve(103,!1);t++,B0(e,1)}}function rR(e,n,t,r){let i=n[Te];if((i&256)===256)return;let s=!1;!s&&n[hr].inlineEffectRunner?.flush(),mp(n);let o=null,a=null;!s&&iR(e)&&(a=ZN(n),o=yx(a));try{x1(n),a2(e.bindingStartIndex),t!==null&&mw(e,n,t,2,r);let c=(i&3)===3;if(!s)if(c){let f=e.preOrderCheckHooks;f!==null&&ku(n,f,null)}else{let f=e.preOrderHooks;f!==null&&Nu(n,f,0,null),l0(n,0)}if(sR(n),kw(n,0),e.contentQueries!==null&&Iw(e,n),!s)if(c){let f=e.contentCheckHooks;f!==null&&ku(n,f)}else{let f=e.contentHooks;f!==null&&Nu(n,f,1),l0(n,1)}xN(e,n);let l=e.components;l!==null&&Rw(n,l,0);let u=e.viewQuery;if(u!==null&&L0(2,u,r),!s)if(c){let f=e.viewCheckHooks;f!==null&&ku(n,f)}else{let f=e.viewHooks;f!==null&&Nu(n,f,2),l0(n,2)}if(e.firstUpdatePass===!0&&(e.firstUpdatePass=!1),n[c0]){for(let f of n[c0])f();n[c0]=null}s||(n[Te]&=-73)}catch(c){throw Ya(n),c}finally{a!==null&&(wx(a,o),eR(a)),gp()}}function iR(e){return e.type!==2}function kw(e,n){for(let t=K1(e);t!==null;t=Y1(t))for(let r=Gn;r<t.length;r++){let i=t[r];Nw(i,n)}}function sR(e){for(let n=K1(e);n!==null;n=Y1(n)){if(!(n[Te]&up.HasTransplantedViews))continue;let t=n[ju];for(let r=0;r<t.length;r++){let i=t[r],s=i[rn];Yk(i)}}}function oR(e,n,t){let r=Li(n,e);Nw(r,t)}function Nw(e,n){dp(e)&&B0(e,n)}function B0(e,n){let r=e[We],i=e[Te],s=e[xs],o=!!(n===0&&i&16);if(o||=!!(i&64&&n===0),o||=!!(i&1024),o||=!!(s?.dirty&&Uh(s)),s&&(s.dirty=!1),e[Te]&=-9217,o)rR(r,e,r.template,e[dr]);else if(i&8192){kw(e,1);let a=r.components;a!==null&&Rw(e,a,1)}}function Rw(e,n,t){for(let r=0;r<n.length;r++)oR(e,n[r],t)}function Fp(e){for(e[hr].changeDetectionScheduler?.notify();e;){e[Te]|=64;let n=Xa(e);if(jk(e)&&!n)return e;e=n}return null}var Ts=class{get rootNodes(){let n=this._lView,t=n[We];return Gu(t,n,t.firstChild,[])}constructor(n,t,r=!0){this._lView=n,this._cdRefInjectingView=t,this.notifyErrorHandler=r,this._appRef=null,this._attachedToViewContainer=!1}get context(){return this._lView[dr]}set context(n){this._lView[dr]=n}get destroyed(){return(this._lView[Te]&256)===256}destroy(){if(this._appRef)this._appRef.detachView(this);else if(this._attachedToViewContainer){let n=this._lView[rn];if(ai(n)){let t=n[Uu],r=t?t.indexOf(this):-1;r>-1&&(O0(n,r),Pu(t,r))}this._attachedToViewContainer=!1}ow(this._lView[We],this._lView)}onDestroy(n){y1(this._lView,n)}markForCheck(){Fp(this._cdRefInjectingView||this._lView)}detach(){this._lView[Te]&=-129}reattach(){D0(this._lView),this._lView[Te]|=128}detectChanges(){this._lView[Te]|=1024,Aw(this._lView,this.notifyErrorHandler)}checkNoChanges(){}attachToViewContainerRef(){if(this._appRef)throw new ve(902,!1);this._attachedToViewContainer=!0}detachFromAppRef(){this._appRef=null,iw(this._lView[We],this._lView)}attachToAppRef(n){if(this._attachedToViewContainer)throw new ve(902,!1);this._appRef=n,D0(this._lView)}},_f=(()=>{class e{static{this.__NG_ELEMENT_ID__=lR}}return e})(),aR=_f,cR=class extends aR{constructor(n,t,r){super(),this._declarationLView=n,this._declarationTContainer=t,this.elementRef=r}get ssrId(){return this._declarationTContainer.tView?.ssrId||null}createEmbeddedView(n,t){return this.createEmbeddedViewImpl(n,t)}createEmbeddedViewImpl(n,t,r){let i=YN(this._declarationLView,this._declarationTContainer,n,{embeddedViewInjector:t,dehydratedView:r});return new Ts(i)}};function lR(){return uR(Yn(),pt())}function uR(e,n){return e.type&4?new cR(n,e,ff(e,n)):null}var dQ=new RegExp(`^(\\d+)*(${V2}|${j2})*(.*)`);var fR=()=>null;function Ey(e,n){return fR(e,n)}var qu=class{},U0=class{},Ku=class{};function dR(e){let n=Error(`No component factory found for ${_n(e)}.`);return n[hR]=e,n}var hR="ngComponent";var j0=class{resolveComponentFactory(n){throw dR(n)}},xf=(()=>{class e{static{this.NULL=new j0}}return e})(),Ja=class{},yf=(()=>{class e{constructor(){this.destroyNode=null}static{this.__NG_ELEMENT_ID__=()=>pR()}}return e})();function pR(){let e=pt(),n=Yn(),t=Li(n.index,e);return(vs(t)?t:e)[Kt]}var mR=(()=>{class e{static{this.\u0275prov=he({token:e,providedIn:"root",factory:()=>null})}}return e})(),p0={};var Ty=new Set;function wf(e){Ty.has(e)||(Ty.add(e),performance?.mark?.("mark_feature_usage",{detail:{feature:e}}))}function Iy(...e){}function gR(){let e=typeof vn.requestAnimationFrame=="function",n=vn[e?"requestAnimationFrame":"setTimeout"],t=vn[e?"cancelAnimationFrame":"clearTimeout"];if(typeof Zone<"u"&&n&&t){let r=n[Zone.__symbol__("OriginalDelegate")];r&&(n=r);let i=t[Zone.__symbol__("OriginalDelegate")];i&&(t=i)}return{nativeRequestAnimationFrame:n,nativeCancelAnimationFrame:t}}var Ye=class e{constructor({enableLongStackTrace:n=!1,shouldCoalesceEventChangeDetection:t=!1,shouldCoalesceRunChangeDetection:r=!1}){if(this.hasPendingMacrotasks=!1,this.hasPendingMicrotasks=!1,this.isStable=!0,this.onUnstable=new gn(!1),this.onMicrotaskEmpty=new gn(!1),this.onStable=new gn(!1),this.onError=new gn(!1),typeof Zone>"u")throw new ve(908,!1);Zone.assertZonePatched();let i=this;i._nesting=0,i._outer=i._inner=Zone.current,Zone.TaskTrackingZoneSpec&&(i._inner=i._inner.fork(new Zone.TaskTrackingZoneSpec)),n&&Zone.longStackTraceZoneSpec&&(i._inner=i._inner.fork(Zone.longStackTraceZoneSpec)),i.shouldCoalesceEventChangeDetection=!r&&t,i.shouldCoalesceRunChangeDetection=r,i.lastRequestAnimationFrameId=-1,i.nativeRequestAnimationFrame=gR().nativeRequestAnimationFrame,xR(i)}static isInAngularZone(){return typeof Zone<"u"&&Zone.current.get("isAngularZone")===!0}static assertInAngularZone(){if(!e.isInAngularZone())throw new ve(909,!1)}static assertNotInAngularZone(){if(e.isInAngularZone())throw new ve(909,!1)}run(n,t,r){return this._inner.run(n,t,r)}runTask(n,t,r,i){let s=this._inner,o=s.scheduleEventTask("NgZoneEvent: "+i,n,vR,Iy,Iy);try{return s.runTask(o,t,r)}finally{s.cancelTask(o)}}runGuarded(n,t,r){return this._inner.runGuarded(n,t,r)}runOutsideAngular(n){return this._outer.run(n)}},vR={};function Pp(e){if(e._nesting==0&&!e.hasPendingMicrotasks&&!e.isStable)try{e._nesting++,e.onMicrotaskEmpty.emit(null)}finally{if(e._nesting--,!e.hasPendingMicrotasks)try{e.runOutsideAngular(()=>e.onStable.emit(null))}finally{e.isStable=!0}}}function _R(e){e.isCheckStableRunning||e.lastRequestAnimationFrameId!==-1||(e.lastRequestAnimationFrameId=e.nativeRequestAnimationFrame.call(vn,()=>{e.fakeTopEventTask||(e.fakeTopEventTask=Zone.root.scheduleEventTask("fakeTopEventTask",()=>{e.lastRequestAnimationFrameId=-1,V0(e),e.isCheckStableRunning=!0,Pp(e),e.isCheckStableRunning=!1},void 0,()=>{},()=>{})),e.fakeTopEventTask.invoke()}),V0(e))}function xR(e){let n=()=>{_R(e)};e._inner=e._inner.fork({name:"angular",properties:{isAngularZone:!0},onInvokeTask:(t,r,i,s,o,a)=>{if(yR(a))return t.invokeTask(i,s,o,a);try{return Cy(e),t.invokeTask(i,s,o,a)}finally{(e.shouldCoalesceEventChangeDetection&&s.type==="eventTask"||e.shouldCoalesceRunChangeDetection)&&n(),Sy(e)}},onInvoke:(t,r,i,s,o,a,c)=>{try{return Cy(e),t.invoke(i,s,o,a,c)}finally{e.shouldCoalesceRunChangeDetection&&n(),Sy(e)}},onHasTask:(t,r,i,s)=>{t.hasTask(i,s),r===i&&(s.change=="microTask"?(e._hasPendingMicrotasks=s.microTask,V0(e),Pp(e)):s.change=="macroTask"&&(e.hasPendingMacrotasks=s.macroTask))},onHandleError:(t,r,i,s)=>(t.handleError(i,s),e.runOutsideAngular(()=>e.onError.emit(s)),!1)})}function V0(e){e._hasPendingMicrotasks||(e.shouldCoalesceEventChangeDetection||e.shouldCoalesceRunChangeDetection)&&e.lastRequestAnimationFrameId!==-1?e.hasPendingMicrotasks=!0:e.hasPendingMicrotasks=!1}function Cy(e){e._nesting++,e.isStable&&(e.isStable=!1,e.onUnstable.emit(null))}function Sy(e){e._nesting--,Pp(e)}var H0=class{constructor(){this.hasPendingMicrotasks=!1,this.hasPendingMacrotasks=!1,this.isStable=!0,this.onUnstable=new gn,this.onMicrotaskEmpty=new gn,this.onStable=new gn,this.onError=new gn}run(n,t,r){return n.apply(t,r)}runGuarded(n,t,r){return n.apply(t,r)}runOutsideAngular(n){return n()}runTask(n,t,r,i){return n.apply(t,r)}};function yR(e){return!Array.isArray(e)||e.length!==1?!1:e[0].data?.__ignore_ng_zone__===!0}function wR(e="zone.js",n){return e==="noop"?new H0:e==="zone.js"?new Ye(n):e}var Co=function(e){return e[e.EarlyRead=0]="EarlyRead",e[e.Write=1]="Write",e[e.MixedReadWrite=2]="MixedReadWrite",e[e.Read=3]="Read",e}(Co||{}),ER={destroy(){}};function Ef(e,n){!n&&Lk(Ef);let t=n?.injector??te(An);if(!X2(t))return ER;wf("NgAfterNextRender");let r=t.get(Lp),i=r.handler??=new W0,s=n?.phase??Co.MixedReadWrite,o=()=>{i.unregister(c),a()},a=t.get(Tp).onDestroy(o),c=pr(t,()=>new $0(s,()=>{o(),e()}));return i.register(c),{destroy:o}}var $0=class{constructor(n,t){this.phase=n,this.callbackFn=t,this.zone=te(Ye),this.errorHandler=te(Fr,{optional:!0}),te(qu,{optional:!0})?.notify(1)}invoke(){try{this.zone.runOutsideAngular(this.callbackFn)}catch(n){this.errorHandler?.handleError(n)}}},W0=class{constructor(){this.executingCallbacks=!1,this.buckets={[Co.EarlyRead]:new Set,[Co.Write]:new Set,[Co.MixedReadWrite]:new Set,[Co.Read]:new Set},this.deferredCallbacks=new Set}register(n){(this.executingCallbacks?this.deferredCallbacks:this.buckets[n.phase]).add(n)}unregister(n){this.buckets[n.phase].delete(n),this.deferredCallbacks.delete(n)}execute(){this.executingCallbacks=!0;for(let n of Object.values(this.buckets))for(let t of n)t.invoke();this.executingCallbacks=!1;for(let n of this.deferredCallbacks)this.buckets[n.phase].add(n);this.deferredCallbacks.clear()}destroy(){for(let n of Object.values(this.buckets))n.clear();this.deferredCallbacks.clear()}},Lp=(()=>{class e{constructor(){this.handler=null,this.internalCallbacks=[]}execute(){this.executeInternalCallbacks(),this.handler?.execute()}executeInternalCallbacks(){let t=[...this.internalCallbacks];this.internalCallbacks.length=0;for(let r of t)r()}ngOnDestroy(){this.handler?.destroy(),this.handler=null,this.internalCallbacks.length=0}static{this.\u0275prov=he({token:e,providedIn:"root",factory:()=>new e})}}return e})();function z0(e,n,t){let r=t?e.styles:null,i=t?e.classes:null,s=0;if(n!==null)for(let o=0;o<n.length;o++){let a=n[o];if(typeof a=="number")s=a;else if(s==1)i=Zx(i,a);else if(s==2){let c=a,l=n[++o];r=Zx(r,c+": "+l+";")}}t?e.styles=r:e.stylesWithoutHost=r,t?e.classes=i:e.classesWithoutHost=i}var Yu=class extends xf{constructor(n){super(),this.ngModule=n}resolveComponentFactory(n){let t=Mi(n);return new Mo(t,this.ngModule)}};function Dy(e){let n=[];for(let t in e){if(!e.hasOwnProperty(t))continue;let r=e[t];r!==void 0&&n.push({propName:Array.isArray(r)?r[0]:r,templateName:t})}return n}function TR(e){let n=e.toLowerCase();return n==="svg"?Wk:n==="math"?zk:null}var G0=class{constructor(n,t){this.injector=n,this.parentInjector=t}get(n,t,r){r=sf(r);let i=this.injector.get(n,p0,r);return i!==p0||t===p0?i:this.parentInjector.get(n,t,r)}},Mo=class extends Ku{get inputs(){let n=this.componentDef,t=n.inputTransforms,r=Dy(n.inputs);if(t!==null)for(let i of r)t.hasOwnProperty(i.propName)&&(i.transform=t[i.propName]);return r}get outputs(){return Dy(this.componentDef.outputs)}constructor(n,t){super(),this.componentDef=n,this.ngModule=t,this.componentType=n.type,this.selector=wk(n.selectors),this.ngContentSelectors=n.ngContentSelectors?n.ngContentSelectors:[],this.isBoundToModule=!!t}create(n,t,r,i){let s=Ze(null);try{i=i||this.ngModule;let o=i instanceof nn?i:i?.injector;o&&this.componentDef.getStandaloneInjector!==null&&(o=this.componentDef.getStandaloneInjector(o)||o);let a=o?new G0(n,o):n,c=a.get(Ja,null);if(c===null)throw new ve(407,!1);let l=a.get(mR,null),u=a.get(Lp,null),f=a.get(qu,null),d={rendererFactory:c,sanitizer:l,inlineEffectRunner:null,afterRenderEventManager:u,changeDetectionScheduler:f},h=c.createRenderer(null,this.componentDef),m=this.componentDef.selectors[0][0]||"div",p=r?EN(h,r,this.componentDef.encapsulation,a):rw(h,m,TR(m)),g=512;this.componentDef.signals?g|=4096:this.componentDef.onPush||(g|=16);let w=null;p!==null&&(w=Sp(p,a,!0));let C=Rp(0,null,null,1,0,null,null,null,null,null,null),_=mf(null,C,null,g,null,null,d,h,a,null,w);mp(_);let M,V;try{let A=this.componentDef,S,F=null;A.findHostDirectiveDefs?(S=[],F=new Map,A.findHostDirectiveDefs(A,S,F),S.push(A)):S=[A];let N=IR(_,p),H=CR(N,p,A,S,_,d,h);V=_1(C,Oi),p&&bR(h,A,p,r),t!==void 0&&AR(V,this.ngContentSelectors,t),M=DR(H,A,S,F,_,[kR]),Op(C,_,null)}finally{gp()}return new q0(this.componentType,M,ff(V,_),_,V)}finally{Ze(s)}}},q0=class extends U0{constructor(n,t,r,i,s){super(),this.location=r,this._rootLView=i,this._tNode=s,this.previousInputValues=null,this.instance=t,this.hostView=this.changeDetectorRef=new Ts(i,void 0,!1),this.componentType=n}setInput(n,t){let r=this._tNode.inputs,i;if(r!==null&&(i=r[n])){if(this.previousInputValues??=new Map,this.previousInputValues.has(n)&&Object.is(this.previousInputValues.get(n),t))return;let s=this._rootLView;Mp(s[We],s,i,n,t),this.previousInputValues.set(n,t);let o=Li(this._tNode.index,s);Fp(o)}}get injector(){return new _s(this._tNode,this._rootLView)}destroy(){this.hostView.destroy()}onDestroy(n){this.hostView.onDestroy(n)}};function IR(e,n){let t=e[We],r=Oi;return e[r]=n,gf(t,r,2,"#host",null)}function CR(e,n,t,r,i,s,o){let a=i[We];SR(r,e,n,o);let c=null;n!==null&&(c=Sp(n,i[No]));let l=s.rendererFactory.createRenderer(n,t),u=16;t.signals?u=4096:t.onPush&&(u=64);let f=mf(i,xw(t),null,u,i[e.index],e,s,l,null,null,c);return a.firstCreatePass&&P0(a,e,r.length-1),vf(i,f),i[e.index]=f}function SR(e,n,t,r){for(let i of e)n.mergedAttrs=op(n.mergedAttrs,i.hostAttrs);n.mergedAttrs!==null&&(z0(n,n.mergedAttrs,!0),t!==null&&uw(r,t,n))}function DR(e,n,t,r,i,s){let o=Yn(),a=i[We],c=Kn(o,i);ww(a,i,o,t,null,r);for(let u=0;u<t.length;u++){let f=o.directiveStart+u,d=Za(i,a,f,o);Es(d,i)}Ew(a,i,o),c&&Es(c,i);let l=Za(i,a,o.directiveStart+o.componentOffset,o);if(e[dr]=i[dr]=l,s!==null)for(let u of s)u(l,n);return gw(a,o,i),l}function bR(e,n,t,r){if(r)w0(e,t,["ng-version","17.3.12"]);else{let{attrs:i,classes:s}=Ek(n.selectors[0]);i&&w0(e,t,i),s&&s.length>0&&lw(e,t,s.join(" "))}}function AR(e,n,t){let r=e.projection=[];for(let i=0;i<n.length;i++){let s=t[i];r.push(s!=null?Array.from(s):null)}}function kR(){let e=Yn();xp(pt()[We],e)}var jo=(()=>{class e{static{this.__NG_ELEMENT_ID__=NR}}return e})();function NR(){let e=Yn();return MR(e,pt())}var RR=jo,Mw=class extends RR{constructor(n,t,r){super(),this._lContainer=n,this._hostTNode=t,this._hostLView=r}get element(){return ff(this._hostTNode,this._hostLView)}get injector(){return new _s(this._hostTNode,this._hostLView)}get parentInjector(){let n=yp(this._hostTNode,this._hostLView);if(O1(n)){let t=$u(n,this._hostLView),r=Hu(n),i=t[We].data[r+8];return new _s(i,t)}else return new _s(null,this._hostLView)}clear(){for(;this.length>0;)this.remove(this.length-1)}get(n){let t=by(this._lContainer);return t!==null&&t[n]||null}get length(){return this._lContainer.length-Gn}createEmbeddedView(n,t,r){let i,s;typeof r=="number"?i=r:r!=null&&(i=r.index,s=r.injector);let o=Ey(this._lContainer,n.ssrId),a=n.createEmbeddedViewImpl(t||{},s,o);return this.insertImpl(a,i,wy(this._hostTNode,o)),a}createComponent(n,t,r,i,s){let o=n&&!Uk(n),a;if(o)a=t;else{let m=t||{};a=m.index,r=m.injector,i=m.projectableNodes,s=m.environmentInjector||m.ngModuleRef}let c=o?n:new Mo(Mi(n)),l=r||this.parentInjector;if(!s&&c.ngModule==null){let p=(o?l:this.parentInjector).get(nn,null);p&&(s=p)}let u=Mi(c.componentType??{}),f=Ey(this._lContainer,u?.id??null),d=f?.firstChild??null,h=c.create(l,i,d,s);return this.insertImpl(h.hostView,a,wy(this._hostTNode,f)),h}insert(n,t){return this.insertImpl(n,t,!0)}insertImpl(n,t,r){let i=n._lView;if(Kk(i)){let a=this.indexOf(n);if(a!==-1)this.detach(a);else{let c=i[rn],l=new Mw(c,c[mr],c[rn]);l.detach(l.indexOf(n))}}let s=this._adjustIndex(t),o=this._lContainer;return XN(o,i,s,r),n.attachToViewContainerRef(),Ky(m0(o),s,n),n}move(n,t){return this.insert(n,t)}indexOf(n){let t=by(this._lContainer);return t!==null?t.indexOf(n):-1}remove(n){let t=this._adjustIndex(n,-1),r=O0(this._lContainer,t);r&&(Pu(m0(this._lContainer),t),ow(r[We],r))}detach(n){let t=this._adjustIndex(n,-1),r=O0(this._lContainer,t);return r&&Pu(m0(this._lContainer),t)!=null?new Ts(r):null}_adjustIndex(n,t=0){return n??this.length+t}};function by(e){return e[Uu]}function m0(e){return e[Uu]||(e[Uu]=[])}function MR(e,n){let t,r=n[e.index];return ai(r)?t=r:(t=Tw(r,n,null,e),n[e.index]=t,vf(n,t)),FR(t,n,e,r),new Mw(t,e,n)}function OR(e,n){let t=e[Kt],r=t.createComment(""),i=Kn(n,e),s=Ap(t,i);return zu(t,s,r,uN(t,i),!1),r}var FR=BR,PR=()=>!1;function LR(e,n,t){return PR(e,n,t)}function BR(e,n,t,r){if(e[ys])return;let i;t.type&8?i=Or(r):i=OR(n,t),e[ys]=i}function UR(e){let n=[],t=new Map;function r(i){let s=t.get(i);if(!s){let o=e(i);t.set(i,s=o.then($R))}return s}return Xu.forEach((i,s)=>{let o=[];i.templateUrl&&o.push(r(i.templateUrl).then(l=>{i.template=l}));let a=typeof i.styles=="string"?[i.styles]:i.styles||[];if(i.styles=a,i.styleUrl&&i.styleUrls?.length)throw new Error("@Component cannot define both `styleUrl` and `styleUrls`. Use `styleUrl` if the component has one stylesheet, or `styleUrls` if it has multiple");if(i.styleUrls?.length){let l=i.styles.length,u=i.styleUrls;i.styleUrls.forEach((f,d)=>{a.push(""),o.push(r(f).then(h=>{a[l+d]=h,u.splice(u.indexOf(f),1),u.length==0&&(i.styleUrls=void 0)}))})}else i.styleUrl&&o.push(r(i.styleUrl).then(l=>{a.push(l),i.styleUrl=void 0}));let c=Promise.all(o).then(()=>WR(s));n.push(c)}),VR(),Promise.all(n).then(()=>{})}var Xu=new Map,jR=new Set;function VR(){let e=Xu;return Xu=new Map,e}function HR(){return Xu.size===0}function $R(e){return typeof e=="string"?e:e.text()}function WR(e){jR.delete(e)}function Bp(e){let n=e.inputConfig,t={};for(let r in n)if(n.hasOwnProperty(r)){let i=n[r];Array.isArray(i)&&i[3]&&(t[r]=i[3])}e.inputTransforms=t}var Fi=class{},ec=class{};var Qu=class extends Fi{constructor(n,t,r){super(),this._parent=t,this._bootstrapComponents=[],this.destroyCbs=[],this.componentFactoryResolver=new Yu(this);let i=r1(n);this._bootstrapComponents=nw(i.bootstrap),this._r3Injector=W1(n,t,[{provide:Fi,useValue:this},{provide:xf,useValue:this.componentFactoryResolver},...r],_n(n),new Set(["environment"])),this._r3Injector.resolveInjectorInitializers(),this.instance=this._r3Injector.get(n)}get injector(){return this._r3Injector}destroy(){let n=this._r3Injector;!n.destroyed&&n.destroy(),this.destroyCbs.forEach(t=>t()),this.destroyCbs=null}onDestroy(n){this.destroyCbs.push(n)}},Zu=class extends ec{constructor(n){super(),this.moduleType=n}create(n){return new Qu(this.moduleType,n,[])}};function zR(e,n,t){return new Qu(e,n,t)}var K0=class extends Fi{constructor(n){super(),this.componentFactoryResolver=new Yu(this),this.instance=null;let t=new Ga([...n.providers,{provide:Fi,useValue:this},{provide:xf,useValue:this.componentFactoryResolver}],n.parent||lp(),n.debugName,new Set(["environment"]));this.injector=t,n.runEnvironmentInitializers&&t.resolveInjectorInitializers()}destroy(){this.injector.destroy()}onDestroy(n){this.injector.onDestroy(n)}};function Tf(e,n,t=null){return new K0({providers:e,parent:n,debugName:t,runEnvironmentInitializers:!0}).injector}var Ss=(()=>{class e{constructor(){this.taskId=0,this.pendingTasks=new Set,this.hasPendingTasks=new qt(!1)}get _hasPendingTasks(){return this.hasPendingTasks.value}add(){this._hasPendingTasks||this.hasPendingTasks.next(!0);let t=this.taskId++;return this.pendingTasks.add(t),t}remove(t){this.pendingTasks.delete(t),this.pendingTasks.size===0&&this._hasPendingTasks&&this.hasPendingTasks.next(!1)}ngOnDestroy(){this.pendingTasks.clear(),this._hasPendingTasks&&this.hasPendingTasks.next(!1)}static{this.\u0275fac=function(r){return new(r||e)}}static{this.\u0275prov=he({token:e,factory:e.\u0275fac,providedIn:"root"})}}return e})();function Ow(e){return qR(e)?Array.isArray(e)||!(e instanceof Map)&&Symbol.iterator in e:!1}function GR(e,n){if(Array.isArray(e))for(let t=0;t<e.length;t++)n(e[t]);else{let t=e[Symbol.iterator](),r;for(;!(r=t.next()).done;)n(r.value)}}function qR(e){return e!==null&&(typeof e=="function"||typeof e=="object")}function Oo(e,n,t){let r=e[n];return Object.is(r,t)?!1:(e[n]=t,!0)}function KR(e,n,t,r){let i=Oo(e,n,t);return Oo(e,n+1,r)||i}function YR(e){return(e.flags&32)===32}function XR(e,n,t,r,i,s,o,a,c){let l=n.consts,u=gf(n,e,4,o||null,Vu(l,a));yw(n,t,u,Vu(l,c)),xp(n,u);let f=u.tView=Rp(2,u,r,i,s,n.directiveRegistry,n.pipeRegistry,null,n.schemas,l,null);return n.queries!==null&&(n.queries.template(n,u),f.queries=n.queries.embeddedTView(u)),u}function Ut(e,n,t,r,i,s,o,a){let c=pt(),l=ci(),u=e+Oi,f=l.firstCreatePass?XR(u,l,c,n,t,r,i,s,o):l.data[u];oc(f,!1);let d=QR(l,c,f,e);vp()&&kp(l,c,d,f),Es(d,c);let h=Tw(d,c,d,f);return c[u]=h,vf(c,h),LR(h,f,c),fp(f)&&vw(l,c,f),o!=null&&_w(c,f,a),Ut}var QR=ZR;function ZR(e,n,t,r){return _p(!0),n[Kt].createComment("")}function Up(e,n,t,r){let i=pt(),s=pp();if(Oo(i,s,n)){let o=ci(),a=N1();jN(a,i,e,n,t,r)}return Up}function JR(e,n,t,r){return Oo(e,pp(),t)?n+bo(t)+r:Bi}function eM(e,n,t,r,i,s){let o=o2(),a=KR(e,o,t,i);return I1(2),a?n+bo(t)+r+bo(i)+s:Bi}function Du(e,n){return e<<17|n<<2}function Is(e){return e>>17&32767}function tM(e){return(e&2)==2}function nM(e,n){return e&131071|n<<17}function Y0(e){return e|2}function Fo(e){return(e&131068)>>2}function g0(e,n){return e&-131069|n<<2}function rM(e){return(e&1)===1}function X0(e){return e|1}function iM(e,n,t,r,i,s){let o=s?n.classBindings:n.styleBindings,a=Is(o),c=Fo(o);e[r]=t;let l=!1,u;if(Array.isArray(t)){let f=t;u=f[1],(u===null||rc(f,u)>0)&&(l=!0)}else u=t;if(i)if(c!==0){let d=Is(e[a+1]);e[r+1]=Du(d,a),d!==0&&(e[d+1]=g0(e[d+1],r)),e[a+1]=nM(e[a+1],r)}else e[r+1]=Du(a,0),a!==0&&(e[a+1]=g0(e[a+1],r)),a=r;else e[r+1]=Du(c,0),a===0?a=r:e[c+1]=g0(e[c+1],r),c=r;l&&(e[r+1]=Y0(e[r+1])),Ay(e,u,r,!0),Ay(e,u,r,!1),sM(n,u,e,r,s),o=Du(a,c),s?n.classBindings=o:n.styleBindings=o}function sM(e,n,t,r,i){let s=i?e.residualClasses:e.residualStyles;s!=null&&typeof n=="string"&&rc(s,n)>=0&&(t[r+1]=X0(t[r+1]))}function Ay(e,n,t,r){let i=e[t+1],s=n===null,o=r?Is(i):Fo(i),a=!1;for(;o!==0&&(a===!1||s);){let c=e[o],l=e[o+1];oM(c,n)&&(a=!0,e[o+1]=r?X0(l):Y0(l)),o=r?Is(l):Fo(l)}a&&(e[t+1]=r?Y0(i):X0(i))}function oM(e,n){return e===null||n==null||(Array.isArray(e)?e[1]:e)===n?!0:Array.isArray(e)&&typeof n=="string"?rc(e,n)>=0:!1}function Et(e,n,t){let r=pt(),i=pp();if(Oo(r,i,n)){let s=ci(),o=N1();bN(s,o,r,e,n,r[Kt],t,!1)}return Et}function ky(e,n,t,r,i){let s=n.inputs,o=i?"class":"style";Mp(e,t,s[o],o,r)}function Ds(e,n){return aM(e,n,null,!0),Ds}function aM(e,n,t,r){let i=pt(),s=ci(),o=I1(2);if(s.firstUpdatePass&&lM(s,e,o,r),n!==Bi&&Oo(i,o,n)){let a=s.data[Cs()];pM(s,a,i,i[Kt],e,i[o+1]=mM(n,t),r,o)}}function cM(e,n){return n>=e.expandoStartIndex}function lM(e,n,t,r){let i=e.data;if(i[t+1]===null){let s=i[Cs()],o=cM(e,t);gM(s,r)&&n===null&&!o&&(n=!1),n=uM(i,s,n,r),iM(i,s,n,t,o,r)}}function uM(e,n,t,r){let i=f2(e),s=r?n.residualClasses:n.residualStyles;if(i===null)(r?n.classBindings:n.styleBindings)===0&&(t=v0(null,e,n,t,r),t=tc(t,n.attrs,r),s=null);else{let o=n.directiveStylingLast;if(o===-1||e[o]!==i)if(t=v0(i,e,n,t,r),s===null){let c=fM(e,n,r);c!==void 0&&Array.isArray(c)&&(c=v0(null,e,n,c[1],r),c=tc(c,n.attrs,r),dM(e,n,r,c))}else s=hM(e,n,r)}return s!==void 0&&(r?n.residualClasses=s:n.residualStyles=s),t}function fM(e,n,t){let r=t?n.classBindings:n.styleBindings;if(Fo(r)!==0)return e[Is(r)]}function dM(e,n,t,r){let i=t?n.classBindings:n.styleBindings;e[Is(i)]=r}function hM(e,n,t){let r,i=n.directiveEnd;for(let s=1+n.directiveStylingLast;s<i;s++){let o=e[s].hostAttrs;r=tc(r,o,t)}return tc(r,n.attrs,t)}function v0(e,n,t,r,i){let s=null,o=t.directiveEnd,a=t.directiveStylingLast;for(a===-1?a=t.directiveStart:a++;a<o&&(s=n[a],r=tc(r,s.hostAttrs,i),s!==e);)a++;return e!==null&&(t.directiveStylingLast=a),r}function tc(e,n,t){let r=t?1:2,i=-1;if(n!==null)for(let s=0;s<n.length;s++){let o=n[s];typeof o=="number"?i=o:i===r&&(Array.isArray(e)||(e=e===void 0?[]:["",e]),lk(e,o,t?!0:n[++s]))}return e===void 0?null:e}function pM(e,n,t,r,i,s,o,a){if(!(n.type&3))return;let c=e.data,l=c[a+1],u=rM(l)?Ny(c,n,t,i,Fo(l),o):void 0;if(!Ju(u)){Ju(s)||tM(l)&&(s=Ny(c,null,t,i,a,o));let f=v1(Cs(),t);vN(r,o,f,i,s)}}function Ny(e,n,t,r,i,s){let o=n===null,a;for(;i>0;){let c=e[i],l=Array.isArray(c),u=l?c[1]:c,f=u===null,d=t[i+1];d===Bi&&(d=f?lr:void 0);let h=f?o0(d,r):u===r?d:void 0;if(l&&!Ju(h)&&(h=o0(c,r)),Ju(h)&&(a=h,o))return a;let m=e[i+1];i=o?Is(m):Fo(m)}if(n!==null){let c=s?n.residualClasses:n.residualStyles;c!=null&&(a=o0(c,r))}return a}function Ju(e){return e!==void 0}function mM(e,n){return e==null||e===""||(typeof n=="string"?e=e+n:typeof e=="object"&&(e=_n(cc(e)))),e}function gM(e,n){return(e.flags&(n?8:16))!==0}function vM(e,n,t,r,i,s){let o=n.consts,a=Vu(o,i),c=gf(n,e,2,r,a);return yw(n,t,c,Vu(o,s)),c.attrs!==null&&z0(c,c.attrs,!1),c.mergedAttrs!==null&&z0(c,c.mergedAttrs,!0),n.queries!==null&&n.queries.elementStart(n,c),c}function ye(e,n,t,r){let i=pt(),s=ci(),o=Oi+e,a=i[Kt],c=s.firstCreatePass?vM(o,s,i,n,t,r):s.data[o],l=_M(s,i,c,a,n,e);i[o]=l;let u=fp(c);return oc(c,!0),uw(a,l,c),!YR(c)&&vp()&&kp(s,i,l,c),Zk()===0&&Es(l,i),Jk(),u&&(vw(s,i,c),gw(s,c,i)),r!==null&&_w(i,c),ye}function we(){let e=Yn();T1()?s2():(e=e.parent,oc(e,!1));let n=e;n2(n)&&r2(),e2();let t=ci();return t.firstCreatePass&&(xp(t,e),d1(e)&&t.queries.elementEnd(e)),n.classesWithoutHost!=null&&_2(n)&&ky(t,n,pt(),n.classesWithoutHost,!0),n.stylesWithoutHost!=null&&x2(n)&&ky(t,n,pt(),n.stylesWithoutHost,!1),we}function Pr(e,n,t,r){return ye(e,n,t,r),we(),Pr}var _M=(e,n,t,r,i,s)=>(_p(!0),rw(r,i,p2()));function Vo(){return pt()}var ef="en-US";var xM=ef;function yM(e){typeof e=="string"&&(xM=e.toLowerCase().replace(/_/g,"-"))}function li(e,n,t,r){let i=pt(),s=ci(),o=Yn();return EM(s,i,i[Kt],o,e,n,r),li}function wM(e,n,t,r){let i=e.cleanup;if(i!=null)for(let s=0;s<i.length-1;s+=2){let o=i[s];if(o===t&&i[s+1]===r){let a=n[qa],c=i[s+2];return a.length>c?a[c]:null}typeof o=="string"&&(s+=2)}return null}function EM(e,n,t,r,i,s,o){let a=fp(r),l=e.firstCreatePass&&zN(e),u=n[dr],f=WN(n),d=!0;if(r.type&3||o){let p=Kn(r,n),g=o?o(p):p,w=f.length,C=o?M=>o(Or(M[r.index])):r.index,_=null;if(!o&&a&&(_=wM(e,n,i,r.index)),_!==null){let M=_.__ngLastListenerFn__||_;M.__ngNextListenerFn__=s,_.__ngLastListenerFn__=s,d=!1}else{s=My(r,n,u,s,!1);let M=t.listen(g,i,s);f.push(s,M),l&&l.push(i,C,w,w+1)}}else s=My(r,n,u,s,!1);let h=r.outputs,m;if(d&&h!==null&&(m=h[i])){let p=m.length;if(p)for(let g=0;g<p;g+=2){let w=m[g],C=m[g+1],V=n[w][C].subscribe(s),A=f.length;f.push(s,V),l&&l.push(i,r.index,A,-(A+1))}}}function Ry(e,n,t,r){let i=Ze(null);try{return kr(6,n,t),t(r)!==!1}catch(s){return Cw(e,s),!1}finally{kr(7,n,t),Ze(i)}}function My(e,n,t,r,i){return function s(o){if(o===Function)return r;let a=e.componentOffset>-1?Li(e.index,n):n;Fp(a);let c=Ry(n,t,r,o),l=s.__ngNextListenerFn__;for(;l;)c=Ry(n,t,l,o)&&c,l=l.__ngNextListenerFn__;return i&&c===!1&&o.preventDefault(),c}}function Qt(e=1){return h2(e)}function Je(e,n=""){let t=pt(),r=ci(),i=e+Oi,s=r.firstCreatePass?gf(r,i,1,n,null):r.data[i],o=TM(r,t,s,n,e);t[i]=o,vp()&&kp(r,t,o,s),oc(s,!1)}var TM=(e,n,t,r,i)=>(_p(!0),Z2(n[Kt],r));function Lr(e){return jt("",e,""),Lr}function jt(e,n,t){let r=pt(),i=JR(r,e,n,t);return i!==Bi&&Sw(r,Cs(),i),jt}function bs(e,n,t,r,i){let s=pt(),o=eM(s,e,n,t,r,i);return o!==Bi&&Sw(s,Cs(),o),bs}var IM=(()=>{class e{constructor(t){this._injector=t,this.cachedInjectors=new Map}getOrCreateStandaloneInjector(t){if(!t.standalone)return null;if(!this.cachedInjectors.has(t)){let r=o1(!1,t.type),i=r.length>0?Tf([r],this._injector,`Standalone[${t.type.name}]`):null;this.cachedInjectors.set(t,i)}return this.cachedInjectors.get(t)}ngOnDestroy(){try{for(let t of this.cachedInjectors.values())t!==null&&t.destroy()}finally{this.cachedInjectors.clear()}}static{this.\u0275prov=he({token:e,providedIn:"environment",factory:()=>new e(ue(nn))})}}return e})();function Fw(e){wf("NgStandalone"),e.getStandaloneInjector=n=>n.get(IM).getOrCreateStandaloneInjector(e)}var bu=null;function CM(e){bu!==null&&(e.defaultEncapsulation!==bu.defaultEncapsulation||e.preserveWhitespaces!==bu.preserveWhitespaces)||(bu=e)}var Pi=class{constructor(n){this.full=n;let t=n.split(".");this.major=t[0],this.minor=t[1],this.patch=t.slice(2).join(".")}},Pw=new Pi("17.3.12"),If=(()=>{class e{log(t){console.log(t)}warn(t){console.warn(t)}static{this.\u0275fac=function(r){return new(r||e)}}static{this.\u0275prov=he({token:e,factory:e.\u0275fac,providedIn:"platform"})}}return e})();var jp=new ge(""),lc=new ge(""),Cf=(()=>{class e{constructor(t,r,i){this._ngZone=t,this.registry=r,this._pendingCount=0,this._isZoneStable=!0,this._callbacks=[],this.taskTrackingZone=null,Vp||(SM(i),i.addToWindow(r)),this._watchAngularEvents(),t.run(()=>{this.taskTrackingZone=typeof Zone>"u"?null:Zone.current.get("TaskTrackingZone")})}_watchAngularEvents(){this._ngZone.onUnstable.subscribe({next:()=>{this._isZoneStable=!1}}),this._ngZone.runOutsideAngular(()=>{this._ngZone.onStable.subscribe({next:()=>{Ye.assertNotInAngularZone(),queueMicrotask(()=>{this._isZoneStable=!0,this._runCallbacksIfReady()})}})})}increasePendingRequestCount(){return this._pendingCount+=1,this._pendingCount}decreasePendingRequestCount(){if(this._pendingCount-=1,this._pendingCount<0)throw new Error("pending async requests below zero");return this._runCallbacksIfReady(),this._pendingCount}isStable(){return this._isZoneStable&&this._pendingCount===0&&!this._ngZone.hasPendingMacrotasks}_runCallbacksIfReady(){if(this.isStable())queueMicrotask(()=>{for(;this._callbacks.length!==0;){let t=this._callbacks.pop();clearTimeout(t.timeoutId),t.doneCb()}});else{let t=this.getPendingTasks();this._callbacks=this._callbacks.filter(r=>r.updateCb&&r.updateCb(t)?(clearTimeout(r.timeoutId),!1):!0)}}getPendingTasks(){return this.taskTrackingZone?this.taskTrackingZone.macroTasks.map(t=>({source:t.source,creationLocation:t.creationLocation,data:t.data})):[]}addCallback(t,r,i){let s=-1;r&&r>0&&(s=setTimeout(()=>{this._callbacks=this._callbacks.filter(o=>o.timeoutId!==s),t()},r)),this._callbacks.push({doneCb:t,timeoutId:s,updateCb:i})}whenStable(t,r,i){if(i&&!this.taskTrackingZone)throw new Error('Task tracking zone is required when passing an update callback to whenStable(). Is "zone.js/plugins/task-tracking" loaded?');this.addCallback(t,r,i),this._runCallbacksIfReady()}getPendingRequestCount(){return this._pendingCount}registerApplication(t){this.registry.registerApplication(t,this)}unregisterApplication(t){this.registry.unregisterApplication(t)}findProviders(t,r,i){return[]}static{this.\u0275fac=function(r){return new(r||e)(ue(Ye),ue(Sf),ue(lc))}}static{this.\u0275prov=he({token:e,factory:e.\u0275fac})}}return e})(),Sf=(()=>{class e{constructor(){this._applications=new Map}registerApplication(t,r){this._applications.set(t,r)}unregisterApplication(t){this._applications.delete(t)}unregisterAllApplications(){this._applications.clear()}getTestability(t){return this._applications.get(t)||null}getAllTestabilities(){return Array.from(this._applications.values())}getAllRootElements(){return Array.from(this._applications.keys())}findTestabilityInTree(t,r=!0){return Vp?.findTestabilityInTree(this,t,r)??null}static{this.\u0275fac=function(r){return new(r||e)}}static{this.\u0275prov=he({token:e,factory:e.\u0275fac,providedIn:"platform"})}}return e})();function SM(e){Vp=e}var Vp;function uc(e){return!!e&&typeof e.then=="function"}function Lw(e){return!!e&&typeof e.subscribe=="function"}var Df=new ge(""),Bw=(()=>{class e{constructor(){this.initialized=!1,this.done=!1,this.donePromise=new Promise((t,r)=>{this.resolve=t,this.reject=r}),this.appInits=te(Df,{optional:!0})??[]}runInitializers(){if(this.initialized)return;let t=[];for(let i of this.appInits){let s=i();if(uc(s))t.push(s);else if(Lw(s)){let o=new Promise((a,c)=>{s.subscribe({complete:a,error:c})});t.push(o)}}let r=()=>{this.done=!0,this.resolve()};Promise.all(t).then(()=>{r()}).catch(i=>{this.reject(i)}),t.length===0&&r(),this.initialized=!0}static{this.\u0275fac=function(r){return new(r||e)}}static{this.\u0275prov=he({token:e,factory:e.\u0275fac,providedIn:"root"})}}return e})(),bf=new ge("");function DM(){Tx(()=>{throw new ve(600,!1)})}function bM(e){return e.isBoundToModule}function AM(e,n,t){try{let r=t();return uc(r)?r.catch(i=>{throw n.runOutsideAngular(()=>e.handleError(i)),i}):r}catch(r){throw n.runOutsideAngular(()=>e.handleError(r)),r}}function Uw(e,n){return Array.isArray(n)?n.reduce(Uw,e):de(de({},e),n)}var As=(()=>{class e{constructor(){this._bootstrapListeners=[],this._runningTick=!1,this._destroyed=!1,this._destroyListeners=[],this._views=[],this.internalErrorHandler=te(z1),this.afterRenderEffectManager=te(Lp),this.externalTestViews=new Set,this.beforeRender=new Lt,this.afterTick=new Lt,this.componentTypes=[],this.components=[],this.isStable=te(Ss).hasPendingTasks.pipe(be(t=>!t)),this._injector=te(nn)}get destroyed(){return this._destroyed}get injector(){return this._injector}bootstrap(t,r){let i=t instanceof Ku;if(!this._injector.get(Bw).done){let d=!i&&n1(t),h=!1;throw new ve(405,h)}let o;i?o=t:o=this._injector.get(xf).resolveComponentFactory(t),this.componentTypes.push(o.componentType);let a=bM(o)?void 0:this._injector.get(Fi),c=r||o.selector,l=o.create(An.NULL,[],c,a),u=l.location.nativeElement,f=l.injector.get(jp,null);return f?.registerApplication(u),l.onDestroy(()=>{this.detachView(l.hostView),Mu(this.components,l),f?.unregisterApplication(u)}),this._loadComponent(l),l}tick(){this._tick(!0)}_tick(t){if(this._runningTick)throw new ve(101,!1);let r=Ze(null);try{this._runningTick=!0,this.detectChangesInAttachedViews(t)}catch(i){this.internalErrorHandler(i)}finally{this.afterTick.next(),this._runningTick=!1,Ze(r)}}detectChangesInAttachedViews(t){let r=0,i=this.afterRenderEffectManager;for(;;){if(r===bw)throw new ve(103,!1);if(t){let s=r===0;this.beforeRender.next(s);for(let{_lView:o,notifyErrorHandler:a}of this._views)kM(o,s,a)}if(r++,i.executeInternalCallbacks(),![...this.externalTestViews.keys(),...this._views].some(({_lView:s})=>Q0(s))&&(i.execute(),![...this.externalTestViews.keys(),...this._views].some(({_lView:s})=>Q0(s))))break}}attachView(t){let r=t;this._views.push(r),r.attachToAppRef(this)}detachView(t){let r=t;Mu(this._views,r),r.detachFromAppRef()}_loadComponent(t){this.attachView(t.hostView),this.tick(),this.components.push(t);let r=this._injector.get(bf,[]);[...this._bootstrapListeners,...r].forEach(i=>i(t))}ngOnDestroy(){if(!this._destroyed)try{this._destroyListeners.forEach(t=>t()),this._views.slice().forEach(t=>t.destroy())}finally{this._destroyed=!0,this._views=[],this._bootstrapListeners=[],this._destroyListeners=[]}}onDestroy(t){return this._destroyListeners.push(t),()=>Mu(this._destroyListeners,t)}destroy(){if(this._destroyed)throw new ve(406,!1);let t=this._injector;t.destroy&&!t.destroyed&&t.destroy()}get viewCount(){return this._views.length}warnIfDestroyed(){}static{this.\u0275fac=function(r){return new(r||e)}}static{this.\u0275prov=he({token:e,factory:e.\u0275fac,providedIn:"root"})}}return e})();function Mu(e,n){let t=e.indexOf(n);t>-1&&e.splice(t,1)}function kM(e,n,t){!n&&!Q0(e)||NM(e,t,n)}function Q0(e){return hp(e)}function NM(e,n,t){let r;t?(r=0,e[Te]|=1024):e[Te]&64?r=0:r=1,Aw(e,n,r)}var Z0=class{constructor(n,t){this.ngModuleFactory=n,this.componentFactories=t}},Af=(()=>{class e{compileModuleSync(t){return new Zu(t)}compileModuleAsync(t){return Promise.resolve(this.compileModuleSync(t))}compileModuleAndAllComponentsSync(t){let r=this.compileModuleSync(t),i=r1(t),s=nw(i.declarations).reduce((o,a)=>{let c=Mi(a);return c&&o.push(new Mo(c)),o},[]);return new Z0(r,s)}compileModuleAndAllComponentsAsync(t){return Promise.resolve(this.compileModuleAndAllComponentsSync(t))}clearCache(){}clearCacheFor(t){}getModuleId(t){}static{this.\u0275fac=function(r){return new(r||e)}}static{this.\u0275prov=he({token:e,factory:e.\u0275fac,providedIn:"root"})}}return e})(),RM=new ge("");function MM(e,n,t){let r=new Zu(t);return Promise.resolve(r)}function Oy(e){for(let n=e.length-1;n>=0;n--)if(e[n]!==void 0)return e[n]}var OM=(()=>{class e{constructor(){this.zone=te(Ye),this.applicationRef=te(As)}initialize(){this._onMicrotaskEmptySubscription||(this._onMicrotaskEmptySubscription=this.zone.onMicrotaskEmpty.subscribe({next:()=>{this.zone.run(()=>{this.applicationRef.tick()})}}))}ngOnDestroy(){this._onMicrotaskEmptySubscription?.unsubscribe()}static{this.\u0275fac=function(r){return new(r||e)}}static{this.\u0275prov=he({token:e,factory:e.\u0275fac,providedIn:"root"})}}return e})();function FM(e){return[{provide:Ye,useFactory:e},{provide:ko,multi:!0,useFactory:()=>{let n=te(OM,{optional:!0});return()=>n.initialize()}},{provide:ko,multi:!0,useFactory:()=>{let n=te(BM);return()=>{n.initialize()}}},{provide:z1,useFactory:PM}]}function PM(){let e=te(Ye),n=te(Fr);return t=>e.runOutsideAngular(()=>n.handleError(t))}function LM(e){return{enableLongStackTrace:!1,shouldCoalesceEventChangeDetection:e?.eventCoalescing??!1,shouldCoalesceRunChangeDetection:e?.runCoalescing??!1}}var BM=(()=>{class e{constructor(){this.subscription=new wt,this.initialized=!1,this.zone=te(Ye),this.pendingTasks=te(Ss)}initialize(){if(this.initialized)return;this.initialized=!0;let t=null;!this.zone.isStable&&!this.zone.hasPendingMacrotasks&&!this.zone.hasPendingMicrotasks&&(t=this.pendingTasks.add()),this.zone.runOutsideAngular(()=>{this.subscription.add(this.zone.onStable.subscribe(()=>{Ye.assertNotInAngularZone(),queueMicrotask(()=>{t!==null&&!this.zone.hasPendingMacrotasks&&!this.zone.hasPendingMicrotasks&&(this.pendingTasks.remove(t),t=null)})}))}),this.subscription.add(this.zone.onUnstable.subscribe(()=>{Ye.assertInAngularZone(),t??=this.pendingTasks.add()}))}ngOnDestroy(){this.subscription.unsubscribe()}static{this.\u0275fac=function(r){return new(r||e)}}static{this.\u0275prov=he({token:e,factory:e.\u0275fac,providedIn:"root"})}}return e})();function UM(){return typeof $localize<"u"&&$localize.locale||ef}var Hp=new ge("",{providedIn:"root",factory:()=>te(Hp,Me.Optional|Me.SkipSelf)||UM()});var jw=new ge(""),Vw=(()=>{class e{constructor(t){this._injector=t,this._modules=[],this._destroyListeners=[],this._destroyed=!1}bootstrapModuleFactory(t,r){let i=wR(r?.ngZone,LM({eventCoalescing:r?.ngZoneEventCoalescing,runCoalescing:r?.ngZoneRunCoalescing}));return i.run(()=>{let s=zR(t.moduleType,this.injector,FM(()=>i)),o=s.injector.get(Fr,null);return i.runOutsideAngular(()=>{let a=i.onError.subscribe({next:c=>{o.handleError(c)}});s.onDestroy(()=>{Mu(this._modules,s),a.unsubscribe()})}),AM(o,i,()=>{let a=s.injector.get(Bw);return a.runInitializers(),a.donePromise.then(()=>{let c=s.injector.get(Hp,ef);return yM(c||ef),this._moduleDoBootstrap(s),s})})})}bootstrapModule(t,r=[]){let i=Uw({},r);return MM(this.injector,i,t).then(s=>this.bootstrapModuleFactory(s,i))}_moduleDoBootstrap(t){let r=t.injector.get(As);if(t._bootstrapComponents.length>0)t._bootstrapComponents.forEach(i=>r.bootstrap(i));else if(t.instance.ngDoBootstrap)t.instance.ngDoBootstrap(r);else throw new ve(-403,!1);this._modules.push(t)}onDestroy(t){this._destroyListeners.push(t)}get injector(){return this._injector}destroy(){if(this._destroyed)throw new ve(404,!1);this._modules.slice().forEach(r=>r.destroy()),this._destroyListeners.forEach(r=>r());let t=this._injector.get(jw,null);t&&(t.forEach(r=>r()),t.clear()),this._destroyed=!0}get destroyed(){return this._destroyed}static{this.\u0275fac=function(r){return new(r||e)(ue(An))}}static{this.\u0275prov=he({token:e,factory:e.\u0275fac,providedIn:"platform"})}}return e})(),$a=null,Hw=new ge("");function jM(e){if($a&&!$a.get(Hw,!1))throw new ve(400,!1);DM(),$a=e;let n=e.get(Vw);return $M(e),n}function $p(e,n,t=[]){let r=`Platform: ${n}`,i=new ge(r);return(s=[])=>{let o=$w();if(!o||o.injector.get(Hw,!1)){let a=[...t,...s,{provide:i,useValue:!0}];e?e(a):jM(VM(a,r))}return HM(i)}}function VM(e=[],n){return An.create({name:n,providers:[{provide:af,useValue:"platform"},{provide:jw,useValue:new Set([()=>$a=null])},...e]})}function HM(e){let n=$w();if(!n)throw new ve(401,!1);return n}function $w(){return $a?.get(Vw)??null}function $M(e){e.get(Ip,null)?.forEach(t=>t())}var fc=(()=>{class e{static{this.__NG_ELEMENT_ID__=WM}}return e})();function WM(e){return zM(Yn(),pt(),(e&16)===16)}function zM(e,n,t){if(uf(e)&&!t){let r=Li(e.index,n);return new Ts(r,r)}else if(e.type&47){let r=n[Mr];return new Ts(r,n)}return null}var J0=class{constructor(){}supports(n){return Ow(n)}create(n){return new ep(n)}},GM=(e,n)=>n,ep=class{constructor(n){this.length=0,this._linkedRecords=null,this._unlinkedRecords=null,this._previousItHead=null,this._itHead=null,this._itTail=null,this._additionsHead=null,this._additionsTail=null,this._movesHead=null,this._movesTail=null,this._removalsHead=null,this._removalsTail=null,this._identityChangesHead=null,this._identityChangesTail=null,this._trackByFn=n||GM}forEachItem(n){let t;for(t=this._itHead;t!==null;t=t._next)n(t)}forEachOperation(n){let t=this._itHead,r=this._removalsHead,i=0,s=null;for(;t||r;){let o=!r||t&&t.currentIndex<Fy(r,i,s)?t:r,a=Fy(o,i,s),c=o.currentIndex;if(o===r)i--,r=r._nextRemoved;else if(t=t._next,o.previousIndex==null)i++;else{s||(s=[]);let l=a-i,u=c-i;if(l!=u){for(let d=0;d<l;d++){let h=d<s.length?s[d]:s[d]=0,m=h+d;u<=m&&m<l&&(s[d]=h+1)}let f=o.previousIndex;s[f]=u-l}}a!==c&&n(o,a,c)}}forEachPreviousItem(n){let t;for(t=this._previousItHead;t!==null;t=t._nextPrevious)n(t)}forEachAddedItem(n){let t;for(t=this._additionsHead;t!==null;t=t._nextAdded)n(t)}forEachMovedItem(n){let t;for(t=this._movesHead;t!==null;t=t._nextMoved)n(t)}forEachRemovedItem(n){let t;for(t=this._removalsHead;t!==null;t=t._nextRemoved)n(t)}forEachIdentityChange(n){let t;for(t=this._identityChangesHead;t!==null;t=t._nextIdentityChange)n(t)}diff(n){if(n==null&&(n=[]),!Ow(n))throw new ve(900,!1);return this.check(n)?this:null}onDestroy(){}check(n){this._reset();let t=this._itHead,r=!1,i,s,o;if(Array.isArray(n)){this.length=n.length;for(let a=0;a<this.length;a++)s=n[a],o=this._trackByFn(a,s),t===null||!Object.is(t.trackById,o)?(t=this._mismatch(t,s,o,a),r=!0):(r&&(t=this._verifyReinsertion(t,s,o,a)),Object.is(t.item,s)||this._addIdentityChange(t,s)),t=t._next}else i=0,GR(n,a=>{o=this._trackByFn(i,a),t===null||!Object.is(t.trackById,o)?(t=this._mismatch(t,a,o,i),r=!0):(r&&(t=this._verifyReinsertion(t,a,o,i)),Object.is(t.item,a)||this._addIdentityChange(t,a)),t=t._next,i++}),this.length=i;return this._truncate(t),this.collection=n,this.isDirty}get isDirty(){return this._additionsHead!==null||this._movesHead!==null||this._removalsHead!==null||this._identityChangesHead!==null}_reset(){if(this.isDirty){let n;for(n=this._previousItHead=this._itHead;n!==null;n=n._next)n._nextPrevious=n._next;for(n=this._additionsHead;n!==null;n=n._nextAdded)n.previousIndex=n.currentIndex;for(this._additionsHead=this._additionsTail=null,n=this._movesHead;n!==null;n=n._nextMoved)n.previousIndex=n.currentIndex;this._movesHead=this._movesTail=null,this._removalsHead=this._removalsTail=null,this._identityChangesHead=this._identityChangesTail=null}}_mismatch(n,t,r,i){let s;return n===null?s=this._itTail:(s=n._prev,this._remove(n)),n=this._unlinkedRecords===null?null:this._unlinkedRecords.get(r,null),n!==null?(Object.is(n.item,t)||this._addIdentityChange(n,t),this._reinsertAfter(n,s,i)):(n=this._linkedRecords===null?null:this._linkedRecords.get(r,i),n!==null?(Object.is(n.item,t)||this._addIdentityChange(n,t),this._moveAfter(n,s,i)):n=this._addAfter(new tp(t,r),s,i)),n}_verifyReinsertion(n,t,r,i){let s=this._unlinkedRecords===null?null:this._unlinkedRecords.get(r,null);return s!==null?n=this._reinsertAfter(s,n._prev,i):n.currentIndex!=i&&(n.currentIndex=i,this._addToMoves(n,i)),n}_truncate(n){for(;n!==null;){let t=n._next;this._addToRemovals(this._unlink(n)),n=t}this._unlinkedRecords!==null&&this._unlinkedRecords.clear(),this._additionsTail!==null&&(this._additionsTail._nextAdded=null),this._movesTail!==null&&(this._movesTail._nextMoved=null),this._itTail!==null&&(this._itTail._next=null),this._removalsTail!==null&&(this._removalsTail._nextRemoved=null),this._identityChangesTail!==null&&(this._identityChangesTail._nextIdentityChange=null)}_reinsertAfter(n,t,r){this._unlinkedRecords!==null&&this._unlinkedRecords.remove(n);let i=n._prevRemoved,s=n._nextRemoved;return i===null?this._removalsHead=s:i._nextRemoved=s,s===null?this._removalsTail=i:s._prevRemoved=i,this._insertAfter(n,t,r),this._addToMoves(n,r),n}_moveAfter(n,t,r){return this._unlink(n),this._insertAfter(n,t,r),this._addToMoves(n,r),n}_addAfter(n,t,r){return this._insertAfter(n,t,r),this._additionsTail===null?this._additionsTail=this._additionsHead=n:this._additionsTail=this._additionsTail._nextAdded=n,n}_insertAfter(n,t,r){let i=t===null?this._itHead:t._next;return n._next=i,n._prev=t,i===null?this._itTail=n:i._prev=n,t===null?this._itHead=n:t._next=n,this._linkedRecords===null&&(this._linkedRecords=new tf),this._linkedRecords.put(n),n.currentIndex=r,n}_remove(n){return this._addToRemovals(this._unlink(n))}_unlink(n){this._linkedRecords!==null&&this._linkedRecords.remove(n);let t=n._prev,r=n._next;return t===null?this._itHead=r:t._next=r,r===null?this._itTail=t:r._prev=t,n}_addToMoves(n,t){return n.previousIndex===t||(this._movesTail===null?this._movesTail=this._movesHead=n:this._movesTail=this._movesTail._nextMoved=n),n}_addToRemovals(n){return this._unlinkedRecords===null&&(this._unlinkedRecords=new tf),this._unlinkedRecords.put(n),n.currentIndex=null,n._nextRemoved=null,this._removalsTail===null?(this._removalsTail=this._removalsHead=n,n._prevRemoved=null):(n._prevRemoved=this._removalsTail,this._removalsTail=this._removalsTail._nextRemoved=n),n}_addIdentityChange(n,t){return n.item=t,this._identityChangesTail===null?this._identityChangesTail=this._identityChangesHead=n:this._identityChangesTail=this._identityChangesTail._nextIdentityChange=n,n}},tp=class{constructor(n,t){this.item=n,this.trackById=t,this.currentIndex=null,this.previousIndex=null,this._nextPrevious=null,this._prev=null,this._next=null,this._prevDup=null,this._nextDup=null,this._prevRemoved=null,this._nextRemoved=null,this._nextAdded=null,this._nextMoved=null,this._nextIdentityChange=null}},np=class{constructor(){this._head=null,this._tail=null}add(n){this._head===null?(this._head=this._tail=n,n._nextDup=null,n._prevDup=null):(this._tail._nextDup=n,n._prevDup=this._tail,n._nextDup=null,this._tail=n)}get(n,t){let r;for(r=this._head;r!==null;r=r._nextDup)if((t===null||t<=r.currentIndex)&&Object.is(r.trackById,n))return r;return null}remove(n){let t=n._prevDup,r=n._nextDup;return t===null?this._head=r:t._nextDup=r,r===null?this._tail=t:r._prevDup=t,this._head===null}},tf=class{constructor(){this.map=new Map}put(n){let t=n.trackById,r=this.map.get(t);r||(r=new np,this.map.set(t,r)),r.add(n)}get(n,t){let r=n,i=this.map.get(r);return i?i.get(n,t):null}remove(n){let t=n.trackById;return this.map.get(t).remove(n)&&this.map.delete(t),n}get isEmpty(){return this.map.size===0}clear(){this.map.clear()}};function Fy(e,n,t){let r=e.previousIndex;if(r===null)return r;let i=0;return t&&r<t.length&&(i=t[r]),r+n+i}function Py(){return new Wp([new J0])}var Wp=(()=>{class e{static{this.\u0275prov=he({token:e,providedIn:"root",factory:Py})}constructor(t){this.factories=t}static create(t,r){if(r!=null){let i=r.factories.slice();t=t.concat(i)}return new e(t)}static extend(t){return{provide:e,useFactory:r=>e.create(t,r||Py()),deps:[[e,new ip,new qn]]}}find(t){let r=this.factories.find(i=>i.supports(t));if(r!=null)return r;throw new ve(901,!1)}}return e})();var Ww=$p(null,"core",[]),zw=(()=>{class e{constructor(t){}static{this.\u0275fac=function(r){return new(r||e)(ue(As))}}static{this.\u0275mod=Xt({type:e})}static{this.\u0275inj=Yt({})}}return e})();function dc(e){return typeof e=="boolean"?e:e!=null&&e!=="false"}function Gw(e){let n=Mi(e);if(!n)return null;let t=new Mo(n);return{get selector(){return t.selector},get type(){return t.componentType},get inputs(){return t.inputs},get outputs(){return t.outputs},get ngContentSelectors(){return t.ngContentSelectors},get isStandalone(){return n.standalone},get isSignal(){return n.signals}}}var Qw=null;function ks(){return Qw}function Zw(e){Qw??=e}var kf=class{};var sn=new ge(""),Yp=(()=>{class e{historyGo(t){throw new Error("")}static{this.\u0275fac=function(r){return new(r||e)}}static{this.\u0275prov=he({token:e,factory:()=>te(qM),providedIn:"platform"})}}return e})(),Jw=new ge(""),qM=(()=>{class e extends Yp{constructor(){super(),this._doc=te(sn),this._location=window.location,this._history=window.history}getBaseHrefFromDOM(){return ks().getBaseHref(this._doc)}onPopState(t){let r=ks().getGlobalEventTarget(this._doc,"window");return r.addEventListener("popstate",t,!1),()=>r.removeEventListener("popstate",t)}onHashChange(t){let r=ks().getGlobalEventTarget(this._doc,"window");return r.addEventListener("hashchange",t,!1),()=>r.removeEventListener("hashchange",t)}get href(){return this._location.href}get protocol(){return this._location.protocol}get hostname(){return this._location.hostname}get port(){return this._location.port}get pathname(){return this._location.pathname}get search(){return this._location.search}get hash(){return this._location.hash}set pathname(t){this._location.pathname=t}pushState(t,r,i){this._history.pushState(t,r,i)}replaceState(t,r,i){this._history.replaceState(t,r,i)}forward(){this._history.forward()}back(){this._history.back()}historyGo(t=0){this._history.go(t)}getState(){return this._history.state}static{this.\u0275fac=function(r){return new(r||e)}}static{this.\u0275prov=he({token:e,factory:()=>new e,providedIn:"platform"})}}return e})();function Xp(e,n){if(e.length==0)return n;if(n.length==0)return e;let t=0;return e.endsWith("/")&&t++,n.startsWith("/")&&t++,t==2?e+n.substring(1):t==1?e+n:e+"/"+n}function qw(e){let n=e.match(/#|\?|$/),t=n&&n.index||e.length,r=t-(e[t-1]==="/"?1:0);return e.slice(0,r)+e.slice(t)}function ui(e){return e&&e[0]!=="?"?"?"+e:e}var fi=(()=>{class e{historyGo(t){throw new Error("")}static{this.\u0275fac=function(r){return new(r||e)}}static{this.\u0275prov=he({token:e,factory:()=>te(Qp),providedIn:"root"})}}return e})(),eE=new ge(""),Qp=(()=>{class e extends fi{constructor(t,r){super(),this._platformLocation=t,this._removeListenerFns=[],this._baseHref=r??this._platformLocation.getBaseHrefFromDOM()??te(sn).location?.origin??""}ngOnDestroy(){for(;this._removeListenerFns.length;)this._removeListenerFns.pop()()}onPopState(t){this._removeListenerFns.push(this._platformLocation.onPopState(t),this._platformLocation.onHashChange(t))}getBaseHref(){return this._baseHref}prepareExternalUrl(t){return Xp(this._baseHref,t)}path(t=!1){let r=this._platformLocation.pathname+ui(this._platformLocation.search),i=this._platformLocation.hash;return i&&t?`${r}${i}`:r}pushState(t,r,i,s){let o=this.prepareExternalUrl(i+ui(s));this._platformLocation.pushState(t,r,o)}replaceState(t,r,i,s){let o=this.prepareExternalUrl(i+ui(s));this._platformLocation.replaceState(t,r,o)}forward(){this._platformLocation.forward()}back(){this._platformLocation.back()}getState(){return this._platformLocation.getState()}historyGo(t=0){this._platformLocation.historyGo?.(t)}static{this.\u0275fac=function(r){return new(r||e)(ue(Yp),ue(eE,8))}}static{this.\u0275prov=he({token:e,factory:e.\u0275fac,providedIn:"root"})}}return e})(),tE=(()=>{class e extends fi{constructor(t,r){super(),this._platformLocation=t,this._baseHref="",this._removeListenerFns=[],r!=null&&(this._baseHref=r)}ngOnDestroy(){for(;this._removeListenerFns.length;)this._removeListenerFns.pop()()}onPopState(t){this._removeListenerFns.push(this._platformLocation.onPopState(t),this._platformLocation.onHashChange(t))}getBaseHref(){return this._baseHref}path(t=!1){let r=this._platformLocation.hash??"#";return r.length>0?r.substring(1):r}prepareExternalUrl(t){let r=Xp(this._baseHref,t);return r.length>0?"#"+r:r}pushState(t,r,i,s){let o=this.prepareExternalUrl(i+ui(s));o.length==0&&(o=this._platformLocation.pathname),this._platformLocation.pushState(t,r,o)}replaceState(t,r,i,s){let o=this.prepareExternalUrl(i+ui(s));o.length==0&&(o=this._platformLocation.pathname),this._platformLocation.replaceState(t,r,o)}forward(){this._platformLocation.forward()}back(){this._platformLocation.back()}getState(){return this._platformLocation.getState()}historyGo(t=0){this._platformLocation.historyGo?.(t)}static{this.\u0275fac=function(r){return new(r||e)(ue(Yp),ue(eE,8))}}static{this.\u0275prov=he({token:e,factory:e.\u0275fac})}}return e})(),$o=(()=>{class e{constructor(t){this._subject=new gn,this._urlChangeListeners=[],this._urlChangeSubscription=null,this._locationStrategy=t;let r=this._locationStrategy.getBaseHref();this._basePath=XM(qw(Kw(r))),this._locationStrategy.onPopState(i=>{this._subject.emit({url:this.path(!0),pop:!0,state:i.state,type:i.type})})}ngOnDestroy(){this._urlChangeSubscription?.unsubscribe(),this._urlChangeListeners=[]}path(t=!1){return this.normalize(this._locationStrategy.path(t))}getState(){return this._locationStrategy.getState()}isCurrentPathEqualTo(t,r=""){return this.path()==this.normalize(t+ui(r))}normalize(t){return e.stripTrailingSlash(YM(this._basePath,Kw(t)))}prepareExternalUrl(t){return t&&t[0]!=="/"&&(t="/"+t),this._locationStrategy.prepareExternalUrl(t)}go(t,r="",i=null){this._locationStrategy.pushState(i,"",t,r),this._notifyUrlChangeListeners(this.prepareExternalUrl(t+ui(r)),i)}replaceState(t,r="",i=null){this._locationStrategy.replaceState(i,"",t,r),this._notifyUrlChangeListeners(this.prepareExternalUrl(t+ui(r)),i)}forward(){this._locationStrategy.forward()}back(){this._locationStrategy.back()}historyGo(t=0){this._locationStrategy.historyGo?.(t)}onUrlChange(t){return this._urlChangeListeners.push(t),this._urlChangeSubscription??=this.subscribe(r=>{this._notifyUrlChangeListeners(r.url,r.state)}),()=>{let r=this._urlChangeListeners.indexOf(t);this._urlChangeListeners.splice(r,1),this._urlChangeListeners.length===0&&(this._urlChangeSubscription?.unsubscribe(),this._urlChangeSubscription=null)}}_notifyUrlChangeListeners(t="",r){this._urlChangeListeners.forEach(i=>i(t,r))}subscribe(t,r,i){return this._subject.subscribe({next:t,error:r,complete:i})}static{this.normalizeQueryParams=ui}static{this.joinWithSlash=Xp}static{this.stripTrailingSlash=qw}static{this.\u0275fac=function(r){return new(r||e)(ue(fi))}}static{this.\u0275prov=he({token:e,factory:()=>KM(),providedIn:"root"})}}return e})();function KM(){return new $o(ue(fi))}function YM(e,n){if(!e||!n.startsWith(e))return n;let t=n.substring(e.length);return t===""||["/",";","?","#"].includes(t[0])?t:n}function Kw(e){return e.replace(/\/index.html$/,"")}function XM(e){if(new RegExp("^(https?:)?//").test(e)){let[,t]=e.split(/\/\/[^\/]+/);return t}return e}function Nf(e,n){n=encodeURIComponent(n);for(let t of e.split(";")){let r=t.indexOf("="),[i,s]=r==-1?[t,""]:[t.slice(0,r),t.slice(r+1)];if(i.trim()===n)return decodeURIComponent(s)}return null}var zp=class{constructor(n,t,r,i){this.$implicit=n,this.ngForOf=t,this.index=r,this.count=i}get first(){return this.index===0}get last(){return this.index===this.count-1}get even(){return this.index%2===0}get odd(){return!this.even}},Wo=(()=>{class e{set ngForOf(t){this._ngForOf=t,this._ngForOfDirty=!0}set ngForTrackBy(t){this._trackByFn=t}get ngForTrackBy(){return this._trackByFn}constructor(t,r,i){this._viewContainer=t,this._template=r,this._differs=i,this._ngForOf=null,this._ngForOfDirty=!0,this._differ=null}set ngForTemplate(t){t&&(this._template=t)}ngDoCheck(){if(this._ngForOfDirty){this._ngForOfDirty=!1;let t=this._ngForOf;if(!this._differ&&t)if(0)try{}catch{}else this._differ=this._differs.find(t).create(this.ngForTrackBy)}if(this._differ){let t=this._differ.diff(this._ngForOf);t&&this._applyChanges(t)}}_applyChanges(t){let r=this._viewContainer;t.forEachOperation((i,s,o)=>{if(i.previousIndex==null)r.createEmbeddedView(this._template,new zp(i.item,this._ngForOf,-1,-1),o===null?void 0:o);else if(o==null)r.remove(s===null?void 0:s);else if(s!==null){let a=r.get(s);r.move(a,o),Yw(a,i)}});for(let i=0,s=r.length;i<s;i++){let a=r.get(i).context;a.index=i,a.count=s,a.ngForOf=this._ngForOf}t.forEachIdentityChange(i=>{let s=r.get(i.currentIndex);Yw(s,i)})}static ngTemplateContextGuard(t,r){return!0}static{this.\u0275fac=function(r){return new(r||e)(at(jo),at(_f),at(Wp))}}static{this.\u0275dir=Po({type:e,selectors:[["","ngFor","","ngForOf",""]],inputs:{ngForOf:"ngForOf",ngForTrackBy:"ngForTrackBy",ngForTemplate:"ngForTemplate"},standalone:!0})}}return e})();function Yw(e,n){e.context.$implicit=n.item}var Ui=(()=>{class e{constructor(t,r){this._viewContainer=t,this._context=new Gp,this._thenTemplateRef=null,this._elseTemplateRef=null,this._thenViewRef=null,this._elseViewRef=null,this._thenTemplateRef=r}set ngIf(t){this._context.$implicit=this._context.ngIf=t,this._updateView()}set ngIfThen(t){Xw("ngIfThen",t),this._thenTemplateRef=t,this._thenViewRef=null,this._updateView()}set ngIfElse(t){Xw("ngIfElse",t),this._elseTemplateRef=t,this._elseViewRef=null,this._updateView()}_updateView(){this._context.$implicit?this._thenViewRef||(this._viewContainer.clear(),this._elseViewRef=null,this._thenTemplateRef&&(this._thenViewRef=this._viewContainer.createEmbeddedView(this._thenTemplateRef,this._context))):this._elseViewRef||(this._viewContainer.clear(),this._thenViewRef=null,this._elseTemplateRef&&(this._elseViewRef=this._viewContainer.createEmbeddedView(this._elseTemplateRef,this._context)))}static ngTemplateContextGuard(t,r){return!0}static{this.\u0275fac=function(r){return new(r||e)(at(jo),at(_f))}}static{this.\u0275dir=Po({type:e,selectors:[["","ngIf",""]],inputs:{ngIf:"ngIf",ngIfThen:"ngIfThen",ngIfElse:"ngIfElse"},standalone:!0})}}return e})(),Gp=class{constructor(){this.$implicit=null,this.ngIf=null}};function Xw(e,n){if(!!!(!n||n.createEmbeddedView))throw new Error(`${e} must be a TemplateRef, but received '${_n(n)}'.`)}var nE=(()=>{class e{static{this.\u0275fac=function(r){return new(r||e)}}static{this.\u0275mod=Xt({type:e})}static{this.\u0275inj=Yt({})}}return e})(),Zp="browser",QM="server";function ZM(e){return e===Zp}function Rf(e){return e===QM}var rE=(()=>{class e{static{this.\u0275prov=he({token:e,providedIn:"root",factory:()=>ZM(te(Xn))?new qp(te(sn),window):new Kp})}}return e})(),qp=class{constructor(n,t){this.document=n,this.window=t,this.offset=()=>[0,0]}setOffset(n){Array.isArray(n)?this.offset=()=>n:this.offset=n}getScrollPosition(){return[this.window.scrollX,this.window.scrollY]}scrollToPosition(n){this.window.scrollTo(n[0],n[1])}scrollToAnchor(n){let t=JM(this.document,n);t&&(this.scrollToElement(t),t.focus())}setHistoryScrollRestoration(n){this.window.history.scrollRestoration=n}scrollToElement(n){let t=n.getBoundingClientRect(),r=t.left+this.window.pageXOffset,i=t.top+this.window.pageYOffset,s=this.offset();this.window.scrollTo(r-s[0],i-s[1])}};function JM(e,n){let t=e.getElementById(n)||e.getElementsByName(n)[0];if(t)return t;if(typeof e.createTreeWalker=="function"&&e.body&&typeof e.body.attachShadow=="function"){let r=e.createTreeWalker(e.body,NodeFilter.SHOW_ELEMENT),i=r.currentNode;for(;i;){let s=i.shadowRoot;if(s){let o=s.getElementById(n)||s.querySelector(`[name="${n}"]`);if(o)return o}i=r.nextNode()}}return null}var Kp=class{setOffset(n){}getScrollPosition(){return[0,0]}scrollToPosition(n){}scrollToAnchor(n){}setHistoryScrollRestoration(n){}},Ho=class{};var pc=class{},Of=class{},Ns=class e{constructor(n){this.normalizedNames=new Map,this.lazyUpdate=null,n?typeof n=="string"?this.lazyInit=()=>{this.headers=new Map,n.split(`
`).forEach(t=>{let r=t.indexOf(":");if(r>0){let i=t.slice(0,r),s=i.toLowerCase(),o=t.slice(r+1).trim();this.maybeSetNormalizedName(i,s),this.headers.has(s)?this.headers.get(s).push(o):this.headers.set(s,[o])}})}:typeof Headers<"u"&&n instanceof Headers?(this.headers=new Map,n.forEach((t,r)=>{this.setHeaderEntries(r,t)})):this.lazyInit=()=>{this.headers=new Map,Object.entries(n).forEach(([t,r])=>{this.setHeaderEntries(t,r)})}:this.headers=new Map}has(n){return this.init(),this.headers.has(n.toLowerCase())}get(n){this.init();let t=this.headers.get(n.toLowerCase());return t&&t.length>0?t[0]:null}keys(){return this.init(),Array.from(this.normalizedNames.values())}getAll(n){return this.init(),this.headers.get(n.toLowerCase())||null}append(n,t){return this.clone({name:n,value:t,op:"a"})}set(n,t){return this.clone({name:n,value:t,op:"s"})}delete(n,t){return this.clone({name:n,value:t,op:"d"})}maybeSetNormalizedName(n,t){this.normalizedNames.has(t)||this.normalizedNames.set(t,n)}init(){this.lazyInit&&(this.lazyInit instanceof e?this.copyFrom(this.lazyInit):this.lazyInit(),this.lazyInit=null,this.lazyUpdate&&(this.lazyUpdate.forEach(n=>this.applyUpdate(n)),this.lazyUpdate=null))}copyFrom(n){n.init(),Array.from(n.headers.keys()).forEach(t=>{this.headers.set(t,n.headers.get(t)),this.normalizedNames.set(t,n.normalizedNames.get(t))})}clone(n){let t=new e;return t.lazyInit=this.lazyInit&&this.lazyInit instanceof e?this.lazyInit:this,t.lazyUpdate=(this.lazyUpdate||[]).concat([n]),t}applyUpdate(n){let t=n.name.toLowerCase();switch(n.op){case"a":case"s":let r=n.value;if(typeof r=="string"&&(r=[r]),r.length===0)return;this.maybeSetNormalizedName(n.name,t);let i=(n.op==="a"?this.headers.get(t):void 0)||[];i.push(...r),this.headers.set(t,i);break;case"d":let s=n.value;if(!s)this.headers.delete(t),this.normalizedNames.delete(t);else{let o=this.headers.get(t);if(!o)return;o=o.filter(a=>s.indexOf(a)===-1),o.length===0?(this.headers.delete(t),this.normalizedNames.delete(t)):this.headers.set(t,o)}break}}setHeaderEntries(n,t){let r=(Array.isArray(t)?t:[t]).map(s=>s.toString()),i=n.toLowerCase();this.headers.set(i,r),this.maybeSetNormalizedName(n,i)}forEach(n){this.init(),Array.from(this.normalizedNames.keys()).forEach(t=>n(this.normalizedNames.get(t),this.headers.get(t)))}};var em=class{encodeKey(n){return iE(n)}encodeValue(n){return iE(n)}decodeKey(n){return decodeURIComponent(n)}decodeValue(n){return decodeURIComponent(n)}};function nO(e,n){let t=new Map;return e.length>0&&e.replace(/^\?/,"").split("&").forEach(i=>{let s=i.indexOf("="),[o,a]=s==-1?[n.decodeKey(i),""]:[n.decodeKey(i.slice(0,s)),n.decodeValue(i.slice(s+1))],c=t.get(o)||[];c.push(a),t.set(o,c)}),t}var rO=/%(\d[a-f0-9])/gi,iO={40:"@","3A":":",24:"$","2C":",","3B":";","3D":"=","3F":"?","2F":"/"};function iE(e){return encodeURIComponent(e).replace(rO,(n,t)=>iO[t]??n)}function Mf(e){return`${e}`}var ji=class e{constructor(n={}){if(this.updates=null,this.cloneFrom=null,this.encoder=n.encoder||new em,n.fromString){if(n.fromObject)throw new Error("Cannot specify both fromString and fromObject.");this.map=nO(n.fromString,this.encoder)}else n.fromObject?(this.map=new Map,Object.keys(n.fromObject).forEach(t=>{let r=n.fromObject[t],i=Array.isArray(r)?r.map(Mf):[Mf(r)];this.map.set(t,i)})):this.map=null}has(n){return this.init(),this.map.has(n)}get(n){this.init();let t=this.map.get(n);return t?t[0]:null}getAll(n){return this.init(),this.map.get(n)||null}keys(){return this.init(),Array.from(this.map.keys())}append(n,t){return this.clone({param:n,value:t,op:"a"})}appendAll(n){let t=[];return Object.keys(n).forEach(r=>{let i=n[r];Array.isArray(i)?i.forEach(s=>{t.push({param:r,value:s,op:"a"})}):t.push({param:r,value:i,op:"a"})}),this.clone(t)}set(n,t){return this.clone({param:n,value:t,op:"s"})}delete(n,t){return this.clone({param:n,value:t,op:"d"})}toString(){return this.init(),this.keys().map(n=>{let t=this.encoder.encodeKey(n);return this.map.get(n).map(r=>t+"="+this.encoder.encodeValue(r)).join("&")}).filter(n=>n!=="").join("&")}clone(n){let t=new e({encoder:this.encoder});return t.cloneFrom=this.cloneFrom||this,t.updates=(this.updates||[]).concat(n),t}init(){this.map===null&&(this.map=new Map),this.cloneFrom!==null&&(this.cloneFrom.init(),this.cloneFrom.keys().forEach(n=>this.map.set(n,this.cloneFrom.map.get(n))),this.updates.forEach(n=>{switch(n.op){case"a":case"s":let t=(n.op==="a"?this.map.get(n.param):void 0)||[];t.push(Mf(n.value)),this.map.set(n.param,t);break;case"d":if(n.value!==void 0){let r=this.map.get(n.param)||[],i=r.indexOf(Mf(n.value));i!==-1&&r.splice(i,1),r.length>0?this.map.set(n.param,r):this.map.delete(n.param)}else{this.map.delete(n.param);break}}}),this.cloneFrom=this.updates=null)}};var tm=class{constructor(){this.map=new Map}set(n,t){return this.map.set(n,t),this}get(n){return this.map.has(n)||this.map.set(n,n.defaultValue()),this.map.get(n)}delete(n){return this.map.delete(n),this}has(n){return this.map.has(n)}keys(){return this.map.keys()}};function sO(e){switch(e){case"DELETE":case"GET":case"HEAD":case"OPTIONS":case"JSONP":return!1;default:return!0}}function sE(e){return typeof ArrayBuffer<"u"&&e instanceof ArrayBuffer}function oE(e){return typeof Blob<"u"&&e instanceof Blob}function aE(e){return typeof FormData<"u"&&e instanceof FormData}function oO(e){return typeof URLSearchParams<"u"&&e instanceof URLSearchParams}var hc=class e{constructor(n,t,r,i){this.url=t,this.body=null,this.reportProgress=!1,this.withCredentials=!1,this.responseType="json",this.method=n.toUpperCase();let s;if(sO(this.method)||i?(this.body=r!==void 0?r:null,s=i):s=r,s&&(this.reportProgress=!!s.reportProgress,this.withCredentials=!!s.withCredentials,s.responseType&&(this.responseType=s.responseType),s.headers&&(this.headers=s.headers),s.context&&(this.context=s.context),s.params&&(this.params=s.params),this.transferCache=s.transferCache),this.headers??=new Ns,this.context??=new tm,!this.params)this.params=new ji,this.urlWithParams=t;else{let o=this.params.toString();if(o.length===0)this.urlWithParams=t;else{let a=t.indexOf("?"),c=a===-1?"?":a<t.length-1?"&":"";this.urlWithParams=t+c+o}}}serializeBody(){return this.body===null?null:typeof this.body=="string"||sE(this.body)||oE(this.body)||aE(this.body)||oO(this.body)?this.body:this.body instanceof ji?this.body.toString():typeof this.body=="object"||typeof this.body=="boolean"||Array.isArray(this.body)?JSON.stringify(this.body):this.body.toString()}detectContentTypeHeader(){return this.body===null||aE(this.body)?null:oE(this.body)?this.body.type||null:sE(this.body)?null:typeof this.body=="string"?"text/plain":this.body instanceof ji?"application/x-www-form-urlencoded;charset=UTF-8":typeof this.body=="object"||typeof this.body=="number"||typeof this.body=="boolean"?"application/json":null}clone(n={}){let t=n.method||this.method,r=n.url||this.url,i=n.responseType||this.responseType,s=n.transferCache??this.transferCache,o=n.body!==void 0?n.body:this.body,a=n.withCredentials??this.withCredentials,c=n.reportProgress??this.reportProgress,l=n.headers||this.headers,u=n.params||this.params,f=n.context??this.context;return n.setHeaders!==void 0&&(l=Object.keys(n.setHeaders).reduce((d,h)=>d.set(h,n.setHeaders[h]),l)),n.setParams&&(u=Object.keys(n.setParams).reduce((d,h)=>d.set(h,n.setParams[h]),u)),new e(t,r,o,{params:u,headers:l,context:f,reportProgress:c,responseType:i,withCredentials:a,transferCache:s})}},Go=function(e){return e[e.Sent=0]="Sent",e[e.UploadProgress=1]="UploadProgress",e[e.ResponseHeader=2]="ResponseHeader",e[e.DownloadProgress=3]="DownloadProgress",e[e.Response=4]="Response",e[e.User=5]="User",e}(Go||{}),mc=class{constructor(n,t=Lf.Ok,r="OK"){this.headers=n.headers||new Ns,this.status=n.status!==void 0?n.status:t,this.statusText=n.statusText||r,this.url=n.url||null,this.ok=this.status>=200&&this.status<300}},nm=class e extends mc{constructor(n={}){super(n),this.type=Go.ResponseHeader}clone(n={}){return new e({headers:n.headers||this.headers,status:n.status!==void 0?n.status:this.status,statusText:n.statusText||this.statusText,url:n.url||this.url||void 0})}},Ff=class e extends mc{constructor(n={}){super(n),this.type=Go.Response,this.body=n.body!==void 0?n.body:null}clone(n={}){return new e({body:n.body!==void 0?n.body:this.body,headers:n.headers||this.headers,status:n.status!==void 0?n.status:this.status,statusText:n.statusText||this.statusText,url:n.url||this.url||void 0})}},Pf=class extends mc{constructor(n){super(n,0,"Unknown Error"),this.name="HttpErrorResponse",this.ok=!1,this.status>=200&&this.status<300?this.message=`Http failure during parsing for ${n.url||"(unknown url)"}`:this.message=`Http failure response for ${n.url||"(unknown url)"}: ${n.status} ${n.statusText}`,this.error=n.error||null}},Lf=function(e){return e[e.Continue=100]="Continue",e[e.SwitchingProtocols=101]="SwitchingProtocols",e[e.Processing=102]="Processing",e[e.EarlyHints=103]="EarlyHints",e[e.Ok=200]="Ok",e[e.Created=201]="Created",e[e.Accepted=202]="Accepted",e[e.NonAuthoritativeInformation=203]="NonAuthoritativeInformation",e[e.NoContent=204]="NoContent",e[e.ResetContent=205]="ResetContent",e[e.PartialContent=206]="PartialContent",e[e.MultiStatus=207]="MultiStatus",e[e.AlreadyReported=208]="AlreadyReported",e[e.ImUsed=226]="ImUsed",e[e.MultipleChoices=300]="MultipleChoices",e[e.MovedPermanently=301]="MovedPermanently",e[e.Found=302]="Found",e[e.SeeOther=303]="SeeOther",e[e.NotModified=304]="NotModified",e[e.UseProxy=305]="UseProxy",e[e.Unused=306]="Unused",e[e.TemporaryRedirect=307]="TemporaryRedirect",e[e.PermanentRedirect=308]="PermanentRedirect",e[e.BadRequest=400]="BadRequest",e[e.Unauthorized=401]="Unauthorized",e[e.PaymentRequired=402]="PaymentRequired",e[e.Forbidden=403]="Forbidden",e[e.NotFound=404]="NotFound",e[e.MethodNotAllowed=405]="MethodNotAllowed",e[e.NotAcceptable=406]="NotAcceptable",e[e.ProxyAuthenticationRequired=407]="ProxyAuthenticationRequired",e[e.RequestTimeout=408]="RequestTimeout",e[e.Conflict=409]="Conflict",e[e.Gone=410]="Gone",e[e.LengthRequired=411]="LengthRequired",e[e.PreconditionFailed=412]="PreconditionFailed",e[e.PayloadTooLarge=413]="PayloadTooLarge",e[e.UriTooLong=414]="UriTooLong",e[e.UnsupportedMediaType=415]="UnsupportedMediaType",e[e.RangeNotSatisfiable=416]="RangeNotSatisfiable",e[e.ExpectationFailed=417]="ExpectationFailed",e[e.ImATeapot=418]="ImATeapot",e[e.MisdirectedRequest=421]="MisdirectedRequest",e[e.UnprocessableEntity=422]="UnprocessableEntity",e[e.Locked=423]="Locked",e[e.FailedDependency=424]="FailedDependency",e[e.TooEarly=425]="TooEarly",e[e.UpgradeRequired=426]="UpgradeRequired",e[e.PreconditionRequired=428]="PreconditionRequired",e[e.TooManyRequests=429]="TooManyRequests",e[e.RequestHeaderFieldsTooLarge=431]="RequestHeaderFieldsTooLarge",e[e.UnavailableForLegalReasons=451]="UnavailableForLegalReasons",e[e.InternalServerError=500]="InternalServerError",e[e.NotImplemented=501]="NotImplemented",e[e.BadGateway=502]="BadGateway",e[e.ServiceUnavailable=503]="ServiceUnavailable",e[e.GatewayTimeout=504]="GatewayTimeout",e[e.HttpVersionNotSupported=505]="HttpVersionNotSupported",e[e.VariantAlsoNegotiates=506]="VariantAlsoNegotiates",e[e.InsufficientStorage=507]="InsufficientStorage",e[e.LoopDetected=508]="LoopDetected",e[e.NotExtended=510]="NotExtended",e[e.NetworkAuthenticationRequired=511]="NetworkAuthenticationRequired",e}(Lf||{});function Jp(e,n){return{body:n,headers:e.headers,context:e.context,observe:e.observe,params:e.params,reportProgress:e.reportProgress,responseType:e.responseType,withCredentials:e.withCredentials,transferCache:e.transferCache}}var rm=(()=>{class e{constructor(t){this.handler=t}request(t,r,i={}){let s;if(t instanceof hc)s=t;else{let c;i.headers instanceof Ns?c=i.headers:c=new Ns(i.headers);let l;i.params&&(i.params instanceof ji?l=i.params:l=new ji({fromObject:i.params})),s=new hc(t,r,i.body!==void 0?i.body:null,{headers:c,context:i.context,params:l,reportProgress:i.reportProgress,responseType:i.responseType||"json",withCredentials:i.withCredentials,transferCache:i.transferCache})}let o=xe(s).pipe(ri(c=>this.handler.handle(c)));if(t instanceof hc||i.observe==="events")return o;let a=o.pipe(Sn(c=>c instanceof Ff));switch(i.observe||"body"){case"body":switch(s.responseType){case"arraybuffer":return a.pipe(be(c=>{if(c.body!==null&&!(c.body instanceof ArrayBuffer))throw new Error("Response is not an ArrayBuffer.");return c.body}));case"blob":return a.pipe(be(c=>{if(c.body!==null&&!(c.body instanceof Blob))throw new Error("Response is not a Blob.");return c.body}));case"text":return a.pipe(be(c=>{if(c.body!==null&&typeof c.body!="string")throw new Error("Response is not a string.");return c.body}));case"json":default:return a.pipe(be(c=>c.body))}case"response":return a;default:throw new Error(`Unreachable: unhandled observe type ${i.observe}}`)}}delete(t,r={}){return this.request("DELETE",t,r)}get(t,r={}){return this.request("GET",t,r)}head(t,r={}){return this.request("HEAD",t,r)}jsonp(t,r){return this.request("JSONP",t,{params:new ji().append(r,"JSONP_CALLBACK"),observe:"body",responseType:"json"})}options(t,r={}){return this.request("OPTIONS",t,r)}patch(t,r,i={}){return this.request("PATCH",t,Jp(i,r))}post(t,r,i={}){return this.request("POST",t,Jp(i,r))}put(t,r,i={}){return this.request("PUT",t,Jp(i,r))}static{this.\u0275fac=function(r){return new(r||e)(ue(pc))}}static{this.\u0275prov=he({token:e,factory:e.\u0275fac})}}return e})();function fE(e,n){return n(e)}function aO(e,n){return(t,r)=>n.intercept(t,{handle:i=>e(i,r)})}function cO(e,n,t){return(r,i)=>pr(t,()=>n(r,s=>e(s,i)))}var lO=new ge(""),im=new ge(""),uO=new ge(""),fO=new ge("");function dO(){let e=null;return(n,t)=>{e===null&&(e=(te(lO,{optional:!0})??[]).reduceRight(aO,fE));let r=te(Ss),i=r.add();return e(n,t).pipe(ki(()=>r.remove(i)))}}var cE=(()=>{class e extends pc{constructor(t,r){super(),this.backend=t,this.injector=r,this.chain=null,this.pendingTasks=te(Ss);let i=te(fO,{optional:!0});this.backend=i??t}handle(t){if(this.chain===null){let i=Array.from(new Set([...this.injector.get(im),...this.injector.get(uO,[])]));this.chain=i.reduceRight((s,o)=>cO(s,o,this.injector),fE)}let r=this.pendingTasks.add();return this.chain(t,i=>this.backend.handle(i)).pipe(ki(()=>this.pendingTasks.remove(r)))}static{this.\u0275fac=function(r){return new(r||e)(ue(Of),ue(nn))}}static{this.\u0275prov=he({token:e,factory:e.\u0275fac})}}return e})();var hO=/^\)\]\}',?\n/;function pO(e){return"responseURL"in e&&e.responseURL?e.responseURL:/^X-Request-URL:/m.test(e.getAllResponseHeaders())?e.getResponseHeader("X-Request-URL"):null}var lE=(()=>{class e{constructor(t){this.xhrFactory=t}handle(t){if(t.method==="JSONP")throw new ve(-2800,!1);let r=this.xhrFactory;return(r.\u0275loadImpl?ht(r.\u0275loadImpl()):xe(null)).pipe(Dn(()=>new Ve(s=>{let o=r.build();if(o.open(t.method,t.urlWithParams),t.withCredentials&&(o.withCredentials=!0),t.headers.forEach((p,g)=>o.setRequestHeader(p,g.join(","))),t.headers.has("Accept")||o.setRequestHeader("Accept","application/json, text/plain, */*"),!t.headers.has("Content-Type")){let p=t.detectContentTypeHeader();p!==null&&o.setRequestHeader("Content-Type",p)}if(t.responseType){let p=t.responseType.toLowerCase();o.responseType=p!=="json"?p:"text"}let a=t.serializeBody(),c=null,l=()=>{if(c!==null)return c;let p=o.statusText||"OK",g=new Ns(o.getAllResponseHeaders()),w=pO(o)||t.url;return c=new nm({headers:g,status:o.status,statusText:p,url:w}),c},u=()=>{let{headers:p,status:g,statusText:w,url:C}=l(),_=null;g!==Lf.NoContent&&(_=typeof o.response>"u"?o.responseText:o.response),g===0&&(g=_?Lf.Ok:0);let M=g>=200&&g<300;if(t.responseType==="json"&&typeof _=="string"){let V=_;_=_.replace(hO,"");try{_=_!==""?JSON.parse(_):null}catch(A){_=V,M&&(M=!1,_={error:A,text:_})}}M?(s.next(new Ff({body:_,headers:p,status:g,statusText:w,url:C||void 0})),s.complete()):s.error(new Pf({error:_,headers:p,status:g,statusText:w,url:C||void 0}))},f=p=>{let{url:g}=l(),w=new Pf({error:p,status:o.status||0,statusText:o.statusText||"Unknown Error",url:g||void 0});s.error(w)},d=!1,h=p=>{d||(s.next(l()),d=!0);let g={type:Go.DownloadProgress,loaded:p.loaded};p.lengthComputable&&(g.total=p.total),t.responseType==="text"&&o.responseText&&(g.partialText=o.responseText),s.next(g)},m=p=>{let g={type:Go.UploadProgress,loaded:p.loaded};p.lengthComputable&&(g.total=p.total),s.next(g)};return o.addEventListener("load",u),o.addEventListener("error",f),o.addEventListener("timeout",f),o.addEventListener("abort",f),t.reportProgress&&(o.addEventListener("progress",h),a!==null&&o.upload&&o.upload.addEventListener("progress",m)),o.send(a),s.next({type:Go.Sent}),()=>{o.removeEventListener("error",f),o.removeEventListener("abort",f),o.removeEventListener("load",u),o.removeEventListener("timeout",f),t.reportProgress&&(o.removeEventListener("progress",h),a!==null&&o.upload&&o.upload.removeEventListener("progress",m)),o.readyState!==o.DONE&&o.abort()}})))}static{this.\u0275fac=function(r){return new(r||e)(ue(Ho))}}static{this.\u0275prov=he({token:e,factory:e.\u0275fac})}}return e})(),dE=new ge(""),mO="XSRF-TOKEN",gO=new ge("",{providedIn:"root",factory:()=>mO}),vO="X-XSRF-TOKEN",_O=new ge("",{providedIn:"root",factory:()=>vO}),Bf=class{},xO=(()=>{class e{constructor(t,r,i){this.doc=t,this.platform=r,this.cookieName=i,this.lastCookieString="",this.lastToken=null,this.parseCount=0}getToken(){if(this.platform==="server")return null;let t=this.doc.cookie||"";return t!==this.lastCookieString&&(this.parseCount++,this.lastToken=Nf(t,this.cookieName),this.lastCookieString=t),this.lastToken}static{this.\u0275fac=function(r){return new(r||e)(ue(sn),ue(Xn),ue(gO))}}static{this.\u0275prov=he({token:e,factory:e.\u0275fac})}}return e})();function yO(e,n){let t=e.url.toLowerCase();if(!te(dE)||e.method==="GET"||e.method==="HEAD"||t.startsWith("http://")||t.startsWith("https://"))return n(e);let r=te(Bf).getToken(),i=te(_O);return r!=null&&!e.headers.has(i)&&(e=e.clone({headers:e.headers.set(i,r)})),n(e)}var hE=function(e){return e[e.Interceptors=0]="Interceptors",e[e.LegacyInterceptors=1]="LegacyInterceptors",e[e.CustomXsrfConfiguration=2]="CustomXsrfConfiguration",e[e.NoXsrfProtection=3]="NoXsrfProtection",e[e.JsonpSupport=4]="JsonpSupport",e[e.RequestsMadeViaParent=5]="RequestsMadeViaParent",e[e.Fetch=6]="Fetch",e}(hE||{});function wO(e,n){return{\u0275kind:e,\u0275providers:n}}function EO(...e){let n=[rm,lE,cE,{provide:pc,useExisting:cE},{provide:Of,useExisting:lE},{provide:im,useValue:yO,multi:!0},{provide:dE,useValue:!0},{provide:Bf,useClass:xO}];for(let t of e)n.push(...t.\u0275providers);return of(n)}var uE=new ge("");function TO(){return wO(hE.LegacyInterceptors,[{provide:uE,useFactory:dO},{provide:im,useExisting:uE,multi:!0}])}var pE=(()=>{class e{static{this.\u0275fac=function(r){return new(r||e)}}static{this.\u0275mod=Xt({type:e})}static{this.\u0275inj=Yt({providers:[EO(TO())]})}}return e})();var am=class extends kf{constructor(){super(...arguments),this.supportsDOMEvents=!0}},cm=class e extends am{static makeCurrent(){Zw(new e)}onAndCancel(n,t,r){return n.addEventListener(t,r),()=>{n.removeEventListener(t,r)}}dispatchEvent(n,t){n.dispatchEvent(t)}remove(n){n.parentNode&&n.parentNode.removeChild(n)}createElement(n,t){return t=t||this.getDefaultDocument(),t.createElement(n)}createHtmlDocument(){return document.implementation.createHTMLDocument("fakeTitle")}getDefaultDocument(){return document}isElementNode(n){return n.nodeType===Node.ELEMENT_NODE}isShadowRoot(n){return n instanceof DocumentFragment}getGlobalEventTarget(n,t){return t==="window"?window:t==="document"?n:t==="body"?n.body:null}getBaseHref(n){let t=CO();return t==null?null:SO(t)}resetBaseElement(){gc=null}getUserAgent(){return window.navigator.userAgent}getCookie(n){return Nf(document.cookie,n)}},gc=null;function CO(){return gc=gc||document.querySelector("base"),gc?gc.getAttribute("href"):null}function SO(e){return new URL(e,document.baseURI).pathname}var lm=class{addToWindow(n){vn.getAngularTestability=(r,i=!0)=>{let s=n.findTestabilityInTree(r,i);if(s==null)throw new ve(5103,!1);return s},vn.getAllAngularTestabilities=()=>n.getAllTestabilities(),vn.getAllAngularRootElements=()=>n.getAllRootElements();let t=r=>{let i=vn.getAllAngularTestabilities(),s=i.length,o=function(){s--,s==0&&r()};i.forEach(a=>{a.whenStable(o)})};vn.frameworkStabilizers||(vn.frameworkStabilizers=[]),vn.frameworkStabilizers.push(t)}findTestabilityInTree(n,t,r){if(t==null)return null;let i=n.getTestability(t);return i??(r?ks().isShadowRoot(t)?this.findTestabilityInTree(n,t.host,!0):this.findTestabilityInTree(n,t.parentElement,!0):null)}},DO=(()=>{class e{build(){return new XMLHttpRequest}static{this.\u0275fac=function(r){return new(r||e)}}static{this.\u0275prov=he({token:e,factory:e.\u0275fac})}}return e})(),um=new ge(""),_E=(()=>{class e{constructor(t,r){this._zone=r,this._eventNameToPlugin=new Map,t.forEach(i=>{i.manager=this}),this._plugins=t.slice().reverse()}addEventListener(t,r,i){return this._findPluginFor(r).addEventListener(t,r,i)}getZone(){return this._zone}_findPluginFor(t){let r=this._eventNameToPlugin.get(t);if(r)return r;if(r=this._plugins.find(s=>s.supports(t)),!r)throw new ve(5101,!1);return this._eventNameToPlugin.set(t,r),r}static{this.\u0275fac=function(r){return new(r||e)(ue(um),ue(Ye))}}static{this.\u0275prov=he({token:e,factory:e.\u0275fac})}}return e})(),Uf=class{constructor(n){this._doc=n}},sm="ng-app-id",xE=(()=>{class e{constructor(t,r,i,s={}){this.doc=t,this.appId=r,this.nonce=i,this.platformId=s,this.styleRef=new Map,this.hostNodes=new Set,this.styleNodesInDOM=this.collectServerRenderedStyles(),this.platformIsServer=Rf(s),this.resetHostNodes()}addStyles(t){for(let r of t)this.changeUsageCount(r,1)===1&&this.onStyleAdded(r)}removeStyles(t){for(let r of t)this.changeUsageCount(r,-1)<=0&&this.onStyleRemoved(r)}ngOnDestroy(){let t=this.styleNodesInDOM;t&&(t.forEach(r=>r.remove()),t.clear());for(let r of this.getAllStyles())this.onStyleRemoved(r);this.resetHostNodes()}addHost(t){this.hostNodes.add(t);for(let r of this.getAllStyles())this.addStyleToHost(t,r)}removeHost(t){this.hostNodes.delete(t)}getAllStyles(){return this.styleRef.keys()}onStyleAdded(t){for(let r of this.hostNodes)this.addStyleToHost(r,t)}onStyleRemoved(t){let r=this.styleRef;r.get(t)?.elements?.forEach(i=>i.remove()),r.delete(t)}collectServerRenderedStyles(){let t=this.doc.head?.querySelectorAll(`style[${sm}="${this.appId}"]`);if(t?.length){let r=new Map;return t.forEach(i=>{i.textContent!=null&&r.set(i.textContent,i)}),r}return null}changeUsageCount(t,r){let i=this.styleRef;if(i.has(t)){let s=i.get(t);return s.usage+=r,s.usage}return i.set(t,{usage:r,elements:[]}),r}getStyleElement(t,r){let i=this.styleNodesInDOM,s=i?.get(r);if(s?.parentNode===t)return i.delete(r),s.removeAttribute(sm),s;{let o=this.doc.createElement("style");return this.nonce&&o.setAttribute("nonce",this.nonce),o.textContent=r,this.platformIsServer&&o.setAttribute(sm,this.appId),t.appendChild(o),o}}addStyleToHost(t,r){let i=this.getStyleElement(t,r),s=this.styleRef,o=s.get(r)?.elements;o?o.push(i):s.set(r,{elements:[i],usage:1})}resetHostNodes(){let t=this.hostNodes;t.clear(),t.add(this.doc.head)}static{this.\u0275fac=function(r){return new(r||e)(ue(sn),ue(df),ue(Cp,8),ue(Xn))}}static{this.\u0275prov=he({token:e,factory:e.\u0275fac})}}return e})(),om={svg:"http://www.w3.org/2000/svg",xhtml:"http://www.w3.org/1999/xhtml",xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/",math:"http://www.w3.org/1998/MathML/"},dm=/%COMP%/g,yE="%COMP%",bO=`_nghost-${yE}`,AO=`_ngcontent-${yE}`,kO=!0,NO=new ge("",{providedIn:"root",factory:()=>kO});function RO(e){return AO.replace(dm,e)}function MO(e){return bO.replace(dm,e)}function wE(e,n){return n.map(t=>t.replace(dm,e))}var mE=(()=>{class e{constructor(t,r,i,s,o,a,c,l=null){this.eventManager=t,this.sharedStylesHost=r,this.appId=i,this.removeStylesOnCompDestroy=s,this.doc=o,this.platformId=a,this.ngZone=c,this.nonce=l,this.rendererByCompId=new Map,this.platformIsServer=Rf(a),this.defaultRenderer=new vc(t,o,c,this.platformIsServer)}createRenderer(t,r){if(!t||!r)return this.defaultRenderer;this.platformIsServer&&r.encapsulation===Rr.ShadowDom&&(r=gt(de({},r),{encapsulation:Rr.Emulated}));let i=this.getOrCreateRenderer(t,r);return i instanceof jf?i.applyToHost(t):i instanceof _c&&i.applyStyles(),i}getOrCreateRenderer(t,r){let i=this.rendererByCompId,s=i.get(r.id);if(!s){let o=this.doc,a=this.ngZone,c=this.eventManager,l=this.sharedStylesHost,u=this.removeStylesOnCompDestroy,f=this.platformIsServer;switch(r.encapsulation){case Rr.Emulated:s=new jf(c,l,r,this.appId,u,o,a,f);break;case Rr.ShadowDom:return new fm(c,l,t,r,o,a,this.nonce,f);default:s=new _c(c,l,r,u,o,a,f);break}i.set(r.id,s)}return s}ngOnDestroy(){this.rendererByCompId.clear()}static{this.\u0275fac=function(r){return new(r||e)(ue(_E),ue(xE),ue(df),ue(NO),ue(sn),ue(Xn),ue(Ye),ue(Cp))}}static{this.\u0275prov=he({token:e,factory:e.\u0275fac})}}return e})(),vc=class{constructor(n,t,r,i){this.eventManager=n,this.doc=t,this.ngZone=r,this.platformIsServer=i,this.data=Object.create(null),this.throwOnSyntheticProps=!0,this.destroyNode=null}destroy(){}createElement(n,t){return t?this.doc.createElementNS(om[t]||t,n):this.doc.createElement(n)}createComment(n){return this.doc.createComment(n)}createText(n){return this.doc.createTextNode(n)}appendChild(n,t){(gE(n)?n.content:n).appendChild(t)}insertBefore(n,t,r){n&&(gE(n)?n.content:n).insertBefore(t,r)}removeChild(n,t){n&&n.removeChild(t)}selectRootElement(n,t){let r=typeof n=="string"?this.doc.querySelector(n):n;if(!r)throw new ve(-5104,!1);return t||(r.textContent=""),r}parentNode(n){return n.parentNode}nextSibling(n){return n.nextSibling}setAttribute(n,t,r,i){if(i){t=i+":"+t;let s=om[i];s?n.setAttributeNS(s,t,r):n.setAttribute(t,r)}else n.setAttribute(t,r)}removeAttribute(n,t,r){if(r){let i=om[r];i?n.removeAttributeNS(i,t):n.removeAttribute(`${r}:${t}`)}else n.removeAttribute(t)}addClass(n,t){n.classList.add(t)}removeClass(n,t){n.classList.remove(t)}setStyle(n,t,r,i){i&(si.DashCase|si.Important)?n.style.setProperty(t,r,i&si.Important?"important":""):n.style[t]=r}removeStyle(n,t,r){r&si.DashCase?n.style.removeProperty(t):n.style[t]=""}setProperty(n,t,r){n!=null&&(n[t]=r)}setValue(n,t){n.nodeValue=t}listen(n,t,r){if(typeof n=="string"&&(n=ks().getGlobalEventTarget(this.doc,n),!n))throw new Error(`Unsupported event target ${n} for event ${t}`);return this.eventManager.addEventListener(n,t,this.decoratePreventDefault(r))}decoratePreventDefault(n){return t=>{if(t==="__ngUnwrap__")return n;(this.platformIsServer?this.ngZone.runGuarded(()=>n(t)):n(t))===!1&&t.preventDefault()}}};function gE(e){return e.tagName==="TEMPLATE"&&e.content!==void 0}var fm=class extends vc{constructor(n,t,r,i,s,o,a,c){super(n,s,o,c),this.sharedStylesHost=t,this.hostEl=r,this.shadowRoot=r.attachShadow({mode:"open"}),this.sharedStylesHost.addHost(this.shadowRoot);let l=wE(i.id,i.styles);for(let u of l){let f=document.createElement("style");a&&f.setAttribute("nonce",a),f.textContent=u,this.shadowRoot.appendChild(f)}}nodeOrShadowRoot(n){return n===this.hostEl?this.shadowRoot:n}appendChild(n,t){return super.appendChild(this.nodeOrShadowRoot(n),t)}insertBefore(n,t,r){return super.insertBefore(this.nodeOrShadowRoot(n),t,r)}removeChild(n,t){return super.removeChild(this.nodeOrShadowRoot(n),t)}parentNode(n){return this.nodeOrShadowRoot(super.parentNode(this.nodeOrShadowRoot(n)))}destroy(){this.sharedStylesHost.removeHost(this.shadowRoot)}},_c=class extends vc{constructor(n,t,r,i,s,o,a,c){super(n,s,o,a),this.sharedStylesHost=t,this.removeStylesOnCompDestroy=i,this.styles=c?wE(c,r.styles):r.styles}applyStyles(){this.sharedStylesHost.addStyles(this.styles)}destroy(){this.removeStylesOnCompDestroy&&this.sharedStylesHost.removeStyles(this.styles)}},jf=class extends _c{constructor(n,t,r,i,s,o,a,c){let l=i+"-"+r.id;super(n,t,r,s,o,a,c,l),this.contentAttr=RO(l),this.hostAttr=MO(l)}applyToHost(n){this.applyStyles(),this.setAttribute(n,this.hostAttr,"")}createElement(n,t){let r=super.createElement(n,t);return super.setAttribute(r,this.contentAttr,""),r}},OO=(()=>{class e extends Uf{constructor(t){super(t)}supports(t){return!0}addEventListener(t,r,i){return t.addEventListener(r,i,!1),()=>this.removeEventListener(t,r,i)}removeEventListener(t,r,i){return t.removeEventListener(r,i)}static{this.\u0275fac=function(r){return new(r||e)(ue(sn))}}static{this.\u0275prov=he({token:e,factory:e.\u0275fac})}}return e})(),vE=["alt","control","meta","shift"],FO={"\b":"Backspace","	":"Tab","\x7F":"Delete","\x1B":"Escape",Del:"Delete",Esc:"Escape",Left:"ArrowLeft",Right:"ArrowRight",Up:"ArrowUp",Down:"ArrowDown",Menu:"ContextMenu",Scroll:"ScrollLock",Win:"OS"},PO={alt:e=>e.altKey,control:e=>e.ctrlKey,meta:e=>e.metaKey,shift:e=>e.shiftKey},LO=(()=>{class e extends Uf{constructor(t){super(t)}supports(t){return e.parseEventName(t)!=null}addEventListener(t,r,i){let s=e.parseEventName(r),o=e.eventCallback(s.fullKey,i,this.manager.getZone());return this.manager.getZone().runOutsideAngular(()=>ks().onAndCancel(t,s.domEventName,o))}static parseEventName(t){let r=t.toLowerCase().split("."),i=r.shift();if(r.length===0||!(i==="keydown"||i==="keyup"))return null;let s=e._normalizeKey(r.pop()),o="",a=r.indexOf("code");if(a>-1&&(r.splice(a,1),o="code."),vE.forEach(l=>{let u=r.indexOf(l);u>-1&&(r.splice(u,1),o+=l+".")}),o+=s,r.length!=0||s.length===0)return null;let c={};return c.domEventName=i,c.fullKey=o,c}static matchEventFullKeyCode(t,r){let i=FO[t.key]||t.key,s="";return r.indexOf("code.")>-1&&(i=t.code,s="code."),i==null||!i?!1:(i=i.toLowerCase(),i===" "?i="space":i==="."&&(i="dot"),vE.forEach(o=>{if(o!==i){let a=PO[o];a(t)&&(s+=o+".")}}),s+=i,s===r)}static eventCallback(t,r,i){return s=>{e.matchEventFullKeyCode(s,t)&&i.runGuarded(()=>r(s))}}static _normalizeKey(t){return t==="esc"?"escape":t}static{this.\u0275fac=function(r){return new(r||e)(ue(sn))}}static{this.\u0275prov=he({token:e,factory:e.\u0275fac})}}return e})();function BO(){cm.makeCurrent()}function UO(){return new Fr}function jO(){return Q1(document),document}var VO=[{provide:Xn,useValue:Zp},{provide:Ip,useValue:BO,multi:!0},{provide:sn,useFactory:jO,deps:[]}],EE=$p(Ww,"browser",VO),HO=new ge(""),$O=[{provide:lc,useClass:lm,deps:[]},{provide:jp,useClass:Cf,deps:[Ye,Sf,lc]},{provide:Cf,useClass:Cf,deps:[Ye,Sf,lc]}],WO=[{provide:af,useValue:"root"},{provide:Fr,useFactory:UO,deps:[]},{provide:um,useClass:OO,multi:!0,deps:[sn,Ye,Xn]},{provide:um,useClass:LO,multi:!0,deps:[sn]},mE,xE,_E,{provide:Ja,useExisting:mE},{provide:Ho,useClass:DO,deps:[]},[]],TE=(()=>{class e{constructor(t){}static withServerTransition(t){return{ngModule:e,providers:[{provide:df,useValue:t.appId}]}}static{this.\u0275fac=function(r){return new(r||e)(ue(HO,12))}}static{this.\u0275mod=Xt({type:e})}static{this.\u0275inj=Yt({providers:[...WO,...$O],imports:[nE,zw]})}}return e})();var IE=(()=>{class e{constructor(t){this._doc=t}getTitle(){return this._doc.title}setTitle(t){this._doc.title=t||""}static{this.\u0275fac=function(r){return new(r||e)(ue(sn))}}static{this.\u0275prov=he({token:e,factory:e.\u0275fac,providedIn:"root"})}}return e})();var Ne="primary",Mc=Symbol("RouteTitle"),vm=class{constructor(n){this.params=n||{}}has(n){return Object.prototype.hasOwnProperty.call(this.params,n)}get(n){if(this.has(n)){let t=this.params[n];return Array.isArray(t)?t[0]:t}return null}getAll(n){if(this.has(n)){let t=this.params[n];return Array.isArray(t)?t:[t]}return[]}get keys(){return Object.keys(this.params)}};function Qo(e){return new vm(e)}function zO(e,n,t){let r=t.path.split("/");if(r.length>e.length||t.pathMatch==="full"&&(n.hasChildren()||r.length<e.length))return null;let i={};for(let s=0;s<r.length;s++){let o=r[s],a=e[s];if(o.startsWith(":"))i[o.substring(1)]=a;else if(o!==a.path)return null}return{consumed:e.slice(0,r.length),posParams:i}}function GO(e,n){if(e.length!==n.length)return!1;for(let t=0;t<e.length;++t)if(!Br(e[t],n[t]))return!1;return!0}function Br(e,n){let t=e?_m(e):void 0,r=n?_m(n):void 0;if(!t||!r||t.length!=r.length)return!1;let i;for(let s=0;s<t.length;s++)if(i=t[s],!OE(e[i],n[i]))return!1;return!0}function _m(e){return[...Object.keys(e),...Object.getOwnPropertySymbols(e)]}function OE(e,n){if(Array.isArray(e)&&Array.isArray(n)){if(e.length!==n.length)return!1;let t=[...e].sort(),r=[...n].sort();return t.every((i,s)=>r[s]===i)}else return e===n}function FE(e){return e.length>0?e[e.length-1]:null}function Wi(e){return e0(e)?e:uc(e)?ht(Promise.resolve(e)):xe(e)}var qO={exact:LE,subset:BE},PE={exact:KO,subset:YO,ignored:()=>!0};function SE(e,n,t){return qO[t.paths](e.root,n.root,t.matrixParams)&&PE[t.queryParams](e.queryParams,n.queryParams)&&!(t.fragment==="exact"&&e.fragment!==n.fragment)}function KO(e,n){return Br(e,n)}function LE(e,n,t){if(!Ms(e.segments,n.segments)||!$f(e.segments,n.segments,t)||e.numberOfChildren!==n.numberOfChildren)return!1;for(let r in n.children)if(!e.children[r]||!LE(e.children[r],n.children[r],t))return!1;return!0}function YO(e,n){return Object.keys(n).length<=Object.keys(e).length&&Object.keys(n).every(t=>OE(e[t],n[t]))}function BE(e,n,t){return UE(e,n,n.segments,t)}function UE(e,n,t,r){if(e.segments.length>t.length){let i=e.segments.slice(0,t.length);return!(!Ms(i,t)||n.hasChildren()||!$f(i,t,r))}else if(e.segments.length===t.length){if(!Ms(e.segments,t)||!$f(e.segments,t,r))return!1;for(let i in n.children)if(!e.children[i]||!BE(e.children[i],n.children[i],r))return!1;return!0}else{let i=t.slice(0,e.segments.length),s=t.slice(e.segments.length);return!Ms(e.segments,i)||!$f(e.segments,i,r)||!e.children[Ne]?!1:UE(e.children[Ne],n,s,r)}}function $f(e,n,t){return n.every((r,i)=>PE[t](e[i].parameters,r.parameters))}var Vi=class{constructor(n=new tt([],{}),t={},r=null){this.root=n,this.queryParams=t,this.fragment=r}get queryParamMap(){return this._queryParamMap??=Qo(this.queryParams),this._queryParamMap}toString(){return ZO.serialize(this)}},tt=class{constructor(n,t){this.segments=n,this.children=t,this.parent=null,Object.values(t).forEach(r=>r.parent=this)}hasChildren(){return this.numberOfChildren>0}get numberOfChildren(){return Object.keys(this.children).length}toString(){return Wf(this)}},Rs=class{constructor(n,t){this.path=n,this.parameters=t}get parameterMap(){return this._parameterMap??=Qo(this.parameters),this._parameterMap}toString(){return VE(this)}};function XO(e,n){return Ms(e,n)&&e.every((t,r)=>Br(t.parameters,n[r].parameters))}function Ms(e,n){return e.length!==n.length?!1:e.every((t,r)=>t.path===n[r].path)}function QO(e,n){let t=[];return Object.entries(e.children).forEach(([r,i])=>{r===Ne&&(t=t.concat(n(i,r)))}),Object.entries(e.children).forEach(([r,i])=>{r!==Ne&&(t=t.concat(n(i,r)))}),t}var Oc=(()=>{class e{static{this.\u0275fac=function(r){return new(r||e)}}static{this.\u0275prov=he({token:e,factory:()=>new Cc,providedIn:"root"})}}return e})(),Cc=class{parse(n){let t=new ym(n);return new Vi(t.parseRootSegment(),t.parseQueryParams(),t.parseFragment())}serialize(n){let t=`/${xc(n.root,!0)}`,r=tF(n.queryParams),i=typeof n.fragment=="string"?`#${JO(n.fragment)}`:"";return`${t}${r}${i}`}},ZO=new Cc;function Wf(e){return e.segments.map(n=>VE(n)).join("/")}function xc(e,n){if(!e.hasChildren())return Wf(e);if(n){let t=e.children[Ne]?xc(e.children[Ne],!1):"",r=[];return Object.entries(e.children).forEach(([i,s])=>{i!==Ne&&r.push(`${i}:${xc(s,!1)}`)}),r.length>0?`${t}(${r.join("//")})`:t}else{let t=QO(e,(r,i)=>i===Ne?[xc(e.children[Ne],!1)]:[`${i}:${xc(r,!1)}`]);return Object.keys(e.children).length===1&&e.children[Ne]!=null?`${Wf(e)}/${t[0]}`:`${Wf(e)}/(${t.join("//")})`}}function jE(e){return encodeURIComponent(e).replace(/%40/g,"@").replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",")}function Vf(e){return jE(e).replace(/%3B/gi,";")}function JO(e){return encodeURI(e)}function xm(e){return jE(e).replace(/\(/g,"%28").replace(/\)/g,"%29").replace(/%26/gi,"&")}function zf(e){return decodeURIComponent(e)}function DE(e){return zf(e.replace(/\+/g,"%20"))}function VE(e){return`${xm(e.path)}${eF(e.parameters)}`}function eF(e){return Object.entries(e).map(([n,t])=>`;${xm(n)}=${xm(t)}`).join("")}function tF(e){let n=Object.entries(e).map(([t,r])=>Array.isArray(r)?r.map(i=>`${Vf(t)}=${Vf(i)}`).join("&"):`${Vf(t)}=${Vf(r)}`).filter(t=>t);return n.length?`?${n.join("&")}`:""}var nF=/^[^\/()?;#]+/;function hm(e){let n=e.match(nF);return n?n[0]:""}var rF=/^[^\/()?;=#]+/;function iF(e){let n=e.match(rF);return n?n[0]:""}var sF=/^[^=?&#]+/;function oF(e){let n=e.match(sF);return n?n[0]:""}var aF=/^[^&#]+/;function cF(e){let n=e.match(aF);return n?n[0]:""}var ym=class{constructor(n){this.url=n,this.remaining=n}parseRootSegment(){return this.consumeOptional("/"),this.remaining===""||this.peekStartsWith("?")||this.peekStartsWith("#")?new tt([],{}):new tt([],this.parseChildren())}parseQueryParams(){let n={};if(this.consumeOptional("?"))do this.parseQueryParam(n);while(this.consumeOptional("&"));return n}parseFragment(){return this.consumeOptional("#")?decodeURIComponent(this.remaining):null}parseChildren(){if(this.remaining==="")return{};this.consumeOptional("/");let n=[];for(this.peekStartsWith("(")||n.push(this.parseSegment());this.peekStartsWith("/")&&!this.peekStartsWith("//")&&!this.peekStartsWith("/(");)this.capture("/"),n.push(this.parseSegment());let t={};this.peekStartsWith("/(")&&(this.capture("/"),t=this.parseParens(!0));let r={};return this.peekStartsWith("(")&&(r=this.parseParens(!1)),(n.length>0||Object.keys(t).length>0)&&(r[Ne]=new tt(n,t)),r}parseSegment(){let n=hm(this.remaining);if(n===""&&this.peekStartsWith(";"))throw new ve(4009,!1);return this.capture(n),new Rs(zf(n),this.parseMatrixParams())}parseMatrixParams(){let n={};for(;this.consumeOptional(";");)this.parseParam(n);return n}parseParam(n){let t=iF(this.remaining);if(!t)return;this.capture(t);let r="";if(this.consumeOptional("=")){let i=hm(this.remaining);i&&(r=i,this.capture(r))}n[zf(t)]=zf(r)}parseQueryParam(n){let t=oF(this.remaining);if(!t)return;this.capture(t);let r="";if(this.consumeOptional("=")){let o=cF(this.remaining);o&&(r=o,this.capture(r))}let i=DE(t),s=DE(r);if(n.hasOwnProperty(i)){let o=n[i];Array.isArray(o)||(o=[o],n[i]=o),o.push(s)}else n[i]=s}parseParens(n){let t={};for(this.capture("(");!this.consumeOptional(")")&&this.remaining.length>0;){let r=hm(this.remaining),i=this.remaining[r.length];if(i!=="/"&&i!==")"&&i!==";")throw new ve(4010,!1);let s;r.indexOf(":")>-1?(s=r.slice(0,r.indexOf(":")),this.capture(s),this.capture(":")):n&&(s=Ne);let o=this.parseChildren();t[s]=Object.keys(o).length===1?o[Ne]:new tt([],o),this.consumeOptional("//")}return t}peekStartsWith(n){return this.remaining.startsWith(n)}consumeOptional(n){return this.peekStartsWith(n)?(this.remaining=this.remaining.substring(n.length),!0):!1}capture(n){if(!this.consumeOptional(n))throw new ve(4011,!1)}};function HE(e){return e.segments.length>0?new tt([],{[Ne]:e}):e}function $E(e){let n={};for(let[r,i]of Object.entries(e.children)){let s=$E(i);if(r===Ne&&s.segments.length===0&&s.hasChildren())for(let[o,a]of Object.entries(s.children))n[o]=a;else(s.segments.length>0||s.hasChildren())&&(n[r]=s)}let t=new tt(e.segments,n);return lF(t)}function lF(e){if(e.numberOfChildren===1&&e.children[Ne]){let n=e.children[Ne];return new tt(e.segments.concat(n.segments),n.children)}return e}function Zo(e){return e instanceof Vi}function uF(e,n,t=null,r=null){let i=WE(e);return zE(i,n,t,r)}function WE(e){let n;function t(s){let o={};for(let c of s.children){let l=t(c);o[c.outlet]=l}let a=new tt(s.url,o);return s===e&&(n=a),a}let r=t(e.root),i=HE(r);return n??i}function zE(e,n,t,r){let i=e;for(;i.parent;)i=i.parent;if(n.length===0)return pm(i,i,i,t,r);let s=fF(n);if(s.toRoot())return pm(i,i,new tt([],{}),t,r);let o=dF(s,i,e),a=o.processChildren?Ec(o.segmentGroup,o.index,s.commands):qE(o.segmentGroup,o.index,s.commands);return pm(i,o.segmentGroup,a,t,r)}function Gf(e){return typeof e=="object"&&e!=null&&!e.outlets&&!e.segmentPath}function Sc(e){return typeof e=="object"&&e!=null&&e.outlets}function pm(e,n,t,r,i){let s={};r&&Object.entries(r).forEach(([c,l])=>{s[c]=Array.isArray(l)?l.map(u=>`${u}`):`${l}`});let o;e===n?o=t:o=GE(e,n,t);let a=HE($E(o));return new Vi(a,s,i)}function GE(e,n,t){let r={};return Object.entries(e.children).forEach(([i,s])=>{s===n?r[i]=t:r[i]=GE(s,n,t)}),new tt(e.segments,r)}var qf=class{constructor(n,t,r){if(this.isAbsolute=n,this.numberOfDoubleDots=t,this.commands=r,n&&r.length>0&&Gf(r[0]))throw new ve(4003,!1);let i=r.find(Sc);if(i&&i!==FE(r))throw new ve(4004,!1)}toRoot(){return this.isAbsolute&&this.commands.length===1&&this.commands[0]=="/"}};function fF(e){if(typeof e[0]=="string"&&e.length===1&&e[0]==="/")return new qf(!0,0,e);let n=0,t=!1,r=e.reduce((i,s,o)=>{if(typeof s=="object"&&s!=null){if(s.outlets){let a={};return Object.entries(s.outlets).forEach(([c,l])=>{a[c]=typeof l=="string"?l.split("/"):l}),[...i,{outlets:a}]}if(s.segmentPath)return[...i,s.segmentPath]}return typeof s!="string"?[...i,s]:o===0?(s.split("/").forEach((a,c)=>{c==0&&a==="."||(c==0&&a===""?t=!0:a===".."?n++:a!=""&&i.push(a))}),i):[...i,s]},[]);return new qf(t,n,r)}var Yo=class{constructor(n,t,r){this.segmentGroup=n,this.processChildren=t,this.index=r}};function dF(e,n,t){if(e.isAbsolute)return new Yo(n,!0,0);if(!t)return new Yo(n,!1,NaN);if(t.parent===null)return new Yo(t,!0,0);let r=Gf(e.commands[0])?0:1,i=t.segments.length-1+r;return hF(t,i,e.numberOfDoubleDots)}function hF(e,n,t){let r=e,i=n,s=t;for(;s>i;){if(s-=i,r=r.parent,!r)throw new ve(4005,!1);i=r.segments.length}return new Yo(r,!1,i-s)}function pF(e){return Sc(e[0])?e[0].outlets:{[Ne]:e}}function qE(e,n,t){if(e??=new tt([],{}),e.segments.length===0&&e.hasChildren())return Ec(e,n,t);let r=mF(e,n,t),i=t.slice(r.commandIndex);if(r.match&&r.pathIndex<e.segments.length){let s=new tt(e.segments.slice(0,r.pathIndex),{});return s.children[Ne]=new tt(e.segments.slice(r.pathIndex),e.children),Ec(s,0,i)}else return r.match&&i.length===0?new tt(e.segments,{}):r.match&&!e.hasChildren()?wm(e,n,t):r.match?Ec(e,0,i):wm(e,n,t)}function Ec(e,n,t){if(t.length===0)return new tt(e.segments,{});{let r=pF(t),i={};if(Object.keys(r).some(s=>s!==Ne)&&e.children[Ne]&&e.numberOfChildren===1&&e.children[Ne].segments.length===0){let s=Ec(e.children[Ne],n,t);return new tt(e.segments,s.children)}return Object.entries(r).forEach(([s,o])=>{typeof o=="string"&&(o=[o]),o!==null&&(i[s]=qE(e.children[s],n,o))}),Object.entries(e.children).forEach(([s,o])=>{r[s]===void 0&&(i[s]=o)}),new tt(e.segments,i)}}function mF(e,n,t){let r=0,i=n,s={match:!1,pathIndex:0,commandIndex:0};for(;i<e.segments.length;){if(r>=t.length)return s;let o=e.segments[i],a=t[r];if(Sc(a))break;let c=`${a}`,l=r<t.length-1?t[r+1]:null;if(i>0&&c===void 0)break;if(c&&l&&typeof l=="object"&&l.outlets===void 0){if(!AE(c,l,o))return s;r+=2}else{if(!AE(c,{},o))return s;r++}i++}return{match:!0,pathIndex:i,commandIndex:r}}function wm(e,n,t){let r=e.segments.slice(0,n),i=0;for(;i<t.length;){let s=t[i];if(Sc(s)){let c=gF(s.outlets);return new tt(r,c)}if(i===0&&Gf(t[0])){let c=e.segments[n];r.push(new Rs(c.path,bE(t[0]))),i++;continue}let o=Sc(s)?s.outlets[Ne]:`${s}`,a=i<t.length-1?t[i+1]:null;o&&a&&Gf(a)?(r.push(new Rs(o,bE(a))),i+=2):(r.push(new Rs(o,{})),i++)}return new tt(r,{})}function gF(e){let n={};return Object.entries(e).forEach(([t,r])=>{typeof r=="string"&&(r=[r]),r!==null&&(n[t]=wm(new tt([],{}),0,r))}),n}function bE(e){let n={};return Object.entries(e).forEach(([t,r])=>n[t]=`${r}`),n}function AE(e,n,t){return e==t.path&&Br(n,t.parameters)}var Tc="imperative",Vt=function(e){return e[e.NavigationStart=0]="NavigationStart",e[e.NavigationEnd=1]="NavigationEnd",e[e.NavigationCancel=2]="NavigationCancel",e[e.NavigationError=3]="NavigationError",e[e.RoutesRecognized=4]="RoutesRecognized",e[e.ResolveStart=5]="ResolveStart",e[e.ResolveEnd=6]="ResolveEnd",e[e.GuardsCheckStart=7]="GuardsCheckStart",e[e.GuardsCheckEnd=8]="GuardsCheckEnd",e[e.RouteConfigLoadStart=9]="RouteConfigLoadStart",e[e.RouteConfigLoadEnd=10]="RouteConfigLoadEnd",e[e.ChildActivationStart=11]="ChildActivationStart",e[e.ChildActivationEnd=12]="ChildActivationEnd",e[e.ActivationStart=13]="ActivationStart",e[e.ActivationEnd=14]="ActivationEnd",e[e.Scroll=15]="Scroll",e[e.NavigationSkipped=16]="NavigationSkipped",e}(Vt||{}),Qn=class{constructor(n,t){this.id=n,this.url=t}},Jo=class extends Qn{constructor(n,t,r="imperative",i=null){super(n,t),this.type=Vt.NavigationStart,this.navigationTrigger=r,this.restoredState=i}toString(){return`NavigationStart(id: ${this.id}, url: '${this.url}')`}},Ur=class extends Qn{constructor(n,t,r){super(n,t),this.urlAfterRedirects=r,this.type=Vt.NavigationEnd}toString(){return`NavigationEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}')`}},Bn=function(e){return e[e.Redirect=0]="Redirect",e[e.SupersededByNewNavigation=1]="SupersededByNewNavigation",e[e.NoDataFromResolver=2]="NoDataFromResolver",e[e.GuardRejected=3]="GuardRejected",e}(Bn||{}),Kf=function(e){return e[e.IgnoredSameUrlNavigation=0]="IgnoredSameUrlNavigation",e[e.IgnoredByUrlHandlingStrategy=1]="IgnoredByUrlHandlingStrategy",e}(Kf||{}),Hi=class extends Qn{constructor(n,t,r,i){super(n,t),this.reason=r,this.code=i,this.type=Vt.NavigationCancel}toString(){return`NavigationCancel(id: ${this.id}, url: '${this.url}')`}},$i=class extends Qn{constructor(n,t,r,i){super(n,t),this.reason=r,this.code=i,this.type=Vt.NavigationSkipped}},Dc=class extends Qn{constructor(n,t,r,i){super(n,t),this.error=r,this.target=i,this.type=Vt.NavigationError}toString(){return`NavigationError(id: ${this.id}, url: '${this.url}', error: ${this.error})`}},Yf=class extends Qn{constructor(n,t,r,i){super(n,t),this.urlAfterRedirects=r,this.state=i,this.type=Vt.RoutesRecognized}toString(){return`RoutesRecognized(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}},Em=class extends Qn{constructor(n,t,r,i){super(n,t),this.urlAfterRedirects=r,this.state=i,this.type=Vt.GuardsCheckStart}toString(){return`GuardsCheckStart(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}},Tm=class extends Qn{constructor(n,t,r,i,s){super(n,t),this.urlAfterRedirects=r,this.state=i,this.shouldActivate=s,this.type=Vt.GuardsCheckEnd}toString(){return`GuardsCheckEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state}, shouldActivate: ${this.shouldActivate})`}},Im=class extends Qn{constructor(n,t,r,i){super(n,t),this.urlAfterRedirects=r,this.state=i,this.type=Vt.ResolveStart}toString(){return`ResolveStart(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}},Cm=class extends Qn{constructor(n,t,r,i){super(n,t),this.urlAfterRedirects=r,this.state=i,this.type=Vt.ResolveEnd}toString(){return`ResolveEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}},Sm=class{constructor(n){this.route=n,this.type=Vt.RouteConfigLoadStart}toString(){return`RouteConfigLoadStart(path: ${this.route.path})`}},Dm=class{constructor(n){this.route=n,this.type=Vt.RouteConfigLoadEnd}toString(){return`RouteConfigLoadEnd(path: ${this.route.path})`}},bm=class{constructor(n){this.snapshot=n,this.type=Vt.ChildActivationStart}toString(){return`ChildActivationStart(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}},Am=class{constructor(n){this.snapshot=n,this.type=Vt.ChildActivationEnd}toString(){return`ChildActivationEnd(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}},km=class{constructor(n){this.snapshot=n,this.type=Vt.ActivationStart}toString(){return`ActivationStart(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}},Nm=class{constructor(n){this.snapshot=n,this.type=Vt.ActivationEnd}toString(){return`ActivationEnd(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}},Xf=class{constructor(n,t,r){this.routerEvent=n,this.position=t,this.anchor=r,this.type=Vt.Scroll}toString(){let n=this.position?`${this.position[0]}, ${this.position[1]}`:null;return`Scroll(anchor: '${this.anchor}', position: '${n}')`}},bc=class{},Ac=class{constructor(n){this.url=n}};var Rm=class{constructor(){this.outlet=null,this.route=null,this.injector=null,this.children=new Fc,this.attachRef=null}},Fc=(()=>{class e{constructor(){this.contexts=new Map}onChildOutletCreated(t,r){let i=this.getOrCreateContext(t);i.outlet=r,this.contexts.set(t,i)}onChildOutletDestroyed(t){let r=this.getContext(t);r&&(r.outlet=null,r.attachRef=null)}onOutletDeactivated(){let t=this.contexts;return this.contexts=new Map,t}onOutletReAttached(t){this.contexts=t}getOrCreateContext(t){let r=this.getContext(t);return r||(r=new Rm,this.contexts.set(t,r)),r}getContext(t){return this.contexts.get(t)||null}static{this.\u0275fac=function(r){return new(r||e)}}static{this.\u0275prov=he({token:e,factory:e.\u0275fac,providedIn:"root"})}}return e})(),Qf=class{constructor(n){this._root=n}get root(){return this._root.value}parent(n){let t=this.pathFromRoot(n);return t.length>1?t[t.length-2]:null}children(n){let t=Mm(n,this._root);return t?t.children.map(r=>r.value):[]}firstChild(n){let t=Mm(n,this._root);return t&&t.children.length>0?t.children[0].value:null}siblings(n){let t=Om(n,this._root);return t.length<2?[]:t[t.length-2].children.map(i=>i.value).filter(i=>i!==n)}pathFromRoot(n){return Om(n,this._root).map(t=>t.value)}};function Mm(e,n){if(e===n.value)return n;for(let t of n.children){let r=Mm(e,t);if(r)return r}return null}function Om(e,n){if(e===n.value)return[n];for(let t of n.children){let r=Om(e,t);if(r.length)return r.unshift(n),r}return[]}var Ln=class{constructor(n,t){this.value=n,this.children=t}toString(){return`TreeNode(${this.value})`}};function Ko(e){let n={};return e&&e.children.forEach(t=>n[t.value.outlet]=t),n}var Zf=class extends Qf{constructor(n,t){super(n),this.snapshot=t,Wm(this,n)}toString(){return this.snapshot.toString()}};function KE(e){let n=vF(e),t=new qt([new Rs("",{})]),r=new qt({}),i=new qt({}),s=new qt({}),o=new qt(""),a=new di(t,r,s,o,i,Ne,e,n.root);return a.snapshot=n.root,new Zf(new Ln(a,[]),n)}function vF(e){let n={},t={},r={},i="",s=new kc([],n,r,i,t,Ne,e,null,{});return new Jf("",new Ln(s,[]))}var di=class{constructor(n,t,r,i,s,o,a,c){this.urlSubject=n,this.paramsSubject=t,this.queryParamsSubject=r,this.fragmentSubject=i,this.dataSubject=s,this.outlet=o,this.component=a,this._futureSnapshot=c,this.title=this.dataSubject?.pipe(be(l=>l[Mc]))??xe(void 0),this.url=n,this.params=t,this.queryParams=r,this.fragment=i,this.data=s}get routeConfig(){return this._futureSnapshot.routeConfig}get root(){return this._routerState.root}get parent(){return this._routerState.parent(this)}get firstChild(){return this._routerState.firstChild(this)}get children(){return this._routerState.children(this)}get pathFromRoot(){return this._routerState.pathFromRoot(this)}get paramMap(){return this._paramMap??=this.params.pipe(be(n=>Qo(n))),this._paramMap}get queryParamMap(){return this._queryParamMap??=this.queryParams.pipe(be(n=>Qo(n))),this._queryParamMap}toString(){return this.snapshot?this.snapshot.toString():`Future(${this._futureSnapshot})`}};function $m(e,n,t="emptyOnly"){let r,{routeConfig:i}=e;return n!==null&&(t==="always"||i?.path===""||!n.component&&!n.routeConfig?.loadComponent)?r={params:de(de({},n.params),e.params),data:de(de({},n.data),e.data),resolve:de(de(de(de({},e.data),n.data),i?.data),e._resolvedData)}:r={params:de({},e.params),data:de({},e.data),resolve:de(de({},e.data),e._resolvedData??{})},i&&XE(i)&&(r.resolve[Mc]=i.title),r}var kc=class{get title(){return this.data?.[Mc]}constructor(n,t,r,i,s,o,a,c,l){this.url=n,this.params=t,this.queryParams=r,this.fragment=i,this.data=s,this.outlet=o,this.component=a,this.routeConfig=c,this._resolve=l}get root(){return this._routerState.root}get parent(){return this._routerState.parent(this)}get firstChild(){return this._routerState.firstChild(this)}get children(){return this._routerState.children(this)}get pathFromRoot(){return this._routerState.pathFromRoot(this)}get paramMap(){return this._paramMap??=Qo(this.params),this._paramMap}get queryParamMap(){return this._queryParamMap??=Qo(this.queryParams),this._queryParamMap}toString(){let n=this.url.map(r=>r.toString()).join("/"),t=this.routeConfig?this.routeConfig.path:"";return`Route(url:'${n}', path:'${t}')`}},Jf=class extends Qf{constructor(n,t){super(t),this.url=n,Wm(this,t)}toString(){return YE(this._root)}};function Wm(e,n){n.value._routerState=e,n.children.forEach(t=>Wm(e,t))}function YE(e){let n=e.children.length>0?` { ${e.children.map(YE).join(", ")} } `:"";return`${e.value}${n}`}function mm(e){if(e.snapshot){let n=e.snapshot,t=e._futureSnapshot;e.snapshot=t,Br(n.queryParams,t.queryParams)||e.queryParamsSubject.next(t.queryParams),n.fragment!==t.fragment&&e.fragmentSubject.next(t.fragment),Br(n.params,t.params)||e.paramsSubject.next(t.params),GO(n.url,t.url)||e.urlSubject.next(t.url),Br(n.data,t.data)||e.dataSubject.next(t.data)}else e.snapshot=e._futureSnapshot,e.dataSubject.next(e._futureSnapshot.data)}function Fm(e,n){let t=Br(e.params,n.params)&&XO(e.url,n.url),r=!e.parent!=!n.parent;return t&&!r&&(!e.parent||Fm(e.parent,n.parent))}function XE(e){return typeof e.title=="string"||e.title===null}var zm=(()=>{class e{constructor(){this.activated=null,this._activatedRoute=null,this.name=Ne,this.activateEvents=new gn,this.deactivateEvents=new gn,this.attachEvents=new gn,this.detachEvents=new gn,this.parentContexts=te(Fc),this.location=te(jo),this.changeDetector=te(fc),this.environmentInjector=te(nn),this.inputBinder=te(id,{optional:!0}),this.supportsBindingToComponentInputs=!0}get activatedComponentRef(){return this.activated}ngOnChanges(t){if(t.name){let{firstChange:r,previousValue:i}=t.name;if(r)return;this.isTrackedInParentContexts(i)&&(this.deactivate(),this.parentContexts.onChildOutletDestroyed(i)),this.initializeOutletWithName()}}ngOnDestroy(){this.isTrackedInParentContexts(this.name)&&this.parentContexts.onChildOutletDestroyed(this.name),this.inputBinder?.unsubscribeFromRouteData(this)}isTrackedInParentContexts(t){return this.parentContexts.getContext(t)?.outlet===this}ngOnInit(){this.initializeOutletWithName()}initializeOutletWithName(){if(this.parentContexts.onChildOutletCreated(this.name,this),this.activated)return;let t=this.parentContexts.getContext(this.name);t?.route&&(t.attachRef?this.attach(t.attachRef,t.route):this.activateWith(t.route,t.injector))}get isActivated(){return!!this.activated}get component(){if(!this.activated)throw new ve(4012,!1);return this.activated.instance}get activatedRoute(){if(!this.activated)throw new ve(4012,!1);return this._activatedRoute}get activatedRouteData(){return this._activatedRoute?this._activatedRoute.snapshot.data:{}}detach(){if(!this.activated)throw new ve(4012,!1);this.location.detach();let t=this.activated;return this.activated=null,this._activatedRoute=null,this.detachEvents.emit(t.instance),t}attach(t,r){this.activated=t,this._activatedRoute=r,this.location.insert(t.hostView),this.inputBinder?.bindActivatedRouteToOutletComponent(this),this.attachEvents.emit(t.instance)}deactivate(){if(this.activated){let t=this.component;this.activated.destroy(),this.activated=null,this._activatedRoute=null,this.deactivateEvents.emit(t)}}activateWith(t,r){if(this.isActivated)throw new ve(4013,!1);this._activatedRoute=t;let i=this.location,o=t.snapshot.component,a=this.parentContexts.getOrCreateContext(this.name).children,c=new Pm(t,a,i.injector);this.activated=i.createComponent(o,{index:i.length,injector:c,environmentInjector:r??this.environmentInjector}),this.changeDetector.markForCheck(),this.inputBinder?.bindActivatedRouteToOutletComponent(this),this.activateEvents.emit(this.activated.instance)}static{this.\u0275fac=function(r){return new(r||e)}}static{this.\u0275dir=Po({type:e,selectors:[["router-outlet"]],inputs:{name:"name"},outputs:{activateEvents:"activate",deactivateEvents:"deactivate",attachEvents:"attach",detachEvents:"detach"},exportAs:["outlet"],standalone:!0,features:[sc]})}}return e})(),Pm=class e{__ngOutletInjector(n){return new e(this.route,this.childContexts,n)}constructor(n,t,r){this.route=n,this.childContexts=t,this.parent=r}get(n,t){return n===di?this.route:n===Fc?this.childContexts:this.parent.get(n,t)}},id=new ge(""),kE=(()=>{class e{constructor(){this.outletDataSubscriptions=new Map}bindActivatedRouteToOutletComponent(t){this.unsubscribeFromRouteData(t),this.subscribeToRouteData(t)}unsubscribeFromRouteData(t){this.outletDataSubscriptions.get(t)?.unsubscribe(),this.outletDataSubscriptions.delete(t)}subscribeToRouteData(t){let{activatedRoute:r}=t,i=Va([r.queryParams,r.params,r.data]).pipe(Dn(([s,o,a],c)=>(a=de(de(de({},s),o),a),c===0?xe(a):Promise.resolve(a)))).subscribe(s=>{if(!t.isActivated||!t.activatedComponentRef||t.activatedRoute!==r||r.component===null){this.unsubscribeFromRouteData(t);return}let o=Gw(r.component);if(!o){this.unsubscribeFromRouteData(t);return}for(let{templateName:a}of o.inputs)t.activatedComponentRef.setInput(a,s[a])});this.outletDataSubscriptions.set(t,i)}static{this.\u0275fac=function(r){return new(r||e)}}static{this.\u0275prov=he({token:e,factory:e.\u0275fac})}}return e})();function _F(e,n,t){let r=Nc(e,n._root,t?t._root:void 0);return new Zf(r,n)}function Nc(e,n,t){if(t&&e.shouldReuseRoute(n.value,t.value.snapshot)){let r=t.value;r._futureSnapshot=n.value;let i=xF(e,n,t);return new Ln(r,i)}else{if(e.shouldAttach(n.value)){let s=e.retrieve(n.value);if(s!==null){let o=s.route;return o.value._futureSnapshot=n.value,o.children=n.children.map(a=>Nc(e,a)),o}}let r=yF(n.value),i=n.children.map(s=>Nc(e,s));return new Ln(r,i)}}function xF(e,n,t){return n.children.map(r=>{for(let i of t.children)if(e.shouldReuseRoute(r.value,i.value.snapshot))return Nc(e,r,i);return Nc(e,r)})}function yF(e){return new di(new qt(e.url),new qt(e.params),new qt(e.queryParams),new qt(e.fragment),new qt(e.data),e.outlet,e.component,e)}var QE="ngNavigationCancelingError";function ZE(e,n){let{redirectTo:t,navigationBehaviorOptions:r}=Zo(n)?{redirectTo:n,navigationBehaviorOptions:void 0}:n,i=JE(!1,Bn.Redirect);return i.url=t,i.navigationBehaviorOptions=r,i}function JE(e,n){let t=new Error(`NavigationCancelingError: ${e||""}`);return t[QE]=!0,t.cancellationCode=n,t}function wF(e){return eT(e)&&Zo(e.url)}function eT(e){return!!e&&e[QE]}var EF=(()=>{class e{static{this.\u0275fac=function(r){return new(r||e)}}static{this.\u0275cmp=bn({type:e,selectors:[["ng-component"]],standalone:!0,features:[Fw],decls:1,vars:0,template:function(r,i){r&1&&Pr(0,"router-outlet")},dependencies:[zm],encapsulation:2})}}return e})();function TF(e,n){return e.providers&&!e._injector&&(e._injector=Tf(e.providers,n,`Route: ${e.path}`)),e._injector??n}function Gm(e){let n=e.children&&e.children.map(Gm),t=n?gt(de({},e),{children:n}):de({},e);return!t.component&&!t.loadComponent&&(n||t.loadChildren)&&t.outlet&&t.outlet!==Ne&&(t.component=EF),t}function jr(e){return e.outlet||Ne}function IF(e,n){let t=e.filter(r=>jr(r)===n);return t.push(...e.filter(r=>jr(r)!==n)),t}function Pc(e){if(!e)return null;if(e.routeConfig?._injector)return e.routeConfig._injector;for(let n=e.parent;n;n=n.parent){let t=n.routeConfig;if(t?._loadedInjector)return t._loadedInjector;if(t?._injector)return t._injector}return null}var CF=(e,n,t,r)=>be(i=>(new Lm(n,i.targetRouterState,i.currentRouterState,t,r).activate(e),i)),Lm=class{constructor(n,t,r,i,s){this.routeReuseStrategy=n,this.futureState=t,this.currState=r,this.forwardEvent=i,this.inputBindingEnabled=s}activate(n){let t=this.futureState._root,r=this.currState?this.currState._root:null;this.deactivateChildRoutes(t,r,n),mm(this.futureState.root),this.activateChildRoutes(t,r,n)}deactivateChildRoutes(n,t,r){let i=Ko(t);n.children.forEach(s=>{let o=s.value.outlet;this.deactivateRoutes(s,i[o],r),delete i[o]}),Object.values(i).forEach(s=>{this.deactivateRouteAndItsChildren(s,r)})}deactivateRoutes(n,t,r){let i=n.value,s=t?t.value:null;if(i===s)if(i.component){let o=r.getContext(i.outlet);o&&this.deactivateChildRoutes(n,t,o.children)}else this.deactivateChildRoutes(n,t,r);else s&&this.deactivateRouteAndItsChildren(t,r)}deactivateRouteAndItsChildren(n,t){n.value.component&&this.routeReuseStrategy.shouldDetach(n.value.snapshot)?this.detachAndStoreRouteSubtree(n,t):this.deactivateRouteAndOutlet(n,t)}detachAndStoreRouteSubtree(n,t){let r=t.getContext(n.value.outlet),i=r&&n.value.component?r.children:t,s=Ko(n);for(let o of Object.values(s))this.deactivateRouteAndItsChildren(o,i);if(r&&r.outlet){let o=r.outlet.detach(),a=r.children.onOutletDeactivated();this.routeReuseStrategy.store(n.value.snapshot,{componentRef:o,route:n,contexts:a})}}deactivateRouteAndOutlet(n,t){let r=t.getContext(n.value.outlet),i=r&&n.value.component?r.children:t,s=Ko(n);for(let o of Object.values(s))this.deactivateRouteAndItsChildren(o,i);r&&(r.outlet&&(r.outlet.deactivate(),r.children.onOutletDeactivated()),r.attachRef=null,r.route=null)}activateChildRoutes(n,t,r){let i=Ko(t);n.children.forEach(s=>{this.activateRoutes(s,i[s.value.outlet],r),this.forwardEvent(new Nm(s.value.snapshot))}),n.children.length&&this.forwardEvent(new Am(n.value.snapshot))}activateRoutes(n,t,r){let i=n.value,s=t?t.value:null;if(mm(i),i===s)if(i.component){let o=r.getOrCreateContext(i.outlet);this.activateChildRoutes(n,t,o.children)}else this.activateChildRoutes(n,t,r);else if(i.component){let o=r.getOrCreateContext(i.outlet);if(this.routeReuseStrategy.shouldAttach(i.snapshot)){let a=this.routeReuseStrategy.retrieve(i.snapshot);this.routeReuseStrategy.store(i.snapshot,null),o.children.onOutletReAttached(a.contexts),o.attachRef=a.componentRef,o.route=a.route.value,o.outlet&&o.outlet.attach(a.componentRef,a.route.value),mm(a.route.value),this.activateChildRoutes(n,null,o.children)}else{let a=Pc(i.snapshot);o.attachRef=null,o.route=i,o.injector=a,o.outlet&&o.outlet.activateWith(i,o.injector),this.activateChildRoutes(n,null,o.children)}}else this.activateChildRoutes(n,null,r)}},ed=class{constructor(n){this.path=n,this.route=this.path[this.path.length-1]}},Xo=class{constructor(n,t){this.component=n,this.route=t}};function SF(e,n,t){let r=e._root,i=n?n._root:null;return yc(r,i,t,[r.value])}function DF(e){let n=e.routeConfig?e.routeConfig.canActivateChild:null;return!n||n.length===0?null:{node:e,guards:n}}function ta(e,n){let t=Symbol(),r=n.get(e,t);return r===t?typeof e=="function"&&!Vy(e)?e:n.get(e):r}function yc(e,n,t,r,i={canDeactivateChecks:[],canActivateChecks:[]}){let s=Ko(n);return e.children.forEach(o=>{bF(o,s[o.value.outlet],t,r.concat([o.value]),i),delete s[o.value.outlet]}),Object.entries(s).forEach(([o,a])=>Ic(a,t.getContext(o),i)),i}function bF(e,n,t,r,i={canDeactivateChecks:[],canActivateChecks:[]}){let s=e.value,o=n?n.value:null,a=t?t.getContext(e.value.outlet):null;if(o&&s.routeConfig===o.routeConfig){let c=AF(o,s,s.routeConfig.runGuardsAndResolvers);c?i.canActivateChecks.push(new ed(r)):(s.data=o.data,s._resolvedData=o._resolvedData),s.component?yc(e,n,a?a.children:null,r,i):yc(e,n,t,r,i),c&&a&&a.outlet&&a.outlet.isActivated&&i.canDeactivateChecks.push(new Xo(a.outlet.component,o))}else o&&Ic(n,a,i),i.canActivateChecks.push(new ed(r)),s.component?yc(e,null,a?a.children:null,r,i):yc(e,null,t,r,i);return i}function AF(e,n,t){if(typeof t=="function")return t(e,n);switch(t){case"pathParamsChange":return!Ms(e.url,n.url);case"pathParamsOrQueryParamsChange":return!Ms(e.url,n.url)||!Br(e.queryParams,n.queryParams);case"always":return!0;case"paramsOrQueryParamsChange":return!Fm(e,n)||!Br(e.queryParams,n.queryParams);case"paramsChange":default:return!Fm(e,n)}}function Ic(e,n,t){let r=Ko(e),i=e.value;Object.entries(r).forEach(([s,o])=>{i.component?n?Ic(o,n.children.getContext(s),t):Ic(o,null,t):Ic(o,n,t)}),i.component?n&&n.outlet&&n.outlet.isActivated?t.canDeactivateChecks.push(new Xo(n.outlet.component,i)):t.canDeactivateChecks.push(new Xo(null,i)):t.canDeactivateChecks.push(new Xo(null,i))}function Lc(e){return typeof e=="function"}function kF(e){return typeof e=="boolean"}function NF(e){return e&&Lc(e.canLoad)}function RF(e){return e&&Lc(e.canActivate)}function MF(e){return e&&Lc(e.canActivateChild)}function OF(e){return e&&Lc(e.canDeactivate)}function FF(e){return e&&Lc(e.canMatch)}function tT(e){return e instanceof ni||e?.name==="EmptyError"}var Hf=Symbol("INITIAL_VALUE");function ea(){return Dn(e=>Va(e.map(n=>n.pipe(ii(1),i0(Hf)))).pipe(be(n=>{for(let t of n)if(t!==!0){if(t===Hf)return Hf;if(t===!1||t instanceof Vi)return t}return!0}),Sn(n=>n!==Hf),ii(1)))}function PF(e,n){return Ct(t=>{let{targetSnapshot:r,currentSnapshot:i,guards:{canActivateChecks:s,canDeactivateChecks:o}}=t;return o.length===0&&s.length===0?xe(gt(de({},t),{guardsResult:!0})):LF(o,r,i,e).pipe(Ct(a=>a&&kF(a)?BF(r,s,e,n):xe(a)),be(a=>gt(de({},t),{guardsResult:a})))})}function LF(e,n,t,r){return ht(e).pipe(Ct(i=>$F(i.component,i.route,t,n,r)),Ar(i=>i!==!0,!0))}function BF(e,n,t,r){return ht(n).pipe(ri(i=>yo(jF(i.route.parent,r),UF(i.route,r),HF(e,i.path,t),VF(e,i.route,t))),Ar(i=>i!==!0,!0))}function UF(e,n){return e!==null&&n&&n(new km(e)),xe(!0)}function jF(e,n){return e!==null&&n&&n(new bm(e)),xe(!0)}function VF(e,n,t){let r=n.routeConfig?n.routeConfig.canActivate:null;if(!r||r.length===0)return xe(!0);let i=r.map(s=>Tu(()=>{let o=Pc(n)??t,a=ta(s,o),c=RF(a)?a.canActivate(n,e):pr(o,()=>a(n,e));return Wi(c).pipe(Ar())}));return xe(i).pipe(ea())}function HF(e,n,t){let r=n[n.length-1],s=n.slice(0,n.length-1).reverse().map(o=>DF(o)).filter(o=>o!==null).map(o=>Tu(()=>{let a=o.guards.map(c=>{let l=Pc(o.node)??t,u=ta(c,l),f=MF(u)?u.canActivateChild(r,e):pr(l,()=>u(r,e));return Wi(f).pipe(Ar())});return xe(a).pipe(ea())}));return xe(s).pipe(ea())}function $F(e,n,t,r,i){let s=n&&n.routeConfig?n.routeConfig.canDeactivate:null;if(!s||s.length===0)return xe(!0);let o=s.map(a=>{let c=Pc(n)??i,l=ta(a,c),u=OF(l)?l.canDeactivate(e,n,t,r):pr(c,()=>l(e,n,t,r));return Wi(u).pipe(Ar())});return xe(o).pipe(ea())}function WF(e,n,t,r){let i=n.canLoad;if(i===void 0||i.length===0)return xe(!0);let s=i.map(o=>{let a=ta(o,e),c=NF(a)?a.canLoad(n,t):pr(e,()=>a(n,t));return Wi(c)});return xe(s).pipe(ea(),nT(r))}function nT(e){return qh(St(n=>{if(Zo(n))throw ZE(e,n)}),be(n=>n===!0))}function zF(e,n,t,r){let i=n.canMatch;if(!i||i.length===0)return xe(!0);let s=i.map(o=>{let a=ta(o,e),c=FF(a)?a.canMatch(n,t):pr(e,()=>a(n,t));return Wi(c)});return xe(s).pipe(ea(),nT(r))}var Rc=class{constructor(n){this.segmentGroup=n||null}},td=class extends Error{constructor(n){super(),this.urlTree=n}};function qo(e){return _o(new Rc(e))}function GF(e){return _o(new ve(4e3,!1))}function qF(e){return _o(JE(!1,Bn.GuardRejected))}var Bm=class{constructor(n,t){this.urlSerializer=n,this.urlTree=t}lineralizeSegments(n,t){let r=[],i=t.root;for(;;){if(r=r.concat(i.segments),i.numberOfChildren===0)return xe(r);if(i.numberOfChildren>1||!i.children[Ne])return GF(n.redirectTo);i=i.children[Ne]}}applyRedirectCommands(n,t,r){let i=this.applyRedirectCreateUrlTree(t,this.urlSerializer.parse(t),n,r);if(t.startsWith("/"))throw new td(i);return i}applyRedirectCreateUrlTree(n,t,r,i){let s=this.createSegmentGroup(n,t.root,r,i);return new Vi(s,this.createQueryParams(t.queryParams,this.urlTree.queryParams),t.fragment)}createQueryParams(n,t){let r={};return Object.entries(n).forEach(([i,s])=>{if(typeof s=="string"&&s.startsWith(":")){let a=s.substring(1);r[i]=t[a]}else r[i]=s}),r}createSegmentGroup(n,t,r,i){let s=this.createSegments(n,t.segments,r,i),o={};return Object.entries(t.children).forEach(([a,c])=>{o[a]=this.createSegmentGroup(n,c,r,i)}),new tt(s,o)}createSegments(n,t,r,i){return t.map(s=>s.path.startsWith(":")?this.findPosParam(n,s,i):this.findOrReturn(s,r))}findPosParam(n,t,r){let i=r[t.path.substring(1)];if(!i)throw new ve(4001,!1);return i}findOrReturn(n,t){let r=0;for(let i of t){if(i.path===n.path)return t.splice(r),i;r++}return n}},Um={matched:!1,consumedSegments:[],remainingSegments:[],parameters:{},positionalParamSegments:{}};function KF(e,n,t,r,i){let s=qm(e,n,t);return s.matched?(r=TF(n,r),zF(r,n,t,i).pipe(be(o=>o===!0?s:de({},Um)))):xe(s)}function qm(e,n,t){if(n.path==="**")return YF(t);if(n.path==="")return n.pathMatch==="full"&&(e.hasChildren()||t.length>0)?de({},Um):{matched:!0,consumedSegments:[],remainingSegments:t,parameters:{},positionalParamSegments:{}};let i=(n.matcher||zO)(t,e,n);if(!i)return de({},Um);let s={};Object.entries(i.posParams??{}).forEach(([a,c])=>{s[a]=c.path});let o=i.consumed.length>0?de(de({},s),i.consumed[i.consumed.length-1].parameters):s;return{matched:!0,consumedSegments:i.consumed,remainingSegments:t.slice(i.consumed.length),parameters:o,positionalParamSegments:i.posParams??{}}}function YF(e){return{matched:!0,parameters:e.length>0?FE(e).parameters:{},consumedSegments:e,remainingSegments:[],positionalParamSegments:{}}}function NE(e,n,t,r){return t.length>0&&ZF(e,t,r)?{segmentGroup:new tt(n,QF(r,new tt(t,e.children))),slicedSegments:[]}:t.length===0&&JF(e,t,r)?{segmentGroup:new tt(e.segments,XF(e,t,r,e.children)),slicedSegments:t}:{segmentGroup:new tt(e.segments,e.children),slicedSegments:t}}function XF(e,n,t,r){let i={};for(let s of t)if(sd(e,n,s)&&!r[jr(s)]){let o=new tt([],{});i[jr(s)]=o}return de(de({},r),i)}function QF(e,n){let t={};t[Ne]=n;for(let r of e)if(r.path===""&&jr(r)!==Ne){let i=new tt([],{});t[jr(r)]=i}return t}function ZF(e,n,t){return t.some(r=>sd(e,n,r)&&jr(r)!==Ne)}function JF(e,n,t){return t.some(r=>sd(e,n,r))}function sd(e,n,t){return(e.hasChildren()||n.length>0)&&t.pathMatch==="full"?!1:t.path===""}function eP(e,n,t,r){return jr(e)!==r&&(r===Ne||!sd(n,t,e))?!1:qm(n,e,t).matched}function tP(e,n,t){return n.length===0&&!e.children[t]}var jm=class{};function nP(e,n,t,r,i,s,o="emptyOnly"){return new Vm(e,n,t,r,i,o,s).recognize()}var rP=31,Vm=class{constructor(n,t,r,i,s,o,a){this.injector=n,this.configLoader=t,this.rootComponentType=r,this.config=i,this.urlTree=s,this.paramsInheritanceStrategy=o,this.urlSerializer=a,this.applyRedirects=new Bm(this.urlSerializer,this.urlTree),this.absoluteRedirectCount=0,this.allowRedirects=!0}noMatchError(n){return new ve(4002,`'${n.segmentGroup}'`)}recognize(){let n=NE(this.urlTree.root,[],[],this.config).segmentGroup;return this.match(n).pipe(be(t=>{let r=new kc([],Object.freeze({}),Object.freeze(de({},this.urlTree.queryParams)),this.urlTree.fragment,{},Ne,this.rootComponentType,null,{}),i=new Ln(r,t),s=new Jf("",i),o=uF(r,[],this.urlTree.queryParams,this.urlTree.fragment);return o.queryParams=this.urlTree.queryParams,s.url=this.urlSerializer.serialize(o),this.inheritParamsAndData(s._root,null),{state:s,tree:o}}))}match(n){return this.processSegmentGroup(this.injector,this.config,n,Ne).pipe(bi(r=>{if(r instanceof td)return this.urlTree=r.urlTree,this.match(r.urlTree.root);throw r instanceof Rc?this.noMatchError(r):r}))}inheritParamsAndData(n,t){let r=n.value,i=$m(r,t,this.paramsInheritanceStrategy);r.params=Object.freeze(i.params),r.data=Object.freeze(i.data),n.children.forEach(s=>this.inheritParamsAndData(s,r))}processSegmentGroup(n,t,r,i){return r.segments.length===0&&r.hasChildren()?this.processChildren(n,t,r):this.processSegment(n,t,r,r.segments,i,!0).pipe(be(s=>s instanceof Ln?[s]:[]))}processChildren(n,t,r){let i=[];for(let s of Object.keys(r.children))s==="primary"?i.unshift(s):i.push(s);return ht(i).pipe(ri(s=>{let o=r.children[s],a=IF(t,s);return this.processSegmentGroup(n,a,o,s)}),r0((s,o)=>(s.push(...o),s)),Ai(null),n0(),Ct(s=>{if(s===null)return qo(r);let o=rT(s);return iP(o),xe(o)}))}processSegment(n,t,r,i,s,o){return ht(t).pipe(ri(a=>this.processSegmentAgainstRoute(a._injector??n,t,a,r,i,s,o).pipe(bi(c=>{if(c instanceof Rc)return xe(null);throw c}))),Ar(a=>!!a),bi(a=>{if(tT(a))return tP(r,i,s)?xe(new jm):qo(r);throw a}))}processSegmentAgainstRoute(n,t,r,i,s,o,a){return eP(r,i,s,o)?r.redirectTo===void 0?this.matchSegmentAgainstRoute(n,i,r,s,o):this.allowRedirects&&a?this.expandSegmentAgainstRouteUsingRedirect(n,i,t,r,s,o):qo(i):qo(i)}expandSegmentAgainstRouteUsingRedirect(n,t,r,i,s,o){let{matched:a,consumedSegments:c,positionalParamSegments:l,remainingSegments:u}=qm(t,i,s);if(!a)return qo(t);i.redirectTo.startsWith("/")&&(this.absoluteRedirectCount++,this.absoluteRedirectCount>rP&&(this.allowRedirects=!1));let f=this.applyRedirects.applyRedirectCommands(c,i.redirectTo,l);return this.applyRedirects.lineralizeSegments(i,f).pipe(Ct(d=>this.processSegment(n,r,t,d.concat(u),o,!1)))}matchSegmentAgainstRoute(n,t,r,i,s){let o=KF(t,r,i,n,this.urlSerializer);return r.path==="**"&&(t.children={}),o.pipe(Dn(a=>a.matched?(n=r._injector??n,this.getChildConfig(n,r,i).pipe(Dn(({routes:c})=>{let l=r._loadedInjector??n,{consumedSegments:u,remainingSegments:f,parameters:d}=a,h=new kc(u,d,Object.freeze(de({},this.urlTree.queryParams)),this.urlTree.fragment,oP(r),jr(r),r.component??r._loadedComponent??null,r,aP(r)),{segmentGroup:m,slicedSegments:p}=NE(t,u,f,c);if(p.length===0&&m.hasChildren())return this.processChildren(l,c,m).pipe(be(w=>w===null?null:new Ln(h,w)));if(c.length===0&&p.length===0)return xe(new Ln(h,[]));let g=jr(r)===s;return this.processSegment(l,c,m,p,g?Ne:s,!0).pipe(be(w=>new Ln(h,w instanceof Ln?[w]:[])))}))):qo(t)))}getChildConfig(n,t,r){return t.children?xe({routes:t.children,injector:n}):t.loadChildren?t._loadedRoutes!==void 0?xe({routes:t._loadedRoutes,injector:t._loadedInjector}):WF(n,t,r,this.urlSerializer).pipe(Ct(i=>i?this.configLoader.loadChildren(n,t).pipe(St(s=>{t._loadedRoutes=s.routes,t._loadedInjector=s.injector})):qF(t))):xe({routes:[],injector:n})}};function iP(e){e.sort((n,t)=>n.value.outlet===Ne?-1:t.value.outlet===Ne?1:n.value.outlet.localeCompare(t.value.outlet))}function sP(e){let n=e.value.routeConfig;return n&&n.path===""}function rT(e){let n=[],t=new Set;for(let r of e){if(!sP(r)){n.push(r);continue}let i=n.find(s=>r.value.routeConfig===s.value.routeConfig);i!==void 0?(i.children.push(...r.children),t.add(i)):n.push(r)}for(let r of t){let i=rT(r.children);n.push(new Ln(r.value,i))}return n.filter(r=>!t.has(r))}function oP(e){return e.data||{}}function aP(e){return e.resolve||{}}function cP(e,n,t,r,i,s){return Ct(o=>nP(e,n,t,r,o.extractedUrl,i,s).pipe(be(({state:a,tree:c})=>gt(de({},o),{targetSnapshot:a,urlAfterRedirects:c}))))}function lP(e,n){return Ct(t=>{let{targetSnapshot:r,guards:{canActivateChecks:i}}=t;if(!i.length)return xe(t);let s=new Set(i.map(c=>c.route)),o=new Set;for(let c of s)if(!o.has(c))for(let l of iT(c))o.add(l);let a=0;return ht(o).pipe(ri(c=>s.has(c)?uP(c,r,e,n):(c.data=$m(c,c.parent,e).resolve,xe(void 0))),St(()=>a++),wo(1),Ct(c=>a===o.size?xe(t):Pn))})}function iT(e){let n=e.children.map(t=>iT(t)).flat();return[e,...n]}function uP(e,n,t,r){let i=e.routeConfig,s=e._resolve;return i?.title!==void 0&&!XE(i)&&(s[Mc]=i.title),fP(s,e,n,r).pipe(be(o=>(e._resolvedData=o,e.data=$m(e,e.parent,t).resolve,null)))}function fP(e,n,t,r){let i=_m(e);if(i.length===0)return xe({});let s={};return ht(i).pipe(Ct(o=>dP(e[o],n,t,r).pipe(Ar(),St(a=>{s[o]=a}))),wo(1),t0(s),bi(o=>tT(o)?Pn:_o(o)))}function dP(e,n,t,r){let i=Pc(n)??r,s=ta(e,i),o=s.resolve?s.resolve(n,t):pr(i,()=>s(n,t));return Wi(o)}function gm(e){return Dn(n=>{let t=e(n);return t?ht(t).pipe(be(()=>n)):xe(n)})}var sT=(()=>{class e{buildTitle(t){let r,i=t.root;for(;i!==void 0;)r=this.getResolvedTitleForRoute(i)??r,i=i.children.find(s=>s.outlet===Ne);return r}getResolvedTitleForRoute(t){return t.data[Mc]}static{this.\u0275fac=function(r){return new(r||e)}}static{this.\u0275prov=he({token:e,factory:()=>te(hP),providedIn:"root"})}}return e})(),hP=(()=>{class e extends sT{constructor(t){super(),this.title=t}updateTitle(t){let r=this.buildTitle(t);r!==void 0&&this.title.setTitle(r)}static{this.\u0275fac=function(r){return new(r||e)(ue(IE))}}static{this.\u0275prov=he({token:e,factory:e.\u0275fac,providedIn:"root"})}}return e})(),Bc=new ge("",{providedIn:"root",factory:()=>({})}),nd=new ge(""),Km=(()=>{class e{constructor(){this.componentLoaders=new WeakMap,this.childrenLoaders=new WeakMap,this.compiler=te(Af)}loadComponent(t){if(this.componentLoaders.get(t))return this.componentLoaders.get(t);if(t._loadedComponent)return xe(t._loadedComponent);this.onLoadStartListener&&this.onLoadStartListener(t);let r=Wi(t.loadComponent()).pipe(be(oT),St(s=>{this.onLoadEndListener&&this.onLoadEndListener(t),t._loadedComponent=s}),ki(()=>{this.componentLoaders.delete(t)})),i=new po(r,()=>new Lt).pipe(ho());return this.componentLoaders.set(t,i),i}loadChildren(t,r){if(this.childrenLoaders.get(r))return this.childrenLoaders.get(r);if(r._loadedRoutes)return xe({routes:r._loadedRoutes,injector:r._loadedInjector});this.onLoadStartListener&&this.onLoadStartListener(r);let s=pP(r,this.compiler,t,this.onLoadEndListener).pipe(ki(()=>{this.childrenLoaders.delete(r)})),o=new po(s,()=>new Lt).pipe(ho());return this.childrenLoaders.set(r,o),o}static{this.\u0275fac=function(r){return new(r||e)}}static{this.\u0275prov=he({token:e,factory:e.\u0275fac,providedIn:"root"})}}return e})();function pP(e,n,t,r){return Wi(e.loadChildren()).pipe(be(oT),Ct(i=>i instanceof ec||Array.isArray(i)?xe(i):ht(n.compileModuleAsync(i))),be(i=>{r&&r(e);let s,o,a=!1;return Array.isArray(i)?(o=i,a=!0):(s=i.create(t).injector,o=s.get(nd,[],{optional:!0,self:!0}).flat()),{routes:o.map(Gm),injector:s}}))}function mP(e){return e&&typeof e=="object"&&"default"in e}function oT(e){return mP(e)?e.default:e}var Ym=(()=>{class e{static{this.\u0275fac=function(r){return new(r||e)}}static{this.\u0275prov=he({token:e,factory:()=>te(gP),providedIn:"root"})}}return e})(),gP=(()=>{class e{shouldProcessUrl(t){return!0}extract(t){return t}merge(t,r){return t}static{this.\u0275fac=function(r){return new(r||e)}}static{this.\u0275prov=he({token:e,factory:e.\u0275fac,providedIn:"root"})}}return e})(),aT=new ge(""),cT=new ge("");function vP(e,n,t){let r=e.get(cT),i=e.get(sn);return e.get(Ye).runOutsideAngular(()=>{if(!i.startViewTransition||r.skipNextTransition)return r.skipNextTransition=!1,new Promise(l=>setTimeout(l));let s,o=new Promise(l=>{s=l}),a=i.startViewTransition(()=>(s(),_P(e))),{onViewTransitionCreated:c}=r;return c&&pr(e,()=>c({transition:a,from:n,to:t})),o})}function _P(e){return new Promise(n=>{Ef(n,{injector:e})})}var Xm=(()=>{class e{get hasRequestedNavigation(){return this.navigationId!==0}constructor(){this.currentNavigation=null,this.currentTransition=null,this.lastSuccessfulNavigation=null,this.events=new Lt,this.transitionAbortSubject=new Lt,this.configLoader=te(Km),this.environmentInjector=te(nn),this.urlSerializer=te(Oc),this.rootContexts=te(Fc),this.location=te($o),this.inputBindingEnabled=te(id,{optional:!0})!==null,this.titleStrategy=te(sT),this.options=te(Bc,{optional:!0})||{},this.paramsInheritanceStrategy=this.options.paramsInheritanceStrategy||"emptyOnly",this.urlHandlingStrategy=te(Ym),this.createViewTransition=te(aT,{optional:!0}),this.navigationId=0,this.afterPreactivation=()=>xe(void 0),this.rootComponentType=null;let t=i=>this.events.next(new Sm(i)),r=i=>this.events.next(new Dm(i));this.configLoader.onLoadEndListener=r,this.configLoader.onLoadStartListener=t}complete(){this.transitions?.complete()}handleNavigationRequest(t){let r=++this.navigationId;this.transitions?.next(gt(de(de({},this.transitions.value),t),{id:r}))}setupNavigations(t,r,i){return this.transitions=new qt({id:0,currentUrlTree:r,currentRawUrl:r,extractedUrl:this.urlHandlingStrategy.extract(r),urlAfterRedirects:this.urlHandlingStrategy.extract(r),rawUrl:r,extras:{},resolve:null,reject:null,promise:Promise.resolve(!0),source:Tc,restoredState:null,currentSnapshot:i.snapshot,targetSnapshot:null,currentRouterState:i,targetRouterState:null,guards:{canActivateChecks:[],canDeactivateChecks:[]},guardsResult:null}),this.transitions.pipe(Sn(s=>s.id!==0),be(s=>gt(de({},s),{extractedUrl:this.urlHandlingStrategy.extract(s.rawUrl)})),Dn(s=>{let o=!1,a=!1;return xe(s).pipe(Dn(c=>{if(this.navigationId>s.id)return this.cancelNavigationTransition(s,"",Bn.SupersededByNewNavigation),Pn;this.currentTransition=s,this.currentNavigation={id:c.id,initialUrl:c.rawUrl,extractedUrl:c.extractedUrl,trigger:c.source,extras:c.extras,previousNavigation:this.lastSuccessfulNavigation?gt(de({},this.lastSuccessfulNavigation),{previousNavigation:null}):null};let l=!t.navigated||this.isUpdatingInternalState()||this.isUpdatedBrowserUrl(),u=c.extras.onSameUrlNavigation??t.onSameUrlNavigation;if(!l&&u!=="reload"){let f="";return this.events.next(new $i(c.id,this.urlSerializer.serialize(c.rawUrl),f,Kf.IgnoredSameUrlNavigation)),c.resolve(null),Pn}if(this.urlHandlingStrategy.shouldProcessUrl(c.rawUrl))return xe(c).pipe(Dn(f=>{let d=this.transitions?.getValue();return this.events.next(new Jo(f.id,this.urlSerializer.serialize(f.extractedUrl),f.source,f.restoredState)),d!==this.transitions?.getValue()?Pn:Promise.resolve(f)}),cP(this.environmentInjector,this.configLoader,this.rootComponentType,t.config,this.urlSerializer,this.paramsInheritanceStrategy),St(f=>{s.targetSnapshot=f.targetSnapshot,s.urlAfterRedirects=f.urlAfterRedirects,this.currentNavigation=gt(de({},this.currentNavigation),{finalUrl:f.urlAfterRedirects});let d=new Yf(f.id,this.urlSerializer.serialize(f.extractedUrl),this.urlSerializer.serialize(f.urlAfterRedirects),f.targetSnapshot);this.events.next(d)}));if(l&&this.urlHandlingStrategy.shouldProcessUrl(c.currentRawUrl)){let{id:f,extractedUrl:d,source:h,restoredState:m,extras:p}=c,g=new Jo(f,this.urlSerializer.serialize(d),h,m);this.events.next(g);let w=KE(this.rootComponentType).snapshot;return this.currentTransition=s=gt(de({},c),{targetSnapshot:w,urlAfterRedirects:d,extras:gt(de({},p),{skipLocationChange:!1,replaceUrl:!1})}),this.currentNavigation.finalUrl=d,xe(s)}else{let f="";return this.events.next(new $i(c.id,this.urlSerializer.serialize(c.extractedUrl),f,Kf.IgnoredByUrlHandlingStrategy)),c.resolve(null),Pn}}),St(c=>{let l=new Em(c.id,this.urlSerializer.serialize(c.extractedUrl),this.urlSerializer.serialize(c.urlAfterRedirects),c.targetSnapshot);this.events.next(l)}),be(c=>(this.currentTransition=s=gt(de({},c),{guards:SF(c.targetSnapshot,c.currentSnapshot,this.rootContexts)}),s)),PF(this.environmentInjector,c=>this.events.next(c)),St(c=>{if(s.guardsResult=c.guardsResult,Zo(c.guardsResult))throw ZE(this.urlSerializer,c.guardsResult);let l=new Tm(c.id,this.urlSerializer.serialize(c.extractedUrl),this.urlSerializer.serialize(c.urlAfterRedirects),c.targetSnapshot,!!c.guardsResult);this.events.next(l)}),Sn(c=>c.guardsResult?!0:(this.cancelNavigationTransition(c,"",Bn.GuardRejected),!1)),gm(c=>{if(c.guards.canActivateChecks.length)return xe(c).pipe(St(l=>{let u=new Im(l.id,this.urlSerializer.serialize(l.extractedUrl),this.urlSerializer.serialize(l.urlAfterRedirects),l.targetSnapshot);this.events.next(u)}),Dn(l=>{let u=!1;return xe(l).pipe(lP(this.paramsInheritanceStrategy,this.environmentInjector),St({next:()=>u=!0,complete:()=>{u||this.cancelNavigationTransition(l,"",Bn.NoDataFromResolver)}}))}),St(l=>{let u=new Cm(l.id,this.urlSerializer.serialize(l.extractedUrl),this.urlSerializer.serialize(l.urlAfterRedirects),l.targetSnapshot);this.events.next(u)}))}),gm(c=>{let l=u=>{let f=[];u.routeConfig?.loadComponent&&!u.routeConfig._loadedComponent&&f.push(this.configLoader.loadComponent(u.routeConfig).pipe(St(d=>{u.component=d}),be(()=>{})));for(let d of u.children)f.push(...l(d));return f};return Va(l(c.targetSnapshot.root)).pipe(Ai(null),ii(1))}),gm(()=>this.afterPreactivation()),Dn(()=>{let{currentSnapshot:c,targetSnapshot:l}=s,u=this.createViewTransition?.(this.environmentInjector,c.root,l.root);return u?ht(u).pipe(be(()=>s)):xe(s)}),be(c=>{let l=_F(t.routeReuseStrategy,c.targetSnapshot,c.currentRouterState);return this.currentTransition=s=gt(de({},c),{targetRouterState:l}),this.currentNavigation.targetRouterState=l,s}),St(()=>{this.events.next(new bc)}),CF(this.rootContexts,t.routeReuseStrategy,c=>this.events.next(c),this.inputBindingEnabled),ii(1),St({next:c=>{o=!0,this.lastSuccessfulNavigation=this.currentNavigation,this.events.next(new Ur(c.id,this.urlSerializer.serialize(c.extractedUrl),this.urlSerializer.serialize(c.urlAfterRedirects))),this.titleStrategy?.updateTitle(c.targetRouterState.snapshot),c.resolve(!0)},complete:()=>{o=!0}}),s0(this.transitionAbortSubject.pipe(St(c=>{throw c}))),ki(()=>{!o&&!a&&this.cancelNavigationTransition(s,"",Bn.SupersededByNewNavigation),this.currentTransition?.id===s.id&&(this.currentNavigation=null,this.currentTransition=null)}),bi(c=>{if(a=!0,eT(c))this.events.next(new Hi(s.id,this.urlSerializer.serialize(s.extractedUrl),c.message,c.cancellationCode)),wF(c)?this.events.next(new Ac(c.url)):s.resolve(!1);else{this.events.next(new Dc(s.id,this.urlSerializer.serialize(s.extractedUrl),c,s.targetSnapshot??void 0));try{s.resolve(t.errorHandler(c))}catch(l){this.options.resolveNavigationPromiseOnError?s.resolve(!1):s.reject(l)}}return Pn}))}))}cancelNavigationTransition(t,r,i){let s=new Hi(t.id,this.urlSerializer.serialize(t.extractedUrl),r,i);this.events.next(s),t.resolve(!1)}isUpdatingInternalState(){return this.currentTransition?.extractedUrl.toString()!==this.currentTransition?.currentUrlTree.toString()}isUpdatedBrowserUrl(){return this.urlHandlingStrategy.extract(this.urlSerializer.parse(this.location.path(!0))).toString()!==this.currentTransition?.extractedUrl.toString()&&!this.currentTransition?.extras.skipLocationChange}static{this.\u0275fac=function(r){return new(r||e)}}static{this.\u0275prov=he({token:e,factory:e.\u0275fac,providedIn:"root"})}}return e})();function xP(e){return e!==Tc}var yP=(()=>{class e{static{this.\u0275fac=function(r){return new(r||e)}}static{this.\u0275prov=he({token:e,factory:()=>te(wP),providedIn:"root"})}}return e})(),Hm=class{shouldDetach(n){return!1}store(n,t){}shouldAttach(n){return!1}retrieve(n){return null}shouldReuseRoute(n,t){return n.routeConfig===t.routeConfig}},wP=(()=>{class e extends Hm{static{this.\u0275fac=(()=>{let t;return function(i){return(t||(t=wp(e)))(i||e)}})()}static{this.\u0275prov=he({token:e,factory:e.\u0275fac,providedIn:"root"})}}return e})(),lT=(()=>{class e{static{this.\u0275fac=function(r){return new(r||e)}}static{this.\u0275prov=he({token:e,factory:()=>te(EP),providedIn:"root"})}}return e})(),EP=(()=>{class e extends lT{constructor(){super(...arguments),this.location=te($o),this.urlSerializer=te(Oc),this.options=te(Bc,{optional:!0})||{},this.canceledNavigationResolution=this.options.canceledNavigationResolution||"replace",this.urlHandlingStrategy=te(Ym),this.urlUpdateStrategy=this.options.urlUpdateStrategy||"deferred",this.currentUrlTree=new Vi,this.rawUrlTree=this.currentUrlTree,this.currentPageId=0,this.lastSuccessfulId=-1,this.routerState=KE(null),this.stateMemento=this.createStateMemento()}getCurrentUrlTree(){return this.currentUrlTree}getRawUrlTree(){return this.rawUrlTree}restoredState(){return this.location.getState()}get browserPageId(){return this.canceledNavigationResolution!=="computed"?this.currentPageId:this.restoredState()?.\u0275routerPageId??this.currentPageId}getRouterState(){return this.routerState}createStateMemento(){return{rawUrlTree:this.rawUrlTree,currentUrlTree:this.currentUrlTree,routerState:this.routerState}}registerNonRouterCurrentEntryChangeListener(t){return this.location.subscribe(r=>{r.type==="popstate"&&t(r.url,r.state)})}handleRouterEvent(t,r){if(t instanceof Jo)this.stateMemento=this.createStateMemento();else if(t instanceof $i)this.rawUrlTree=r.initialUrl;else if(t instanceof Yf){if(this.urlUpdateStrategy==="eager"&&!r.extras.skipLocationChange){let i=this.urlHandlingStrategy.merge(r.finalUrl,r.initialUrl);this.setBrowserUrl(i,r)}}else t instanceof bc?(this.currentUrlTree=r.finalUrl,this.rawUrlTree=this.urlHandlingStrategy.merge(r.finalUrl,r.initialUrl),this.routerState=r.targetRouterState,this.urlUpdateStrategy==="deferred"&&(r.extras.skipLocationChange||this.setBrowserUrl(this.rawUrlTree,r))):t instanceof Hi&&(t.code===Bn.GuardRejected||t.code===Bn.NoDataFromResolver)?this.restoreHistory(r):t instanceof Dc?this.restoreHistory(r,!0):t instanceof Ur&&(this.lastSuccessfulId=t.id,this.currentPageId=this.browserPageId)}setBrowserUrl(t,r){let i=this.urlSerializer.serialize(t);if(this.location.isCurrentPathEqualTo(i)||r.extras.replaceUrl){let s=this.browserPageId,o=de(de({},r.extras.state),this.generateNgRouterState(r.id,s));this.location.replaceState(i,"",o)}else{let s=de(de({},r.extras.state),this.generateNgRouterState(r.id,this.browserPageId+1));this.location.go(i,"",s)}}restoreHistory(t,r=!1){if(this.canceledNavigationResolution==="computed"){let i=this.browserPageId,s=this.currentPageId-i;s!==0?this.location.historyGo(s):this.currentUrlTree===t.finalUrl&&s===0&&(this.resetState(t),this.resetUrlToCurrentUrlTree())}else this.canceledNavigationResolution==="replace"&&(r&&this.resetState(t),this.resetUrlToCurrentUrlTree())}resetState(t){this.routerState=this.stateMemento.routerState,this.currentUrlTree=this.stateMemento.currentUrlTree,this.rawUrlTree=this.urlHandlingStrategy.merge(this.currentUrlTree,t.finalUrl??this.rawUrlTree)}resetUrlToCurrentUrlTree(){this.location.replaceState(this.urlSerializer.serialize(this.rawUrlTree),"",this.generateNgRouterState(this.lastSuccessfulId,this.currentPageId))}generateNgRouterState(t,r){return this.canceledNavigationResolution==="computed"?{navigationId:t,\u0275routerPageId:r}:{navigationId:t}}static{this.\u0275fac=(()=>{let t;return function(i){return(t||(t=wp(e)))(i||e)}})()}static{this.\u0275prov=he({token:e,factory:e.\u0275fac,providedIn:"root"})}}return e})(),wc=function(e){return e[e.COMPLETE=0]="COMPLETE",e[e.FAILED=1]="FAILED",e[e.REDIRECTING=2]="REDIRECTING",e}(wc||{});function uT(e,n){e.events.pipe(Sn(t=>t instanceof Ur||t instanceof Hi||t instanceof Dc||t instanceof $i),be(t=>t instanceof Ur||t instanceof $i?wc.COMPLETE:(t instanceof Hi?t.code===Bn.Redirect||t.code===Bn.SupersededByNewNavigation:!1)?wc.REDIRECTING:wc.FAILED),Sn(t=>t!==wc.REDIRECTING),ii(1)).subscribe(()=>{n()})}function TP(e){throw e}var IP={paths:"exact",fragment:"ignored",matrixParams:"ignored",queryParams:"exact"},CP={paths:"subset",fragment:"ignored",matrixParams:"ignored",queryParams:"subset"},Vr=(()=>{class e{get currentUrlTree(){return this.stateManager.getCurrentUrlTree()}get rawUrlTree(){return this.stateManager.getRawUrlTree()}get events(){return this._events}get routerState(){return this.stateManager.getRouterState()}constructor(){this.disposed=!1,this.isNgZoneEnabled=!1,this.console=te(If),this.stateManager=te(lT),this.options=te(Bc,{optional:!0})||{},this.pendingTasks=te(Ss),this.urlUpdateStrategy=this.options.urlUpdateStrategy||"deferred",this.navigationTransitions=te(Xm),this.urlSerializer=te(Oc),this.location=te($o),this.urlHandlingStrategy=te(Ym),this._events=new Lt,this.errorHandler=this.options.errorHandler||TP,this.navigated=!1,this.routeReuseStrategy=te(yP),this.onSameUrlNavigation=this.options.onSameUrlNavigation||"ignore",this.config=te(nd,{optional:!0})?.flat()??[],this.componentInputBindingEnabled=!!te(id,{optional:!0}),this.eventsSubscription=new wt,this.isNgZoneEnabled=te(Ye)instanceof Ye&&Ye.isInAngularZone(),this.resetConfig(this.config),this.navigationTransitions.setupNavigations(this,this.currentUrlTree,this.routerState).subscribe({error:t=>{this.console.warn(t)}}),this.subscribeToNavigationEvents()}subscribeToNavigationEvents(){let t=this.navigationTransitions.events.subscribe(r=>{try{let i=this.navigationTransitions.currentTransition,s=this.navigationTransitions.currentNavigation;if(i!==null&&s!==null){if(this.stateManager.handleRouterEvent(r,s),r instanceof Hi&&r.code!==Bn.Redirect&&r.code!==Bn.SupersededByNewNavigation)this.navigated=!0;else if(r instanceof Ur)this.navigated=!0;else if(r instanceof Ac){let o=this.urlHandlingStrategy.merge(r.url,i.currentRawUrl),a={info:i.extras.info,skipLocationChange:i.extras.skipLocationChange,replaceUrl:this.urlUpdateStrategy==="eager"||xP(i.source)};this.scheduleNavigation(o,Tc,null,a,{resolve:i.resolve,reject:i.reject,promise:i.promise})}}DP(r)&&this._events.next(r)}catch(i){this.navigationTransitions.transitionAbortSubject.next(i)}});this.eventsSubscription.add(t)}resetRootComponentType(t){this.routerState.root.component=t,this.navigationTransitions.rootComponentType=t}initialNavigation(){this.setUpLocationChangeListener(),this.navigationTransitions.hasRequestedNavigation||this.navigateToSyncWithBrowser(this.location.path(!0),Tc,this.stateManager.restoredState())}setUpLocationChangeListener(){this.nonRouterCurrentEntryChangeSubscription??=this.stateManager.registerNonRouterCurrentEntryChangeListener((t,r)=>{setTimeout(()=>{this.navigateToSyncWithBrowser(t,"popstate",r)},0)})}navigateToSyncWithBrowser(t,r,i){let s={replaceUrl:!0},o=i?.navigationId?i:null;if(i){let c=de({},i);delete c.navigationId,delete c.\u0275routerPageId,Object.keys(c).length!==0&&(s.state=c)}let a=this.parseUrl(t);this.scheduleNavigation(a,r,o,s)}get url(){return this.serializeUrl(this.currentUrlTree)}getCurrentNavigation(){return this.navigationTransitions.currentNavigation}get lastSuccessfulNavigation(){return this.navigationTransitions.lastSuccessfulNavigation}resetConfig(t){this.config=t.map(Gm),this.navigated=!1}ngOnDestroy(){this.dispose()}dispose(){this.navigationTransitions.complete(),this.nonRouterCurrentEntryChangeSubscription&&(this.nonRouterCurrentEntryChangeSubscription.unsubscribe(),this.nonRouterCurrentEntryChangeSubscription=void 0),this.disposed=!0,this.eventsSubscription.unsubscribe()}createUrlTree(t,r={}){let{relativeTo:i,queryParams:s,fragment:o,queryParamsHandling:a,preserveFragment:c}=r,l=c?this.currentUrlTree.fragment:o,u=null;switch(a){case"merge":u=de(de({},this.currentUrlTree.queryParams),s);break;case"preserve":u=this.currentUrlTree.queryParams;break;default:u=s||null}u!==null&&(u=this.removeEmptyProps(u));let f;try{let d=i?i.snapshot:this.routerState.snapshot.root;f=WE(d)}catch{(typeof t[0]!="string"||!t[0].startsWith("/"))&&(t=[]),f=this.currentUrlTree.root}return zE(f,t,u,l??null)}navigateByUrl(t,r={skipLocationChange:!1}){let i=Zo(t)?t:this.parseUrl(t),s=this.urlHandlingStrategy.merge(i,this.rawUrlTree);return this.scheduleNavigation(s,Tc,null,r)}navigate(t,r={skipLocationChange:!1}){return SP(t),this.navigateByUrl(this.createUrlTree(t,r),r)}serializeUrl(t){return this.urlSerializer.serialize(t)}parseUrl(t){try{return this.urlSerializer.parse(t)}catch{return this.urlSerializer.parse("/")}}isActive(t,r){let i;if(r===!0?i=de({},IP):r===!1?i=de({},CP):i=r,Zo(t))return SE(this.currentUrlTree,t,i);let s=this.parseUrl(t);return SE(this.currentUrlTree,s,i)}removeEmptyProps(t){return Object.entries(t).reduce((r,[i,s])=>(s!=null&&(r[i]=s),r),{})}scheduleNavigation(t,r,i,s,o){if(this.disposed)return Promise.resolve(!1);let a,c,l;o?(a=o.resolve,c=o.reject,l=o.promise):l=new Promise((f,d)=>{a=f,c=d});let u=this.pendingTasks.add();return uT(this,()=>{queueMicrotask(()=>this.pendingTasks.remove(u))}),this.navigationTransitions.handleNavigationRequest({source:r,restoredState:i,currentUrlTree:this.currentUrlTree,currentRawUrl:this.currentUrlTree,rawUrl:t,extras:s,resolve:a,reject:c,promise:l,currentSnapshot:this.routerState.snapshot,currentRouterState:this.routerState}),l.catch(f=>Promise.reject(f))}static{this.\u0275fac=function(r){return new(r||e)}}static{this.\u0275prov=he({token:e,factory:e.\u0275fac,providedIn:"root"})}}return e})();function SP(e){for(let n=0;n<e.length;n++)if(e[n]==null)throw new ve(4008,!1)}function DP(e){return!(e instanceof bc)&&!(e instanceof Ac)}var od=(()=>{class e{constructor(t,r,i,s,o,a){this.router=t,this.route=r,this.tabIndexAttribute=i,this.renderer=s,this.el=o,this.locationStrategy=a,this.href=null,this.commands=null,this.onChanges=new Lt,this.preserveFragment=!1,this.skipLocationChange=!1,this.replaceUrl=!1;let c=o.nativeElement.tagName?.toLowerCase();this.isAnchorElement=c==="a"||c==="area",this.isAnchorElement?this.subscription=t.events.subscribe(l=>{l instanceof Ur&&this.updateHref()}):this.setTabIndexIfNotOnNativeEl("0")}setTabIndexIfNotOnNativeEl(t){this.tabIndexAttribute!=null||this.isAnchorElement||this.applyAttributeValue("tabindex",t)}ngOnChanges(t){this.isAnchorElement&&this.updateHref(),this.onChanges.next(this)}set routerLink(t){t!=null?(this.commands=Array.isArray(t)?t:[t],this.setTabIndexIfNotOnNativeEl("0")):(this.commands=null,this.setTabIndexIfNotOnNativeEl(null))}onClick(t,r,i,s,o){let a=this.urlTree;if(a===null||this.isAnchorElement&&(t!==0||r||i||s||o||typeof this.target=="string"&&this.target!="_self"))return!0;let c={skipLocationChange:this.skipLocationChange,replaceUrl:this.replaceUrl,state:this.state,info:this.info};return this.router.navigateByUrl(a,c),!this.isAnchorElement}ngOnDestroy(){this.subscription?.unsubscribe()}updateHref(){let t=this.urlTree;this.href=t!==null&&this.locationStrategy?this.locationStrategy?.prepareExternalUrl(this.router.serializeUrl(t)):null;let r=this.href===null?null:ew(this.href,this.el.nativeElement.tagName.toLowerCase(),"href");this.applyAttributeValue("href",r)}applyAttributeValue(t,r){let i=this.renderer,s=this.el.nativeElement;r!==null?i.setAttribute(s,t,r):i.removeAttribute(s,t)}get urlTree(){return this.commands===null?null:this.router.createUrlTree(this.commands,{relativeTo:this.relativeTo!==void 0?this.relativeTo:this.route,queryParams:this.queryParams,fragment:this.fragment,queryParamsHandling:this.queryParamsHandling,preserveFragment:this.preserveFragment})}static{this.\u0275fac=function(r){return new(r||e)(at(Vr),at(di),Ep("tabindex"),at(yf),at(ac),at(fi))}}static{this.\u0275dir=Po({type:e,selectors:[["","routerLink",""]],hostVars:1,hostBindings:function(r,i){r&1&&li("click",function(o){return i.onClick(o.button,o.ctrlKey,o.shiftKey,o.altKey,o.metaKey)}),r&2&&Up("target",i.target)},inputs:{target:"target",queryParams:"queryParams",fragment:"fragment",queryParamsHandling:"queryParamsHandling",state:"state",info:"info",relativeTo:"relativeTo",preserveFragment:[fr.HasDecoratorInputTransform,"preserveFragment","preserveFragment",dc],skipLocationChange:[fr.HasDecoratorInputTransform,"skipLocationChange","skipLocationChange",dc],replaceUrl:[fr.HasDecoratorInputTransform,"replaceUrl","replaceUrl",dc],routerLink:"routerLink"},standalone:!0,features:[Bp,sc]})}}return e})();var rd=class{};var bP=(()=>{class e{constructor(t,r,i,s,o){this.router=t,this.injector=i,this.preloadingStrategy=s,this.loader=o}setUpPreloading(){this.subscription=this.router.events.pipe(Sn(t=>t instanceof Ur),ri(()=>this.preload())).subscribe(()=>{})}preload(){return this.processRoutes(this.injector,this.router.config)}ngOnDestroy(){this.subscription&&this.subscription.unsubscribe()}processRoutes(t,r){let i=[];for(let s of r){s.providers&&!s._injector&&(s._injector=Tf(s.providers,t,`Route: ${s.path}`));let o=s._injector??t,a=s._loadedInjector??o;(s.loadChildren&&!s._loadedRoutes&&s.canLoad===void 0||s.loadComponent&&!s._loadedComponent)&&i.push(this.preloadConfig(o,s)),(s.children||s._loadedRoutes)&&i.push(this.processRoutes(a,s.children??s._loadedRoutes))}return ht(i).pipe(xo())}preloadConfig(t,r){return this.preloadingStrategy.preload(r,()=>{let i;r.loadChildren&&r.canLoad===void 0?i=this.loader.loadChildren(t,r):i=xe(null);let s=i.pipe(Ct(o=>o===null?xe(void 0):(r._loadedRoutes=o.routes,r._loadedInjector=o.injector,this.processRoutes(o.injector??t,o.routes))));if(r.loadComponent&&!r._loadedComponent){let o=this.loader.loadComponent(r);return ht([s,o]).pipe(xo())}else return s})}static{this.\u0275fac=function(r){return new(r||e)(ue(Vr),ue(Af),ue(nn),ue(rd),ue(Km))}}static{this.\u0275prov=he({token:e,factory:e.\u0275fac,providedIn:"root"})}}return e})(),fT=new ge(""),AP=(()=>{class e{constructor(t,r,i,s,o={}){this.urlSerializer=t,this.transitions=r,this.viewportScroller=i,this.zone=s,this.options=o,this.lastId=0,this.lastSource="imperative",this.restoredId=0,this.store={},this.environmentInjector=te(nn),o.scrollPositionRestoration||="disabled",o.anchorScrolling||="disabled"}init(){this.options.scrollPositionRestoration!=="disabled"&&this.viewportScroller.setHistoryScrollRestoration("manual"),this.routerEventsSubscription=this.createScrollEvents(),this.scrollEventsSubscription=this.consumeScrollEvents()}createScrollEvents(){return this.transitions.events.subscribe(t=>{t instanceof Jo?(this.store[this.lastId]=this.viewportScroller.getScrollPosition(),this.lastSource=t.navigationTrigger,this.restoredId=t.restoredState?t.restoredState.navigationId:0):t instanceof Ur?(this.lastId=t.id,this.scheduleScrollEvent(t,this.urlSerializer.parse(t.urlAfterRedirects).fragment)):t instanceof $i&&t.code===Kf.IgnoredSameUrlNavigation&&(this.lastSource=void 0,this.restoredId=0,this.scheduleScrollEvent(t,this.urlSerializer.parse(t.url).fragment))})}consumeScrollEvents(){return this.transitions.events.subscribe(t=>{t instanceof Xf&&(t.position?this.options.scrollPositionRestoration==="top"?this.viewportScroller.scrollToPosition([0,0]):this.options.scrollPositionRestoration==="enabled"&&this.viewportScroller.scrollToPosition(t.position):t.anchor&&this.options.anchorScrolling==="enabled"?this.viewportScroller.scrollToAnchor(t.anchor):this.options.scrollPositionRestoration!=="disabled"&&this.viewportScroller.scrollToPosition([0,0]))})}scheduleScrollEvent(t,r){this.zone.runOutsideAngular(()=>Z(this,null,function*(){yield new Promise(i=>{setTimeout(()=>{i()}),Ef(()=>{i()},{injector:this.environmentInjector})}),this.zone.run(()=>{this.transitions.events.next(new Xf(t,this.lastSource==="popstate"?this.store[this.restoredId]:null,r))})}))}ngOnDestroy(){this.routerEventsSubscription?.unsubscribe(),this.scrollEventsSubscription?.unsubscribe()}static{this.\u0275fac=function(r){dw()}}static{this.\u0275prov=he({token:e,factory:e.\u0275fac})}}return e})();function kP(e){return e.routerState.root}function Uc(e,n){return{\u0275kind:e,\u0275providers:n}}function NP(){let e=te(An);return n=>{let t=e.get(As);if(n!==t.components[0])return;let r=e.get(Vr),i=e.get(dT);e.get(Qm)===1&&r.initialNavigation(),e.get(hT,null,Me.Optional)?.setUpPreloading(),e.get(fT,null,Me.Optional)?.init(),r.resetRootComponentType(t.componentTypes[0]),i.closed||(i.next(),i.complete(),i.unsubscribe())}}var dT=new ge("",{factory:()=>new Lt}),Qm=new ge("",{providedIn:"root",factory:()=>1});function RP(){return Uc(2,[{provide:Qm,useValue:0},{provide:Df,multi:!0,deps:[An],useFactory:n=>{let t=n.get(Jw,Promise.resolve());return()=>t.then(()=>new Promise(r=>{let i=n.get(Vr),s=n.get(dT);uT(i,()=>{r(!0)}),n.get(Xm).afterPreactivation=()=>(r(!0),s.closed?xe(void 0):s),i.initialNavigation()}))}}])}function MP(){return Uc(3,[{provide:Df,multi:!0,useFactory:()=>{let n=te(Vr);return()=>{n.setUpLocationChangeListener()}}},{provide:Qm,useValue:2}])}var hT=new ge("");function OP(e){return Uc(0,[{provide:hT,useExisting:bP},{provide:rd,useExisting:e}])}function FP(){return Uc(8,[kE,{provide:id,useExisting:kE}])}function PP(e){let n=[{provide:aT,useValue:vP},{provide:cT,useValue:de({skipNextTransition:!!e?.skipInitialTransition},e)}];return Uc(9,n)}var RE=new ge("ROUTER_FORROOT_GUARD"),LP=[$o,{provide:Oc,useClass:Cc},Vr,Fc,{provide:di,useFactory:kP,deps:[Vr]},Km,[]],Zm=(()=>{class e{constructor(t){}static forRoot(t,r){return{ngModule:e,providers:[LP,[],{provide:nd,multi:!0,useValue:t},{provide:RE,useFactory:VP,deps:[[Vr,new qn,new ip]]},{provide:Bc,useValue:r||{}},r?.useHash?UP():jP(),BP(),r?.preloadingStrategy?OP(r.preloadingStrategy).\u0275providers:[],r?.initialNavigation?HP(r):[],r?.bindToComponentInputs?FP().\u0275providers:[],r?.enableViewTransitions?PP().\u0275providers:[],$P()]}}static forChild(t){return{ngModule:e,providers:[{provide:nd,multi:!0,useValue:t}]}}static{this.\u0275fac=function(r){return new(r||e)(ue(RE,8))}}static{this.\u0275mod=Xt({type:e})}static{this.\u0275inj=Yt({})}}return e})();function BP(){return{provide:fT,useFactory:()=>{let e=te(rE),n=te(Ye),t=te(Bc),r=te(Xm),i=te(Oc);return t.scrollOffset&&e.setOffset(t.scrollOffset),new AP(i,r,e,n,t)}}}function UP(){return{provide:fi,useClass:tE}}function jP(){return{provide:fi,useClass:Qp}}function VP(e){return"guarded"}function HP(e){return[e.initialNavigation==="disabled"?MP().\u0275providers:[],e.initialNavigation==="enabledBlocking"?RP().\u0275providers:[]]}var ME=new ge("");function $P(){return[{provide:ME,useFactory:NP},{provide:bf,multi:!0,useExisting:ME}]}var vI={};vI.version="0.18.5";var Wr=1200,aa=1252,WP=[874,932,936,949,950,1250,1251,1252,1253,1254,1255,1256,1257,1258,1e4],wg={0:1252,1:65001,2:65001,77:1e4,128:932,129:949,130:1361,134:936,136:950,161:1253,162:1254,163:1258,177:1255,178:1256,186:1257,204:1251,222:874,238:1250,255:1252,69:6969},Eg=function(e){WP.indexOf(e)!=-1&&(aa=wg[0]=e)};function zP(){Eg(1252)}var xr=function(e){Wr=e,Eg(e)};function _I(){xr(1200),zP()}function ug(e){for(var n=[],t=0,r=e.length;t<r;++t)n[t]=e.charCodeAt(t);return n}function GP(e){for(var n=[],t=0;t<e.length>>1;++t)n[t]=String.fromCharCode(e.charCodeAt(2*t)+(e.charCodeAt(2*t+1)<<8));return n.join("")}function xI(e){for(var n=[],t=0;t<e.length>>1;++t)n[t]=String.fromCharCode(e.charCodeAt(2*t+1)+(e.charCodeAt(2*t)<<8));return n.join("")}var Vc=function(e){var n=e.charCodeAt(0),t=e.charCodeAt(1);return n==255&&t==254?GP(e.slice(2)):n==254&&t==255?xI(e.slice(2)):n==65279?e.slice(1):e},ad=function(n){return String.fromCharCode(n)},pT=function(n){return String.fromCharCode(n)},nt;var Nt=null,jc=!0,qi="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";function mT(e){for(var n="",t=0,r=0,i=0,s=0,o=0,a=0,c=0,l=0;l<e.length;)t=e.charCodeAt(l++),s=t>>2,r=e.charCodeAt(l++),o=(t&3)<<4|r>>4,i=e.charCodeAt(l++),a=(r&15)<<2|i>>6,c=i&63,isNaN(r)?a=c=64:isNaN(i)&&(c=64),n+=qi.charAt(s)+qi.charAt(o)+qi.charAt(a)+qi.charAt(c);return n}function jn(e){var n="",t=0,r=0,i=0,s=0,o=0,a=0,c=0;e=e.replace(/[^\w\+\/\=]/g,"");for(var l=0;l<e.length;)s=qi.indexOf(e.charAt(l++)),o=qi.indexOf(e.charAt(l++)),t=s<<2|o>>4,n+=String.fromCharCode(t),a=qi.indexOf(e.charAt(l++)),r=(o&15)<<4|a>>2,a!==64&&(n+=String.fromCharCode(r)),c=qi.indexOf(e.charAt(l++)),i=(a&3)<<6|c,c!==64&&(n+=String.fromCharCode(i));return n}var Ue=function(){return typeof Buffer<"u"&&typeof process<"u"&&typeof process.versions<"u"&&!!process.versions.node}(),Vs=function(){if(typeof Buffer<"u"){var e=!Buffer.from;if(!e)try{Buffer.from("foo","utf8")}catch{e=!0}return e?function(n,t){return t?new Buffer(n,t):new Buffer(n)}:Buffer.from.bind(Buffer)}return function(){}}();function Xi(e){return Ue?Buffer.alloc?Buffer.alloc(e):new Buffer(e):typeof Uint8Array<"u"?new Uint8Array(e):new Array(e)}function gT(e){return Ue?Buffer.allocUnsafe?Buffer.allocUnsafe(e):new Buffer(e):typeof Uint8Array<"u"?new Uint8Array(e):new Array(e)}var _r=function(n){return Ue?Vs(n,"binary"):n.split("").map(function(t){return t.charCodeAt(0)&255})};function Hs(e){if(Array.isArray(e))return e.map(function(r){return String.fromCharCode(r)}).join("");for(var n=[],t=0;t<e.length;++t)n[t]=String.fromCharCode(e[t]);return n.join("")}function Tg(e){if(typeof ArrayBuffer>"u")throw new Error("Unsupported");if(e instanceof ArrayBuffer)return Tg(new Uint8Array(e));for(var n=new Array(e.length),t=0;t<e.length;++t)n[t]=e[t];return n}var Gi=Ue?function(e){return Buffer.concat(e.map(function(n){return Buffer.isBuffer(n)?n:Vs(n)}))}:function(e){if(typeof Uint8Array<"u"){var n=0,t=0;for(n=0;n<e.length;++n)t+=e[n].length;var r=new Uint8Array(t),i=0;for(n=0,t=0;n<e.length;t+=i,++n)if(i=e[n].length,e[n]instanceof Uint8Array)r.set(e[n],t);else{if(typeof e[n]=="string")throw"wtf";r.set(new Uint8Array(e[n]),t)}return r}return[].concat.apply([],e.map(function(s){return Array.isArray(s)?s:[].slice.call(s)}))};function qP(e){for(var n=[],t=0,r=e.length+250,i=Xi(e.length+255),s=0;s<e.length;++s){var o=e.charCodeAt(s);if(o<128)i[t++]=o;else if(o<2048)i[t++]=192|o>>6&31,i[t++]=128|o&63;else if(o>=55296&&o<57344){o=(o&1023)+64;var a=e.charCodeAt(++s)&1023;i[t++]=240|o>>8&7,i[t++]=128|o>>2&63,i[t++]=128|a>>6&15|(o&3)<<4,i[t++]=128|a&63}else i[t++]=224|o>>12&15,i[t++]=128|o>>6&63,i[t++]=128|o&63;t>r&&(n.push(i.slice(0,t)),t=0,i=Xi(65535),r=65530)}return n.push(i.slice(0,t)),Gi(n)}var un=/\u0000/g,Hc=/[\u0001-\u0006]/g;function ia(e){for(var n="",t=e.length-1;t>=0;)n+=e.charAt(t--);return n}function yr(e,n){var t=""+e;return t.length>=n?t:vt("0",n-t.length)+t}function Ig(e,n){var t=""+e;return t.length>=n?t:vt(" ",n-t.length)+t}function gd(e,n){var t=""+e;return t.length>=n?t:t+vt(" ",n-t.length)}function KP(e,n){var t=""+Math.round(e);return t.length>=n?t:vt("0",n-t.length)+t}function YP(e,n){var t=""+e;return t.length>=n?t:vt("0",n-t.length)+t}var vT=Math.pow(2,32);function na(e,n){if(e>vT||e<-vT)return KP(e,n);var t=Math.round(e);return YP(t,n)}function vd(e,n){return n=n||0,e.length>=7+n&&(e.charCodeAt(n)|32)===103&&(e.charCodeAt(n+1)|32)===101&&(e.charCodeAt(n+2)|32)===110&&(e.charCodeAt(n+3)|32)===101&&(e.charCodeAt(n+4)|32)===114&&(e.charCodeAt(n+5)|32)===97&&(e.charCodeAt(n+6)|32)===108}var _T=[["Sun","Sunday"],["Mon","Monday"],["Tue","Tuesday"],["Wed","Wednesday"],["Thu","Thursday"],["Fri","Friday"],["Sat","Saturday"]],eg=[["J","Jan","January"],["F","Feb","February"],["M","Mar","March"],["A","Apr","April"],["M","May","May"],["J","Jun","June"],["J","Jul","July"],["A","Aug","August"],["S","Sep","September"],["O","Oct","October"],["N","Nov","November"],["D","Dec","December"]];function XP(e){return e||(e={}),e[0]="General",e[1]="0",e[2]="0.00",e[3]="#,##0",e[4]="#,##0.00",e[9]="0%",e[10]="0.00%",e[11]="0.00E+00",e[12]="# ?/?",e[13]="# ??/??",e[14]="m/d/yy",e[15]="d-mmm-yy",e[16]="d-mmm",e[17]="mmm-yy",e[18]="h:mm AM/PM",e[19]="h:mm:ss AM/PM",e[20]="h:mm",e[21]="h:mm:ss",e[22]="m/d/yy h:mm",e[37]="#,##0 ;(#,##0)",e[38]="#,##0 ;[Red](#,##0)",e[39]="#,##0.00;(#,##0.00)",e[40]="#,##0.00;[Red](#,##0.00)",e[45]="mm:ss",e[46]="[h]:mm:ss",e[47]="mmss.0",e[48]="##0.0E+0",e[49]="@",e[56]='"\u4E0A\u5348/\u4E0B\u5348 "hh"\u6642"mm"\u5206"ss"\u79D2 "',e}var Ae={0:"General",1:"0",2:"0.00",3:"#,##0",4:"#,##0.00",9:"0%",10:"0.00%",11:"0.00E+00",12:"# ?/?",13:"# ??/??",14:"m/d/yy",15:"d-mmm-yy",16:"d-mmm",17:"mmm-yy",18:"h:mm AM/PM",19:"h:mm:ss AM/PM",20:"h:mm",21:"h:mm:ss",22:"m/d/yy h:mm",37:"#,##0 ;(#,##0)",38:"#,##0 ;[Red](#,##0)",39:"#,##0.00;(#,##0.00)",40:"#,##0.00;[Red](#,##0.00)",45:"mm:ss",46:"[h]:mm:ss",47:"mmss.0",48:"##0.0E+0",49:"@",56:'"\u4E0A\u5348/\u4E0B\u5348 "hh"\u6642"mm"\u5206"ss"\u79D2 "'},xT={5:37,6:38,7:39,8:40,23:0,24:0,25:0,26:0,27:14,28:14,29:14,30:14,31:14,50:14,51:14,52:14,53:14,54:14,55:14,56:14,57:14,58:14,59:1,60:2,61:3,62:4,67:9,68:10,69:12,70:13,71:14,72:14,73:15,74:16,75:17,76:20,77:21,78:22,79:45,80:46,81:47,82:0},QP={5:'"$"#,##0_);\\("$"#,##0\\)',63:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',41:'_(* #,##0_);_(* \\(#,##0\\);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* \\(#,##0\\);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* \\(#,##0.00\\);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* \\(#,##0.00\\);_("$"* "-"??_);_(@_)'};function _d(e,n,t){for(var r=e<0?-1:1,i=e*r,s=0,o=1,a=0,c=1,l=0,u=0,f=Math.floor(i);l<n&&(f=Math.floor(i),a=f*o+s,u=f*l+c,!(i-f<5e-8));)i=1/(i-f),s=o,o=a,c=l,l=u;if(u>n&&(l>n?(u=c,a=s):(u=l,a=o)),!t)return[0,r*a,u];var d=Math.floor(r*a/u);return[d,r*a-d*u,u]}function Fs(e,n,t){if(e>2958465||e<0)return null;var r=e|0,i=Math.floor(86400*(e-r)),s=0,o=[],a={D:r,T:i,u:86400*(e-r)-i,y:0,m:0,d:0,H:0,M:0,S:0,q:0};if(Math.abs(a.u)<1e-6&&(a.u=0),n&&n.date1904&&(r+=1462),a.u>.9999&&(a.u=0,++i==86400&&(a.T=i=0,++r,++a.D)),r===60)o=t?[1317,10,29]:[1900,2,29],s=3;else if(r===0)o=t?[1317,8,29]:[1900,1,0],s=6;else{r>60&&--r;var c=new Date(1900,0,1);c.setDate(c.getDate()+r-1),o=[c.getFullYear(),c.getMonth()+1,c.getDate()],s=c.getDay(),r<60&&(s=(s+6)%7),t&&(s=rL(c,o))}return a.y=o[0],a.m=o[1],a.d=o[2],a.S=i%60,i=Math.floor(i/60),a.M=i%60,i=Math.floor(i/60),a.H=i,a.q=s,a}var yI=new Date(1899,11,31,0,0,0),ZP=yI.getTime(),JP=new Date(1900,2,1,0,0,0);function wI(e,n){var t=e.getTime();return n?t-=1461*24*60*60*1e3:e>=JP&&(t+=24*60*60*1e3),(t-(ZP+(e.getTimezoneOffset()-yI.getTimezoneOffset())*6e4))/(24*60*60*1e3)}function Cg(e){return e.indexOf(".")==-1?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)$/,"$1")}function eL(e){return e.indexOf("E")==-1?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)[Ee]/,"$1E").replace(/(E[+-])(\d)$/,"$10$2")}function tL(e){var n=e<0?12:11,t=Cg(e.toFixed(12));return t.length<=n||(t=e.toPrecision(10),t.length<=n)?t:e.toExponential(5)}function nL(e){var n=Cg(e.toFixed(11));return n.length>(e<0?12:11)||n==="0"||n==="-0"?e.toPrecision(6):n}function el(e){var n=Math.floor(Math.log(Math.abs(e))*Math.LOG10E),t;return n>=-4&&n<=-1?t=e.toPrecision(10+n):Math.abs(n)<=9?t=tL(e):n===10?t=e.toFixed(10).substr(0,12):t=nL(e),Cg(eL(t.toUpperCase()))}function Bs(e,n){switch(typeof e){case"string":return e;case"boolean":return e?"TRUE":"FALSE";case"number":return(e|0)===e?e.toString(10):el(e);case"undefined":return"";case"object":if(e==null)return"";if(e instanceof Date)return tr(14,wI(e,n&&n.date1904),n)}throw new Error("unsupported value in General format: "+e)}function rL(e,n){n[0]-=581;var t=e.getDay();return e<60&&(t=(t+6)%7),t}function iL(e,n,t,r){var i="",s=0,o=0,a=t.y,c,l=0;switch(e){case 98:a=t.y+543;case 121:switch(n.length){case 1:case 2:c=a%100,l=2;break;default:c=a%1e4,l=4;break}break;case 109:switch(n.length){case 1:case 2:c=t.m,l=n.length;break;case 3:return eg[t.m-1][1];case 5:return eg[t.m-1][0];default:return eg[t.m-1][2]}break;case 100:switch(n.length){case 1:case 2:c=t.d,l=n.length;break;case 3:return _T[t.q][0];default:return _T[t.q][1]}break;case 104:switch(n.length){case 1:case 2:c=1+(t.H+11)%12,l=n.length;break;default:throw"bad hour format: "+n}break;case 72:switch(n.length){case 1:case 2:c=t.H,l=n.length;break;default:throw"bad hour format: "+n}break;case 77:switch(n.length){case 1:case 2:c=t.M,l=n.length;break;default:throw"bad minute format: "+n}break;case 115:if(n!="s"&&n!="ss"&&n!=".0"&&n!=".00"&&n!=".000")throw"bad second format: "+n;return t.u===0&&(n=="s"||n=="ss")?yr(t.S,n.length):(r>=2?o=r===3?1e3:100:o=r===1?10:1,s=Math.round(o*(t.S+t.u)),s>=60*o&&(s=0),n==="s"?s===0?"0":""+s/o:(i=yr(s,2+r),n==="ss"?i.substr(0,2):"."+i.substr(2,n.length-1)));case 90:switch(n){case"[h]":case"[hh]":c=t.D*24+t.H;break;case"[m]":case"[mm]":c=(t.D*24+t.H)*60+t.M;break;case"[s]":case"[ss]":c=((t.D*24+t.H)*60+t.M)*60+Math.round(t.S+t.u);break;default:throw"bad abstime format: "+n}l=n.length===3?1:2;break;case 101:c=a,l=1;break}var u=l>0?yr(c,l):"";return u}function Ki(e){var n=3;if(e.length<=n)return e;for(var t=e.length%n,r=e.substr(0,t);t!=e.length;t+=n)r+=(r.length>0?",":"")+e.substr(t,n);return r}var EI=/%/g;function sL(e,n,t){var r=n.replace(EI,""),i=n.length-r.length;return mi(e,r,t*Math.pow(10,2*i))+vt("%",i)}function oL(e,n,t){for(var r=n.length-1;n.charCodeAt(r-1)===44;)--r;return mi(e,n.substr(0,r),t/Math.pow(10,3*(n.length-r)))}function TI(e,n){var t,r=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(n==0)return"0.0E+0";if(n<0)return"-"+TI(e,-n);var i=e.indexOf(".");i===-1&&(i=e.indexOf("E"));var s=Math.floor(Math.log(n)*Math.LOG10E)%i;if(s<0&&(s+=i),t=(n/Math.pow(10,s)).toPrecision(r+1+(i+s)%i),t.indexOf("e")===-1){var o=Math.floor(Math.log(n)*Math.LOG10E);for(t.indexOf(".")===-1?t=t.charAt(0)+"."+t.substr(1)+"E+"+(o-t.length+s):t+="E+"+(o-s);t.substr(0,2)==="0.";)t=t.charAt(0)+t.substr(2,i)+"."+t.substr(2+i),t=t.replace(/^0+([1-9])/,"$1").replace(/^0+\./,"0.");t=t.replace(/\+-/,"-")}t=t.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(a,c,l,u){return c+l+u.substr(0,(i+s)%i)+"."+u.substr(s)+"E"})}else t=n.toExponential(r);return e.match(/E\+00$/)&&t.match(/e[+-]\d$/)&&(t=t.substr(0,t.length-1)+"0"+t.charAt(t.length-1)),e.match(/E\-/)&&t.match(/e\+/)&&(t=t.replace(/e\+/,"e")),t.replace("e","E")}var II=/# (\?+)( ?)\/( ?)(\d+)/;function aL(e,n,t){var r=parseInt(e[4],10),i=Math.round(n*r),s=Math.floor(i/r),o=i-s*r,a=r;return t+(s===0?"":""+s)+" "+(o===0?vt(" ",e[1].length+1+e[4].length):Ig(o,e[1].length)+e[2]+"/"+e[3]+yr(a,e[4].length))}function cL(e,n,t){return t+(n===0?"":""+n)+vt(" ",e[1].length+2+e[4].length)}var CI=/^#*0*\.([0#]+)/,SI=/\).*[0#]/,DI=/\(###\) ###\\?-####/;function xn(e){for(var n="",t,r=0;r!=e.length;++r)switch(t=e.charCodeAt(r)){case 35:break;case 63:n+=" ";break;case 48:n+="0";break;default:n+=String.fromCharCode(t)}return n}function yT(e,n){var t=Math.pow(10,n);return""+Math.round(e*t)/t}function wT(e,n){var t=e-Math.floor(e),r=Math.pow(10,n);return n<(""+Math.round(t*r)).length?0:Math.round(t*r)}function lL(e,n){return n<(""+Math.round((e-Math.floor(e))*Math.pow(10,n))).length?1:0}function uL(e){return e<2147483647&&e>-2147483648?""+(e>=0?e|0:e-1|0):""+Math.floor(e)}function Jn(e,n,t){if(e.charCodeAt(0)===40&&!n.match(SI)){var r=n.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return t>=0?Jn("n",r,t):"("+Jn("n",r,-t)+")"}if(n.charCodeAt(n.length-1)===44)return oL(e,n,t);if(n.indexOf("%")!==-1)return sL(e,n,t);if(n.indexOf("E")!==-1)return TI(n,t);if(n.charCodeAt(0)===36)return"$"+Jn(e,n.substr(n.charAt(1)==" "?2:1),t);var i,s,o,a,c=Math.abs(t),l=t<0?"-":"";if(n.match(/^00+$/))return l+na(c,n.length);if(n.match(/^[#?]+$/))return i=na(t,0),i==="0"&&(i=""),i.length>n.length?i:xn(n.substr(0,n.length-i.length))+i;if(s=n.match(II))return aL(s,c,l);if(n.match(/^#+0+$/))return l+na(c,n.length-n.indexOf("0"));if(s=n.match(CI))return i=yT(t,s[1].length).replace(/^([^\.]+)$/,"$1."+xn(s[1])).replace(/\.$/,"."+xn(s[1])).replace(/\.(\d*)$/,function(m,p){return"."+p+vt("0",xn(s[1]).length-p.length)}),n.indexOf("0.")!==-1?i:i.replace(/^0\./,".");if(n=n.replace(/^#+([0.])/,"$1"),s=n.match(/^(0*)\.(#*)$/))return l+yT(c,s[2].length).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,s[1].length?"0.":".");if(s=n.match(/^#{1,3},##0(\.?)$/))return l+Ki(na(c,0));if(s=n.match(/^#,##0\.([#0]*0)$/))return t<0?"-"+Jn(e,n,-t):Ki(""+(Math.floor(t)+lL(t,s[1].length)))+"."+yr(wT(t,s[1].length),s[1].length);if(s=n.match(/^#,#*,#0/))return Jn(e,n.replace(/^#,#*,/,""),t);if(s=n.match(/^([0#]+)(\\?-([0#]+))+$/))return i=ia(Jn(e,n.replace(/[\\-]/g,""),t)),o=0,ia(ia(n.replace(/\\/g,"")).replace(/[0#]/g,function(m){return o<i.length?i.charAt(o++):m==="0"?"0":""}));if(n.match(DI))return i=Jn(e,"##########",t),"("+i.substr(0,3)+") "+i.substr(3,3)+"-"+i.substr(6);var u="";if(s=n.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return o=Math.min(s[4].length,7),a=_d(c,Math.pow(10,o)-1,!1),i=""+l,u=mi("n",s[1],a[1]),u.charAt(u.length-1)==" "&&(u=u.substr(0,u.length-1)+"0"),i+=u+s[2]+"/"+s[3],u=gd(a[2],o),u.length<s[4].length&&(u=xn(s[4].substr(s[4].length-u.length))+u),i+=u,i;if(s=n.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return o=Math.min(Math.max(s[1].length,s[4].length),7),a=_d(c,Math.pow(10,o)-1,!0),l+(a[0]||(a[1]?"":"0"))+" "+(a[1]?Ig(a[1],o)+s[2]+"/"+s[3]+gd(a[2],o):vt(" ",2*o+1+s[2].length+s[3].length));if(s=n.match(/^[#0?]+$/))return i=na(t,0),n.length<=i.length?i:xn(n.substr(0,n.length-i.length))+i;if(s=n.match(/^([#0?]+)\.([#0]+)$/)){i=""+t.toFixed(Math.min(s[2].length,10)).replace(/([^0])0+$/,"$1"),o=i.indexOf(".");var f=n.indexOf(".")-o,d=n.length-i.length-f;return xn(n.substr(0,f)+i+n.substr(n.length-d))}if(s=n.match(/^00,000\.([#0]*0)$/))return o=wT(t,s[1].length),t<0?"-"+Jn(e,n,-t):Ki(uL(t)).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(m){return"00,"+(m.length<3?yr(0,3-m.length):"")+m})+"."+yr(o,s[1].length);switch(n){case"###,##0.00":return Jn(e,"#,##0.00",t);case"###,###":case"##,###":case"#,###":var h=Ki(na(c,0));return h!=="0"?l+h:"";case"###,###.00":return Jn(e,"###,##0.00",t).replace(/^0\./,".");case"#,###.00":return Jn(e,"#,##0.00",t).replace(/^0\./,".");default:}throw new Error("unsupported format |"+n+"|")}function fL(e,n,t){for(var r=n.length-1;n.charCodeAt(r-1)===44;)--r;return mi(e,n.substr(0,r),t/Math.pow(10,3*(n.length-r)))}function dL(e,n,t){var r=n.replace(EI,""),i=n.length-r.length;return mi(e,r,t*Math.pow(10,2*i))+vt("%",i)}function bI(e,n){var t,r=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(n==0)return"0.0E+0";if(n<0)return"-"+bI(e,-n);var i=e.indexOf(".");i===-1&&(i=e.indexOf("E"));var s=Math.floor(Math.log(n)*Math.LOG10E)%i;if(s<0&&(s+=i),t=(n/Math.pow(10,s)).toPrecision(r+1+(i+s)%i),!t.match(/[Ee]/)){var o=Math.floor(Math.log(n)*Math.LOG10E);t.indexOf(".")===-1?t=t.charAt(0)+"."+t.substr(1)+"E+"+(o-t.length+s):t+="E+"+(o-s),t=t.replace(/\+-/,"-")}t=t.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(a,c,l,u){return c+l+u.substr(0,(i+s)%i)+"."+u.substr(s)+"E"})}else t=n.toExponential(r);return e.match(/E\+00$/)&&t.match(/e[+-]\d$/)&&(t=t.substr(0,t.length-1)+"0"+t.charAt(t.length-1)),e.match(/E\-/)&&t.match(/e\+/)&&(t=t.replace(/e\+/,"e")),t.replace("e","E")}function $r(e,n,t){if(e.charCodeAt(0)===40&&!n.match(SI)){var r=n.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return t>=0?$r("n",r,t):"("+$r("n",r,-t)+")"}if(n.charCodeAt(n.length-1)===44)return fL(e,n,t);if(n.indexOf("%")!==-1)return dL(e,n,t);if(n.indexOf("E")!==-1)return bI(n,t);if(n.charCodeAt(0)===36)return"$"+$r(e,n.substr(n.charAt(1)==" "?2:1),t);var i,s,o,a,c=Math.abs(t),l=t<0?"-":"";if(n.match(/^00+$/))return l+yr(c,n.length);if(n.match(/^[#?]+$/))return i=""+t,t===0&&(i=""),i.length>n.length?i:xn(n.substr(0,n.length-i.length))+i;if(s=n.match(II))return cL(s,c,l);if(n.match(/^#+0+$/))return l+yr(c,n.length-n.indexOf("0"));if(s=n.match(CI))return i=(""+t).replace(/^([^\.]+)$/,"$1."+xn(s[1])).replace(/\.$/,"."+xn(s[1])),i=i.replace(/\.(\d*)$/,function(m,p){return"."+p+vt("0",xn(s[1]).length-p.length)}),n.indexOf("0.")!==-1?i:i.replace(/^0\./,".");if(n=n.replace(/^#+([0.])/,"$1"),s=n.match(/^(0*)\.(#*)$/))return l+(""+c).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,s[1].length?"0.":".");if(s=n.match(/^#{1,3},##0(\.?)$/))return l+Ki(""+c);if(s=n.match(/^#,##0\.([#0]*0)$/))return t<0?"-"+$r(e,n,-t):Ki(""+t)+"."+vt("0",s[1].length);if(s=n.match(/^#,#*,#0/))return $r(e,n.replace(/^#,#*,/,""),t);if(s=n.match(/^([0#]+)(\\?-([0#]+))+$/))return i=ia($r(e,n.replace(/[\\-]/g,""),t)),o=0,ia(ia(n.replace(/\\/g,"")).replace(/[0#]/g,function(m){return o<i.length?i.charAt(o++):m==="0"?"0":""}));if(n.match(DI))return i=$r(e,"##########",t),"("+i.substr(0,3)+") "+i.substr(3,3)+"-"+i.substr(6);var u="";if(s=n.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return o=Math.min(s[4].length,7),a=_d(c,Math.pow(10,o)-1,!1),i=""+l,u=mi("n",s[1],a[1]),u.charAt(u.length-1)==" "&&(u=u.substr(0,u.length-1)+"0"),i+=u+s[2]+"/"+s[3],u=gd(a[2],o),u.length<s[4].length&&(u=xn(s[4].substr(s[4].length-u.length))+u),i+=u,i;if(s=n.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return o=Math.min(Math.max(s[1].length,s[4].length),7),a=_d(c,Math.pow(10,o)-1,!0),l+(a[0]||(a[1]?"":"0"))+" "+(a[1]?Ig(a[1],o)+s[2]+"/"+s[3]+gd(a[2],o):vt(" ",2*o+1+s[2].length+s[3].length));if(s=n.match(/^[#0?]+$/))return i=""+t,n.length<=i.length?i:xn(n.substr(0,n.length-i.length))+i;if(s=n.match(/^([#0]+)\.([#0]+)$/)){i=""+t.toFixed(Math.min(s[2].length,10)).replace(/([^0])0+$/,"$1"),o=i.indexOf(".");var f=n.indexOf(".")-o,d=n.length-i.length-f;return xn(n.substr(0,f)+i+n.substr(n.length-d))}if(s=n.match(/^00,000\.([#0]*0)$/))return t<0?"-"+$r(e,n,-t):Ki(""+t).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(m){return"00,"+(m.length<3?yr(0,3-m.length):"")+m})+"."+yr(0,s[1].length);switch(n){case"###,###":case"##,###":case"#,###":var h=Ki(""+c);return h!=="0"?l+h:"";default:if(n.match(/\.[0#?]*$/))return $r(e,n.slice(0,n.lastIndexOf(".")),t)+xn(n.slice(n.lastIndexOf(".")))}throw new Error("unsupported format |"+n+"|")}function mi(e,n,t){return(t|0)===t?$r(e,n,t):Jn(e,n,t)}function hL(e){for(var n=[],t=!1,r=0,i=0;r<e.length;++r)switch(e.charCodeAt(r)){case 34:t=!t;break;case 95:case 42:case 92:++r;break;case 59:n[n.length]=e.substr(i,r-i),i=r+1}if(n[n.length]=e.substr(i),t===!0)throw new Error("Format |"+e+"| unterminated string ");return n}var AI=/\[[HhMmSs\u0E0A\u0E19\u0E17]*\]/;function ua(e){for(var n=0,t="",r="";n<e.length;)switch(t=e.charAt(n)){case"G":vd(e,n)&&(n+=6),n++;break;case'"':for(;e.charCodeAt(++n)!==34&&n<e.length;);++n;break;case"\\":n+=2;break;case"_":n+=2;break;case"@":++n;break;case"B":case"b":if(e.charAt(n+1)==="1"||e.charAt(n+1)==="2")return!0;case"M":case"D":case"Y":case"H":case"S":case"E":case"m":case"d":case"y":case"h":case"s":case"e":case"g":return!0;case"A":case"a":case"\u4E0A":if(e.substr(n,3).toUpperCase()==="A/P"||e.substr(n,5).toUpperCase()==="AM/PM"||e.substr(n,5).toUpperCase()==="\u4E0A\u5348/\u4E0B\u5348")return!0;++n;break;case"[":for(r=t;e.charAt(n++)!=="]"&&n<e.length;)r+=e.charAt(n);if(r.match(AI))return!0;break;case".":case"0":case"#":for(;n<e.length&&("0#?.,E+-%".indexOf(t=e.charAt(++n))>-1||t=="\\"&&e.charAt(n+1)=="-"&&"0#".indexOf(e.charAt(n+2))>-1););break;case"?":for(;e.charAt(++n)===t;);break;case"*":++n,(e.charAt(n)==" "||e.charAt(n)=="*")&&++n;break;case"(":case")":++n;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(;n<e.length&&"0123456789".indexOf(e.charAt(++n))>-1;);break;case" ":++n;break;default:++n;break}return!1}function pL(e,n,t,r){for(var i=[],s="",o=0,a="",c="t",l,u,f,d="H";o<e.length;)switch(a=e.charAt(o)){case"G":if(!vd(e,o))throw new Error("unrecognized character "+a+" in "+e);i[i.length]={t:"G",v:"General"},o+=7;break;case'"':for(s="";(f=e.charCodeAt(++o))!==34&&o<e.length;)s+=String.fromCharCode(f);i[i.length]={t:"t",v:s},++o;break;case"\\":var h=e.charAt(++o),m=h==="("||h===")"?h:"t";i[i.length]={t:m,v:h},++o;break;case"_":i[i.length]={t:"t",v:" "},o+=2;break;case"@":i[i.length]={t:"T",v:n},++o;break;case"B":case"b":if(e.charAt(o+1)==="1"||e.charAt(o+1)==="2"){if(l==null&&(l=Fs(n,t,e.charAt(o+1)==="2"),l==null))return"";i[i.length]={t:"X",v:e.substr(o,2)},c=a,o+=2;break}case"M":case"D":case"Y":case"H":case"S":case"E":a=a.toLowerCase();case"m":case"d":case"y":case"h":case"s":case"e":case"g":if(n<0||l==null&&(l=Fs(n,t),l==null))return"";for(s=a;++o<e.length&&e.charAt(o).toLowerCase()===a;)s+=a;a==="m"&&c.toLowerCase()==="h"&&(a="M"),a==="h"&&(a=d),i[i.length]={t:a,v:s},c=a;break;case"A":case"a":case"\u4E0A":var p={t:a,v:a};if(l==null&&(l=Fs(n,t)),e.substr(o,3).toUpperCase()==="A/P"?(l!=null&&(p.v=l.H>=12?"P":"A"),p.t="T",d="h",o+=3):e.substr(o,5).toUpperCase()==="AM/PM"?(l!=null&&(p.v=l.H>=12?"PM":"AM"),p.t="T",o+=5,d="h"):e.substr(o,5).toUpperCase()==="\u4E0A\u5348/\u4E0B\u5348"?(l!=null&&(p.v=l.H>=12?"\u4E0B\u5348":"\u4E0A\u5348"),p.t="T",o+=5,d="h"):(p.t="t",++o),l==null&&p.t==="T")return"";i[i.length]=p,c=a;break;case"[":for(s=a;e.charAt(o++)!=="]"&&o<e.length;)s+=e.charAt(o);if(s.slice(-1)!=="]")throw'unterminated "[" block: |'+s+"|";if(s.match(AI)){if(l==null&&(l=Fs(n,t),l==null))return"";i[i.length]={t:"Z",v:s.toLowerCase()},c=s.charAt(1)}else s.indexOf("$")>-1&&(s=(s.match(/\$([^-\[\]]*)/)||[])[1]||"$",ua(e)||(i[i.length]={t:"t",v:s}));break;case".":if(l!=null){for(s=a;++o<e.length&&(a=e.charAt(o))==="0";)s+=a;i[i.length]={t:"s",v:s};break}case"0":case"#":for(s=a;++o<e.length&&"0#?.,E+-%".indexOf(a=e.charAt(o))>-1;)s+=a;i[i.length]={t:"n",v:s};break;case"?":for(s=a;e.charAt(++o)===a;)s+=a;i[i.length]={t:a,v:s},c=a;break;case"*":++o,(e.charAt(o)==" "||e.charAt(o)=="*")&&++o;break;case"(":case")":i[i.length]={t:r===1?"t":a,v:a},++o;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(s=a;o<e.length&&"0123456789".indexOf(e.charAt(++o))>-1;)s+=e.charAt(o);i[i.length]={t:"D",v:s};break;case" ":i[i.length]={t:a,v:a},++o;break;case"$":i[i.length]={t:"t",v:"$"},++o;break;default:if(",$-+/():!^&'~{}<>=\u20ACacfijklopqrtuvwxzP".indexOf(a)===-1)throw new Error("unrecognized character "+a+" in "+e);i[i.length]={t:"t",v:a},++o;break}var g=0,w=0,C;for(o=i.length-1,c="t";o>=0;--o)switch(i[o].t){case"h":case"H":i[o].t=d,c="h",g<1&&(g=1);break;case"s":(C=i[o].v.match(/\.0+$/))&&(w=Math.max(w,C[0].length-1)),g<3&&(g=3);case"d":case"y":case"M":case"e":c=i[o].t;break;case"m":c==="s"&&(i[o].t="M",g<2&&(g=2));break;case"X":break;case"Z":g<1&&i[o].v.match(/[Hh]/)&&(g=1),g<2&&i[o].v.match(/[Mm]/)&&(g=2),g<3&&i[o].v.match(/[Ss]/)&&(g=3)}switch(g){case 0:break;case 1:l.u>=.5&&(l.u=0,++l.S),l.S>=60&&(l.S=0,++l.M),l.M>=60&&(l.M=0,++l.H);break;case 2:l.u>=.5&&(l.u=0,++l.S),l.S>=60&&(l.S=0,++l.M);break}var _="",M;for(o=0;o<i.length;++o)switch(i[o].t){case"t":case"T":case" ":case"D":break;case"X":i[o].v="",i[o].t=";";break;case"d":case"m":case"y":case"h":case"H":case"M":case"s":case"e":case"b":case"Z":i[o].v=iL(i[o].t.charCodeAt(0),i[o].v,l,w),i[o].t="t";break;case"n":case"?":for(M=o+1;i[M]!=null&&((a=i[M].t)==="?"||a==="D"||(a===" "||a==="t")&&i[M+1]!=null&&(i[M+1].t==="?"||i[M+1].t==="t"&&i[M+1].v==="/")||i[o].t==="("&&(a===" "||a==="n"||a===")")||a==="t"&&(i[M].v==="/"||i[M].v===" "&&i[M+1]!=null&&i[M+1].t=="?"));)i[o].v+=i[M].v,i[M]={v:"",t:";"},++M;_+=i[o].v,o=M-1;break;case"G":i[o].t="t",i[o].v=Bs(n,t);break}var V="",A,S;if(_.length>0){_.charCodeAt(0)==40?(A=n<0&&_.charCodeAt(0)===45?-n:n,S=mi("n",_,A)):(A=n<0&&r>1?-n:n,S=mi("n",_,A),A<0&&i[0]&&i[0].t=="t"&&(S=S.substr(1),i[0].v="-"+i[0].v)),M=S.length-1;var F=i.length;for(o=0;o<i.length;++o)if(i[o]!=null&&i[o].t!="t"&&i[o].v.indexOf(".")>-1){F=o;break}var N=i.length;if(F===i.length&&S.indexOf("E")===-1){for(o=i.length-1;o>=0;--o)i[o]==null||"n?".indexOf(i[o].t)===-1||(M>=i[o].v.length-1?(M-=i[o].v.length,i[o].v=S.substr(M+1,i[o].v.length)):M<0?i[o].v="":(i[o].v=S.substr(0,M+1),M=-1),i[o].t="t",N=o);M>=0&&N<i.length&&(i[N].v=S.substr(0,M+1)+i[N].v)}else if(F!==i.length&&S.indexOf("E")===-1){for(M=S.indexOf(".")-1,o=F;o>=0;--o)if(!(i[o]==null||"n?".indexOf(i[o].t)===-1)){for(u=i[o].v.indexOf(".")>-1&&o===F?i[o].v.indexOf(".")-1:i[o].v.length-1,V=i[o].v.substr(u+1);u>=0;--u)M>=0&&(i[o].v.charAt(u)==="0"||i[o].v.charAt(u)==="#")&&(V=S.charAt(M--)+V);i[o].v=V,i[o].t="t",N=o}for(M>=0&&N<i.length&&(i[N].v=S.substr(0,M+1)+i[N].v),M=S.indexOf(".")+1,o=F;o<i.length;++o)if(!(i[o]==null||"n?(".indexOf(i[o].t)===-1&&o!==F)){for(u=i[o].v.indexOf(".")>-1&&o===F?i[o].v.indexOf(".")+1:0,V=i[o].v.substr(0,u);u<i[o].v.length;++u)M<S.length&&(V+=S.charAt(M++));i[o].v=V,i[o].t="t",N=o}}}for(o=0;o<i.length;++o)i[o]!=null&&"n?".indexOf(i[o].t)>-1&&(A=r>1&&n<0&&o>0&&i[o-1].v==="-"?-n:n,i[o].v=mi(i[o].t,i[o].v,A),i[o].t="t");var H="";for(o=0;o!==i.length;++o)i[o]!=null&&(H+=i[o].v);return H}var ET=/\[(=|>[=]?|<[>=]?)(-?\d+(?:\.\d*)?)\]/;function TT(e,n){if(n==null)return!1;var t=parseFloat(n[2]);switch(n[1]){case"=":if(e==t)return!0;break;case">":if(e>t)return!0;break;case"<":if(e<t)return!0;break;case"<>":if(e!=t)return!0;break;case">=":if(e>=t)return!0;break;case"<=":if(e<=t)return!0;break}return!1}function mL(e,n){var t=hL(e),r=t.length,i=t[r-1].indexOf("@");if(r<4&&i>-1&&--r,t.length>4)throw new Error("cannot find right format for |"+t.join("|")+"|");if(typeof n!="number")return[4,t.length===4||i>-1?t[t.length-1]:"@"];switch(t.length){case 1:t=i>-1?["General","General","General",t[0]]:[t[0],t[0],t[0],"@"];break;case 2:t=i>-1?[t[0],t[0],t[0],t[1]]:[t[0],t[1],t[0],"@"];break;case 3:t=i>-1?[t[0],t[1],t[0],t[2]]:[t[0],t[1],t[2],"@"];break;case 4:break}var s=n>0?t[0]:n<0?t[1]:t[2];if(t[0].indexOf("[")===-1&&t[1].indexOf("[")===-1)return[r,s];if(t[0].match(/\[[=<>]/)!=null||t[1].match(/\[[=<>]/)!=null){var o=t[0].match(ET),a=t[1].match(ET);return TT(n,o)?[r,t[0]]:TT(n,a)?[r,t[1]]:[r,t[o!=null&&a!=null?2:1]]}return[r,s]}function tr(e,n,t){t==null&&(t={});var r="";switch(typeof e){case"string":e=="m/d/yy"&&t.dateNF?r=t.dateNF:r=e;break;case"number":e==14&&t.dateNF?r=t.dateNF:r=(t.table!=null?t.table:Ae)[e],r==null&&(r=t.table&&t.table[xT[e]]||Ae[xT[e]]),r==null&&(r=QP[e]||"General");break}if(vd(r,0))return Bs(n,t);n instanceof Date&&(n=wI(n,t.date1904));var i=mL(r,n);if(vd(i[1]))return Bs(n,t);if(n===!0)n="TRUE";else if(n===!1)n="FALSE";else if(n===""||n==null)return"";return pL(i[1],n,t,i[0])}function Ps(e,n){if(typeof n!="number"){n=+n||-1;for(var t=0;t<392;++t){if(Ae[t]==null){n<0&&(n=t);continue}if(Ae[t]==e){n=t;break}}n<0&&(n=391)}return Ae[n]=e,n}function kI(){Ae=XP()}var gL={5:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',23:"General",24:"General",25:"General",26:"General",27:"m/d/yy",28:"m/d/yy",29:"m/d/yy",30:"m/d/yy",31:"m/d/yy",32:"h:mm:ss",33:"h:mm:ss",34:"h:mm:ss",35:"h:mm:ss",36:"m/d/yy",41:'_(* #,##0_);_(* (#,##0);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* (#,##0);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* (#,##0.00);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* (#,##0.00);_("$"* "-"??_);_(@_)',50:"m/d/yy",51:"m/d/yy",52:"m/d/yy",53:"m/d/yy",54:"m/d/yy",55:"m/d/yy",56:"m/d/yy",57:"m/d/yy",58:"m/d/yy",59:"0",60:"0.00",61:"#,##0",62:"#,##0.00",63:'"$"#,##0_);\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',67:"0%",68:"0.00%",69:"# ?/?",70:"# ??/??",71:"m/d/yy",72:"m/d/yy",73:"d-mmm-yy",74:"d-mmm",75:"mmm-yy",76:"h:mm",77:"h:mm:ss",78:"m/d/yy h:mm",79:"mm:ss",80:"[h]:mm:ss",81:"mmss.0"},NI=/[dD]+|[mM]+|[yYeE]+|[Hh]+|[Ss]+/g;function vL(e){var n=typeof e=="number"?Ae[e]:e;return n=n.replace(NI,"(\\d+)"),new RegExp("^"+n+"$")}function _L(e,n,t){var r=-1,i=-1,s=-1,o=-1,a=-1,c=-1;(n.match(NI)||[]).forEach(function(f,d){var h=parseInt(t[d+1],10);switch(f.toLowerCase().charAt(0)){case"y":r=h;break;case"d":s=h;break;case"h":o=h;break;case"s":c=h;break;case"m":o>=0?a=h:i=h;break}}),c>=0&&a==-1&&i>=0&&(a=i,i=-1);var l=(""+(r>=0?r:new Date().getFullYear())).slice(-4)+"-"+("00"+(i>=1?i:1)).slice(-2)+"-"+("00"+(s>=1?s:1)).slice(-2);l.length==7&&(l="0"+l),l.length==8&&(l="20"+l);var u=("00"+(o>=0?o:0)).slice(-2)+":"+("00"+(a>=0?a:0)).slice(-2)+":"+("00"+(c>=0?c:0)).slice(-2);return o==-1&&a==-1&&c==-1?l:r==-1&&i==-1&&s==-1?u:l+"T"+u}var xL=function(){var e={};e.version="1.2.0";function n(){for(var S=0,F=new Array(256),N=0;N!=256;++N)S=N,S=S&1?-306674912^S>>>1:S>>>1,S=S&1?-306674912^S>>>1:S>>>1,S=S&1?-306674912^S>>>1:S>>>1,S=S&1?-306674912^S>>>1:S>>>1,S=S&1?-306674912^S>>>1:S>>>1,S=S&1?-306674912^S>>>1:S>>>1,S=S&1?-306674912^S>>>1:S>>>1,S=S&1?-306674912^S>>>1:S>>>1,F[N]=S;return typeof Int32Array<"u"?new Int32Array(F):F}var t=n();function r(S){var F=0,N=0,H=0,W=typeof Int32Array<"u"?new Int32Array(4096):new Array(4096);for(H=0;H!=256;++H)W[H]=S[H];for(H=0;H!=256;++H)for(N=S[H],F=256+H;F<4096;F+=256)N=W[F]=N>>>8^S[N&255];var O=[];for(H=1;H!=16;++H)O[H-1]=typeof Int32Array<"u"?W.subarray(H*256,H*256+256):W.slice(H*256,H*256+256);return O}var i=r(t),s=i[0],o=i[1],a=i[2],c=i[3],l=i[4],u=i[5],f=i[6],d=i[7],h=i[8],m=i[9],p=i[10],g=i[11],w=i[12],C=i[13],_=i[14];function M(S,F){for(var N=F^-1,H=0,W=S.length;H<W;)N=N>>>8^t[(N^S.charCodeAt(H++))&255];return~N}function V(S,F){for(var N=F^-1,H=S.length-15,W=0;W<H;)N=_[S[W++]^N&255]^C[S[W++]^N>>8&255]^w[S[W++]^N>>16&255]^g[S[W++]^N>>>24]^p[S[W++]]^m[S[W++]]^h[S[W++]]^d[S[W++]]^f[S[W++]]^u[S[W++]]^l[S[W++]]^c[S[W++]]^a[S[W++]]^o[S[W++]]^s[S[W++]]^t[S[W++]];for(H+=15;W<H;)N=N>>>8^t[(N^S[W++])&255];return~N}function A(S,F){for(var N=F^-1,H=0,W=S.length,O=0,Q=0;H<W;)O=S.charCodeAt(H++),O<128?N=N>>>8^t[(N^O)&255]:O<2048?(N=N>>>8^t[(N^(192|O>>6&31))&255],N=N>>>8^t[(N^(128|O&63))&255]):O>=55296&&O<57344?(O=(O&1023)+64,Q=S.charCodeAt(H++)&1023,N=N>>>8^t[(N^(240|O>>8&7))&255],N=N>>>8^t[(N^(128|O>>2&63))&255],N=N>>>8^t[(N^(128|Q>>6&15|(O&3)<<4))&255],N=N>>>8^t[(N^(128|Q&63))&255]):(N=N>>>8^t[(N^(224|O>>12&15))&255],N=N>>>8^t[(N^(128|O>>6&63))&255],N=N>>>8^t[(N^(128|O&63))&255]);return~N}return e.table=t,e.bstr=M,e.buf=V,e.str=A,e}(),ze=function(){var n={};n.version="1.2.1";function t(v,E){for(var x=v.split("/"),y=E.split("/"),T=0,I=0,P=Math.min(x.length,y.length);T<P;++T){if(I=x[T].length-y[T].length)return I;if(x[T]!=y[T])return x[T]<y[T]?-1:1}return x.length-y.length}function r(v){if(v.charAt(v.length-1)=="/")return v.slice(0,-1).indexOf("/")===-1?v:r(v.slice(0,-1));var E=v.lastIndexOf("/");return E===-1?v:v.slice(0,E+1)}function i(v){if(v.charAt(v.length-1)=="/")return i(v.slice(0,-1));var E=v.lastIndexOf("/");return E===-1?v:v.slice(E+1)}function s(v,E){typeof E=="string"&&(E=new Date(E));var x=E.getHours();x=x<<6|E.getMinutes(),x=x<<5|E.getSeconds()>>>1,v.write_shift(2,x);var y=E.getFullYear()-1980;y=y<<4|E.getMonth()+1,y=y<<5|E.getDate(),v.write_shift(2,y)}function o(v){var E=v.read_shift(2)&65535,x=v.read_shift(2)&65535,y=new Date,T=x&31;x>>>=5;var I=x&15;x>>>=4,y.setMilliseconds(0),y.setFullYear(x+1980),y.setMonth(I-1),y.setDate(T);var P=E&31;E>>>=5;var z=E&63;return E>>>=6,y.setHours(E),y.setMinutes(z),y.setSeconds(P<<1),y}function a(v){Jt(v,0);for(var E={},x=0;v.l<=v.length-4;){var y=v.read_shift(2),T=v.read_shift(2),I=v.l+T,P={};switch(y){case 21589:x=v.read_shift(1),x&1&&(P.mtime=v.read_shift(4)),T>5&&(x&2&&(P.atime=v.read_shift(4)),x&4&&(P.ctime=v.read_shift(4))),P.mtime&&(P.mt=new Date(P.mtime*1e3));break}v.l=I,E[y]=P}return E}var c;function l(){return c||(c={})}function u(v,E){if(v[0]==80&&v[1]==75)return px(v,E);if((v[0]|32)==109&&(v[1]|32)==105)return aA(v,E);if(v.length<512)throw new Error("CFB file size "+v.length+" < 512");var x=3,y=512,T=0,I=0,P=0,z=0,B=0,L=[],j=v.slice(0,512);Jt(j,0);var Y=f(j);switch(x=Y[0],x){case 3:y=512;break;case 4:y=4096;break;case 0:if(Y[1]==0)return px(v,E);default:throw new Error("Major Version: Expected 3 or 4 saw "+x)}y!==512&&(j=v.slice(0,y),Jt(j,28));var J=v.slice(0,y);d(j,x);var le=j.read_shift(4,"i");if(x===3&&le!==0)throw new Error("# Directory Sectors: Expected 0 saw "+le);j.l+=4,P=j.read_shift(4,"i"),j.l+=4,j.chk("00100000","Mini Stream Cutoff Size: "),z=j.read_shift(4,"i"),T=j.read_shift(4,"i"),B=j.read_shift(4,"i"),I=j.read_shift(4,"i");for(var ee=-1,re=0;re<109&&(ee=j.read_shift(4,"i"),!(ee<0));++re)L[re]=ee;var Ie=h(v,y);g(B,I,Ie,y,L);var ut=C(Ie,P,L,y);ut[P].name="!Directory",T>0&&z!==Q&&(ut[z].name="!MiniFAT"),ut[L[0]].name="!FAT",ut.fat_addrs=L,ut.ssz=y;var In={},It=[],On=[],Fa=[];_(P,ut,Ie,It,T,In,On,z),m(On,Fa,It),It.shift();var Pa={FileIndex:On,FullPaths:Fa};return E&&E.raw&&(Pa.raw={header:J,sectors:Ie}),Pa}function f(v){if(v[v.l]==80&&v[v.l+1]==75)return[0,0];v.chk(pe,"Header Signature: "),v.l+=16;var E=v.read_shift(2,"u");return[v.read_shift(2,"u"),E]}function d(v,E){var x=9;switch(v.l+=2,x=v.read_shift(2)){case 9:if(E!=3)throw new Error("Sector Shift: Expected 9 saw "+x);break;case 12:if(E!=4)throw new Error("Sector Shift: Expected 12 saw "+x);break;default:throw new Error("Sector Shift: Expected 9 or 12 saw "+x)}v.chk("0600","Mini Sector Shift: "),v.chk("000000000000","Reserved: ")}function h(v,E){for(var x=Math.ceil(v.length/E)-1,y=[],T=1;T<x;++T)y[T-1]=v.slice(T*E,(T+1)*E);return y[x-1]=v.slice(x*E),y}function m(v,E,x){for(var y=0,T=0,I=0,P=0,z=0,B=x.length,L=[],j=[];y<B;++y)L[y]=j[y]=y,E[y]=x[y];for(;z<j.length;++z)y=j[z],T=v[y].L,I=v[y].R,P=v[y].C,L[y]===y&&(T!==-1&&L[T]!==T&&(L[y]=L[T]),I!==-1&&L[I]!==I&&(L[y]=L[I])),P!==-1&&(L[P]=y),T!==-1&&y!=L[y]&&(L[T]=L[y],j.lastIndexOf(T)<z&&j.push(T)),I!==-1&&y!=L[y]&&(L[I]=L[y],j.lastIndexOf(I)<z&&j.push(I));for(y=1;y<B;++y)L[y]===y&&(I!==-1&&L[I]!==I?L[y]=L[I]:T!==-1&&L[T]!==T&&(L[y]=L[T]));for(y=1;y<B;++y)if(v[y].type!==0){if(z=y,z!=L[z])do z=L[z],E[y]=E[z]+"/"+E[y];while(z!==0&&L[z]!==-1&&z!=L[z]);L[y]=-1}for(E[0]+="/",y=1;y<B;++y)v[y].type!==2&&(E[y]+="/")}function p(v,E,x){for(var y=v.start,T=v.size,I=[],P=y;x&&T>0&&P>=0;)I.push(E.slice(P*O,P*O+O)),T-=O,P=Os(x,P*4);return I.length===0?kt(0):Gi(I).slice(0,v.size)}function g(v,E,x,y,T){var I=Q;if(v===Q){if(E!==0)throw new Error("DIFAT chain shorter than expected")}else if(v!==-1){var P=x[v],z=(y>>>2)-1;if(!P)return;for(var B=0;B<z&&(I=Os(P,B*4))!==Q;++B)T.push(I);g(Os(P,y-4),E-1,x,y,T)}}function w(v,E,x,y,T){var I=[],P=[];T||(T=[]);var z=y-1,B=0,L=0;for(B=E;B>=0;){T[B]=!0,I[I.length]=B,P.push(v[B]);var j=x[Math.floor(B*4/y)];if(L=B*4&z,y<4+L)throw new Error("FAT boundary crossed: "+B+" 4 "+y);if(!v[j])break;B=Os(v[j],L)}return{nodes:I,data:OT([P])}}function C(v,E,x,y){var T=v.length,I=[],P=[],z=[],B=[],L=y-1,j=0,Y=0,J=0,le=0;for(j=0;j<T;++j)if(z=[],J=j+E,J>=T&&(J-=T),!P[J]){B=[];var ee=[];for(Y=J;Y>=0;){ee[Y]=!0,P[Y]=!0,z[z.length]=Y,B.push(v[Y]);var re=x[Math.floor(Y*4/y)];if(le=Y*4&L,y<4+le)throw new Error("FAT boundary crossed: "+Y+" 4 "+y);if(!v[re]||(Y=Os(v[re],le),ee[Y]))break}I[J]={nodes:z,data:OT([B])}}return I}function _(v,E,x,y,T,I,P,z){for(var B=0,L=y.length?2:0,j=E[v].data,Y=0,J=0,le;Y<j.length;Y+=128){var ee=j.slice(Y,Y+128);Jt(ee,64),J=ee.read_shift(2),le=Ad(ee,0,J-L),y.push(le);var re={name:le,type:ee.read_shift(1),color:ee.read_shift(1),L:ee.read_shift(4,"i"),R:ee.read_shift(4,"i"),C:ee.read_shift(4,"i"),clsid:ee.read_shift(16),state:ee.read_shift(4,"i"),start:0,size:0},Ie=ee.read_shift(2)+ee.read_shift(2)+ee.read_shift(2)+ee.read_shift(2);Ie!==0&&(re.ct=M(ee,ee.l-8));var ut=ee.read_shift(2)+ee.read_shift(2)+ee.read_shift(2)+ee.read_shift(2);ut!==0&&(re.mt=M(ee,ee.l-8)),re.start=ee.read_shift(4,"i"),re.size=ee.read_shift(4,"i"),re.size<0&&re.start<0&&(re.size=re.type=0,re.start=Q,re.name=""),re.type===5?(B=re.start,T>0&&B!==Q&&(E[B].name="!StreamData")):re.size>=4096?(re.storage="fat",E[re.start]===void 0&&(E[re.start]=w(x,re.start,E.fat_addrs,E.ssz)),E[re.start].name=re.name,re.content=E[re.start].data.slice(0,re.size)):(re.storage="minifat",re.size<0?re.size=0:B!==Q&&re.start!==Q&&E[B]&&(re.content=p(re,E[B].data,(E[z]||{}).data))),re.content&&Jt(re.content,0),I[le]=re,P.push(re)}}function M(v,E){return new Date(($t(v,E+4)/1e7*Math.pow(2,32)+$t(v,E)/1e7-11644473600)*1e3)}function V(v,E){return l(),u(c.readFileSync(v),E)}function A(v,E){var x=E&&E.type;switch(x||Ue&&Buffer.isBuffer(v)&&(x="buffer"),x||"base64"){case"file":return V(v,E);case"base64":return u(_r(jn(v)),E);case"binary":return u(_r(v),E)}return u(v,E)}function S(v,E){var x=E||{},y=x.root||"Root Entry";if(v.FullPaths||(v.FullPaths=[]),v.FileIndex||(v.FileIndex=[]),v.FullPaths.length!==v.FileIndex.length)throw new Error("inconsistent CFB structure");v.FullPaths.length===0&&(v.FullPaths[0]=y+"/",v.FileIndex[0]={name:y,type:5}),x.CLSID&&(v.FileIndex[0].clsid=x.CLSID),F(v)}function F(v){var E="Sh33tJ5";if(!ze.find(v,"/"+E)){var x=kt(4);x[0]=55,x[1]=x[3]=50,x[2]=54,v.FileIndex.push({name:E,type:2,content:x,size:4,L:69,R:69,C:69}),v.FullPaths.push(v.FullPaths[0]+E),N(v)}}function N(v,E){S(v);for(var x=!1,y=!1,T=v.FullPaths.length-1;T>=0;--T){var I=v.FileIndex[T];switch(I.type){case 0:y?x=!0:(v.FileIndex.pop(),v.FullPaths.pop());break;case 1:case 2:case 5:y=!0,isNaN(I.R*I.L*I.C)&&(x=!0),I.R>-1&&I.L>-1&&I.R==I.L&&(x=!0);break;default:x=!0;break}}if(!(!x&&!E)){var P=new Date(1987,1,19),z=0,B=Object.create?Object.create(null):{},L=[];for(T=0;T<v.FullPaths.length;++T)B[v.FullPaths[T]]=!0,v.FileIndex[T].type!==0&&L.push([v.FullPaths[T],v.FileIndex[T]]);for(T=0;T<L.length;++T){var j=r(L[T][0]);y=B[j],y||(L.push([j,{name:i(j).replace("/",""),type:1,clsid:_e,ct:P,mt:P,content:null}]),B[j]=!0)}for(L.sort(function(le,ee){return t(le[0],ee[0])}),v.FullPaths=[],v.FileIndex=[],T=0;T<L.length;++T)v.FullPaths[T]=L[T][0],v.FileIndex[T]=L[T][1];for(T=0;T<L.length;++T){var Y=v.FileIndex[T],J=v.FullPaths[T];if(Y.name=i(J).replace("/",""),Y.L=Y.R=Y.C=-(Y.color=1),Y.size=Y.content?Y.content.length:0,Y.start=0,Y.clsid=Y.clsid||_e,T===0)Y.C=L.length>1?1:-1,Y.size=0,Y.type=5;else if(J.slice(-1)=="/"){for(z=T+1;z<L.length&&r(v.FullPaths[z])!=J;++z);for(Y.C=z>=L.length?-1:z,z=T+1;z<L.length&&r(v.FullPaths[z])!=r(J);++z);Y.R=z>=L.length?-1:z,Y.type=1}else r(v.FullPaths[T+1]||"")==r(J)&&(Y.R=T+1),Y.type=2}}}function H(v,E){var x=E||{};if(x.fileType=="mad")return cA(v,x);switch(N(v),x.fileType){case"zip":return tA(v,x)}var y=function(le){for(var ee=0,re=0,Ie=0;Ie<le.FileIndex.length;++Ie){var ut=le.FileIndex[Ie];if(ut.content){var In=ut.content.length;In>0&&(In<4096?ee+=In+63>>6:re+=In+511>>9)}}for(var It=le.FullPaths.length+3>>2,On=ee+7>>3,Fa=ee+127>>7,Pa=On+re+It+Fa,ds=Pa+127>>7,Lh=ds<=109?0:Math.ceil((ds-109)/127);Pa+ds+Lh+127>>7>ds;)Lh=++ds<=109?0:Math.ceil((ds-109)/127);var ti=[1,Lh,ds,Fa,It,re,ee,0];return le.FileIndex[0].size=ee<<6,ti[7]=(le.FileIndex[0].start=ti[0]+ti[1]+ti[2]+ti[3]+ti[4]+ti[5])+(ti[6]+7>>3),ti}(v),T=kt(y[7]<<9),I=0,P=0;{for(I=0;I<8;++I)T.write_shift(1,ne[I]);for(I=0;I<8;++I)T.write_shift(2,0);for(T.write_shift(2,62),T.write_shift(2,3),T.write_shift(2,65534),T.write_shift(2,9),T.write_shift(2,6),I=0;I<3;++I)T.write_shift(2,0);for(T.write_shift(4,0),T.write_shift(4,y[2]),T.write_shift(4,y[0]+y[1]+y[2]+y[3]-1),T.write_shift(4,0),T.write_shift(4,4096),T.write_shift(4,y[3]?y[0]+y[1]+y[2]-1:Q),T.write_shift(4,y[3]),T.write_shift(-4,y[1]?y[0]-1:Q),T.write_shift(4,y[1]),I=0;I<109;++I)T.write_shift(-4,I<y[2]?y[1]+I:-1)}if(y[1])for(P=0;P<y[1];++P){for(;I<236+P*127;++I)T.write_shift(-4,I<y[2]?y[1]+I:-1);T.write_shift(-4,P===y[1]-1?Q:P+1)}var z=function(le){for(P+=le;I<P-1;++I)T.write_shift(-4,I+1);le&&(++I,T.write_shift(-4,Q))};for(P=I=0,P+=y[1];I<P;++I)T.write_shift(-4,fe.DIFSECT);for(P+=y[2];I<P;++I)T.write_shift(-4,fe.FATSECT);z(y[3]),z(y[4]);for(var B=0,L=0,j=v.FileIndex[0];B<v.FileIndex.length;++B)j=v.FileIndex[B],j.content&&(L=j.content.length,!(L<4096)&&(j.start=P,z(L+511>>9)));for(z(y[6]+7>>3);T.l&511;)T.write_shift(-4,fe.ENDOFCHAIN);for(P=I=0,B=0;B<v.FileIndex.length;++B)j=v.FileIndex[B],j.content&&(L=j.content.length,!(!L||L>=4096)&&(j.start=P,z(L+63>>6)));for(;T.l&511;)T.write_shift(-4,fe.ENDOFCHAIN);for(I=0;I<y[4]<<2;++I){var Y=v.FullPaths[I];if(!Y||Y.length===0){for(B=0;B<17;++B)T.write_shift(4,0);for(B=0;B<3;++B)T.write_shift(4,-1);for(B=0;B<12;++B)T.write_shift(4,0);continue}j=v.FileIndex[I],I===0&&(j.start=j.size?j.start-1:Q);var J=I===0&&x.root||j.name;if(L=2*(J.length+1),T.write_shift(64,J,"utf16le"),T.write_shift(2,L),T.write_shift(1,j.type),T.write_shift(1,j.color),T.write_shift(-4,j.L),T.write_shift(-4,j.R),T.write_shift(-4,j.C),j.clsid)T.write_shift(16,j.clsid,"hex");else for(B=0;B<4;++B)T.write_shift(4,0);T.write_shift(4,j.state||0),T.write_shift(4,0),T.write_shift(4,0),T.write_shift(4,0),T.write_shift(4,0),T.write_shift(4,j.start),T.write_shift(4,j.size),T.write_shift(4,0)}for(I=1;I<v.FileIndex.length;++I)if(j=v.FileIndex[I],j.size>=4096)if(T.l=j.start+1<<9,Ue&&Buffer.isBuffer(j.content))j.content.copy(T,T.l,0,j.size),T.l+=j.size+511&-512;else{for(B=0;B<j.size;++B)T.write_shift(1,j.content[B]);for(;B&511;++B)T.write_shift(1,0)}for(I=1;I<v.FileIndex.length;++I)if(j=v.FileIndex[I],j.size>0&&j.size<4096)if(Ue&&Buffer.isBuffer(j.content))j.content.copy(T,T.l,0,j.size),T.l+=j.size+63&-64;else{for(B=0;B<j.size;++B)T.write_shift(1,j.content[B]);for(;B&63;++B)T.write_shift(1,0)}if(Ue)T.l=T.length;else for(;T.l<T.length;)T.write_shift(1,0);return T}function W(v,E){var x=v.FullPaths.map(function(B){return B.toUpperCase()}),y=x.map(function(B){var L=B.split("/");return L[L.length-(B.slice(-1)=="/"?2:1)]}),T=!1;E.charCodeAt(0)===47?(T=!0,E=x[0].slice(0,-1)+E):T=E.indexOf("/")!==-1;var I=E.toUpperCase(),P=T===!0?x.indexOf(I):y.indexOf(I);if(P!==-1)return v.FileIndex[P];var z=!I.match(Hc);for(I=I.replace(un,""),z&&(I=I.replace(Hc,"!")),P=0;P<x.length;++P)if((z?x[P].replace(Hc,"!"):x[P]).replace(un,"")==I||(z?y[P].replace(Hc,"!"):y[P]).replace(un,"")==I)return v.FileIndex[P];return null}var O=64,Q=-2,pe="d0cf11e0a1b11ae1",ne=[208,207,17,224,161,177,26,225],_e="00000000000000000000000000000000",fe={MAXREGSECT:-6,DIFSECT:-4,FATSECT:-3,ENDOFCHAIN:Q,FREESECT:-1,HEADER_SIGNATURE:pe,HEADER_MINOR_VERSION:"3e00",MAXREGSID:-6,NOSTREAM:-1,HEADER_CLSID:_e,EntryTypes:["unknown","storage","stream","lockbytes","property","root"]};function qe(v,E,x){l();var y=H(v,x);c.writeFileSync(E,y)}function se(v){for(var E=new Array(v.length),x=0;x<v.length;++x)E[x]=String.fromCharCode(v[x]);return E.join("")}function me(v,E){var x=H(v,E);switch(E&&E.type||"buffer"){case"file":return l(),c.writeFileSync(E.filename,x),x;case"binary":return typeof x=="string"?x:se(x);case"base64":return mT(typeof x=="string"?x:se(x));case"buffer":if(Ue)return Buffer.isBuffer(x)?x:Vs(x);case"array":return typeof x=="string"?_r(x):x}return x}var G;function b(v){try{var E=v.InflateRaw,x=new E;if(x._processChunk(new Uint8Array([3,0]),x._finishFlushFlag),x.bytesRead)G=v;else throw new Error("zlib does not expose bytesRead")}catch(y){console.error("cannot use native zlib: "+(y.message||y))}}function U(v,E){if(!G)return dx(v,E);var x=G.InflateRaw,y=new x,T=y._processChunk(v.slice(v.l),y._finishFlushFlag);return v.l+=y.bytesRead,T}function R(v){return G?G.deflateRawSync(v):Re(v)}var k=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],q=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258],ce=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577];function ie(v){var E=(v<<1|v<<11)&139536|(v<<5|v<<15)&558144;return(E>>16|E>>8|E)&255}for(var ae=typeof Uint8Array<"u",K=ae?new Uint8Array(256):[],je=0;je<256;++je)K[je]=ie(je);function D(v,E){var x=K[v&255];return E<=8?x>>>8-E:(x=x<<8|K[v>>8&255],E<=16?x>>>16-E:(x=x<<8|K[v>>16&255],x>>>24-E))}function dt(v,E){var x=E&7,y=E>>>3;return(v[y]|(x<=6?0:v[y+1]<<8))>>>x&3}function Ke(v,E){var x=E&7,y=E>>>3;return(v[y]|(x<=5?0:v[y+1]<<8))>>>x&7}function st(v,E){var x=E&7,y=E>>>3;return(v[y]|(x<=4?0:v[y+1]<<8))>>>x&15}function Pe(v,E){var x=E&7,y=E>>>3;return(v[y]|(x<=3?0:v[y+1]<<8))>>>x&31}function oe(v,E){var x=E&7,y=E>>>3;return(v[y]|(x<=1?0:v[y+1]<<8))>>>x&127}function xt(v,E,x){var y=E&7,T=E>>>3,I=(1<<x)-1,P=v[T]>>>y;return x<8-y||(P|=v[T+1]<<8-y,x<16-y)||(P|=v[T+2]<<16-y,x<24-y)||(P|=v[T+3]<<24-y),P&I}function Hn(v,E,x){var y=E&7,T=E>>>3;return y<=5?v[T]|=(x&7)<<y:(v[T]|=x<<y&255,v[T+1]=(x&7)>>8-y),E+3}function Dr(v,E,x){var y=E&7,T=E>>>3;return x=(x&1)<<y,v[T]|=x,E+1}function Jr(v,E,x){var y=E&7,T=E>>>3;return x<<=y,v[T]|=x&255,x>>>=8,v[T+1]=x,E+8}function Ma(v,E,x){var y=E&7,T=E>>>3;return x<<=y,v[T]|=x&255,x>>>=8,v[T+1]=x&255,v[T+2]=x>>>8,E+16}function Ti(v,E){var x=v.length,y=2*x>E?2*x:E+5,T=0;if(x>=E)return v;if(Ue){var I=gT(y);if(v.copy)v.copy(I);else for(;T<v.length;++T)I[T]=v[T];return I}else if(ae){var P=new Uint8Array(y);if(P.set)P.set(v);else for(;T<x;++T)P[T]=v[T];return P}return v.length=y,v}function Mn(v){for(var E=new Array(v),x=0;x<v;++x)E[x]=0;return E}function ei(v,E,x){var y=1,T=0,I=0,P=0,z=0,B=v.length,L=ae?new Uint16Array(32):Mn(32);for(I=0;I<32;++I)L[I]=0;for(I=B;I<x;++I)v[I]=0;B=v.length;var j=ae?new Uint16Array(B):Mn(B);for(I=0;I<B;++I)L[T=v[I]]++,y<T&&(y=T),j[I]=0;for(L[0]=0,I=1;I<=y;++I)L[I+16]=z=z+L[I-1]<<1;for(I=0;I<B;++I)z=v[I],z!=0&&(j[I]=L[z+16]++);var Y=0;for(I=0;I<B;++I)if(Y=v[I],Y!=0)for(z=D(j[I],y)>>y-Y,P=(1<<y+4-Y)-1;P>=0;--P)E[z|P<<Y]=Y&15|I<<4;return y}var Ii=ae?new Uint16Array(512):Mn(512),Oa=ae?new Uint16Array(32):Mn(32);if(!ae){for(var mn=0;mn<512;++mn)Ii[mn]=0;for(mn=0;mn<32;++mn)Oa[mn]=0}(function(){for(var v=[],E=0;E<32;E++)v.push(5);ei(v,Oa,32);var x=[];for(E=0;E<=143;E++)x.push(8);for(;E<=255;E++)x.push(9);for(;E<=279;E++)x.push(7);for(;E<=287;E++)x.push(8);ei(x,Ii,288)})();var br=function(){for(var E=ae?new Uint8Array(32768):[],x=0,y=0;x<ce.length-1;++x)for(;y<ce[x+1];++y)E[y]=x;for(;y<32768;++y)E[y]=29;var T=ae?new Uint8Array(259):[];for(x=0,y=0;x<q.length-1;++x)for(;y<q[x+1];++y)T[y]=x;function I(z,B){for(var L=0;L<z.length;){var j=Math.min(65535,z.length-L),Y=L+j==z.length;for(B.write_shift(1,+Y),B.write_shift(2,j),B.write_shift(2,~j&65535);j-- >0;)B[B.l++]=z[L++]}return B.l}function P(z,B){for(var L=0,j=0,Y=ae?new Uint16Array(32768):[];j<z.length;){var J=Math.min(65535,z.length-j);if(J<10){for(L=Hn(B,L,+(j+J==z.length)),L&7&&(L+=8-(L&7)),B.l=L/8|0,B.write_shift(2,J),B.write_shift(2,~J&65535);J-- >0;)B[B.l++]=z[j++];L=B.l*8;continue}L=Hn(B,L,+(j+J==z.length)+2);for(var le=0;J-- >0;){var ee=z[j];le=(le<<5^ee)&32767;var re=-1,Ie=0;if((re=Y[le])&&(re|=j&-32768,re>j&&(re-=32768),re<j))for(;z[re+Ie]==z[j+Ie]&&Ie<250;)++Ie;if(Ie>2){ee=T[Ie],ee<=22?L=Jr(B,L,K[ee+1]>>1)-1:(Jr(B,L,3),L+=5,Jr(B,L,K[ee-23]>>5),L+=3);var ut=ee<8?0:ee-4>>2;ut>0&&(Ma(B,L,Ie-q[ee]),L+=ut),ee=E[j-re],L=Jr(B,L,K[ee]>>3),L-=3;var In=ee<4?0:ee-2>>1;In>0&&(Ma(B,L,j-re-ce[ee]),L+=In);for(var It=0;It<Ie;++It)Y[le]=j&32767,le=(le<<5^z[j])&32767,++j;J-=Ie-1}else ee<=143?ee=ee+48:L=Dr(B,L,1),L=Jr(B,L,K[ee]),Y[le]=j&32767,++j}L=Jr(B,L,0)-1}return B.l=(L+7)/8|0,B.l}return function(B,L){return B.length<8?I(B,L):P(B,L)}}();function Re(v){var E=kt(50+Math.floor(v.length*1.1)),x=br(v,E);return E.slice(0,x)}var yt=ae?new Uint16Array(32768):Mn(32768),$n=ae?new Uint16Array(32768):Mn(32768),Mt=ae?new Uint16Array(128):Mn(128),fs=1,fx=1;function Zb(v,E){var x=Pe(v,E)+257;E+=5;var y=Pe(v,E)+1;E+=5;var T=st(v,E)+4;E+=4;for(var I=0,P=ae?new Uint8Array(19):Mn(19),z=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],B=1,L=ae?new Uint8Array(8):Mn(8),j=ae?new Uint8Array(8):Mn(8),Y=P.length,J=0;J<T;++J)P[k[J]]=I=Ke(v,E),B<I&&(B=I),L[I]++,E+=3;var le=0;for(L[0]=0,J=1;J<=B;++J)j[J]=le=le+L[J-1]<<1;for(J=0;J<Y;++J)(le=P[J])!=0&&(z[J]=j[le]++);var ee=0;for(J=0;J<Y;++J)if(ee=P[J],ee!=0){le=K[z[J]]>>8-ee;for(var re=(1<<7-ee)-1;re>=0;--re)Mt[le|re<<ee]=ee&7|J<<3}var Ie=[];for(B=1;Ie.length<x+y;)switch(le=Mt[oe(v,E)],E+=le&7,le>>>=3){case 16:for(I=3+dt(v,E),E+=2,le=Ie[Ie.length-1];I-- >0;)Ie.push(le);break;case 17:for(I=3+Ke(v,E),E+=3;I-- >0;)Ie.push(0);break;case 18:for(I=11+oe(v,E),E+=7;I-- >0;)Ie.push(0);break;default:Ie.push(le),B<le&&(B=le);break}var ut=Ie.slice(0,x),In=Ie.slice(x);for(J=x;J<286;++J)ut[J]=0;for(J=y;J<30;++J)In[J]=0;return fs=ei(ut,yt,286),fx=ei(In,$n,30),E}function Jb(v,E){if(v[0]==3&&!(v[1]&3))return[Xi(E),2];for(var x=0,y=0,T=gT(E||1<<18),I=0,P=T.length>>>0,z=0,B=0;!(y&1);){if(y=Ke(v,x),x+=3,y>>>1)y>>1==1?(z=9,B=5):(x=Zb(v,x),z=fs,B=fx);else{x&7&&(x+=8-(x&7));var L=v[x>>>3]|v[(x>>>3)+1]<<8;if(x+=32,L>0)for(!E&&P<I+L&&(T=Ti(T,I+L),P=T.length);L-- >0;)T[I++]=v[x>>>3],x+=8;continue}for(;;){!E&&P<I+32767&&(T=Ti(T,I+32767),P=T.length);var j=xt(v,x,z),Y=y>>>1==1?Ii[j]:yt[j];if(x+=Y&15,Y>>>=4,!(Y>>>8&255))T[I++]=Y;else{if(Y==256)break;Y-=257;var J=Y<8?0:Y-4>>2;J>5&&(J=0);var le=I+q[Y];J>0&&(le+=xt(v,x,J),x+=J),j=xt(v,x,B),Y=y>>>1==1?Oa[j]:$n[j],x+=Y&15,Y>>>=4;var ee=Y<4?0:Y-2>>1,re=ce[Y];for(ee>0&&(re+=xt(v,x,ee),x+=ee),!E&&P<le&&(T=Ti(T,le+100),P=T.length);I<le;)T[I]=T[I-re],++I}}}return E?[T,x+7>>>3]:[T.slice(0,I),x+7>>>3]}function dx(v,E){var x=v.slice(v.l||0),y=Jb(x,E);return v.l+=y[1],y[0]}function hx(v,E){if(v)typeof console<"u"&&console.error(E);else throw new Error(E)}function px(v,E){var x=v;Jt(x,0);var y=[],T=[],I={FileIndex:y,FullPaths:T};S(I,{root:E.root});for(var P=x.length-4;(x[P]!=80||x[P+1]!=75||x[P+2]!=5||x[P+3]!=6)&&P>=0;)--P;x.l=P+4,x.l+=4;var z=x.read_shift(2);x.l+=6;var B=x.read_shift(4);for(x.l=B,P=0;P<z;++P){x.l+=20;var L=x.read_shift(4),j=x.read_shift(4),Y=x.read_shift(2),J=x.read_shift(2),le=x.read_shift(2);x.l+=8;var ee=x.read_shift(4),re=a(x.slice(x.l+Y,x.l+Y+J));x.l+=Y+J+le;var Ie=x.l;x.l=ee+4,eA(x,L,j,I,re),x.l=Ie}return I}function eA(v,E,x,y,T){v.l+=2;var I=v.read_shift(2),P=v.read_shift(2),z=o(v);if(I&8257)throw new Error("Unsupported ZIP encryption");for(var B=v.read_shift(4),L=v.read_shift(4),j=v.read_shift(4),Y=v.read_shift(2),J=v.read_shift(2),le="",ee=0;ee<Y;++ee)le+=String.fromCharCode(v[v.l++]);if(J){var re=a(v.slice(v.l,v.l+J));(re[21589]||{}).mt&&(z=re[21589].mt),((T||{})[21589]||{}).mt&&(z=T[21589].mt)}v.l+=J;var Ie=v.slice(v.l,v.l+L);switch(P){case 8:Ie=U(v,j);break;case 0:break;default:throw new Error("Unsupported ZIP Compression method "+P)}var ut=!1;I&8&&(B=v.read_shift(4),B==134695760&&(B=v.read_shift(4),ut=!0),L=v.read_shift(4),j=v.read_shift(4)),L!=E&&hx(ut,"Bad compressed size: "+E+" != "+L),j!=x&&hx(ut,"Bad uncompressed size: "+x+" != "+j),Ph(y,le,Ie,{unsafe:!0,mt:z})}function tA(v,E){var x=E||{},y=[],T=[],I=kt(1),P=x.compression?8:0,z=0,B=!1;B&&(z|=8);var L=0,j=0,Y=0,J=0,le=v.FullPaths[0],ee=le,re=v.FileIndex[0],Ie=[],ut=0;for(L=1;L<v.FullPaths.length;++L)if(ee=v.FullPaths[L].slice(le.length),re=v.FileIndex[L],!(!re.size||!re.content||ee=="Sh33tJ5")){var In=Y,It=kt(ee.length);for(j=0;j<ee.length;++j)It.write_shift(1,ee.charCodeAt(j)&127);It=It.slice(0,It.l),Ie[J]=xL.buf(re.content,0);var On=re.content;P==8&&(On=R(On)),I=kt(30),I.write_shift(4,67324752),I.write_shift(2,20),I.write_shift(2,z),I.write_shift(2,P),re.mt?s(I,re.mt):I.write_shift(4,0),I.write_shift(-4,z&8?0:Ie[J]),I.write_shift(4,z&8?0:On.length),I.write_shift(4,z&8?0:re.content.length),I.write_shift(2,It.length),I.write_shift(2,0),Y+=I.length,y.push(I),Y+=It.length,y.push(It),Y+=On.length,y.push(On),z&8&&(I=kt(12),I.write_shift(-4,Ie[J]),I.write_shift(4,On.length),I.write_shift(4,re.content.length),Y+=I.l,y.push(I)),I=kt(46),I.write_shift(4,33639248),I.write_shift(2,0),I.write_shift(2,20),I.write_shift(2,z),I.write_shift(2,P),I.write_shift(4,0),I.write_shift(-4,Ie[J]),I.write_shift(4,On.length),I.write_shift(4,re.content.length),I.write_shift(2,It.length),I.write_shift(2,0),I.write_shift(2,0),I.write_shift(2,0),I.write_shift(2,0),I.write_shift(4,0),I.write_shift(4,In),ut+=I.l,T.push(I),ut+=It.length,T.push(It),++J}return I=kt(22),I.write_shift(4,101010256),I.write_shift(2,0),I.write_shift(2,0),I.write_shift(2,J),I.write_shift(2,J),I.write_shift(4,ut),I.write_shift(4,Y),I.write_shift(2,0),Gi([Gi(y),Gi(T),I])}var ru={htm:"text/html",xml:"text/xml",gif:"image/gif",jpg:"image/jpeg",png:"image/png",mso:"application/x-mso",thmx:"application/vnd.ms-officetheme",sh33tj5:"application/octet-stream"};function nA(v,E){if(v.ctype)return v.ctype;var x=v.name||"",y=x.match(/\.([^\.]+)$/);return y&&ru[y[1]]||E&&(y=(x=E).match(/[\.\\]([^\.\\])+$/),y&&ru[y[1]])?ru[y[1]]:"application/octet-stream"}function rA(v){for(var E=mT(v),x=[],y=0;y<E.length;y+=76)x.push(E.slice(y,y+76));return x.join(`\r
`)+`\r
`}function iA(v){var E=v.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF=]/g,function(L){var j=L.charCodeAt(0).toString(16).toUpperCase();return"="+(j.length==1?"0"+j:j)});E=E.replace(/ $/mg,"=20").replace(/\t$/mg,"=09"),E.charAt(0)==`
`&&(E="=0D"+E.slice(1)),E=E.replace(/\r(?!\n)/mg,"=0D").replace(/\n\n/mg,`
=0A`).replace(/([^\r\n])\n/mg,"$1=0A");for(var x=[],y=E.split(`\r
`),T=0;T<y.length;++T){var I=y[T];if(I.length==0){x.push("");continue}for(var P=0;P<I.length;){var z=76,B=I.slice(P,P+z);B.charAt(z-1)=="="?z--:B.charAt(z-2)=="="?z-=2:B.charAt(z-3)=="="&&(z-=3),B=I.slice(P,P+z),P+=z,P<I.length&&(B+="="),x.push(B)}}return x.join(`\r
`)}function sA(v){for(var E=[],x=0;x<v.length;++x){for(var y=v[x];x<=v.length&&y.charAt(y.length-1)=="=";)y=y.slice(0,y.length-1)+v[++x];E.push(y)}for(var T=0;T<E.length;++T)E[T]=E[T].replace(/[=][0-9A-Fa-f]{2}/g,function(I){return String.fromCharCode(parseInt(I.slice(1),16))});return _r(E.join(`\r
`))}function oA(v,E,x){for(var y="",T="",I="",P,z=0;z<10;++z){var B=E[z];if(!B||B.match(/^\s*$/))break;var L=B.match(/^(.*?):\s*([^\s].*)$/);if(L)switch(L[1].toLowerCase()){case"content-location":y=L[2].trim();break;case"content-type":I=L[2].trim();break;case"content-transfer-encoding":T=L[2].trim();break}}switch(++z,T.toLowerCase()){case"base64":P=_r(jn(E.slice(z).join("")));break;case"quoted-printable":P=sA(E.slice(z));break;default:throw new Error("Unsupported Content-Transfer-Encoding "+T)}var j=Ph(v,y.slice(x.length),P,{unsafe:!0});I&&(j.ctype=I)}function aA(v,E){if(se(v.slice(0,13)).toLowerCase()!="mime-version:")throw new Error("Unsupported MAD header");var x=E&&E.root||"",y=(Ue&&Buffer.isBuffer(v)?v.toString("binary"):se(v)).split(`\r
`),T=0,I="";for(T=0;T<y.length;++T)if(I=y[T],!!/^Content-Location:/i.test(I)&&(I=I.slice(I.indexOf("file")),x||(x=I.slice(0,I.lastIndexOf("/")+1)),I.slice(0,x.length)!=x))for(;x.length>0&&(x=x.slice(0,x.length-1),x=x.slice(0,x.lastIndexOf("/")+1),I.slice(0,x.length)!=x););var P=(y[1]||"").match(/boundary="(.*?)"/);if(!P)throw new Error("MAD cannot find boundary");var z="--"+(P[1]||""),B=[],L=[],j={FileIndex:B,FullPaths:L};S(j);var Y,J=0;for(T=0;T<y.length;++T){var le=y[T];le!==z&&le!==z+"--"||(J++&&oA(j,y.slice(Y,T),x),Y=T)}return j}function cA(v,E){var x=E||{},y=x.boundary||"SheetJS";y="------="+y;for(var T=["MIME-Version: 1.0",'Content-Type: multipart/related; boundary="'+y.slice(2)+'"',"","",""],I=v.FullPaths[0],P=I,z=v.FileIndex[0],B=1;B<v.FullPaths.length;++B)if(P=v.FullPaths[B].slice(I.length),z=v.FileIndex[B],!(!z.size||!z.content||P=="Sh33tJ5")){P=P.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF]/g,function(Ie){return"_x"+Ie.charCodeAt(0).toString(16)+"_"}).replace(/[\u0080-\uFFFF]/g,function(Ie){return"_u"+Ie.charCodeAt(0).toString(16)+"_"});for(var L=z.content,j=Ue&&Buffer.isBuffer(L)?L.toString("binary"):se(L),Y=0,J=Math.min(1024,j.length),le=0,ee=0;ee<=J;++ee)(le=j.charCodeAt(ee))>=32&&le<128&&++Y;var re=Y>=J*4/5;T.push(y),T.push("Content-Location: "+(x.root||"file:///C:/SheetJS/")+P),T.push("Content-Transfer-Encoding: "+(re?"quoted-printable":"base64")),T.push("Content-Type: "+nA(z,P)),T.push(""),T.push(re?iA(j):rA(j))}return T.push(y+`--\r
`),T.join(`\r
`)}function lA(v){var E={};return S(E,v),E}function Ph(v,E,x,y){var T=y&&y.unsafe;T||S(v);var I=!T&&ze.find(v,E);if(!I){var P=v.FullPaths[0];E.slice(0,P.length)==P?P=E:(P.slice(-1)!="/"&&(P+="/"),P=(P+E).replace("//","/")),I={name:i(E),type:2},v.FileIndex.push(I),v.FullPaths.push(P),T||ze.utils.cfb_gc(v)}return I.content=x,I.size=x?x.length:0,y&&(y.CLSID&&(I.clsid=y.CLSID),y.mt&&(I.mt=y.mt),y.ct&&(I.ct=y.ct)),I}function uA(v,E){S(v);var x=ze.find(v,E);if(x){for(var y=0;y<v.FileIndex.length;++y)if(v.FileIndex[y]==x)return v.FileIndex.splice(y,1),v.FullPaths.splice(y,1),!0}return!1}function fA(v,E,x){S(v);var y=ze.find(v,E);if(y){for(var T=0;T<v.FileIndex.length;++T)if(v.FileIndex[T]==y)return v.FileIndex[T].name=i(x),v.FullPaths[T]=x,!0}return!1}function dA(v){N(v,!0)}return n.find=W,n.read=A,n.parse=u,n.write=me,n.writeFile=qe,n.utils={cfb_new:lA,cfb_add:Ph,cfb_del:uA,cfb_mov:fA,cfb_gc:dA,ReadShift:zc,CheckField:YI,prep_blob:Jt,bconcat:Gi,use_zlib:b,_deflateRaw:Re,_inflateRaw:dx,consts:fe},n}(),IT;function yL(e){if(typeof IT<"u")return IT.readFileSync(e);if(typeof Deno<"u")return Deno.readFileSync(e);if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var n=File(e);n.open("r"),n.encoding="binary";var t=n.read();return n.close(),t}catch(r){if(!r.message||!r.message.match(/onstruct/))throw r}throw new Error("Cannot access file "+e)}function zr(e){for(var n=Object.keys(e),t=[],r=0;r<n.length;++r)Object.prototype.hasOwnProperty.call(e,n[r])&&t.push(n[r]);return t}function Sg(e){for(var n=[],t=zr(e),r=0;r!==t.length;++r)n[e[t[r]]]=t[r];return n}var xd=new Date(1899,11,30,0,0,0);function En(e,n){var t=e.getTime();n&&(t-=1462*24*60*60*1e3);var r=xd.getTime()+(e.getTimezoneOffset()-xd.getTimezoneOffset())*6e4;return(t-r)/(24*60*60*1e3)}var RI=new Date,wL=xd.getTime()+(RI.getTimezoneOffset()-xd.getTimezoneOffset())*6e4,CT=RI.getTimezoneOffset();function bd(e){var n=new Date;return n.setTime(e*24*60*60*1e3+wL),n.getTimezoneOffset()!==CT&&n.setTime(n.getTime()+(n.getTimezoneOffset()-CT)*6e4),n}function EL(e){var n=0,t=0,r=!1,i=e.match(/P([0-9\.]+Y)?([0-9\.]+M)?([0-9\.]+D)?T([0-9\.]+H)?([0-9\.]+M)?([0-9\.]+S)?/);if(!i)throw new Error("|"+e+"| is not an ISO8601 Duration");for(var s=1;s!=i.length;++s)if(i[s]){switch(t=1,s>3&&(r=!0),i[s].slice(i[s].length-1)){case"Y":throw new Error("Unsupported ISO Duration Field: "+i[s].slice(i[s].length-1));case"D":t*=24;case"H":t*=60;case"M":if(r)t*=60;else throw new Error("Unsupported ISO Duration Field: M");case"S":break}n+=t*parseInt(i[s],10)}return n}var ST=new Date("2017-02-19T19:06:09.000Z"),MI=isNaN(ST.getFullYear())?new Date("2/19/17"):ST,TL=MI.getFullYear()==2017;function Wt(e,n){var t=new Date(e);if(TL)return n>0?t.setTime(t.getTime()+t.getTimezoneOffset()*60*1e3):n<0&&t.setTime(t.getTime()-t.getTimezoneOffset()*60*1e3),t;if(e instanceof Date)return e;if(MI.getFullYear()==1917&&!isNaN(t.getFullYear())){var r=t.getFullYear();return e.indexOf(""+r)>-1||t.setFullYear(t.getFullYear()+100),t}var i=e.match(/\d+/g)||["2017","2","19","0","0","0"],s=new Date(+i[0],+i[1]-1,+i[2],+i[3]||0,+i[4]||0,+i[5]||0);return e.indexOf("Z")>-1&&(s=new Date(s.getTime()-s.getTimezoneOffset()*60*1e3)),s}function Us(e,n){if(Ue&&Buffer.isBuffer(e)){if(n){if(e[0]==255&&e[1]==254)return Wc(e.slice(2).toString("utf16le"));if(e[1]==254&&e[2]==255)return Wc(xI(e.slice(2).toString("binary")))}return e.toString("binary")}if(typeof TextDecoder<"u")try{if(n){if(e[0]==255&&e[1]==254)return Wc(new TextDecoder("utf-16le").decode(e.slice(2)));if(e[0]==254&&e[1]==255)return Wc(new TextDecoder("utf-16be").decode(e.slice(2)))}var t={"\u20AC":"\x80","\u201A":"\x82",\u0192:"\x83","\u201E":"\x84","\u2026":"\x85","\u2020":"\x86","\u2021":"\x87","\u02C6":"\x88","\u2030":"\x89",\u0160:"\x8A","\u2039":"\x8B",\u0152:"\x8C",\u017D:"\x8E","\u2018":"\x91","\u2019":"\x92","\u201C":"\x93","\u201D":"\x94","\u2022":"\x95","\u2013":"\x96","\u2014":"\x97","\u02DC":"\x98","\u2122":"\x99",\u0161:"\x9A","\u203A":"\x9B",\u0153:"\x9C",\u017E:"\x9E",\u0178:"\x9F"};return Array.isArray(e)&&(e=new Uint8Array(e)),new TextDecoder("latin1").decode(e).replace(/[€‚ƒ„…†‡ˆ‰Š‹ŒŽ‘’“”•–—˜™š›œžŸ]/g,function(s){return t[s]||s})}catch{}for(var r=[],i=0;i!=e.length;++i)r.push(String.fromCharCode(e[i]));return r.join("")}function en(e){if(typeof JSON<"u"&&!Array.isArray(e))return JSON.parse(JSON.stringify(e));if(typeof e!="object"||e==null)return e;if(e instanceof Date)return new Date(e.getTime());var n={};for(var t in e)Object.prototype.hasOwnProperty.call(e,t)&&(n[t]=en(e[t]));return n}function vt(e,n){for(var t="";t.length<n;)t+=e;return t}function wr(e){var n=Number(e);if(!isNaN(n))return isFinite(n)?n:NaN;if(!/\d/.test(e))return n;var t=1,r=e.replace(/([\d]),([\d])/g,"$1$2").replace(/[$]/g,"").replace(/[%]/g,function(){return t*=100,""});return!isNaN(n=Number(r))||(r=r.replace(/[(](.*)[)]/,function(i,s){return t=-t,s}),!isNaN(n=Number(r)))?n/t:n}var IL=["january","february","march","april","may","june","july","august","september","october","november","december"];function ca(e){var n=new Date(e),t=new Date(NaN),r=n.getYear(),i=n.getMonth(),s=n.getDate();if(isNaN(s))return t;var o=e.toLowerCase();if(o.match(/jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec/)){if(o=o.replace(/[^a-z]/g,"").replace(/([^a-z]|^)[ap]m?([^a-z]|$)/,""),o.length>3&&IL.indexOf(o)==-1)return t}else if(o.match(/[a-z]/))return t;return r<0||r>8099?t:(i>0||s>1)&&r!=101?n:e.match(/[^-0-9:,\/\\]/)?t:n}var CL=function(){var e="abacaba".split(/(:?b)/i).length==5;return function(t,r,i){if(e||typeof r=="string")return t.split(r);for(var s=t.split(r),o=[s[0]],a=1;a<s.length;++a)o.push(i),o.push(s[a]);return o}}();function OI(e){return e?e.content&&e.type?Us(e.content,!0):e.data?Vc(e.data):e.asNodeBuffer&&Ue?Vc(e.asNodeBuffer().toString("binary")):e.asBinary?Vc(e.asBinary()):e._data&&e._data.getContent?Vc(Us(Array.prototype.slice.call(e._data.getContent(),0))):null:null}function FI(e){if(!e)return null;if(e.data)return ug(e.data);if(e.asNodeBuffer&&Ue)return e.asNodeBuffer();if(e._data&&e._data.getContent){var n=e._data.getContent();return typeof n=="string"?ug(n):Array.prototype.slice.call(n)}return e.content&&e.type?e.content:null}function SL(e){return e&&e.name.slice(-4)===".bin"?FI(e):OI(e)}function er(e,n){for(var t=e.FullPaths||zr(e.files),r=n.toLowerCase().replace(/[\/]/g,"\\"),i=r.replace(/\\/g,"/"),s=0;s<t.length;++s){var o=t[s].replace(/^Root Entry[\/]/,"").toLowerCase();if(r==o||i==o)return e.files?e.files[t[s]]:e.FileIndex[s]}return null}function Dg(e,n){var t=er(e,n);if(t==null)throw new Error("Cannot find file "+n+" in zip");return t}function bt(e,n,t){if(!t)return SL(Dg(e,n));if(!n)return null;try{return bt(e,n)}catch{return null}}function Un(e,n,t){if(!t)return OI(Dg(e,n));if(!n)return null;try{return Un(e,n)}catch{return null}}function PI(e,n,t){if(!t)return FI(Dg(e,n));if(!n)return null;try{return PI(e,n)}catch{return null}}function DT(e){for(var n=e.FullPaths||zr(e.files),t=[],r=0;r<n.length;++r)n[r].slice(-1)!="/"&&t.push(n[r].replace(/^Root Entry[\/]/,""));return t.sort()}function DL(e,n,t){if(e.FullPaths){if(typeof t=="string"){var r;return Ue?r=Vs(t):r=qP(t),ze.utils.cfb_add(e,n,r)}ze.utils.cfb_add(e,n,t)}else e.file(n,t)}function LI(e,n){switch(n.type){case"base64":return ze.read(e,{type:"base64"});case"binary":return ze.read(e,{type:"binary"});case"buffer":case"array":return ze.read(e,{type:"buffer"})}throw new Error("Unrecognized type "+n.type)}function $c(e,n){if(e.charAt(0)=="/")return e.slice(1);var t=n.split("/");n.slice(-1)!="/"&&t.pop();for(var r=e.split("/");r.length!==0;){var i=r.shift();i===".."?t.pop():i!=="."&&t.push(i)}return t.join("/")}var BI=`<?xml version="1.0" encoding="UTF-8" standalone="yes"?>\r
`,bL=/([^"\s?>\/]+)\s*=\s*((?:")([^"]*)(?:")|(?:')([^']*)(?:')|([^'">\s]+))/g,bT=/<[\/\?]?[a-zA-Z0-9:_-]+(?:\s+[^"\s?>\/]+\s*=\s*(?:"[^"]*"|'[^']*'|[^'">\s=]+))*\s*[\/\?]?>/mg,AL=/<[^>]*>/g,hn=BI.match(bT)?bT:AL,kL=/<\w*:/,NL=/<(\/?)\w+:/;function Ee(e,n,t){for(var r={},i=0,s=0;i!==e.length&&!((s=e.charCodeAt(i))===32||s===10||s===13);++i);if(n||(r[0]=e.slice(0,i)),i===e.length)return r;var o=e.match(bL),a=0,c="",l=0,u="",f="",d=1;if(o)for(l=0;l!=o.length;++l){for(f=o[l],s=0;s!=f.length&&f.charCodeAt(s)!==61;++s);for(u=f.slice(0,s).trim();f.charCodeAt(s+1)==32;)++s;for(d=(i=f.charCodeAt(s+1))==34||i==39?1:0,c=f.slice(s+1+d,f.length-d),a=0;a!=u.length&&u.charCodeAt(a)!==58;++a);if(a===u.length)u.indexOf("_")>0&&(u=u.slice(0,u.indexOf("_"))),r[u]=c,t||(r[u.toLowerCase()]=c);else{var h=(a===5&&u.slice(0,5)==="xmlns"?"xmlns":"")+u.slice(a+1);if(r[h]&&u.slice(a-3,a)=="ext")continue;r[h]=c,t||(r[h.toLowerCase()]=c)}}return r}function Gr(e){return e.replace(NL,"<$1")}var UI={"&quot;":'"',"&apos;":"'","&gt;":">","&lt;":"<","&amp;":"&"},RL=Sg(UI),Xe=function(){var e=/&(?:quot|apos|gt|lt|amp|#x?([\da-fA-F]+));/ig,n=/_x([\da-fA-F]{4})_/ig;return function t(r){var i=r+"",s=i.indexOf("<![CDATA[");if(s==-1)return i.replace(e,function(a,c){return UI[a]||String.fromCharCode(parseInt(c,a.indexOf("x")>-1?16:10))||a}).replace(n,function(a,c){return String.fromCharCode(parseInt(c,16))});var o=i.indexOf("]]>");return t(i.slice(0,s))+i.slice(s+9,o)+t(i.slice(o+3))}}(),ML=/[&<>'"]/g;var OL=/[\u0000-\u001f]/g;function bg(e){var n=e+"";return n.replace(ML,function(t){return RL[t]}).replace(/\n/g,"<br/>").replace(OL,function(t){return"&#x"+("000"+t.charCodeAt(0).toString(16)).slice(-4)+";"})}var AT=function(){var e=/&#(\d+);/g;function n(t,r){return String.fromCharCode(parseInt(r,10))}return function(r){return r.replace(e,n)}}();function ft(e){switch(e){case 1:case!0:case"1":case"true":case"TRUE":return!0;default:return!1}}function tg(e){for(var n="",t=0,r=0,i=0,s=0,o=0,a=0;t<e.length;){if(r=e.charCodeAt(t++),r<128){n+=String.fromCharCode(r);continue}if(i=e.charCodeAt(t++),r>191&&r<224){o=(r&31)<<6,o|=i&63,n+=String.fromCharCode(o);continue}if(s=e.charCodeAt(t++),r<240){n+=String.fromCharCode((r&15)<<12|(i&63)<<6|s&63);continue}o=e.charCodeAt(t++),a=((r&7)<<18|(i&63)<<12|(s&63)<<6|o&63)-65536,n+=String.fromCharCode(55296+(a>>>10&1023)),n+=String.fromCharCode(56320+(a&1023))}return n}function kT(e){var n=Xi(2*e.length),t,r,i=1,s=0,o=0,a;for(r=0;r<e.length;r+=i)i=1,(a=e.charCodeAt(r))<128?t=a:a<224?(t=(a&31)*64+(e.charCodeAt(r+1)&63),i=2):a<240?(t=(a&15)*4096+(e.charCodeAt(r+1)&63)*64+(e.charCodeAt(r+2)&63),i=3):(i=4,t=(a&7)*262144+(e.charCodeAt(r+1)&63)*4096+(e.charCodeAt(r+2)&63)*64+(e.charCodeAt(r+3)&63),t-=65536,o=55296+(t>>>10&1023),t=56320+(t&1023)),o!==0&&(n[s++]=o&255,n[s++]=o>>>8,o=0),n[s++]=t%256,n[s++]=t>>>8;return n.slice(0,s).toString("ucs2")}function NT(e){return Vs(e,"binary").toString("utf8")}var cd="foo bar baz\xE2\x98\x83\xF0\x9F\x8D\xA3",ct=Ue&&(NT(cd)==tg(cd)&&NT||kT(cd)==tg(cd)&&kT)||tg,Wc=Ue?function(e){return Vs(e,"utf8").toString("binary")}:function(e){for(var n=[],t=0,r=0,i=0;t<e.length;)switch(r=e.charCodeAt(t++),!0){case r<128:n.push(String.fromCharCode(r));break;case r<2048:n.push(String.fromCharCode(192+(r>>6))),n.push(String.fromCharCode(128+(r&63)));break;case(r>=55296&&r<57344):r-=55296,i=e.charCodeAt(t++)-56320+(r<<10),n.push(String.fromCharCode(240+(i>>18&7))),n.push(String.fromCharCode(144+(i>>12&63))),n.push(String.fromCharCode(128+(i>>6&63))),n.push(String.fromCharCode(128+(i&63)));break;default:n.push(String.fromCharCode(224+(r>>12))),n.push(String.fromCharCode(128+(r>>6&63))),n.push(String.fromCharCode(128+(r&63)))}return n.join("")},tl=function(){var e={};return function(t,r){var i=t+"|"+(r||"");return e[i]?e[i]:e[i]=new RegExp("<(?:\\w+:)?"+t+'(?: xml:space="preserve")?(?:[^>]*)>([\\s\\S]*?)</(?:\\w+:)?'+t+">",r||"")}}(),jI=function(){var e=[["nbsp"," "],["middot","\xB7"],["quot",'"'],["apos","'"],["gt",">"],["lt","<"],["amp","&"]].map(function(n){return[new RegExp("&"+n[0]+";","ig"),n[1]]});return function(t){for(var r=t.replace(/^[\t\n\r ]+/,"").replace(/[\t\n\r ]+$/,"").replace(/>\s+/g,">").replace(/\s+</g,"<").replace(/[\t\n\r ]+/g," ").replace(/<\s*[bB][rR]\s*\/?>/g,`
`).replace(/<[^>]*>/g,""),i=0;i<e.length;++i)r=r.replace(e[i][0],e[i][1]);return r}}(),FL=function(){var e={};return function(t){return e[t]!==void 0?e[t]:e[t]=new RegExp("<(?:vt:)?"+t+">([\\s\\S]*?)</(?:vt:)?"+t+">","g")}}(),PL=/<\/?(?:vt:)?variant>/g,LL=/<(?:vt:)([^>]*)>([\s\S]*)</;function RT(e,n){var t=Ee(e),r=e.match(FL(t.baseType))||[],i=[];if(r.length!=t.size){if(n.WTF)throw new Error("unexpected vector length "+r.length+" != "+t.size);return i}return r.forEach(function(s){var o=s.replace(PL,"").match(LL);o&&i.push({v:ct(o[2]),t:o[1]})}),i}var BL=/(^\s|\s$|\n)/;function UL(e){return zr(e).map(function(n){return" "+n+'="'+e[n]+'"'}).join("")}function jL(e,n,t){return"<"+e+(t!=null?UL(t):"")+(n!=null?(n.match(BL)?' xml:space="preserve"':"")+">"+n+"</"+e:"/")+">"}function Ag(e){if(Ue&&Buffer.isBuffer(e))return e.toString("utf8");if(typeof e=="string")return e;if(typeof Uint8Array<"u"&&e instanceof Uint8Array)return ct(Hs(Tg(e)));throw new Error("Bad input format: expected Buffer or string")}var nl=/<(\/?)([^\s?><!\/:]*:|)([^\s?<>:\/]+)(?:[\s?:\/][^>]*)?>/mg,VL={CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/metadata/core-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/custom-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/extended-properties",CT:"http://schemas.openxmlformats.org/package/2006/content-types",RELS:"http://schemas.openxmlformats.org/package/2006/relationships",TCMNT:"http://schemas.microsoft.com/office/spreadsheetml/2018/threadedcomments",dc:"http://purl.org/dc/elements/1.1/",dcterms:"http://purl.org/dc/terms/",dcmitype:"http://purl.org/dc/dcmitype/",mx:"http://schemas.microsoft.com/office/mac/excel/2008/main",r:"http://schemas.openxmlformats.org/officeDocument/2006/relationships",sjs:"http://schemas.openxmlformats.org/package/2006/sheetjs/core-properties",vt:"http://schemas.openxmlformats.org/officeDocument/2006/docPropsVTypes",xsi:"http://www.w3.org/2001/XMLSchema-instance",xsd:"http://www.w3.org/2001/XMLSchema"},HL=["http://schemas.openxmlformats.org/spreadsheetml/2006/main","http://purl.oclc.org/ooxml/spreadsheetml/main","http://schemas.microsoft.com/office/excel/2006/main","http://schemas.microsoft.com/office/excel/2006/2"];function $L(e,n){for(var t=1-2*(e[n+7]>>>7),r=((e[n+7]&127)<<4)+(e[n+6]>>>4&15),i=e[n+6]&15,s=5;s>=0;--s)i=i*256+e[n+s];return r==2047?i==0?t*(1/0):NaN:(r==0?r=-1022:(r-=1023,i+=Math.pow(2,52)),t*Math.pow(2,r-52)*i)}function WL(e,n,t){var r=(n<0||1/n==-1/0?1:0)<<7,i=0,s=0,o=r?-n:n;isFinite(o)?o==0?i=s=0:(i=Math.floor(Math.log(o)/Math.LN2),s=o*Math.pow(2,52-i),i<=-1023&&(!isFinite(s)||s<Math.pow(2,52))?i=-1022:(s-=Math.pow(2,52),i+=1023)):(i=2047,s=isNaN(n)?26985:0);for(var a=0;a<=5;++a,s/=256)e[t+a]=s&255;e[t+6]=(i&15)<<4|s&15,e[t+7]=i>>4|r}var MT=function(e){for(var n=[],t=10240,r=0;r<e[0].length;++r)if(e[0][r])for(var i=0,s=e[0][r].length;i<s;i+=t)n.push.apply(n,e[0][r].slice(i,i+t));return n},OT=Ue?function(e){return e[0].length>0&&Buffer.isBuffer(e[0][0])?Buffer.concat(e[0].map(function(n){return Buffer.isBuffer(n)?n:Vs(n)})):MT(e)}:MT,FT=function(e,n,t){for(var r=[],i=n;i<t;i+=2)r.push(String.fromCharCode(pi(e,i)));return r.join("").replace(un,"")},Ad=Ue?function(e,n,t){return Buffer.isBuffer(e)?e.toString("utf16le",n,t).replace(un,""):FT(e,n,t)}:FT,PT=function(e,n,t){for(var r=[],i=n;i<n+t;++i)r.push(("0"+e[i].toString(16)).slice(-2));return r.join("")},VI=Ue?function(e,n,t){return Buffer.isBuffer(e)?e.toString("hex",n,n+t):PT(e,n,t)}:PT,LT=function(e,n,t){for(var r=[],i=n;i<t;i++)r.push(String.fromCharCode(ra(e,i)));return r.join("")},fa=Ue?function(n,t,r){return Buffer.isBuffer(n)?n.toString("utf8",t,r):LT(n,t,r)}:LT,HI=function(e,n){var t=$t(e,n);return t>0?fa(e,n+4,n+4+t-1):""},kg=HI,$I=function(e,n){var t=$t(e,n);return t>0?fa(e,n+4,n+4+t-1):""},Ng=$I,WI=function(e,n){var t=2*$t(e,n);return t>0?fa(e,n+4,n+4+t-1):""},Rg=WI,zI=function(n,t){var r=$t(n,t);return r>0?Ad(n,t+4,t+4+r):""},Mg=zI,GI=function(e,n){var t=$t(e,n);return t>0?fa(e,n+4,n+4+t):""},Og=GI,qI=function(e,n){return $L(e,n)},yd=qI,KI=function(n){return Array.isArray(n)||typeof Uint8Array<"u"&&n instanceof Uint8Array};Ue&&(kg=function(n,t){if(!Buffer.isBuffer(n))return HI(n,t);var r=n.readUInt32LE(t);return r>0?n.toString("utf8",t+4,t+4+r-1):""},Ng=function(n,t){if(!Buffer.isBuffer(n))return $I(n,t);var r=n.readUInt32LE(t);return r>0?n.toString("utf8",t+4,t+4+r-1):""},Rg=function(n,t){if(!Buffer.isBuffer(n))return WI(n,t);var r=2*n.readUInt32LE(t);return n.toString("utf16le",t+4,t+4+r-1)},Mg=function(n,t){if(!Buffer.isBuffer(n))return zI(n,t);var r=n.readUInt32LE(t);return n.toString("utf16le",t+4,t+4+r)},Og=function(n,t){if(!Buffer.isBuffer(n))return GI(n,t);var r=n.readUInt32LE(t);return n.toString("utf8",t+4,t+4+r)},yd=function(n,t){return Buffer.isBuffer(n)?n.readDoubleLE(t):qI(n,t)},KI=function(n){return Buffer.isBuffer(n)||Array.isArray(n)||typeof Uint8Array<"u"&&n instanceof Uint8Array});function zL(){Ad=function(e,n,t){return nt.utils.decode(1200,e.slice(n,t)).replace(un,"")},fa=function(e,n,t){return nt.utils.decode(65001,e.slice(n,t))},kg=function(e,n){var t=$t(e,n);return t>0?nt.utils.decode(aa,e.slice(n+4,n+4+t-1)):""},Ng=function(e,n){var t=$t(e,n);return t>0?nt.utils.decode(Wr,e.slice(n+4,n+4+t-1)):""},Rg=function(e,n){var t=2*$t(e,n);return t>0?nt.utils.decode(1200,e.slice(n+4,n+4+t-1)):""},Mg=function(e,n){var t=$t(e,n);return t>0?nt.utils.decode(1200,e.slice(n+4,n+4+t)):""},Og=function(e,n){var t=$t(e,n);return t>0?nt.utils.decode(65001,e.slice(n+4,n+4+t)):""}}typeof nt<"u"&&zL();var ra=function(e,n){return e[n]},pi=function(e,n){return e[n+1]*256+e[n]},GL=function(e,n){var t=e[n+1]*256+e[n];return t<32768?t:(65535-t+1)*-1},$t=function(e,n){return e[n+3]*(1<<24)+(e[n+2]<<16)+(e[n+1]<<8)+e[n]},Os=function(e,n){return e[n+3]<<24|e[n+2]<<16|e[n+1]<<8|e[n]},qL=function(e,n){return e[n]<<24|e[n+1]<<16|e[n+2]<<8|e[n+3]};function zc(e,n){var t="",r,i,s=[],o,a,c,l;switch(n){case"dbcs":if(l=this.l,Ue&&Buffer.isBuffer(this))t=this.slice(this.l,this.l+2*e).toString("utf16le");else for(c=0;c<e;++c)t+=String.fromCharCode(pi(this,l)),l+=2;e*=2;break;case"utf8":t=fa(this,this.l,this.l+e);break;case"utf16le":e*=2,t=Ad(this,this.l,this.l+e);break;case"wstr":if(typeof nt<"u")t=nt.utils.decode(Wr,this.slice(this.l,this.l+2*e));else return zc.call(this,e,"dbcs");e=2*e;break;case"lpstr-ansi":t=kg(this,this.l),e=4+$t(this,this.l);break;case"lpstr-cp":t=Ng(this,this.l),e=4+$t(this,this.l);break;case"lpwstr":t=Rg(this,this.l),e=4+2*$t(this,this.l);break;case"lpp4":e=4+$t(this,this.l),t=Mg(this,this.l),e&2&&(e+=2);break;case"8lpp4":e=4+$t(this,this.l),t=Og(this,this.l),e&3&&(e+=4-(e&3));break;case"cstr":for(e=0,t="";(o=ra(this,this.l+e++))!==0;)s.push(ad(o));t=s.join("");break;case"_wstr":for(e=0,t="";(o=pi(this,this.l+e))!==0;)s.push(ad(o)),e+=2;e+=2,t=s.join("");break;case"dbcs-cont":for(t="",l=this.l,c=0;c<e;++c){if(this.lens&&this.lens.indexOf(l)!==-1)return o=ra(this,l),this.l=l+1,a=zc.call(this,e-c,o?"dbcs-cont":"sbcs-cont"),s.join("")+a;s.push(ad(pi(this,l))),l+=2}t=s.join(""),e*=2;break;case"cpstr":if(typeof nt<"u"){t=nt.utils.decode(Wr,this.slice(this.l,this.l+e));break}case"sbcs-cont":for(t="",l=this.l,c=0;c!=e;++c){if(this.lens&&this.lens.indexOf(l)!==-1)return o=ra(this,l),this.l=l+1,a=zc.call(this,e-c,o?"dbcs-cont":"sbcs-cont"),s.join("")+a;s.push(ad(ra(this,l))),l+=1}t=s.join("");break;default:switch(e){case 1:return r=ra(this,this.l),this.l++,r;case 2:return r=(n==="i"?GL:pi)(this,this.l),this.l+=2,r;case 4:case-4:return n==="i"||!(this[this.l+3]&128)?(r=(e>0?Os:qL)(this,this.l),this.l+=4,r):(i=$t(this,this.l),this.l+=4,i);case 8:case-8:if(n==="f")return e==8?i=yd(this,this.l):i=yd([this[this.l+7],this[this.l+6],this[this.l+5],this[this.l+4],this[this.l+3],this[this.l+2],this[this.l+1],this[this.l+0]],0),this.l+=8,i;e=8;case 16:t=VI(this,this.l,e);break}}return this.l+=e,t}var KL=function(e,n,t){e[t]=n&255,e[t+1]=n>>>8&255,e[t+2]=n>>>16&255,e[t+3]=n>>>24&255},YL=function(e,n,t){e[t]=n&255,e[t+1]=n>>8&255,e[t+2]=n>>16&255,e[t+3]=n>>24&255},XL=function(e,n,t){e[t]=n&255,e[t+1]=n>>>8&255};function QL(e,n,t){var r=0,i=0;if(t==="dbcs"){for(i=0;i!=n.length;++i)XL(this,n.charCodeAt(i),this.l+2*i);r=2*n.length}else if(t==="sbcs"){if(typeof nt<"u"&&aa==874)for(i=0;i!=n.length;++i){var s=nt.utils.encode(aa,n.charAt(i));this[this.l+i]=s[0]}else for(n=n.replace(/[^\x00-\x7F]/g,"_"),i=0;i!=n.length;++i)this[this.l+i]=n.charCodeAt(i)&255;r=n.length}else if(t==="hex"){for(;i<e;++i)this[this.l++]=parseInt(n.slice(2*i,2*i+2),16)||0;return this}else if(t==="utf16le"){var o=Math.min(this.l+e,this.length);for(i=0;i<Math.min(n.length,e);++i){var a=n.charCodeAt(i);this[this.l++]=a&255,this[this.l++]=a>>8}for(;this.l<o;)this[this.l++]=0;return this}else switch(e){case 1:r=1,this[this.l]=n&255;break;case 2:r=2,this[this.l]=n&255,n>>>=8,this[this.l+1]=n&255;break;case 3:r=3,this[this.l]=n&255,n>>>=8,this[this.l+1]=n&255,n>>>=8,this[this.l+2]=n&255;break;case 4:r=4,KL(this,n,this.l);break;case 8:if(r=8,t==="f"){WL(this,n,this.l);break}case 16:break;case-4:r=4,YL(this,n,this.l);break}return this.l+=r,this}function YI(e,n){var t=VI(this,this.l,e.length>>1);if(t!==e)throw new Error(n+"Expected "+e+" saw "+t);this.l+=e.length>>1}function Jt(e,n){e.l=n,e.read_shift=zc,e.chk=YI,e.write_shift=QL}function dn(e,n){e.l+=n}function kt(e){var n=Xi(e);return Jt(n,0),n}function _i(e,n,t){if(e){var r,i,s;Jt(e,e.l||0);for(var o=e.length,a=0,c=0;e.l<o;){a=e.read_shift(1),a&128&&(a=(a&127)+((e.read_shift(1)&127)<<7));var l=Sd[a]||Sd[65535];for(r=e.read_shift(1),s=r&127,i=1;i<4&&r&128;++i)s+=((r=e.read_shift(1))&127)<<7*i;c=e.l+s;var u=l.f&&l.f(e,s,t);if(e.l=c,n(u,l,a))return}}}function fg(){var e=[],n=Ue?256:2048,t=function(l){var u=kt(l);return Jt(u,0),u},r=t(n),i=function(){r&&(r.length>r.l&&(r=r.slice(0,r.l),r.l=r.length),r.length>0&&e.push(r),r=null)},s=function(l){return r&&l<r.length-r.l?r:(i(),r=t(Math.max(l+1,n)))},o=function(){return i(),Gi(e)},a=function(l){i(),r=l,r.l==null&&(r.l=r.length),s(n)};return{next:s,push:a,end:o,_bufs:e}}function Gc(e,n,t){var r=en(e);if(n.s?(r.cRel&&(r.c+=n.s.c),r.rRel&&(r.r+=n.s.r)):(r.cRel&&(r.c+=n.c),r.rRel&&(r.r+=n.r)),!t||t.biff<12){for(;r.c>=256;)r.c-=256;for(;r.r>=65536;)r.r-=65536}return r}function BT(e,n,t){var r=en(e);return r.s=Gc(r.s,n.s,t),r.e=Gc(r.e,n.s,t),r}function qc(e,n){if(e.cRel&&e.c<0)for(e=en(e);e.c<0;)e.c+=n>8?16384:256;if(e.rRel&&e.r<0)for(e=en(e);e.r<0;)e.r+=n>8?1048576:n>5?65536:16384;var t=Ce(e);return!e.cRel&&e.cRel!=null&&(t=e4(t)),!e.rRel&&e.rRel!=null&&(t=ZL(t)),t}function ng(e,n){return e.s.r==0&&!e.s.rRel&&e.e.r==(n.biff>=12?1048575:n.biff>=8?65536:16384)&&!e.e.rRel?(e.s.cRel?"":"$")+Ot(e.s.c)+":"+(e.e.cRel?"":"$")+Ot(e.e.c):e.s.c==0&&!e.s.cRel&&e.e.c==(n.biff>=12?16383:255)&&!e.e.cRel?(e.s.rRel?"":"$")+tn(e.s.r)+":"+(e.e.rRel?"":"$")+tn(e.e.r):qc(e.s,n.biff)+":"+qc(e.e,n.biff)}function Fg(e){return parseInt(JL(e),10)-1}function tn(e){return""+(e+1)}function ZL(e){return e.replace(/([A-Z]|^)(\d+)$/,"$1$$$2")}function JL(e){return e.replace(/\$(\d+)$/,"$1")}function Pg(e){for(var n=t4(e),t=0,r=0;r!==n.length;++r)t=26*t+n.charCodeAt(r)-64;return t-1}function Ot(e){if(e<0)throw new Error("invalid column "+e);var n="";for(++e;e;e=Math.floor((e-1)/26))n=String.fromCharCode((e-1)%26+65)+n;return n}function e4(e){return e.replace(/^([A-Z])/,"$$$1")}function t4(e){return e.replace(/^\$([A-Z])/,"$1")}function n4(e){return e.replace(/(\$?[A-Z]*)(\$?\d*)/,"$1,$2").split(",")}function wn(e){for(var n=0,t=0,r=0;r<e.length;++r){var i=e.charCodeAt(r);i>=48&&i<=57?n=10*n+(i-48):i>=65&&i<=90&&(t=26*t+(i-64))}return{c:t-1,r:n-1}}function Ce(e){for(var n=e.c+1,t="";n;n=(n-1)/26|0)t=String.fromCharCode((n-1)%26+65)+t;return t+(e.r+1)}function da(e){var n=e.indexOf(":");return n==-1?{s:wn(e),e:wn(e)}:{s:wn(e.slice(0,n)),e:wn(e.slice(n+1))}}function Ge(e,n){return typeof n>"u"||typeof n=="number"?Ge(e.s,e.e):(typeof e!="string"&&(e=Ce(e)),typeof n!="string"&&(n=Ce(n)),e==n?e:e+":"+n)}function _t(e){var n={s:{c:0,r:0},e:{c:0,r:0}},t=0,r=0,i=0,s=e.length;for(t=0;r<s&&!((i=e.charCodeAt(r)-64)<1||i>26);++r)t=26*t+i;for(n.s.c=--t,t=0;r<s&&!((i=e.charCodeAt(r)-48)<0||i>9);++r)t=10*t+i;if(n.s.r=--t,r===s||i!=10)return n.e.c=n.s.c,n.e.r=n.s.r,n;for(++r,t=0;r!=s&&!((i=e.charCodeAt(r)-64)<1||i>26);++r)t=26*t+i;for(n.e.c=--t,t=0;r!=s&&!((i=e.charCodeAt(r)-48)<0||i>9);++r)t=10*t+i;return n.e.r=--t,n}function UT(e,n){var t=e.t=="d"&&n instanceof Date;if(e.z!=null)try{return e.w=tr(e.z,t?En(n):n)}catch{}try{return e.w=tr((e.XF||{}).numFmtId||(t?14:0),t?En(n):n)}catch{return""+n}}function vi(e,n,t){return e==null||e.t==null||e.t=="z"?"":e.w!==void 0?e.w:(e.t=="d"&&!e.z&&t&&t.dateNF&&(e.z=t.dateNF),e.t=="e"?zs[e.v]||e.v:n==null?UT(e,e.v):UT(e,n))}function Zi(e,n){var t=n&&n.sheet?n.sheet:"Sheet1",r={};return r[t]=e,{SheetNames:[t],Sheets:r}}function XI(e,n,t){var r=t||{},i=e?Array.isArray(e):r.dense;Nt!=null&&i==null&&(i=Nt);var s=e||(i?[]:{}),o=0,a=0;if(s&&r.origin!=null){if(typeof r.origin=="number")o=r.origin;else{var c=typeof r.origin=="string"?wn(r.origin):r.origin;o=c.r,a=c.c}s["!ref"]||(s["!ref"]="A1:A1")}var l={s:{c:1e7,r:1e7},e:{c:0,r:0}};if(s["!ref"]){var u=_t(s["!ref"]);l.s.c=u.s.c,l.s.r=u.s.r,l.e.c=Math.max(l.e.c,u.e.c),l.e.r=Math.max(l.e.r,u.e.r),o==-1&&(l.e.r=o=u.e.r+1)}for(var f=0;f!=n.length;++f)if(n[f]){if(!Array.isArray(n[f]))throw new Error("aoa_to_sheet expects an array of arrays");for(var d=0;d!=n[f].length;++d)if(!(typeof n[f][d]>"u")){var h={v:n[f][d]},m=o+f,p=a+d;if(l.s.r>m&&(l.s.r=m),l.s.c>p&&(l.s.c=p),l.e.r<m&&(l.e.r=m),l.e.c<p&&(l.e.c=p),n[f][d]&&typeof n[f][d]=="object"&&!Array.isArray(n[f][d])&&!(n[f][d]instanceof Date))h=n[f][d];else if(Array.isArray(h.v)&&(h.f=n[f][d][1],h.v=h.v[0]),h.v===null)if(h.f)h.t="n";else if(r.nullError)h.t="e",h.v=0;else if(r.sheetStubs)h.t="z";else continue;else typeof h.v=="number"?h.t="n":typeof h.v=="boolean"?h.t="b":h.v instanceof Date?(h.z=r.dateNF||Ae[14],r.cellDates?(h.t="d",h.w=tr(h.z,En(h.v))):(h.t="n",h.v=En(h.v),h.w=tr(h.z,h.v))):h.t="s";if(i)s[m]||(s[m]=[]),s[m][p]&&s[m][p].z&&(h.z=s[m][p].z),s[m][p]=h;else{var g=Ce({c:p,r:m});s[g]&&s[g].z&&(h.z=s[g].z),s[g]=h}}}return l.s.c<1e7&&(s["!ref"]=Ge(l)),s}function ha(e,n){return XI(null,e,n)}function r4(e){return e.read_shift(4,"i")}function fn(e){var n=e.read_shift(4);return n===0?"":e.read_shift(n,"dbcs")}function i4(e){return{ich:e.read_shift(2),ifnt:e.read_shift(2)}}function Lg(e,n){var t=e.l,r=e.read_shift(1),i=fn(e),s=[],o={t:i,h:i};if(r&1){for(var a=e.read_shift(4),c=0;c!=a;++c)s.push(i4(e));o.r=s}else o.r=[{ich:0,ifnt:0}];return e.l=t+n,o}var s4=Lg;function nr(e){var n=e.read_shift(4),t=e.read_shift(2);return t+=e.read_shift(1)<<16,e.l++,{c:n,iStyleRef:t}}function $s(e){var n=e.read_shift(2);return n+=e.read_shift(1)<<16,e.l++,{c:-1,iStyleRef:n}}var o4=fn;function Bg(e){var n=e.read_shift(4);return n===0||n===4294967295?"":e.read_shift(n,"dbcs")}var a4=fn,dg=Bg;function Ug(e){var n=e.slice(e.l,e.l+4),t=n[0]&1,r=n[0]&2;e.l+=4;var i=r===0?yd([0,0,0,0,n[0]&252,n[1],n[2],n[3]],0):Os(n,0)>>2;return t?i/100:i}function QI(e){var n={s:{},e:{}};return n.s.r=e.read_shift(4),n.e.r=e.read_shift(4),n.s.c=e.read_shift(4),n.e.c=e.read_shift(4),n}var Ws=QI;function cn(e){if(e.length-e.l<8)throw"XLS Xnum Buffer underflow";return e.read_shift(8,"f")}function c4(e){var n={},t=e.read_shift(1),r=t>>>1,i=e.read_shift(1),s=e.read_shift(2,"i"),o=e.read_shift(1),a=e.read_shift(1),c=e.read_shift(1);switch(e.l++,r){case 0:n.auto=1;break;case 1:n.index=i;var l=Ls[i];l&&(n.rgb=il(l));break;case 2:n.rgb=il([o,a,c]);break;case 3:n.theme=i;break}return s!=0&&(n.tint=s>0?s/32767:s/32768),n}function l4(e){var n=e.read_shift(1);e.l++;var t={fBold:n&1,fItalic:n&2,fUnderline:n&4,fStrikeout:n&8,fOutline:n&16,fShadow:n&32,fCondense:n&64,fExtend:n&128};return t}function ZI(e,n){var t={2:"BITMAP",3:"METAFILEPICT",8:"DIB",14:"ENHMETAFILE"},r=e.read_shift(4);switch(r){case 0:return"";case 4294967295:case 4294967294:return t[e.read_shift(4)]||""}if(r>400)throw new Error("Unsupported Clipboard: "+r.toString(16));return e.l-=4,e.read_shift(0,n==1?"lpstr":"lpwstr")}function u4(e){return ZI(e,1)}function f4(e){return ZI(e,2)}var jg=2,kn=3,ld=11,jT=12,wd=19;var ud=64,d4=65,h4=71;var p4=4108,m4=4126,Ht=80,JI=81,g4=[Ht,JI],v4={1:{n:"CodePage",t:jg},2:{n:"Category",t:Ht},3:{n:"PresentationFormat",t:Ht},4:{n:"ByteCount",t:kn},5:{n:"LineCount",t:kn},6:{n:"ParagraphCount",t:kn},7:{n:"SlideCount",t:kn},8:{n:"NoteCount",t:kn},9:{n:"HiddenCount",t:kn},10:{n:"MultimediaClipCount",t:kn},11:{n:"ScaleCrop",t:ld},12:{n:"HeadingPairs",t:p4},13:{n:"TitlesOfParts",t:m4},14:{n:"Manager",t:Ht},15:{n:"Company",t:Ht},16:{n:"LinksUpToDate",t:ld},17:{n:"CharacterCount",t:kn},19:{n:"SharedDoc",t:ld},22:{n:"HyperlinksChanged",t:ld},23:{n:"AppVersion",t:kn,p:"version"},24:{n:"DigSig",t:d4},26:{n:"ContentType",t:Ht},27:{n:"ContentStatus",t:Ht},28:{n:"Language",t:Ht},29:{n:"Version",t:Ht},255:{},2147483648:{n:"Locale",t:wd},2147483651:{n:"Behavior",t:wd},1919054434:{}},_4={1:{n:"CodePage",t:jg},2:{n:"Title",t:Ht},3:{n:"Subject",t:Ht},4:{n:"Author",t:Ht},5:{n:"Keywords",t:Ht},6:{n:"Comments",t:Ht},7:{n:"Template",t:Ht},8:{n:"LastAuthor",t:Ht},9:{n:"RevNumber",t:Ht},10:{n:"EditTime",t:ud},11:{n:"LastPrinted",t:ud},12:{n:"CreatedDate",t:ud},13:{n:"ModifiedDate",t:ud},14:{n:"PageCount",t:kn},15:{n:"WordCount",t:kn},16:{n:"CharCount",t:kn},17:{n:"Thumbnail",t:h4},18:{n:"Application",t:Ht},19:{n:"DocSecurity",t:kn},255:{},2147483648:{n:"Locale",t:wd},2147483651:{n:"Behavior",t:wd},1919054434:{}},VT={1:"US",2:"CA",3:"",7:"RU",20:"EG",30:"GR",31:"NL",32:"BE",33:"FR",34:"ES",36:"HU",39:"IT",41:"CH",43:"AT",44:"GB",45:"DK",46:"SE",47:"NO",48:"PL",49:"DE",52:"MX",55:"BR",61:"AU",64:"NZ",66:"TH",81:"JP",82:"KR",84:"VN",86:"CN",90:"TR",105:"JS",213:"DZ",216:"MA",218:"LY",351:"PT",354:"IS",358:"FI",420:"CZ",886:"TW",961:"LB",962:"JO",963:"SY",964:"IQ",965:"KW",966:"SA",971:"AE",972:"IL",974:"QA",981:"IR",65535:"US"},x4=[null,"solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"];function y4(e){return e.map(function(n){return[n>>16&255,n>>8&255,n&255]})}var w4=y4([0,16777215,16711680,65280,255,16776960,16711935,65535,0,16777215,16711680,65280,255,16776960,16711935,65535,8388608,32768,128,8421376,8388736,32896,12632256,8421504,10066431,10040166,16777164,13434879,6684774,16744576,26316,13421823,128,16711935,16776960,65535,8388736,8388608,32896,255,52479,13434879,13434828,16777113,10079487,16751052,13408767,16764057,3368703,3394764,10079232,16763904,16750848,16737792,6710937,9868950,13158,3381606,13056,3355392,10040064,10040166,3355545,3355443,16777215,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),Ls=en(w4),zs={0:"#NULL!",7:"#DIV/0!",15:"#VALUE!",23:"#REF!",29:"#NAME?",36:"#NUM!",42:"#N/A",43:"#GETTING_DATA",255:"#WTF?"},eC={"#NULL!":0,"#DIV/0!":7,"#VALUE!":15,"#REF!":23,"#NAME?":29,"#NUM!":36,"#N/A":42,"#GETTING_DATA":43,"#WTF?":255},HT={"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml":"workbooks","application/vnd.ms-excel.sheet.macroEnabled.main+xml":"workbooks","application/vnd.ms-excel.sheet.binary.macroEnabled.main":"workbooks","application/vnd.ms-excel.addin.macroEnabled.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml":"sheets","application/vnd.ms-excel.worksheet":"sheets","application/vnd.ms-excel.binIndexWs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml":"charts","application/vnd.ms-excel.chartsheet":"charts","application/vnd.ms-excel.macrosheet+xml":"macros","application/vnd.ms-excel.macrosheet":"macros","application/vnd.ms-excel.intlmacrosheet":"TODO","application/vnd.ms-excel.binIndexMs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml":"dialogs","application/vnd.ms-excel.dialogsheet":"dialogs","application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml":"strs","application/vnd.ms-excel.sharedStrings":"strs","application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml":"styles","application/vnd.ms-excel.styles":"styles","application/vnd.openxmlformats-package.core-properties+xml":"coreprops","application/vnd.openxmlformats-officedocument.custom-properties+xml":"custprops","application/vnd.openxmlformats-officedocument.extended-properties+xml":"extprops","application/vnd.openxmlformats-officedocument.customXmlProperties+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.customProperty":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml":"comments","application/vnd.ms-excel.comments":"comments","application/vnd.ms-excel.threadedcomments+xml":"threadedcomments","application/vnd.ms-excel.person+xml":"people","application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml":"metadata","application/vnd.ms-excel.sheetMetadata":"metadata","application/vnd.ms-excel.pivotTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotTable+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.chart+xml":"TODO","application/vnd.ms-office.chartcolorstyle+xml":"TODO","application/vnd.ms-office.chartstyle+xml":"TODO","application/vnd.ms-office.chartex+xml":"TODO","application/vnd.ms-excel.calcChain":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.calcChain+xml":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.printerSettings":"TODO","application/vnd.ms-office.activeX":"TODO","application/vnd.ms-office.activeX+xml":"TODO","application/vnd.ms-excel.attachedToolbars":"TODO","application/vnd.ms-excel.connections":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.connections+xml":"TODO","application/vnd.ms-excel.externalLink":"links","application/vnd.openxmlformats-officedocument.spreadsheetml.externalLink+xml":"links","application/vnd.ms-excel.pivotCacheDefinition":"TODO","application/vnd.ms-excel.pivotCacheRecords":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheDefinition+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheRecords+xml":"TODO","application/vnd.ms-excel.queryTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.queryTable+xml":"TODO","application/vnd.ms-excel.userNames":"TODO","application/vnd.ms-excel.revisionHeaders":"TODO","application/vnd.ms-excel.revisionLog":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionHeaders+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionLog+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.userNames+xml":"TODO","application/vnd.ms-excel.tableSingleCells":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.tableSingleCells+xml":"TODO","application/vnd.ms-excel.slicer":"TODO","application/vnd.ms-excel.slicerCache":"TODO","application/vnd.ms-excel.slicer+xml":"TODO","application/vnd.ms-excel.slicerCache+xml":"TODO","application/vnd.ms-excel.wsSortMap":"TODO","application/vnd.ms-excel.table":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.table+xml":"TODO","application/vnd.openxmlformats-officedocument.theme+xml":"themes","application/vnd.openxmlformats-officedocument.themeOverride+xml":"TODO","application/vnd.ms-excel.Timeline+xml":"TODO","application/vnd.ms-excel.TimelineCache+xml":"TODO","application/vnd.ms-office.vbaProject":"vba","application/vnd.ms-office.vbaProjectSignature":"TODO","application/vnd.ms-office.volatileDependencies":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.volatileDependencies+xml":"TODO","application/vnd.ms-excel.controlproperties+xml":"TODO","application/vnd.openxmlformats-officedocument.model+data":"TODO","application/vnd.ms-excel.Survey+xml":"TODO","application/vnd.openxmlformats-officedocument.drawing+xml":"drawings","application/vnd.openxmlformats-officedocument.drawingml.chartshapes+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramColors+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramData+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramLayout+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramStyle+xml":"TODO","application/vnd.openxmlformats-officedocument.vmlDrawing":"TODO","application/vnd.openxmlformats-package.relationships+xml":"rels","application/vnd.openxmlformats-officedocument.oleObject":"TODO","image/png":"TODO",sheet:"js"};function E4(){return{workbooks:[],sheets:[],charts:[],dialogs:[],macros:[],rels:[],strs:[],comments:[],threadedcomments:[],links:[],coreprops:[],extprops:[],custprops:[],themes:[],styles:[],calcchains:[],vba:[],drawings:[],metadata:[],people:[],TODO:[],xmlns:""}}function T4(e){var n=E4();if(!e||!e.match)return n;var t={};if((e.match(hn)||[]).forEach(function(r){var i=Ee(r);switch(i[0].replace(kL,"<")){case"<?xml":break;case"<Types":n.xmlns=i["xmlns"+(i[0].match(/<(\w+):/)||["",""])[1]];break;case"<Default":t[i.Extension]=i.ContentType;break;case"<Override":n[HT[i.ContentType]]!==void 0&&n[HT[i.ContentType]].push(i.PartName);break}}),n.xmlns!==VL.CT)throw new Error("Unknown Namespace: "+n.xmlns);return n.calcchain=n.calcchains.length>0?n.calcchains[0]:"",n.sst=n.strs.length>0?n.strs[0]:"",n.style=n.styles.length>0?n.styles[0]:"",n.defaults=t,delete n.calcchains,n}var hi={WB:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument",SHEET:"http://sheetjs.openxmlformats.org/officeDocument/2006/relationships/officeDocument",HLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink",VML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/vmlDrawing",XPATH:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLinkPath",XMISS:"http://schemas.microsoft.com/office/2006/relationships/xlExternalLinkPath/xlPathMissing",XLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLink",CXML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXml",CXMLP:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXmlProps",CMNT:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/comments",CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/custom-properties",SST:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings",STY:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles",THEME:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme",CHART:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chart",CHARTEX:"http://schemas.microsoft.com/office/2014/relationships/chartEx",CS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chartsheet",WS:["http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet","http://purl.oclc.org/ooxml/officeDocument/relationships/worksheet"],DS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/dialogsheet",MS:"http://schemas.microsoft.com/office/2006/relationships/xlMacrosheet",IMG:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/image",DRAW:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/drawing",XLMETA:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sheetMetadata",TCMNT:"http://schemas.microsoft.com/office/2017/10/relationships/threadedComment",PEOPLE:"http://schemas.microsoft.com/office/2017/10/relationships/person",VBA:"http://schemas.microsoft.com/office/2006/relationships/vbaProject"};function hg(e){var n=e.lastIndexOf("/");return e.slice(0,n+1)+"_rels/"+e.slice(n+1)+".rels"}function Kc(e,n){var t={"!id":{}};if(!e)return t;n.charAt(0)!=="/"&&(n="/"+n);var r={};return(e.match(hn)||[]).forEach(function(i){var s=Ee(i);if(s[0]==="<Relationship"){var o={};o.Type=s.Type,o.Target=s.Target,o.Id=s.Id,s.TargetMode&&(o.TargetMode=s.TargetMode);var a=s.TargetMode==="External"?s.Target:$c(s.Target,n);t[a]=o,r[s.Id]=o}}),t["!id"]=r,t}var I4="application/vnd.oasis.opendocument.spreadsheet";function C4(e,n){for(var t=Ag(e),r,i;r=nl.exec(t);)switch(r[3]){case"manifest":break;case"file-entry":if(i=Ee(r[0],!1),i.path=="/"&&i.type!==I4)throw new Error("This OpenDocument is not a spreadsheet");break;case"encryption-data":case"algorithm":case"start-key-generation":case"key-derivation":throw new Error("Unsupported ODS Encryption");default:if(n&&n.WTF)throw r}}var Yc=[["cp:category","Category"],["cp:contentStatus","ContentStatus"],["cp:keywords","Keywords"],["cp:lastModifiedBy","LastAuthor"],["cp:lastPrinted","LastPrinted"],["cp:revision","RevNumber"],["cp:version","Version"],["dc:creator","Author"],["dc:description","Comments"],["dc:identifier","Identifier"],["dc:language","Language"],["dc:subject","Subject"],["dc:title","Title"],["dcterms:created","CreatedDate","date"],["dcterms:modified","ModifiedDate","date"]],S4=function(){for(var e=new Array(Yc.length),n=0;n<Yc.length;++n){var t=Yc[n],r="(?:"+t[0].slice(0,t[0].indexOf(":"))+":)"+t[0].slice(t[0].indexOf(":")+1);e[n]=new RegExp("<"+r+"[^>]*>([\\s\\S]*?)</"+r+">")}return e}();function tC(e){var n={};e=ct(e);for(var t=0;t<Yc.length;++t){var r=Yc[t],i=e.match(S4[t]);i!=null&&i.length>0&&(n[r[1]]=Xe(i[1])),r[2]==="date"&&n[r[1]]&&(n[r[1]]=Wt(n[r[1]]))}return n}var D4=[["Application","Application","string"],["AppVersion","AppVersion","string"],["Company","Company","string"],["DocSecurity","DocSecurity","string"],["Manager","Manager","string"],["HyperlinksChanged","HyperlinksChanged","bool"],["SharedDoc","SharedDoc","bool"],["LinksUpToDate","LinksUpToDate","bool"],["ScaleCrop","ScaleCrop","bool"],["HeadingPairs","HeadingPairs","raw"],["TitlesOfParts","TitlesOfParts","raw"]];function nC(e,n,t,r){var i=[];if(typeof e=="string")i=RT(e,r);else for(var s=0;s<e.length;++s)i=i.concat(e[s].map(function(u){return{v:u}}));var o=typeof n=="string"?RT(n,r).map(function(u){return u.v}):n,a=0,c=0;if(o.length>0)for(var l=0;l!==i.length;l+=2){switch(c=+i[l+1].v,i[l].v){case"Worksheets":case"\u5DE5\u4F5C\u8868":case"\u041B\u0438\u0441\u0442\u044B":case"\u0623\u0648\u0631\u0627\u0642 \u0627\u0644\u0639\u0645\u0644":case"\u30EF\u30FC\u30AF\u30B7\u30FC\u30C8":case"\u05D2\u05DC\u05D9\u05D5\u05E0\u05D5\u05EA \u05E2\u05D1\u05D5\u05D3\u05D4":case"Arbeitsbl\xE4tter":case"\xC7al\u0131\u015Fma Sayfalar\u0131":case"Feuilles de calcul":case"Fogli di lavoro":case"Folhas de c\xE1lculo":case"Planilhas":case"Regneark":case"Hojas de c\xE1lculo":case"Werkbladen":t.Worksheets=c,t.SheetNames=o.slice(a,a+c);break;case"Named Ranges":case"Rangos con nombre":case"\u540D\u524D\u4ED8\u304D\u4E00\u89A7":case"Benannte Bereiche":case"Navngivne omr\xE5der":t.NamedRanges=c,t.DefinedNames=o.slice(a,a+c);break;case"Charts":case"Diagramme":t.Chartsheets=c,t.ChartNames=o.slice(a,a+c);break}a+=c}}function b4(e,n,t){var r={};return n||(n={}),e=ct(e),D4.forEach(function(i){var s=(e.match(tl(i[0]))||[])[1];switch(i[2]){case"string":s&&(n[i[1]]=Xe(s));break;case"bool":n[i[1]]=s==="true";break;case"raw":var o=e.match(new RegExp("<"+i[0]+"[^>]*>([\\s\\S]*?)</"+i[0]+">"));o&&o.length>0&&(r[i[1]]=o[1]);break}}),r.HeadingPairs&&r.TitlesOfParts&&nC(r.HeadingPairs,r.TitlesOfParts,n,t),n}var A4=/<[^>]+>[^<]*/g;function k4(e,n){var t={},r="",i=e.match(A4);if(i)for(var s=0;s!=i.length;++s){var o=i[s],a=Ee(o);switch(a[0]){case"<?xml":break;case"<Properties":break;case"<property":r=Xe(a.name);break;case"</property>":r=null;break;default:if(o.indexOf("<vt:")===0){var c=o.split(">"),l=c[0].slice(4),u=c[1];switch(l){case"lpstr":case"bstr":case"lpwstr":t[r]=Xe(u);break;case"bool":t[r]=ft(u);break;case"i1":case"i2":case"i4":case"i8":case"int":case"uint":t[r]=parseInt(u,10);break;case"r4":case"r8":case"decimal":t[r]=parseFloat(u);break;case"filetime":case"date":t[r]=Wt(u);break;case"cy":case"error":t[r]=Xe(u);break;default:if(l.slice(-1)=="/")break;n.WTF&&typeof console<"u"&&console.warn("Unexpected",o,l,c)}}else if(o.slice(0,2)!=="</"){if(n.WTF)throw new Error(o)}}}return t}var N4={Title:"Title",Subject:"Subject",Author:"Author",Keywords:"Keywords",Comments:"Description",LastAuthor:"LastAuthor",RevNumber:"Revision",Application:"AppName",LastPrinted:"LastPrinted",CreatedDate:"Created",ModifiedDate:"LastSaved",Category:"Category",Manager:"Manager",Company:"Company",AppVersion:"Version",ContentStatus:"ContentStatus",Identifier:"Identifier",Language:"Language"},rg;function R4(e,n,t){rg||(rg=Sg(N4)),n=rg[n]||n,e[n]=t}function Vg(e){var n=e.read_shift(4),t=e.read_shift(4);return new Date((t/1e7*Math.pow(2,32)+n/1e7-11644473600)*1e3).toISOString().replace(/\.000/,"")}function rC(e,n,t){var r=e.l,i=e.read_shift(0,"lpstr-cp");if(t)for(;e.l-r&3;)++e.l;return i}function iC(e,n,t){var r=e.read_shift(0,"lpwstr");return t&&(e.l+=4-(r.length+1&3)&3),r}function sC(e,n,t){return n===31?iC(e):rC(e,n,t)}function pg(e,n,t){return sC(e,n,t===!1?0:4)}function M4(e,n){if(!n)throw new Error("VtUnalignedString must have positive length");return sC(e,n,0)}function O4(e){for(var n=e.read_shift(4),t=[],r=0;r!=n;++r){var i=e.l;t[r]=e.read_shift(0,"lpwstr").replace(un,""),e.l-i&2&&(e.l+=2)}return t}function F4(e){for(var n=e.read_shift(4),t=[],r=0;r!=n;++r)t[r]=e.read_shift(0,"lpstr-cp").replace(un,"");return t}function P4(e){var n=e.l,t=Ed(e,JI);e[e.l]==0&&e[e.l+1]==0&&e.l-n&2&&(e.l+=2);var r=Ed(e,kn);return[t,r]}function L4(e){for(var n=e.read_shift(4),t=[],r=0;r<n/2;++r)t.push(P4(e));return t}function $T(e,n){for(var t=e.read_shift(4),r={},i=0;i!=t;++i){var s=e.read_shift(4),o=e.read_shift(4);r[s]=e.read_shift(o,n===1200?"utf16le":"utf8").replace(un,"").replace(Hc,"!"),n===1200&&o%2&&(e.l+=2)}return e.l&3&&(e.l=e.l>>3<<2),r}function oC(e){var n=e.read_shift(4),t=e.slice(e.l,e.l+n);return e.l+=n,(n&3)>0&&(e.l+=4-(n&3)&3),t}function B4(e){var n={};return n.Size=e.read_shift(4),e.l+=n.Size+3-(n.Size-1)%4,n}function Ed(e,n,t){var r=e.read_shift(2),i,s=t||{};if(e.l+=2,n!==jT&&r!==n&&g4.indexOf(n)===-1&&!((n&65534)==4126&&(r&65534)==4126))throw new Error("Expected type "+n+" saw "+r);switch(n===jT?r:n){case 2:return i=e.read_shift(2,"i"),s.raw||(e.l+=2),i;case 3:return i=e.read_shift(4,"i"),i;case 11:return e.read_shift(4)!==0;case 19:return i=e.read_shift(4),i;case 30:return rC(e,r,4).replace(un,"");case 31:return iC(e);case 64:return Vg(e);case 65:return oC(e);case 71:return B4(e);case 80:return pg(e,r,!s.raw).replace(un,"");case 81:return M4(e,r).replace(un,"");case 4108:return L4(e);case 4126:case 4127:return r==4127?O4(e):F4(e);default:throw new Error("TypedPropertyValue unrecognized type "+n+" "+r)}}function WT(e,n){var t=e.l,r=e.read_shift(4),i=e.read_shift(4),s=[],o=0,a=0,c=-1,l={};for(o=0;o!=i;++o){var u=e.read_shift(4),f=e.read_shift(4);s[o]=[u,f+t]}s.sort(function(C,_){return C[1]-_[1]});var d={};for(o=0;o!=i;++o){if(e.l!==s[o][1]){var h=!0;if(o>0&&n)switch(n[s[o-1][0]].t){case 2:e.l+2===s[o][1]&&(e.l+=2,h=!1);break;case 80:e.l<=s[o][1]&&(e.l=s[o][1],h=!1);break;case 4108:e.l<=s[o][1]&&(e.l=s[o][1],h=!1);break}if((!n||o==0)&&e.l<=s[o][1]&&(h=!1,e.l=s[o][1]),h)throw new Error("Read Error: Expected address "+s[o][1]+" at "+e.l+" :"+o)}if(n){var m=n[s[o][0]];if(d[m.n]=Ed(e,m.t,{raw:!0}),m.p==="version"&&(d[m.n]=String(d[m.n]>>16)+"."+("0000"+String(d[m.n]&65535)).slice(-4)),m.n=="CodePage")switch(d[m.n]){case 0:d[m.n]=1252;case 874:case 932:case 936:case 949:case 950:case 1250:case 1251:case 1253:case 1254:case 1255:case 1256:case 1257:case 1258:case 1e4:case 1200:case 1201:case 1252:case 65e3:case-536:case 65001:case-535:xr(a=d[m.n]>>>0&65535);break;default:throw new Error("Unsupported CodePage: "+d[m.n])}}else if(s[o][0]===1){if(a=d.CodePage=Ed(e,jg),xr(a),c!==-1){var p=e.l;e.l=s[c][1],l=$T(e,a),e.l=p}}else if(s[o][0]===0){if(a===0){c=o,e.l=s[o+1][1];continue}l=$T(e,a)}else{var g=l[s[o][0]],w;switch(e[e.l]){case 65:e.l+=4,w=oC(e);break;case 30:e.l+=4,w=pg(e,e[e.l-4]).replace(/\u0000+$/,"");break;case 31:e.l+=4,w=pg(e,e[e.l-4]).replace(/\u0000+$/,"");break;case 3:e.l+=4,w=e.read_shift(4,"i");break;case 19:e.l+=4,w=e.read_shift(4);break;case 5:e.l+=4,w=e.read_shift(8,"f");break;case 11:e.l+=4,w=Tt(e,4);break;case 64:e.l+=4,w=Wt(Vg(e));break;default:throw new Error("unparsed value: "+e[e.l])}d[g]=w}}return e.l=t+r,d}function zT(e,n,t){var r=e.content;if(!r)return{};Jt(r,0);var i,s,o,a,c=0;r.chk("feff","Byte Order: "),r.read_shift(2);var l=r.read_shift(4),u=r.read_shift(16);if(u!==ze.utils.consts.HEADER_CLSID&&u!==t)throw new Error("Bad PropertySet CLSID "+u);if(i=r.read_shift(4),i!==1&&i!==2)throw new Error("Unrecognized #Sets: "+i);if(s=r.read_shift(16),a=r.read_shift(4),i===1&&a!==r.l)throw new Error("Length mismatch: "+a+" !== "+r.l);i===2&&(o=r.read_shift(16),c=r.read_shift(4));var f=WT(r,n),d={SystemIdentifier:l};for(var h in f)d[h]=f[h];if(d.FMTID=s,i===1)return d;if(c-r.l==2&&(r.l+=2),r.l!==c)throw new Error("Length mismatch 2: "+r.l+" !== "+c);var m;try{m=WT(r,null)}catch{}for(h in m)d[h]=m[h];return d.FMTID=[s,o],d}function zi(e,n){return e.read_shift(n),null}function U4(e,n,t){for(var r=[],i=e.l+n;e.l<i;)r.push(t(e,i-e.l));if(i!==e.l)throw new Error("Slurp error");return r}function Tt(e,n){return e.read_shift(n)===1}function At(e){return e.read_shift(2,"u")}function aC(e,n){return U4(e,n,At)}function j4(e){var n=e.read_shift(1),t=e.read_shift(1);return t===1?n:n===1}function cl(e,n,t){var r=e.read_shift(t&&t.biff>=12?2:1),i="sbcs-cont",s=Wr;if(t&&t.biff>=8&&(Wr=1200),!t||t.biff==8){var o=e.read_shift(1);o&&(i="dbcs-cont")}else t.biff==12&&(i="wstr");t.biff>=2&&t.biff<=5&&(i="cpstr");var a=r?e.read_shift(r,i):"";return Wr=s,a}function V4(e){var n=Wr;Wr=1200;var t=e.read_shift(2),r=e.read_shift(1),i=r&4,s=r&8,o=1+(r&1),a=0,c,l={};s&&(a=e.read_shift(2)),i&&(c=e.read_shift(4));var u=o==2?"dbcs-cont":"sbcs-cont",f=t===0?"":e.read_shift(t,u);return s&&(e.l+=4*a),i&&(e.l+=c),l.t=f,s||(l.raw="<t>"+l.t+"</t>",l.r=l.t),Wr=n,l}function js(e,n,t){var r;if(t){if(t.biff>=2&&t.biff<=5)return e.read_shift(n,"cpstr");if(t.biff>=12)return e.read_shift(n,"dbcs-cont")}var i=e.read_shift(1);return i===0?r=e.read_shift(n,"sbcs-cont"):r=e.read_shift(n,"dbcs-cont"),r}function ll(e,n,t){var r=e.read_shift(t&&t.biff==2?1:2);return r===0?(e.l++,""):js(e,r,t)}function Gs(e,n,t){if(t.biff>5)return ll(e,n,t);var r=e.read_shift(1);return r===0?(e.l++,""):e.read_shift(r,t.biff<=4||!e.lens?"cpstr":"sbcs-cont")}function H4(e){var n=e.read_shift(1);e.l++;var t=e.read_shift(2);return e.l+=2,[n,t]}function $4(e){var n=e.read_shift(4),t=e.l,r=!1;n>24&&(e.l+=n-24,e.read_shift(16)==="795881f43b1d7f48af2c825dc4852763"&&(r=!0),e.l=t);var i=e.read_shift((r?n-24:n)>>1,"utf16le").replace(un,"");return r&&(e.l+=24),i}function W4(e){for(var n=e.read_shift(2),t="";n-- >0;)t+="../";var r=e.read_shift(0,"lpstr-ansi");if(e.l+=2,e.read_shift(2)!=57005)throw new Error("Bad FileMoniker");var i=e.read_shift(4);if(i===0)return t+r.replace(/\\/g,"/");var s=e.read_shift(4);if(e.read_shift(2)!=3)throw new Error("Bad FileMoniker");var o=e.read_shift(s>>1,"utf16le").replace(un,"");return t+o}function z4(e,n){var t=e.read_shift(16);switch(n-=16,t){case"e0c9ea79f9bace118c8200aa004ba90b":return $4(e,n);case"0303000000000000c000000000000046":return W4(e,n);default:throw new Error("Unsupported Moniker "+t)}}function fd(e){var n=e.read_shift(4),t=n>0?e.read_shift(n,"utf16le").replace(un,""):"";return t}function G4(e,n){var t=e.l+n,r=e.read_shift(4);if(r!==2)throw new Error("Unrecognized streamVersion: "+r);var i=e.read_shift(2);e.l+=2;var s,o,a,c,l="",u,f;i&16&&(s=fd(e,t-e.l)),i&128&&(o=fd(e,t-e.l)),(i&257)===257&&(a=fd(e,t-e.l)),(i&257)===1&&(c=z4(e,t-e.l)),i&8&&(l=fd(e,t-e.l)),i&32&&(u=e.read_shift(16)),i&64&&(f=Vg(e)),e.l=t;var d=o||a||c||"";d&&l&&(d+="#"+l),d||(d="#"+l),i&2&&d.charAt(0)=="/"&&d.charAt(1)!="/"&&(d="file://"+d);var h={Target:d};return u&&(h.guid=u),f&&(h.time=f),s&&(h.Tooltip=s),h}function cC(e){var n=e.read_shift(1),t=e.read_shift(1),r=e.read_shift(1),i=e.read_shift(1);return[n,t,r,i]}function lC(e,n){var t=cC(e,n);return t[3]=0,t}function qr(e){var n=e.read_shift(2),t=e.read_shift(2),r=e.read_shift(2);return{r:n,c:t,ixfe:r}}function q4(e){var n=e.read_shift(2),t=e.read_shift(2);return e.l+=8,{type:n,flags:t}}function K4(e,n,t){return n===0?"":Gs(e,n,t)}function Y4(e,n,t){var r=t.biff>8?4:2,i=e.read_shift(r),s=e.read_shift(r,"i"),o=e.read_shift(r,"i");return[i,s,o]}function uC(e){var n=e.read_shift(2),t=Ug(e);return[n,t]}function X4(e,n,t){e.l+=4,n-=4;var r=e.l+n,i=cl(e,n,t),s=e.read_shift(2);if(r-=e.l,s!==r)throw new Error("Malformed AddinUdf: padding = "+r+" != "+s);return e.l+=s,i}function kd(e){var n=e.read_shift(2),t=e.read_shift(2),r=e.read_shift(2),i=e.read_shift(2);return{s:{c:r,r:n},e:{c:i,r:t}}}function fC(e){var n=e.read_shift(2),t=e.read_shift(2),r=e.read_shift(1),i=e.read_shift(1);return{s:{c:r,r:n},e:{c:i,r:t}}}var Q4=fC;function dC(e){e.l+=4;var n=e.read_shift(2),t=e.read_shift(2),r=e.read_shift(2);return e.l+=12,[t,n,r]}function Z4(e){var n={};return e.l+=4,e.l+=16,n.fSharedNote=e.read_shift(2),e.l+=4,n}function J4(e){var n={};return e.l+=4,e.cf=e.read_shift(2),n}function on(e){e.l+=2,e.l+=e.read_shift(2)}var e3={0:on,4:on,5:on,6:on,7:J4,8:on,9:on,10:on,11:on,12:on,13:Z4,14:on,15:on,16:on,17:on,18:on,19:on,20:on,21:dC};function t3(e,n){for(var t=e.l+n,r=[];e.l<t;){var i=e.read_shift(2);e.l-=2;try{r.push(e3[i](e,t-e.l))}catch{return e.l=t,r}}return e.l!=t&&(e.l=t),r}function dd(e,n){var t={BIFFVer:0,dt:0};switch(t.BIFFVer=e.read_shift(2),n-=2,n>=2&&(t.dt=e.read_shift(2),e.l-=2),t.BIFFVer){case 1536:case 1280:case 1024:case 768:case 512:case 2:case 7:break;default:if(n>6)throw new Error("Unexpected BIFF Ver "+t.BIFFVer)}return e.read_shift(n),t}function n3(e,n){return n===0||e.read_shift(2),1200}function r3(e,n,t){if(t.enc)return e.l+=n,"";var r=e.l,i=Gs(e,0,t);return e.read_shift(n+r-e.l),i}function i3(e,n,t){var r=t&&t.biff==8||n==2?e.read_shift(2):(e.l+=n,0);return{fDialog:r&16,fBelow:r&64,fRight:r&128}}function s3(e,n,t){var r=e.read_shift(4),i=e.read_shift(1)&3,s=e.read_shift(1);switch(s){case 0:s="Worksheet";break;case 1:s="Macrosheet";break;case 2:s="Chartsheet";break;case 6:s="VBAModule";break}var o=cl(e,0,t);return o.length===0&&(o="Sheet1"),{pos:r,hs:i,dt:s,name:o}}function o3(e,n){for(var t=e.l+n,r=e.read_shift(4),i=e.read_shift(4),s=[],o=0;o!=i&&e.l<t;++o)s.push(V4(e));return s.Count=r,s.Unique=i,s}function a3(e,n){var t={};return t.dsst=e.read_shift(2),e.l+=n-2,t}function c3(e){var n={};n.r=e.read_shift(2),n.c=e.read_shift(2),n.cnt=e.read_shift(2)-n.c;var t=e.read_shift(2);e.l+=4;var r=e.read_shift(1);return e.l+=3,r&7&&(n.level=r&7),r&32&&(n.hidden=!0),r&64&&(n.hpt=t/20),n}function l3(e){var n=q4(e);if(n.type!=2211)throw new Error("Invalid Future Record "+n.type);var t=e.read_shift(4);return t!==0}function u3(e){return e.read_shift(2),e.read_shift(4)}function GT(e,n,t){var r=0;t&&t.biff==2||(r=e.read_shift(2));var i=e.read_shift(2);t&&t.biff==2&&(r=1-(i>>15),i&=32767);var s={Unsynced:r&1,DyZero:(r&2)>>1,ExAsc:(r&4)>>2,ExDsc:(r&8)>>3};return[s,i]}function f3(e){var n=e.read_shift(2),t=e.read_shift(2),r=e.read_shift(2),i=e.read_shift(2),s=e.read_shift(2),o=e.read_shift(2),a=e.read_shift(2),c=e.read_shift(2),l=e.read_shift(2);return{Pos:[n,t],Dim:[r,i],Flags:s,CurTab:o,FirstTab:a,Selected:c,TabRatio:l}}function d3(e,n,t){if(t&&t.biff>=2&&t.biff<5)return{};var r=e.read_shift(2);return{RTL:r&64}}function h3(){}function p3(e,n,t){var r={dyHeight:e.read_shift(2),fl:e.read_shift(2)};switch(t&&t.biff||8){case 2:break;case 3:case 4:e.l+=2;break;default:e.l+=10;break}return r.name=cl(e,0,t),r}function m3(e){var n=qr(e);return n.isst=e.read_shift(4),n}function g3(e,n,t){t.biffguess&&t.biff==2&&(t.biff=5);var r=e.l+n,i=qr(e,6);t.biff==2&&e.l++;var s=ll(e,r-e.l,t);return i.val=s,i}function v3(e,n,t){var r=e.read_shift(2),i=Gs(e,0,t);return[r,i]}var _3=Gs;function qT(e,n,t){var r=e.l+n,i=t.biff==8||!t.biff?4:2,s=e.read_shift(i),o=e.read_shift(i),a=e.read_shift(2),c=e.read_shift(2);return e.l=r,{s:{r:s,c:a},e:{r:o,c}}}function x3(e){var n=e.read_shift(2),t=e.read_shift(2),r=uC(e);return{r:n,c:t,ixfe:r[0],rknum:r[1]}}function y3(e,n){for(var t=e.l+n-2,r=e.read_shift(2),i=e.read_shift(2),s=[];e.l<t;)s.push(uC(e));if(e.l!==t)throw new Error("MulRK read error");var o=e.read_shift(2);if(s.length!=o-i+1)throw new Error("MulRK length mismatch");return{r,c:i,C:o,rkrec:s}}function w3(e,n){for(var t=e.l+n-2,r=e.read_shift(2),i=e.read_shift(2),s=[];e.l<t;)s.push(e.read_shift(2));if(e.l!==t)throw new Error("MulBlank read error");var o=e.read_shift(2);if(s.length!=o-i+1)throw new Error("MulBlank length mismatch");return{r,c:i,C:o,ixfe:s}}function E3(e,n,t,r){var i={},s=e.read_shift(4),o=e.read_shift(4),a=e.read_shift(4),c=e.read_shift(2);return i.patternType=x4[a>>26],r.cellStyles&&(i.alc=s&7,i.fWrap=s>>3&1,i.alcV=s>>4&7,i.fJustLast=s>>7&1,i.trot=s>>8&255,i.cIndent=s>>16&15,i.fShrinkToFit=s>>20&1,i.iReadOrder=s>>22&2,i.fAtrNum=s>>26&1,i.fAtrFnt=s>>27&1,i.fAtrAlc=s>>28&1,i.fAtrBdr=s>>29&1,i.fAtrPat=s>>30&1,i.fAtrProt=s>>31&1,i.dgLeft=o&15,i.dgRight=o>>4&15,i.dgTop=o>>8&15,i.dgBottom=o>>12&15,i.icvLeft=o>>16&127,i.icvRight=o>>23&127,i.grbitDiag=o>>30&3,i.icvTop=a&127,i.icvBottom=a>>7&127,i.icvDiag=a>>14&127,i.dgDiag=a>>21&15,i.icvFore=c&127,i.icvBack=c>>7&127,i.fsxButton=c>>14&1),i}function T3(e,n,t){var r={};return r.ifnt=e.read_shift(2),r.numFmtId=e.read_shift(2),r.flags=e.read_shift(2),r.fStyle=r.flags>>2&1,n-=6,r.data=E3(e,n,r.fStyle,t),r}function I3(e){e.l+=4;var n=[e.read_shift(2),e.read_shift(2)];if(n[0]!==0&&n[0]--,n[1]!==0&&n[1]--,n[0]>7||n[1]>7)throw new Error("Bad Gutters: "+n.join("|"));return n}function KT(e,n,t){var r=qr(e,6);(t.biff==2||n==9)&&++e.l;var i=j4(e,2);return r.val=i,r.t=i===!0||i===!1?"b":"e",r}function C3(e,n,t){t.biffguess&&t.biff==2&&(t.biff=5);var r=qr(e,6),i=cn(e,8);return r.val=i,r}var YT=K4;function S3(e,n,t){var r=e.l+n,i=e.read_shift(2),s=e.read_shift(2);if(t.sbcch=s,s==1025||s==14849)return[s,i];if(s<1||s>255)throw new Error("Unexpected SupBook type: "+s);for(var o=js(e,s),a=[];r>e.l;)a.push(ll(e));return[s,i,o,a]}function XT(e,n,t){var r=e.read_shift(2),i,s={fBuiltIn:r&1,fWantAdvise:r>>>1&1,fWantPict:r>>>2&1,fOle:r>>>3&1,fOleLink:r>>>4&1,cf:r>>>5&1023,fIcon:r>>>15&1};return t.sbcch===14849&&(i=X4(e,n-2,t)),s.body=i||e.read_shift(n-2),typeof i=="string"&&(s.Name=i),s}var D3=["_xlnm.Consolidate_Area","_xlnm.Auto_Open","_xlnm.Auto_Close","_xlnm.Extract","_xlnm.Database","_xlnm.Criteria","_xlnm.Print_Area","_xlnm.Print_Titles","_xlnm.Recorder","_xlnm.Data_Form","_xlnm.Auto_Activate","_xlnm.Auto_Deactivate","_xlnm.Sheet_Title","_xlnm._FilterDatabase"];function QT(e,n,t){var r=e.l+n,i=e.read_shift(2),s=e.read_shift(1),o=e.read_shift(1),a=e.read_shift(t&&t.biff==2?1:2),c=0;(!t||t.biff>=5)&&(t.biff!=5&&(e.l+=2),c=e.read_shift(2),t.biff==5&&(e.l+=2),e.l+=4);var l=js(e,o,t);i&32&&(l=D3[l.charCodeAt(0)]);var u=r-e.l;t&&t.biff==2&&--u;var f=r==e.l||a===0||!(u>0)?[]:cU(e,u,t,a);return{chKey:s,Name:l,itab:c,rgce:f}}function hC(e,n,t){if(t.biff<8)return b3(e,n,t);for(var r=[],i=e.l+n,s=e.read_shift(t.biff>8?4:2);s--!==0;)r.push(Y4(e,t.biff>8?12:6,t));if(e.l!=i)throw new Error("Bad ExternSheet: "+e.l+" != "+i);return r}function b3(e,n,t){e[e.l+1]==3&&e[e.l]++;var r=cl(e,n,t);return r.charCodeAt(0)==3?r.slice(1):r}function A3(e,n,t){if(t.biff<8){e.l+=n;return}var r=e.read_shift(2),i=e.read_shift(2),s=js(e,r,t),o=js(e,i,t);return[s,o]}function k3(e,n,t){var r=fC(e,6);e.l++;var i=e.read_shift(1);return n-=8,[lU(e,n,t),i,r]}function ZT(e,n,t){var r=Q4(e,6);switch(t.biff){case 2:e.l++,n-=7;break;case 3:case 4:e.l+=2,n-=8;break;default:e.l+=6,n-=12}return[r,oU(e,n,t,r)]}function N3(e){var n=e.read_shift(4)!==0,t=e.read_shift(4)!==0,r=e.read_shift(4);return[n,t,r]}function R3(e,n,t){if(!(t.biff<8)){var r=e.read_shift(2),i=e.read_shift(2),s=e.read_shift(2),o=e.read_shift(2),a=Gs(e,0,t);return t.biff<8&&e.read_shift(1),[{r,c:i},a,o,s]}}function M3(e,n,t){return R3(e,n,t)}function O3(e,n){for(var t=[],r=e.read_shift(2);r--;)t.push(kd(e,n));return t}function F3(e,n,t){if(t&&t.biff<8)return L3(e,n,t);var r=dC(e,22),i=t3(e,n-22,r[1]);return{cmo:r,ft:i}}var P3={8:function(e,n){var t=e.l+n;e.l+=10;var r=e.read_shift(2);e.l+=4,e.l+=2,e.l+=2,e.l+=2,e.l+=4;var i=e.read_shift(1);return e.l+=i,e.l=t,{fmt:r}}};function L3(e,n,t){e.l+=4;var r=e.read_shift(2),i=e.read_shift(2),s=e.read_shift(2);e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=6,n-=36;var o=[];return o.push((P3[r]||dn)(e,n,t)),{cmo:[i,r,s],ft:o}}function B3(e,n,t){var r=e.l,i="";try{e.l+=4;var s=(t.lastobj||{cmo:[0,0]}).cmo[1],o;[0,5,7,11,12,14].indexOf(s)==-1?e.l+=6:o=H4(e,6,t);var a=e.read_shift(2);e.read_shift(2),At(e,2);var c=e.read_shift(2);e.l+=c;for(var l=1;l<e.lens.length-1;++l){if(e.l-r!=e.lens[l])throw new Error("TxO: bad continue record");var u=e[e.l],f=js(e,e.lens[l+1]-e.lens[l]-1);if(i+=f,i.length>=(u?a:2*a))break}if(i.length!==a&&i.length!==a*2)throw new Error("cchText: "+a+" != "+i.length);return e.l=r+n,{t:i}}catch{return e.l=r+n,{t:i}}}function U3(e,n){var t=kd(e,8);e.l+=16;var r=G4(e,n-24);return[t,r]}function j3(e,n){e.read_shift(2);var t=kd(e,8),r=e.read_shift((n-10)/2,"dbcs-cont");return r=r.replace(un,""),[t,r]}function V3(e){var n=[0,0],t;return t=e.read_shift(2),n[0]=VT[t]||t,t=e.read_shift(2),n[1]=VT[t]||t,n}function H3(e){for(var n=e.read_shift(2),t=[];n-- >0;)t.push(lC(e,8));return t}function $3(e){for(var n=e.read_shift(2),t=[];n-- >0;)t.push(lC(e,8));return t}function W3(e){e.l+=2;var n={cxfs:0,crc:0};return n.cxfs=e.read_shift(2),n.crc=e.read_shift(4),n}function pC(e,n,t){if(!t.cellStyles)return dn(e,n);var r=t&&t.biff>=12?4:2,i=e.read_shift(r),s=e.read_shift(r),o=e.read_shift(r),a=e.read_shift(r),c=e.read_shift(2);r==2&&(e.l+=2);var l={s:i,e:s,w:o,ixfe:a,flags:c};return(t.biff>=5||!t.biff)&&(l.level=c>>8&7),l}function z3(e,n){var t={};return n<32||(e.l+=16,t.header=cn(e,8),t.footer=cn(e,8),e.l+=2),t}function G3(e,n,t){var r={area:!1};if(t.biff!=5)return e.l+=n,r;var i=e.read_shift(1);return e.l+=3,i&16&&(r.area=!0),r}var q3=qr,K3=aC,Y3=ll;function X3(e){var n=e.read_shift(2),t=e.read_shift(2),r=e.read_shift(4),i={fmt:n,env:t,len:r,data:e.slice(e.l,e.l+r)};return e.l+=r,i}function Q3(e,n,t){t.biffguess&&t.biff==5&&(t.biff=2);var r=qr(e,6);++e.l;var i=Gs(e,n-7,t);return r.t="str",r.val=i,r}function Z3(e){var n=qr(e,6);++e.l;var t=cn(e,8);return n.t="n",n.val=t,n}function J3(e){var n=qr(e,6);++e.l;var t=e.read_shift(2);return n.t="n",n.val=t,n}function e8(e){var n=e.read_shift(1);return n===0?(e.l++,""):e.read_shift(n,"sbcs-cont")}function t8(e,n){e.l+=6,e.l+=2,e.l+=1,e.l+=3,e.l+=1,e.l+=n-13}function n8(e,n,t){var r=e.l+n,i=qr(e,6),s=e.read_shift(2),o=js(e,s,t);return e.l=r,i.t="str",i.val=o,i}var r8=[2,3,48,49,131,139,140,245],JT=function(){var e={1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127,8:865,9:437,10:850,11:437,13:437,14:850,15:437,16:850,17:437,18:850,19:932,20:850,21:437,22:850,23:865,24:437,25:437,26:850,27:437,28:863,29:850,31:852,34:852,35:852,36:860,37:850,38:866,55:850,64:852,77:936,78:949,79:950,80:874,87:1252,88:1252,89:1252,108:863,134:737,135:852,136:857,204:1257,255:16969},n=Sg({1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127});function t(a,c){var l=[],u=Xi(1);switch(c.type){case"base64":u=_r(jn(a));break;case"binary":u=_r(a);break;case"buffer":case"array":u=a;break}Jt(u,0);var f=u.read_shift(1),d=!!(f&136),h=!1,m=!1;switch(f){case 2:break;case 3:break;case 48:h=!0,d=!0;break;case 49:h=!0,d=!0;break;case 131:break;case 139:break;case 140:m=!0;break;case 245:break;default:throw new Error("DBF Unsupported Version: "+f.toString(16))}var p=0,g=521;f==2&&(p=u.read_shift(2)),u.l+=3,f!=2&&(p=u.read_shift(4)),p>1048576&&(p=1e6),f!=2&&(g=u.read_shift(2));var w=u.read_shift(2),C=c.codepage||1252;f!=2&&(u.l+=16,u.read_shift(1),u[u.l]!==0&&(C=e[u[u.l]]),u.l+=1,u.l+=2),m&&(u.l+=36);for(var _=[],M={},V=Math.min(u.length,f==2?521:g-10-(h?264:0)),A=m?32:11;u.l<V&&u[u.l]!=13;)switch(M={},M.name=nt.utils.decode(C,u.slice(u.l,u.l+A)).replace(/[\u0000\r\n].*$/g,""),u.l+=A,M.type=String.fromCharCode(u.read_shift(1)),f!=2&&!m&&(M.offset=u.read_shift(4)),M.len=u.read_shift(1),f==2&&(M.offset=u.read_shift(2)),M.dec=u.read_shift(1),M.name.length&&_.push(M),f!=2&&(u.l+=m?13:14),M.type){case"B":(!h||M.len!=8)&&c.WTF&&console.log("Skipping "+M.name+":"+M.type);break;case"G":case"P":c.WTF&&console.log("Skipping "+M.name+":"+M.type);break;case"+":case"0":case"@":case"C":case"D":case"F":case"I":case"L":case"M":case"N":case"O":case"T":case"Y":break;default:throw new Error("Unknown Field Type: "+M.type)}if(u[u.l]!==13&&(u.l=g-1),u.read_shift(1)!==13)throw new Error("DBF Terminator not found "+u.l+" "+u[u.l]);u.l=g;var S=0,F=0;for(l[0]=[],F=0;F!=_.length;++F)l[0][F]=_[F].name;for(;p-- >0;){if(u[u.l]===42){u.l+=w;continue}for(++u.l,l[++S]=[],F=0,F=0;F!=_.length;++F){var N=u.slice(u.l,u.l+_[F].len);u.l+=_[F].len,Jt(N,0);var H=nt.utils.decode(C,N);switch(_[F].type){case"C":H.trim().length&&(l[S][F]=H.replace(/\s+$/,""));break;case"D":H.length===8?l[S][F]=new Date(+H.slice(0,4),+H.slice(4,6)-1,+H.slice(6,8)):l[S][F]=H;break;case"F":l[S][F]=parseFloat(H.trim());break;case"+":case"I":l[S][F]=m?N.read_shift(-4,"i")^2147483648:N.read_shift(4,"i");break;case"L":switch(H.trim().toUpperCase()){case"Y":case"T":l[S][F]=!0;break;case"N":case"F":l[S][F]=!1;break;case"":case"?":break;default:throw new Error("DBF Unrecognized L:|"+H+"|")}break;case"M":if(!d)throw new Error("DBF Unexpected MEMO for type "+f.toString(16));l[S][F]="##MEMO##"+(m?parseInt(H.trim(),10):N.read_shift(4));break;case"N":H=H.replace(/\u0000/g,"").trim(),H&&H!="."&&(l[S][F]=+H||0);break;case"@":l[S][F]=new Date(N.read_shift(-8,"f")-621356832e5);break;case"T":l[S][F]=new Date((N.read_shift(4)-2440588)*864e5+N.read_shift(4));break;case"Y":l[S][F]=N.read_shift(4,"i")/1e4+N.read_shift(4,"i")/1e4*Math.pow(2,32);break;case"O":l[S][F]=-N.read_shift(-8,"f");break;case"B":if(h&&_[F].len==8){l[S][F]=N.read_shift(8,"f");break}case"G":case"P":N.l+=_[F].len;break;case"0":if(_[F].name==="_NullFlags")break;default:throw new Error("DBF Unsupported data type "+_[F].type)}}}if(f!=2&&u.l<u.length&&u[u.l++]!=26)throw new Error("DBF EOF Marker missing "+(u.l-1)+" of "+u.length+" "+u[u.l-1].toString(16));return c&&c.sheetRows&&(l=l.slice(0,c.sheetRows)),c.DBF=_,l}function r(a,c){var l=c||{};l.dateNF||(l.dateNF="yyyymmdd");var u=ha(t(a,l),l);return u["!cols"]=l.DBF.map(function(f){return{wch:f.len,DBF:f}}),delete l.DBF,u}function i(a,c){try{return Zi(r(a,c),c)}catch(l){if(c&&c.WTF)throw l}return{SheetNames:[],Sheets:{}}}var s={B:8,C:250,L:1,D:8,"?":0,"":0};function o(a,c){var l=c||{};if(+l.codepage>=0&&xr(+l.codepage),l.type=="string")throw new Error("Cannot write DBF to JS string");var u=fg(),f=yg(a,{header:1,raw:!0,cellDates:!0}),d=f[0],h=f.slice(1),m=a["!cols"]||[],p=0,g=0,w=0,C=1;for(p=0;p<d.length;++p){if(((m[p]||{}).DBF||{}).name){d[p]=m[p].DBF.name,++w;continue}if(d[p]!=null){if(++w,typeof d[p]=="number"&&(d[p]=d[p].toString(10)),typeof d[p]!="string")throw new Error("DBF Invalid column name "+d[p]+" |"+typeof d[p]+"|");if(d.indexOf(d[p])!==p){for(g=0;g<1024;++g)if(d.indexOf(d[p]+"_"+g)==-1){d[p]+="_"+g;break}}}}var _=_t(a["!ref"]),M=[],V=[],A=[];for(p=0;p<=_.e.c-_.s.c;++p){var S="",F="",N=0,H=[];for(g=0;g<h.length;++g)h[g][p]!=null&&H.push(h[g][p]);if(H.length==0||d[p]==null){M[p]="?";continue}for(g=0;g<H.length;++g){switch(typeof H[g]){case"number":F="B";break;case"string":F="C";break;case"boolean":F="L";break;case"object":F=H[g]instanceof Date?"D":"C";break;default:F="C"}N=Math.max(N,String(H[g]).length),S=S&&S!=F?"C":F}N>250&&(N=250),F=((m[p]||{}).DBF||{}).type,F=="C"&&m[p].DBF.len>N&&(N=m[p].DBF.len),S=="B"&&F=="N"&&(S="N",A[p]=m[p].DBF.dec,N=m[p].DBF.len),V[p]=S=="C"||F=="N"?N:s[S]||0,C+=V[p],M[p]=S}var W=u.next(32);for(W.write_shift(4,318902576),W.write_shift(4,h.length),W.write_shift(2,296+32*w),W.write_shift(2,C),p=0;p<4;++p)W.write_shift(4,0);for(W.write_shift(4,0|(+n[aa]||3)<<8),p=0,g=0;p<d.length;++p)if(d[p]!=null){var O=u.next(32),Q=(d[p].slice(-10)+"\0\0\0\0\0\0\0\0\0\0\0").slice(0,11);O.write_shift(1,Q,"sbcs"),O.write_shift(1,M[p]=="?"?"C":M[p],"sbcs"),O.write_shift(4,g),O.write_shift(1,V[p]||s[M[p]]||0),O.write_shift(1,A[p]||0),O.write_shift(1,2),O.write_shift(4,0),O.write_shift(1,0),O.write_shift(4,0),O.write_shift(4,0),g+=V[p]||s[M[p]]||0}var pe=u.next(264);for(pe.write_shift(4,13),p=0;p<65;++p)pe.write_shift(4,0);for(p=0;p<h.length;++p){var ne=u.next(C);for(ne.write_shift(1,0),g=0;g<d.length;++g)if(d[g]!=null)switch(M[g]){case"L":ne.write_shift(1,h[p][g]==null?63:h[p][g]?84:70);break;case"B":ne.write_shift(8,h[p][g]||0,"f");break;case"N":var _e="0";for(typeof h[p][g]=="number"&&(_e=h[p][g].toFixed(A[g]||0)),w=0;w<V[g]-_e.length;++w)ne.write_shift(1,32);ne.write_shift(1,_e,"sbcs");break;case"D":h[p][g]?(ne.write_shift(4,("0000"+h[p][g].getFullYear()).slice(-4),"sbcs"),ne.write_shift(2,("00"+(h[p][g].getMonth()+1)).slice(-2),"sbcs"),ne.write_shift(2,("00"+h[p][g].getDate()).slice(-2),"sbcs")):ne.write_shift(8,"00000000","sbcs");break;case"C":var fe=String(h[p][g]!=null?h[p][g]:"").slice(0,V[g]);for(ne.write_shift(1,fe,"sbcs"),w=0;w<V[g]-fe.length;++w)ne.write_shift(1,32);break}}return u.next(1).write_shift(1,26),u.end()}return{to_workbook:i,to_sheet:r,from_sheet:o}}(),i8=function(){var e={AA:"\xC0",BA:"\xC1",CA:"\xC2",DA:195,HA:"\xC4",JA:197,AE:"\xC8",BE:"\xC9",CE:"\xCA",HE:"\xCB",AI:"\xCC",BI:"\xCD",CI:"\xCE",HI:"\xCF",AO:"\xD2",BO:"\xD3",CO:"\xD4",DO:213,HO:"\xD6",AU:"\xD9",BU:"\xDA",CU:"\xDB",HU:"\xDC",Aa:"\xE0",Ba:"\xE1",Ca:"\xE2",Da:227,Ha:"\xE4",Ja:229,Ae:"\xE8",Be:"\xE9",Ce:"\xEA",He:"\xEB",Ai:"\xEC",Bi:"\xED",Ci:"\xEE",Hi:"\xEF",Ao:"\xF2",Bo:"\xF3",Co:"\xF4",Do:245,Ho:"\xF6",Au:"\xF9",Bu:"\xFA",Cu:"\xFB",Hu:"\xFC",KC:"\xC7",Kc:"\xE7",q:"\xE6",z:"\u0153",a:"\xC6",j:"\u0152",DN:209,Dn:241,Hy:255,S:169,c:170,R:174,"B ":180,0:176,1:177,2:178,3:179,5:181,6:182,7:183,Q:185,k:186,b:208,i:216,l:222,s:240,y:248,"!":161,'"':162,"#":163,"(":164,"%":165,"'":167,"H ":168,"+":171,";":187,"<":188,"=":189,">":190,"?":191,"{":223},n=new RegExp("\x1BN("+zr(e).join("|").replace(/\|\|\|/,"|\\||").replace(/([?()+])/g,"\\$1")+"|\\|)","gm"),t=function(d,h){var m=e[h];return typeof m=="number"?pT(m):m},r=function(d,h,m){var p=h.charCodeAt(0)-32<<4|m.charCodeAt(0)-48;return p==59?d:pT(p)};e["|"]=254;function i(d,h){switch(h.type){case"base64":return s(jn(d),h);case"binary":return s(d,h);case"buffer":return s(Ue&&Buffer.isBuffer(d)?d.toString("binary"):Hs(d),h);case"array":return s(Us(d),h)}throw new Error("Unrecognized type "+h.type)}function s(d,h){var m=d.split(/[\n\r]+/),p=-1,g=-1,w=0,C=0,_=[],M=[],V=null,A={},S=[],F=[],N=[],H=0,W;for(+h.codepage>=0&&xr(+h.codepage);w!==m.length;++w){H=0;var O=m[w].trim().replace(/\x1B([\x20-\x2F])([\x30-\x3F])/g,r).replace(n,t),Q=O.replace(/;;/g,"\0").split(";").map(function(k){return k.replace(/\u0000/g,";")}),pe=Q[0],ne;if(O.length>0)switch(pe){case"ID":break;case"E":break;case"B":break;case"O":break;case"W":break;case"P":Q[1].charAt(0)=="P"&&M.push(O.slice(3).replace(/;;/g,";"));break;case"C":var _e=!1,fe=!1,qe=!1,se=!1,me=-1,G=-1;for(C=1;C<Q.length;++C)switch(Q[C].charAt(0)){case"A":break;case"X":g=parseInt(Q[C].slice(1))-1,fe=!0;break;case"Y":for(p=parseInt(Q[C].slice(1))-1,fe||(g=0),W=_.length;W<=p;++W)_[W]=[];break;case"K":ne=Q[C].slice(1),ne.charAt(0)==='"'?ne=ne.slice(1,ne.length-1):ne==="TRUE"?ne=!0:ne==="FALSE"?ne=!1:isNaN(wr(ne))?isNaN(ca(ne).getDate())||(ne=Wt(ne)):(ne=wr(ne),V!==null&&ua(V)&&(ne=bd(ne))),typeof nt<"u"&&typeof ne=="string"&&(h||{}).type!="string"&&(h||{}).codepage&&(ne=nt.utils.decode(h.codepage,ne)),_e=!0;break;case"E":se=!0;var b=sa(Q[C].slice(1),{r:p,c:g});_[p][g]=[_[p][g],b];break;case"S":qe=!0,_[p][g]=[_[p][g],"S5S"];break;case"G":break;case"R":me=parseInt(Q[C].slice(1))-1;break;case"C":G=parseInt(Q[C].slice(1))-1;break;default:if(h&&h.WTF)throw new Error("SYLK bad record "+O)}if(_e&&(_[p][g]&&_[p][g].length==2?_[p][g][0]=ne:_[p][g]=ne,V=null),qe){if(se)throw new Error("SYLK shared formula cannot have own formula");var U=me>-1&&_[me][G];if(!U||!U[1])throw new Error("SYLK shared formula cannot find base");_[p][g][1]=IC(U[1],{r:p-me,c:g-G})}break;case"F":var R=0;for(C=1;C<Q.length;++C)switch(Q[C].charAt(0)){case"X":g=parseInt(Q[C].slice(1))-1,++R;break;case"Y":for(p=parseInt(Q[C].slice(1))-1,W=_.length;W<=p;++W)_[W]=[];break;case"M":H=parseInt(Q[C].slice(1))/20;break;case"F":break;case"G":break;case"P":V=M[parseInt(Q[C].slice(1))];break;case"S":break;case"D":break;case"N":break;case"W":for(N=Q[C].slice(1).split(" "),W=parseInt(N[0],10);W<=parseInt(N[1],10);++W)H=parseInt(N[2],10),F[W-1]=H===0?{hidden:!0}:{wch:H},la(F[W-1]);break;case"C":g=parseInt(Q[C].slice(1))-1,F[g]||(F[g]={});break;case"R":p=parseInt(Q[C].slice(1))-1,S[p]||(S[p]={}),H>0?(S[p].hpt=H,S[p].hpx=sl(H)):H===0&&(S[p].hidden=!0);break;default:if(h&&h.WTF)throw new Error("SYLK bad record "+O)}R<1&&(V=null);break;default:if(h&&h.WTF)throw new Error("SYLK bad record "+O)}}return S.length>0&&(A["!rows"]=S),F.length>0&&(A["!cols"]=F),h&&h.sheetRows&&(_=_.slice(0,h.sheetRows)),[_,A]}function o(d,h){var m=i(d,h),p=m[0],g=m[1],w=ha(p,h);return zr(g).forEach(function(C){w[C]=g[C]}),w}function a(d,h){return Zi(o(d,h),h)}function c(d,h,m,p){var g="C;Y"+(m+1)+";X"+(p+1)+";K";switch(d.t){case"n":g+=d.v||0,d.f&&!d.F&&(g+=";E"+WB(d.f,{r:m,c:p}));break;case"b":g+=d.v?"TRUE":"FALSE";break;case"e":g+=d.w||d.v;break;case"d":g+='"'+(d.w||d.v)+'"';break;case"s":g+='"'+d.v.replace(/"/g,"").replace(/;/g,";;")+'"';break}return g}function l(d,h){h.forEach(function(m,p){var g="F;W"+(p+1)+" "+(p+1)+" ";m.hidden?g+="0":(typeof m.width=="number"&&!m.wpx&&(m.wpx=Id(m.width)),typeof m.wpx=="number"&&!m.wch&&(m.wch=Cd(m.wpx)),typeof m.wch=="number"&&(g+=Math.round(m.wch))),g.charAt(g.length-1)!=" "&&d.push(g)})}function u(d,h){h.forEach(function(m,p){var g="F;";m.hidden?g+="M0;":m.hpt?g+="M"+20*m.hpt+";":m.hpx&&(g+="M"+20*wC(m.hpx)+";"),g.length>2&&d.push(g+"R"+(p+1))})}function f(d,h){var m=["ID;PWXL;N;E"],p=[],g=_t(d["!ref"]),w,C=Array.isArray(d),_=`\r
`;m.push("P;PGeneral"),m.push("F;P0;DG0G8;M255"),d["!cols"]&&l(m,d["!cols"]),d["!rows"]&&u(m,d["!rows"]),m.push("B;Y"+(g.e.r-g.s.r+1)+";X"+(g.e.c-g.s.c+1)+";D"+[g.s.c,g.s.r,g.e.c,g.e.r].join(" "));for(var M=g.s.r;M<=g.e.r;++M)for(var V=g.s.c;V<=g.e.c;++V){var A=Ce({r:M,c:V});w=C?(d[M]||[])[V]:d[A],!(!w||w.v==null&&(!w.f||w.F))&&p.push(c(w,d,M,V,h))}return m.join(_)+_+p.join(_)+_+"E"+_}return{to_workbook:a,to_sheet:o,from_sheet:f}}(),s8=function(){function e(s,o){switch(o.type){case"base64":return n(jn(s),o);case"binary":return n(s,o);case"buffer":return n(Ue&&Buffer.isBuffer(s)?s.toString("binary"):Hs(s),o);case"array":return n(Us(s),o)}throw new Error("Unrecognized type "+o.type)}function n(s,o){for(var a=s.split(`
`),c=-1,l=-1,u=0,f=[];u!==a.length;++u){if(a[u].trim()==="BOT"){f[++c]=[],l=0;continue}if(!(c<0)){var d=a[u].trim().split(","),h=d[0],m=d[1];++u;for(var p=a[u]||"";(p.match(/["]/g)||[]).length&1&&u<a.length-1;)p+=`
`+a[++u];switch(p=p.trim(),+h){case-1:if(p==="BOT"){f[++c]=[],l=0;continue}else if(p!=="EOD")throw new Error("Unrecognized DIF special command "+p);break;case 0:p==="TRUE"?f[c][l]=!0:p==="FALSE"?f[c][l]=!1:isNaN(wr(m))?isNaN(ca(m).getDate())?f[c][l]=m:f[c][l]=Wt(m):f[c][l]=wr(m),++l;break;case 1:p=p.slice(1,p.length-1),p=p.replace(/""/g,'"'),jc&&p&&p.match(/^=".*"$/)&&(p=p.slice(2,-1)),f[c][l++]=p!==""?p:null;break}if(p==="EOD")break}}return o&&o.sheetRows&&(f=f.slice(0,o.sheetRows)),f}function t(s,o){return ha(e(s,o),o)}function r(s,o){return Zi(t(s,o),o)}var i=function(){var s=function(c,l,u,f,d){c.push(l),c.push(u+","+f),c.push('"'+d.replace(/"/g,'""')+'"')},o=function(c,l,u,f){c.push(l+","+u),c.push(l==1?'"'+f.replace(/"/g,'""')+'"':f)};return function(c){var l=[],u=_t(c["!ref"]),f,d=Array.isArray(c);s(l,"TABLE",0,1,"sheetjs"),s(l,"VECTORS",0,u.e.r-u.s.r+1,""),s(l,"TUPLES",0,u.e.c-u.s.c+1,""),s(l,"DATA",0,0,"");for(var h=u.s.r;h<=u.e.r;++h){o(l,-1,0,"BOT");for(var m=u.s.c;m<=u.e.c;++m){var p=Ce({r:h,c:m});if(f=d?(c[h]||[])[m]:c[p],!f){o(l,1,0,"");continue}switch(f.t){case"n":var g=jc?f.w:f.v;!g&&f.v!=null&&(g=f.v),g==null?jc&&f.f&&!f.F?o(l,1,0,"="+f.f):o(l,1,0,""):o(l,0,g,"V");break;case"b":o(l,0,f.v?1:0,f.v?"TRUE":"FALSE");break;case"s":o(l,1,0,!jc||isNaN(f.v)?f.v:'="'+f.v+'"');break;case"d":f.w||(f.w=tr(f.z||Ae[14],En(Wt(f.v)))),jc?o(l,0,f.w,"V"):o(l,1,0,f.w);break;default:o(l,1,0,"")}}}o(l,-1,0,"EOD");var w=`\r
`,C=l.join(w);return C}}();return{to_workbook:r,to_sheet:t,from_sheet:i}}(),o8=function(){function e(f){return f.replace(/\\b/g,"\\").replace(/\\c/g,":").replace(/\\n/g,`
`)}function n(f){return f.replace(/\\/g,"\\b").replace(/:/g,"\\c").replace(/\n/g,"\\n")}function t(f,d){for(var h=f.split(`
`),m=-1,p=-1,g=0,w=[];g!==h.length;++g){var C=h[g].trim().split(":");if(C[0]==="cell"){var _=wn(C[1]);if(w.length<=_.r)for(m=w.length;m<=_.r;++m)w[m]||(w[m]=[]);switch(m=_.r,p=_.c,C[2]){case"t":w[m][p]=e(C[3]);break;case"v":w[m][p]=+C[3];break;case"vtf":var M=C[C.length-1];case"vtc":switch(C[3]){case"nl":w[m][p]=!!+C[4];break;default:w[m][p]=+C[4];break}C[2]=="vtf"&&(w[m][p]=[w[m][p],M])}}}return d&&d.sheetRows&&(w=w.slice(0,d.sheetRows)),w}function r(f,d){return ha(t(f,d),d)}function i(f,d){return Zi(r(f,d),d)}var s=["socialcalc:version:1.5","MIME-Version: 1.0","Content-Type: multipart/mixed; boundary=SocialCalcSpreadsheetControlSave"].join(`
`),o=["--SocialCalcSpreadsheetControlSave","Content-type: text/plain; charset=UTF-8"].join(`
`)+`
`,a=["# SocialCalc Spreadsheet Control Save","part:sheet"].join(`
`),c="--SocialCalcSpreadsheetControlSave--";function l(f){if(!f||!f["!ref"])return"";for(var d=[],h=[],m,p="",g=da(f["!ref"]),w=Array.isArray(f),C=g.s.r;C<=g.e.r;++C)for(var _=g.s.c;_<=g.e.c;++_)if(p=Ce({r:C,c:_}),m=w?(f[C]||[])[_]:f[p],!(!m||m.v==null||m.t==="z")){switch(h=["cell",p,"t"],m.t){case"s":case"str":h.push(n(m.v));break;case"n":m.f?(h[2]="vtf",h[3]="n",h[4]=m.v,h[5]=n(m.f)):(h[2]="v",h[3]=m.v);break;case"b":h[2]="vt"+(m.f?"f":"c"),h[3]="nl",h[4]=m.v?"1":"0",h[5]=n(m.f||(m.v?"TRUE":"FALSE"));break;case"d":var M=En(Wt(m.v));h[2]="vtc",h[3]="nd",h[4]=""+M,h[5]=m.w||tr(m.z||Ae[14],M);break;case"e":continue}d.push(h.join(":"))}return d.push("sheet:c:"+(g.e.c-g.s.c+1)+":r:"+(g.e.r-g.s.r+1)+":tvf:1"),d.push("valueformat:1:text-wiki"),d.join(`
`)}function u(f){return[s,o,a,o,l(f),c].join(`
`)}return{to_workbook:i,to_sheet:r,from_sheet:u}}(),rl=function(){function e(u,f,d,h,m){m.raw?f[d][h]=u:u===""||(u==="TRUE"?f[d][h]=!0:u==="FALSE"?f[d][h]=!1:isNaN(wr(u))?isNaN(ca(u).getDate())?f[d][h]=u:f[d][h]=Wt(u):f[d][h]=wr(u))}function n(u,f){var d=f||{},h=[];if(!u||u.length===0)return h;for(var m=u.split(/[\r\n]/),p=m.length-1;p>=0&&m[p].length===0;)--p;for(var g=10,w=0,C=0;C<=p;++C)w=m[C].indexOf(" "),w==-1?w=m[C].length:w++,g=Math.max(g,w);for(C=0;C<=p;++C){h[C]=[];var _=0;for(e(m[C].slice(0,g).trim(),h,C,_,d),_=1;_<=(m[C].length-g)/10+1;++_)e(m[C].slice(g+(_-1)*10,g+_*10).trim(),h,C,_,d)}return d.sheetRows&&(h=h.slice(0,d.sheetRows)),h}var t={44:",",9:"	",59:";",124:"|"},r={44:3,9:2,59:1,124:0};function i(u){for(var f={},d=!1,h=0,m=0;h<u.length;++h)(m=u.charCodeAt(h))==34?d=!d:!d&&m in t&&(f[m]=(f[m]||0)+1);m=[];for(h in f)Object.prototype.hasOwnProperty.call(f,h)&&m.push([f[h],h]);if(!m.length){f=r;for(h in f)Object.prototype.hasOwnProperty.call(f,h)&&m.push([f[h],h])}return m.sort(function(p,g){return p[0]-g[0]||r[p[1]]-r[g[1]]}),t[m.pop()[1]]||44}function s(u,f){var d=f||{},h="";Nt!=null&&d.dense==null&&(d.dense=Nt);var m=d.dense?[]:{},p={s:{c:0,r:0},e:{c:0,r:0}};u.slice(0,4)=="sep="?u.charCodeAt(5)==13&&u.charCodeAt(6)==10?(h=u.charAt(4),u=u.slice(7)):u.charCodeAt(5)==13||u.charCodeAt(5)==10?(h=u.charAt(4),u=u.slice(6)):h=i(u.slice(0,1024)):d&&d.FS?h=d.FS:h=i(u.slice(0,1024));var g=0,w=0,C=0,_=0,M=0,V=h.charCodeAt(0),A=!1,S=0,F=u.charCodeAt(0);u=u.replace(/\r\n/mg,`
`);var N=d.dateNF!=null?vL(d.dateNF):null;function H(){var W=u.slice(_,M),O={};if(W.charAt(0)=='"'&&W.charAt(W.length-1)=='"'&&(W=W.slice(1,-1).replace(/""/g,'"')),W.length===0)O.t="z";else if(d.raw)O.t="s",O.v=W;else if(W.trim().length===0)O.t="s",O.v=W;else if(W.charCodeAt(0)==61)W.charCodeAt(1)==34&&W.charCodeAt(W.length-1)==34?(O.t="s",O.v=W.slice(2,-1).replace(/""/g,'"')):GB(W)?(O.t="n",O.f=W.slice(1)):(O.t="s",O.v=W);else if(W=="TRUE")O.t="b",O.v=!0;else if(W=="FALSE")O.t="b",O.v=!1;else if(!isNaN(C=wr(W)))O.t="n",d.cellText!==!1&&(O.w=W),O.v=C;else if(!isNaN(ca(W).getDate())||N&&W.match(N)){O.z=d.dateNF||Ae[14];var Q=0;N&&W.match(N)&&(W=_L(W,d.dateNF,W.match(N)||[]),Q=1),d.cellDates?(O.t="d",O.v=Wt(W,Q)):(O.t="n",O.v=En(Wt(W,Q))),d.cellText!==!1&&(O.w=tr(O.z,O.v instanceof Date?En(O.v):O.v)),d.cellNF||delete O.z}else O.t="s",O.v=W;if(O.t=="z"||(d.dense?(m[g]||(m[g]=[]),m[g][w]=O):m[Ce({c:w,r:g})]=O),_=M+1,F=u.charCodeAt(_),p.e.c<w&&(p.e.c=w),p.e.r<g&&(p.e.r=g),S==V)++w;else if(w=0,++g,d.sheetRows&&d.sheetRows<=g)return!0}e:for(;M<u.length;++M)switch(S=u.charCodeAt(M)){case 34:F===34&&(A=!A);break;case V:case 10:case 13:if(!A&&H())break e;break;default:break}return M-_>0&&H(),m["!ref"]=Ge(p),m}function o(u,f){return!(f&&f.PRN)||f.FS||u.slice(0,4)=="sep="||u.indexOf("	")>=0||u.indexOf(",")>=0||u.indexOf(";")>=0?s(u,f):ha(n(u,f),f)}function a(u,f){var d="",h=f.type=="string"?[0,0,0,0]:Yg(u,f);switch(f.type){case"base64":d=jn(u);break;case"binary":d=u;break;case"buffer":f.codepage==65001?d=u.toString("utf8"):f.codepage&&typeof nt<"u"?d=nt.utils.decode(f.codepage,u):d=Ue&&Buffer.isBuffer(u)?u.toString("binary"):Hs(u);break;case"array":d=Us(u);break;case"string":d=u;break;default:throw new Error("Unrecognized type "+f.type)}return h[0]==239&&h[1]==187&&h[2]==191?d=ct(d.slice(3)):f.type!="string"&&f.type!="buffer"&&f.codepage==65001?d=ct(d):f.type=="binary"&&typeof nt<"u"&&f.codepage&&(d=nt.utils.decode(f.codepage,nt.utils.encode(28591,d))),d.slice(0,19)=="socialcalc:version:"?o8.to_sheet(f.type=="string"?d:ct(d),f):o(d,f)}function c(u,f){return Zi(a(u,f),f)}function l(u){for(var f=[],d=_t(u["!ref"]),h,m=Array.isArray(u),p=d.s.r;p<=d.e.r;++p){for(var g=[],w=d.s.c;w<=d.e.c;++w){var C=Ce({r:p,c:w});if(h=m?(u[p]||[])[w]:u[C],!h||h.v==null){g.push("          ");continue}for(var _=(h.w||(vi(h),h.w)||"").slice(0,10);_.length<10;)_+=" ";g.push(_+(w===0?" ":""))}f.push(g.join(""))}return f.join(`
`)}return{to_workbook:c,to_sheet:a,from_sheet:l}}();function a8(e,n){var t=n||{},r=!!t.WTF;t.WTF=!0;try{var i=i8.to_workbook(e,t);return t.WTF=r,i}catch(s){if(t.WTF=r,!s.message.match(/SYLK bad record ID/)&&r)throw s;return rl.to_workbook(e,n)}}var Xc=function(){function e(b,U,R){if(b){Jt(b,b.l||0);for(var k=R.Enum||me;b.l<b.length;){var q=b.read_shift(2),ce=k[q]||k[65535],ie=b.read_shift(2),ae=b.l+ie,K=ce.f&&ce.f(b,ie,R);if(b.l=ae,U(K,ce,q))return}}}function n(b,U){switch(U.type){case"base64":return t(_r(jn(b)),U);case"binary":return t(_r(b),U);case"buffer":case"array":return t(b,U)}throw"Unsupported type "+U.type}function t(b,U){if(!b)return b;var R=U||{};Nt!=null&&R.dense==null&&(R.dense=Nt);var k=R.dense?[]:{},q="Sheet1",ce="",ie=0,ae={},K=[],je=[],D={s:{r:0,c:0},e:{r:0,c:0}},dt=R.sheetRows||0;if(b[2]==0&&(b[3]==8||b[3]==9)&&b.length>=16&&b[14]==5&&b[15]===108)throw new Error("Unsupported Works 3 for Mac file");if(b[2]==2)R.Enum=me,e(b,function(oe,xt,Hn){switch(Hn){case 0:R.vers=oe,oe>=4096&&(R.qpro=!0);break;case 6:D=oe;break;case 204:oe&&(ce=oe);break;case 222:ce=oe;break;case 15:case 51:R.qpro||(oe[1].v=oe[1].v.slice(1));case 13:case 14:case 16:Hn==14&&(oe[2]&112)==112&&(oe[2]&15)>1&&(oe[2]&15)<15&&(oe[1].z=R.dateNF||Ae[14],R.cellDates&&(oe[1].t="d",oe[1].v=bd(oe[1].v))),R.qpro&&oe[3]>ie&&(k["!ref"]=Ge(D),ae[q]=k,K.push(q),k=R.dense?[]:{},D={s:{r:0,c:0},e:{r:0,c:0}},ie=oe[3],q=ce||"Sheet"+(ie+1),ce="");var Dr=R.dense?(k[oe[0].r]||[])[oe[0].c]:k[Ce(oe[0])];if(Dr){Dr.t=oe[1].t,Dr.v=oe[1].v,oe[1].z!=null&&(Dr.z=oe[1].z),oe[1].f!=null&&(Dr.f=oe[1].f);break}R.dense?(k[oe[0].r]||(k[oe[0].r]=[]),k[oe[0].r][oe[0].c]=oe[1]):k[Ce(oe[0])]=oe[1];break;default:}},R);else if(b[2]==26||b[2]==14)R.Enum=G,b[2]==14&&(R.qpro=!0,b.l=0),e(b,function(oe,xt,Hn){switch(Hn){case 204:q=oe;break;case 22:oe[1].v=oe[1].v.slice(1);case 23:case 24:case 25:case 37:case 39:case 40:if(oe[3]>ie&&(k["!ref"]=Ge(D),ae[q]=k,K.push(q),k=R.dense?[]:{},D={s:{r:0,c:0},e:{r:0,c:0}},ie=oe[3],q="Sheet"+(ie+1)),dt>0&&oe[0].r>=dt)break;R.dense?(k[oe[0].r]||(k[oe[0].r]=[]),k[oe[0].r][oe[0].c]=oe[1]):k[Ce(oe[0])]=oe[1],D.e.c<oe[0].c&&(D.e.c=oe[0].c),D.e.r<oe[0].r&&(D.e.r=oe[0].r);break;case 27:oe[14e3]&&(je[oe[14e3][0]]=oe[14e3][1]);break;case 1537:je[oe[0]]=oe[1],oe[0]==ie&&(q=oe[1]);break;default:break}},R);else throw new Error("Unrecognized LOTUS BOF "+b[2]);if(k["!ref"]=Ge(D),ae[ce||q]=k,K.push(ce||q),!je.length)return{SheetNames:K,Sheets:ae};for(var Ke={},st=[],Pe=0;Pe<je.length;++Pe)ae[K[Pe]]?(st.push(je[Pe]||K[Pe]),Ke[je[Pe]]=ae[je[Pe]]||ae[K[Pe]]):(st.push(je[Pe]),Ke[je[Pe]]={"!ref":"A1"});return{SheetNames:st,Sheets:Ke}}function r(b,U){var R=U||{};if(+R.codepage>=0&&xr(+R.codepage),R.type=="string")throw new Error("Cannot write WK1 to JS string");var k=fg(),q=_t(b["!ref"]),ce=Array.isArray(b),ie=[];vr(k,0,s(1030)),vr(k,6,c(q));for(var ae=Math.min(q.e.r,8191),K=q.s.r;K<=ae;++K)for(var je=tn(K),D=q.s.c;D<=q.e.c;++D){K===q.s.r&&(ie[D]=Ot(D));var dt=ie[D]+je,Ke=ce?(b[K]||[])[D]:b[dt];if(!(!Ke||Ke.t=="z"))if(Ke.t=="n")(Ke.v|0)==Ke.v&&Ke.v>=-32768&&Ke.v<=32767?vr(k,13,h(K,D,Ke.v)):vr(k,14,p(K,D,Ke.v));else{var st=vi(Ke);vr(k,15,f(K,D,st.slice(0,239)))}}return vr(k,1),k.end()}function i(b,U){var R=U||{};if(+R.codepage>=0&&xr(+R.codepage),R.type=="string")throw new Error("Cannot write WK3 to JS string");var k=fg();vr(k,0,o(b));for(var q=0,ce=0;q<b.SheetNames.length;++q)(b.Sheets[b.SheetNames[q]]||{})["!ref"]&&vr(k,27,se(b.SheetNames[q],ce++));var ie=0;for(q=0;q<b.SheetNames.length;++q){var ae=b.Sheets[b.SheetNames[q]];if(!(!ae||!ae["!ref"])){for(var K=_t(ae["!ref"]),je=Array.isArray(ae),D=[],dt=Math.min(K.e.r,8191),Ke=K.s.r;Ke<=dt;++Ke)for(var st=tn(Ke),Pe=K.s.c;Pe<=K.e.c;++Pe){Ke===K.s.r&&(D[Pe]=Ot(Pe));var oe=D[Pe]+st,xt=je?(ae[Ke]||[])[Pe]:ae[oe];if(!(!xt||xt.t=="z"))if(xt.t=="n")vr(k,23,H(Ke,Pe,ie,xt.v));else{var Hn=vi(xt);vr(k,22,S(Ke,Pe,ie,Hn.slice(0,239)))}}++ie}}return vr(k,1),k.end()}function s(b){var U=kt(2);return U.write_shift(2,b),U}function o(b){var U=kt(26);U.write_shift(2,4096),U.write_shift(2,4),U.write_shift(4,0);for(var R=0,k=0,q=0,ce=0;ce<b.SheetNames.length;++ce){var ie=b.SheetNames[ce],ae=b.Sheets[ie];if(!(!ae||!ae["!ref"])){++q;var K=da(ae["!ref"]);R<K.e.r&&(R=K.e.r),k<K.e.c&&(k=K.e.c)}}return R>8191&&(R=8191),U.write_shift(2,R),U.write_shift(1,q),U.write_shift(1,k),U.write_shift(2,0),U.write_shift(2,0),U.write_shift(1,1),U.write_shift(1,2),U.write_shift(4,0),U.write_shift(4,0),U}function a(b,U,R){var k={s:{c:0,r:0},e:{c:0,r:0}};return U==8&&R.qpro?(k.s.c=b.read_shift(1),b.l++,k.s.r=b.read_shift(2),k.e.c=b.read_shift(1),b.l++,k.e.r=b.read_shift(2),k):(k.s.c=b.read_shift(2),k.s.r=b.read_shift(2),U==12&&R.qpro&&(b.l+=2),k.e.c=b.read_shift(2),k.e.r=b.read_shift(2),U==12&&R.qpro&&(b.l+=2),k.s.c==65535&&(k.s.c=k.e.c=k.s.r=k.e.r=0),k)}function c(b){var U=kt(8);return U.write_shift(2,b.s.c),U.write_shift(2,b.s.r),U.write_shift(2,b.e.c),U.write_shift(2,b.e.r),U}function l(b,U,R){var k=[{c:0,r:0},{t:"n",v:0},0,0];return R.qpro&&R.vers!=20768?(k[0].c=b.read_shift(1),k[3]=b.read_shift(1),k[0].r=b.read_shift(2),b.l+=2):(k[2]=b.read_shift(1),k[0].c=b.read_shift(2),k[0].r=b.read_shift(2)),k}function u(b,U,R){var k=b.l+U,q=l(b,U,R);if(q[1].t="s",R.vers==20768){b.l++;var ce=b.read_shift(1);return q[1].v=b.read_shift(ce,"utf8"),q}return R.qpro&&b.l++,q[1].v=b.read_shift(k-b.l,"cstr"),q}function f(b,U,R){var k=kt(7+R.length);k.write_shift(1,255),k.write_shift(2,U),k.write_shift(2,b),k.write_shift(1,39);for(var q=0;q<k.length;++q){var ce=R.charCodeAt(q);k.write_shift(1,ce>=128?95:ce)}return k.write_shift(1,0),k}function d(b,U,R){var k=l(b,U,R);return k[1].v=b.read_shift(2,"i"),k}function h(b,U,R){var k=kt(7);return k.write_shift(1,255),k.write_shift(2,U),k.write_shift(2,b),k.write_shift(2,R,"i"),k}function m(b,U,R){var k=l(b,U,R);return k[1].v=b.read_shift(8,"f"),k}function p(b,U,R){var k=kt(13);return k.write_shift(1,255),k.write_shift(2,U),k.write_shift(2,b),k.write_shift(8,R,"f"),k}function g(b,U,R){var k=b.l+U,q=l(b,U,R);if(q[1].v=b.read_shift(8,"f"),R.qpro)b.l=k;else{var ce=b.read_shift(2);M(b.slice(b.l,b.l+ce),q),b.l+=ce}return q}function w(b,U,R){var k=U&32768;return U&=-32769,U=(k?b:0)+(U>=8192?U-16384:U),(k?"":"$")+(R?Ot(U):tn(U))}var C={51:["FALSE",0],52:["TRUE",0],70:["LEN",1],80:["SUM",69],81:["AVERAGEA",69],82:["COUNTA",69],83:["MINA",69],84:["MAXA",69],111:["T",1]},_=["","","","","","","","","","+","-","*","/","^","=","<>","<=",">=","<",">","","","","","&","","","","","","",""];function M(b,U){Jt(b,0);for(var R=[],k=0,q="",ce="",ie="",ae="";b.l<b.length;){var K=b[b.l++];switch(K){case 0:R.push(b.read_shift(8,"f"));break;case 1:ce=w(U[0].c,b.read_shift(2),!0),q=w(U[0].r,b.read_shift(2),!1),R.push(ce+q);break;case 2:{var je=w(U[0].c,b.read_shift(2),!0),D=w(U[0].r,b.read_shift(2),!1);ce=w(U[0].c,b.read_shift(2),!0),q=w(U[0].r,b.read_shift(2),!1),R.push(je+D+":"+ce+q)}break;case 3:if(b.l<b.length){console.error("WK1 premature formula end");return}break;case 4:R.push("("+R.pop()+")");break;case 5:R.push(b.read_shift(2));break;case 6:{for(var dt="";K=b[b.l++];)dt+=String.fromCharCode(K);R.push('"'+dt.replace(/"/g,'""')+'"')}break;case 8:R.push("-"+R.pop());break;case 23:R.push("+"+R.pop());break;case 22:R.push("NOT("+R.pop()+")");break;case 20:case 21:ae=R.pop(),ie=R.pop(),R.push(["AND","OR"][K-20]+"("+ie+","+ae+")");break;default:if(K<32&&_[K])ae=R.pop(),ie=R.pop(),R.push(ie+_[K]+ae);else if(C[K]){if(k=C[K][1],k==69&&(k=b[b.l++]),k>R.length){console.error("WK1 bad formula parse 0x"+K.toString(16)+":|"+R.join("|")+"|");return}var Ke=R.slice(-k);R.length-=k,R.push(C[K][0]+"("+Ke.join(",")+")")}else return K<=7?console.error("WK1 invalid opcode "+K.toString(16)):K<=24?console.error("WK1 unsupported op "+K.toString(16)):K<=30?console.error("WK1 invalid opcode "+K.toString(16)):K<=115?console.error("WK1 unsupported function opcode "+K.toString(16)):console.error("WK1 unrecognized opcode "+K.toString(16))}}R.length==1?U[1].f=""+R[0]:console.error("WK1 bad formula parse |"+R.join("|")+"|")}function V(b){var U=[{c:0,r:0},{t:"n",v:0},0];return U[0].r=b.read_shift(2),U[3]=b[b.l++],U[0].c=b[b.l++],U}function A(b,U){var R=V(b,U);return R[1].t="s",R[1].v=b.read_shift(U-4,"cstr"),R}function S(b,U,R,k){var q=kt(6+k.length);q.write_shift(2,b),q.write_shift(1,R),q.write_shift(1,U),q.write_shift(1,39);for(var ce=0;ce<k.length;++ce){var ie=k.charCodeAt(ce);q.write_shift(1,ie>=128?95:ie)}return q.write_shift(1,0),q}function F(b,U){var R=V(b,U);R[1].v=b.read_shift(2);var k=R[1].v>>1;if(R[1].v&1)switch(k&7){case 0:k=(k>>3)*5e3;break;case 1:k=(k>>3)*500;break;case 2:k=(k>>3)/20;break;case 3:k=(k>>3)/200;break;case 4:k=(k>>3)/2e3;break;case 5:k=(k>>3)/2e4;break;case 6:k=(k>>3)/16;break;case 7:k=(k>>3)/64;break}return R[1].v=k,R}function N(b,U){var R=V(b,U),k=b.read_shift(4),q=b.read_shift(4),ce=b.read_shift(2);if(ce==65535)return k===0&&q===3221225472?(R[1].t="e",R[1].v=15):k===0&&q===3489660928?(R[1].t="e",R[1].v=42):R[1].v=0,R;var ie=ce&32768;return ce=(ce&32767)-16446,R[1].v=(1-ie*2)*(q*Math.pow(2,ce+32)+k*Math.pow(2,ce)),R}function H(b,U,R,k){var q=kt(14);if(q.write_shift(2,b),q.write_shift(1,R),q.write_shift(1,U),k==0)return q.write_shift(4,0),q.write_shift(4,0),q.write_shift(2,65535),q;var ce=0,ie=0,ae=0,K=0;return k<0&&(ce=1,k=-k),ie=Math.log2(k)|0,k/=Math.pow(2,ie-31),K=k>>>0,K&2147483648||(k/=2,++ie,K=k>>>0),k-=K,K|=2147483648,K>>>=0,k*=Math.pow(2,32),ae=k>>>0,q.write_shift(4,ae),q.write_shift(4,K),ie+=16383+(ce?32768:0),q.write_shift(2,ie),q}function W(b,U){var R=N(b,14);return b.l+=U-14,R}function O(b,U){var R=V(b,U),k=b.read_shift(4);return R[1].v=k>>6,R}function Q(b,U){var R=V(b,U),k=b.read_shift(8,"f");return R[1].v=k,R}function pe(b,U){var R=Q(b,14);return b.l+=U-10,R}function ne(b,U){return b[b.l+U-1]==0?b.read_shift(U,"cstr"):""}function _e(b,U){var R=b[b.l++];R>U-1&&(R=U-1);for(var k="";k.length<R;)k+=String.fromCharCode(b[b.l++]);return k}function fe(b,U,R){if(!(!R.qpro||U<21)){var k=b.read_shift(1);b.l+=17,b.l+=1,b.l+=2;var q=b.read_shift(U-21,"cstr");return[k,q]}}function qe(b,U){for(var R={},k=b.l+U;b.l<k;){var q=b.read_shift(2);if(q==14e3){for(R[q]=[0,""],R[q][0]=b.read_shift(2);b[b.l];)R[q][1]+=String.fromCharCode(b[b.l]),b.l++;b.l++}}return R}function se(b,U){var R=kt(5+b.length);R.write_shift(2,14e3),R.write_shift(2,U);for(var k=0;k<b.length;++k){var q=b.charCodeAt(k);R[R.l++]=q>127?95:q}return R[R.l++]=0,R}var me={0:{n:"BOF",f:At},1:{n:"EOF"},2:{n:"CALCMODE"},3:{n:"CALCORDER"},4:{n:"SPLIT"},5:{n:"SYNC"},6:{n:"RANGE",f:a},7:{n:"WINDOW1"},8:{n:"COLW1"},9:{n:"WINTWO"},10:{n:"COLW2"},11:{n:"NAME"},12:{n:"BLANK"},13:{n:"INTEGER",f:d},14:{n:"NUMBER",f:m},15:{n:"LABEL",f:u},16:{n:"FORMULA",f:g},24:{n:"TABLE"},25:{n:"ORANGE"},26:{n:"PRANGE"},27:{n:"SRANGE"},28:{n:"FRANGE"},29:{n:"KRANGE1"},32:{n:"HRANGE"},35:{n:"KRANGE2"},36:{n:"PROTEC"},37:{n:"FOOTER"},38:{n:"HEADER"},39:{n:"SETUP"},40:{n:"MARGINS"},41:{n:"LABELFMT"},42:{n:"TITLES"},43:{n:"SHEETJS"},45:{n:"GRAPH"},46:{n:"NGRAPH"},47:{n:"CALCCOUNT"},48:{n:"UNFORMATTED"},49:{n:"CURSORW12"},50:{n:"WINDOW"},51:{n:"STRING",f:u},55:{n:"PASSWORD"},56:{n:"LOCKED"},60:{n:"QUERY"},61:{n:"QUERYNAME"},62:{n:"PRINT"},63:{n:"PRINTNAME"},64:{n:"GRAPH2"},65:{n:"GRAPHNAME"},66:{n:"ZOOM"},67:{n:"SYMSPLIT"},68:{n:"NSROWS"},69:{n:"NSCOLS"},70:{n:"RULER"},71:{n:"NNAME"},72:{n:"ACOMM"},73:{n:"AMACRO"},74:{n:"PARSE"},102:{n:"PRANGES??"},103:{n:"RRANGES??"},104:{n:"FNAME??"},105:{n:"MRANGES??"},204:{n:"SHEETNAMECS",f:ne},222:{n:"SHEETNAMELP",f:_e},65535:{n:""}},G={0:{n:"BOF"},1:{n:"EOF"},2:{n:"PASSWORD"},3:{n:"CALCSET"},4:{n:"WINDOWSET"},5:{n:"SHEETCELLPTR"},6:{n:"SHEETLAYOUT"},7:{n:"COLUMNWIDTH"},8:{n:"HIDDENCOLUMN"},9:{n:"USERRANGE"},10:{n:"SYSTEMRANGE"},11:{n:"ZEROFORCE"},12:{n:"SORTKEYDIR"},13:{n:"FILESEAL"},14:{n:"DATAFILLNUMS"},15:{n:"PRINTMAIN"},16:{n:"PRINTSTRING"},17:{n:"GRAPHMAIN"},18:{n:"GRAPHSTRING"},19:{n:"??"},20:{n:"ERRCELL"},21:{n:"NACELL"},22:{n:"LABEL16",f:A},23:{n:"NUMBER17",f:N},24:{n:"NUMBER18",f:F},25:{n:"FORMULA19",f:W},26:{n:"FORMULA1A"},27:{n:"XFORMAT",f:qe},28:{n:"DTLABELMISC"},29:{n:"DTLABELCELL"},30:{n:"GRAPHWINDOW"},31:{n:"CPA"},32:{n:"LPLAUTO"},33:{n:"QUERY"},34:{n:"HIDDENSHEET"},35:{n:"??"},37:{n:"NUMBER25",f:O},38:{n:"??"},39:{n:"NUMBER27",f:Q},40:{n:"FORMULA28",f:pe},142:{n:"??"},147:{n:"??"},150:{n:"??"},151:{n:"??"},152:{n:"??"},153:{n:"??"},154:{n:"??"},155:{n:"??"},156:{n:"??"},163:{n:"??"},174:{n:"??"},175:{n:"??"},176:{n:"??"},177:{n:"??"},184:{n:"??"},185:{n:"??"},186:{n:"??"},187:{n:"??"},188:{n:"??"},195:{n:"??"},201:{n:"??"},204:{n:"SHEETNAMECS",f:ne},205:{n:"??"},206:{n:"??"},207:{n:"??"},208:{n:"??"},256:{n:"??"},259:{n:"??"},260:{n:"??"},261:{n:"??"},262:{n:"??"},263:{n:"??"},265:{n:"??"},266:{n:"??"},267:{n:"??"},268:{n:"??"},270:{n:"??"},271:{n:"??"},384:{n:"??"},389:{n:"??"},390:{n:"??"},393:{n:"??"},396:{n:"??"},512:{n:"??"},514:{n:"??"},513:{n:"??"},516:{n:"??"},517:{n:"??"},640:{n:"??"},641:{n:"??"},642:{n:"??"},643:{n:"??"},644:{n:"??"},645:{n:"??"},646:{n:"??"},647:{n:"??"},648:{n:"??"},658:{n:"??"},659:{n:"??"},660:{n:"??"},661:{n:"??"},662:{n:"??"},665:{n:"??"},666:{n:"??"},768:{n:"??"},772:{n:"??"},1537:{n:"SHEETINFOQP",f:fe},1600:{n:"??"},1602:{n:"??"},1793:{n:"??"},1794:{n:"??"},1795:{n:"??"},1796:{n:"??"},1920:{n:"??"},2048:{n:"??"},2049:{n:"??"},2052:{n:"??"},2688:{n:"??"},10998:{n:"??"},12849:{n:"??"},28233:{n:"??"},28484:{n:"??"},65535:{n:""}};return{sheet_to_wk1:r,book_to_wk3:i,to_workbook:n}}();function c8(e){var n={},t=e.match(hn),r=0,i=!1;if(t)for(;r!=t.length;++r){var s=Ee(t[r]);switch(s[0].replace(/\w*:/g,"")){case"<condense":break;case"<extend":break;case"<shadow":if(!s.val)break;case"<shadow>":case"<shadow/>":n.shadow=1;break;case"</shadow>":break;case"<charset":if(s.val=="1")break;n.cp=wg[parseInt(s.val,10)];break;case"<outline":if(!s.val)break;case"<outline>":case"<outline/>":n.outline=1;break;case"</outline>":break;case"<rFont":n.name=s.val;break;case"<sz":n.sz=s.val;break;case"<strike":if(!s.val)break;case"<strike>":case"<strike/>":n.strike=1;break;case"</strike>":break;case"<u":if(!s.val)break;switch(s.val){case"double":n.uval="double";break;case"singleAccounting":n.uval="single-accounting";break;case"doubleAccounting":n.uval="double-accounting";break}case"<u>":case"<u/>":n.u=1;break;case"</u>":break;case"<b":if(s.val=="0")break;case"<b>":case"<b/>":n.b=1;break;case"</b>":break;case"<i":if(s.val=="0")break;case"<i>":case"<i/>":n.i=1;break;case"</i>":break;case"<color":s.rgb&&(n.color=s.rgb.slice(2,8));break;case"<color>":case"<color/>":case"</color>":break;case"<family":n.family=s.val;break;case"<family>":case"<family/>":case"</family>":break;case"<vertAlign":n.valign=s.val;break;case"<vertAlign>":case"<vertAlign/>":case"</vertAlign>":break;case"<scheme":break;case"<scheme>":case"<scheme/>":case"</scheme>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":i=!0;break;case"</ext>":i=!1;break;default:if(s[0].charCodeAt(1)!==47&&!i)throw new Error("Unrecognized rich format "+s[0])}}return n}var l8=function(){var e=tl("t"),n=tl("rPr");function t(s){var o=s.match(e);if(!o)return{t:"s",v:""};var a={t:"s",v:Xe(o[1])},c=s.match(n);return c&&(a.s=c8(c[1])),a}var r=/<(?:\w+:)?r>/g,i=/<\/(?:\w+:)?r>/;return function(o){return o.replace(r,"").split(i).map(t).filter(function(a){return a.v})}}(),u8=function(){var n=/(\r\n|\n)/g;function t(i,s,o){var a=[];i.u&&a.push("text-decoration: underline;"),i.uval&&a.push("text-underline-style:"+i.uval+";"),i.sz&&a.push("font-size:"+i.sz+"pt;"),i.outline&&a.push("text-effect: outline;"),i.shadow&&a.push("text-shadow: auto;"),s.push('<span style="'+a.join("")+'">'),i.b&&(s.push("<b>"),o.push("</b>")),i.i&&(s.push("<i>"),o.push("</i>")),i.strike&&(s.push("<s>"),o.push("</s>"));var c=i.valign||"";return c=="superscript"||c=="super"?c="sup":c=="subscript"&&(c="sub"),c!=""&&(s.push("<"+c+">"),o.push("</"+c+">")),o.push("</span>"),i}function r(i){var s=[[],i.v,[]];return i.v?(i.s&&t(i.s,s[0],s[2]),s[0].join("")+s[1].replace(n,"<br/>")+s[2].join("")):""}return function(s){return s.map(r).join("")}}(),f8=/<(?:\w+:)?t[^>]*>([^<]*)<\/(?:\w+:)?t>/g,d8=/<(?:\w+:)?r>/,h8=/<(?:\w+:)?rPh.*?>([\s\S]*?)<\/(?:\w+:)?rPh>/g;function Hg(e,n){var t=n?n.cellHTML:!0,r={};return e?(e.match(/^\s*<(?:\w+:)?t[^>]*>/)?(r.t=Xe(ct(e.slice(e.indexOf(">")+1).split(/<\/(?:\w+:)?t>/)[0]||"")),r.r=ct(e),t&&(r.h=bg(r.t))):e.match(d8)&&(r.r=ct(e),r.t=Xe(ct((e.replace(h8,"").match(f8)||[]).join("").replace(hn,""))),t&&(r.h=u8(l8(r.r)))),r):{t:""}}var p8=/<(?:\w+:)?sst([^>]*)>([\s\S]*)<\/(?:\w+:)?sst>/,m8=/<(?:\w+:)?(?:si|sstItem)>/g,g8=/<\/(?:\w+:)?(?:si|sstItem)>/;function v8(e,n){var t=[],r="";if(!e)return t;var i=e.match(p8);if(i){r=i[2].replace(m8,"").split(g8);for(var s=0;s!=r.length;++s){var o=Hg(r[s].trim(),n);o!=null&&(t[t.length]=o)}i=Ee(i[1]),t.Count=i.count,t.Unique=i.uniqueCount}return t}function _8(e){return[e.read_shift(4),e.read_shift(4)]}function x8(e,n){var t=[],r=!1;return _i(e,function(s,o,a){switch(a){case 159:t.Count=s[0],t.Unique=s[1];break;case 19:t.push(s);break;case 160:return!0;case 35:r=!0;break;case 36:r=!1;break;default:if(o.T,!r||n.WTF)throw new Error("Unexpected record 0x"+a.toString(16))}}),t}function mC(e){if(typeof nt<"u")return nt.utils.encode(aa,e);for(var n=[],t=e.split(""),r=0;r<t.length;++r)n[r]=t[r].charCodeAt(0);return n}function gi(e,n){var t={};return t.Major=e.read_shift(2),t.Minor=e.read_shift(2),n>=4&&(e.l+=n-4),t}function y8(e){var n={};return n.id=e.read_shift(0,"lpp4"),n.R=gi(e,4),n.U=gi(e,4),n.W=gi(e,4),n}function w8(e){for(var n=e.read_shift(4),t=e.l+n-4,r={},i=e.read_shift(4),s=[];i-- >0;)s.push({t:e.read_shift(4),v:e.read_shift(0,"lpp4")});if(r.name=e.read_shift(0,"lpp4"),r.comps=s,e.l!=t)throw new Error("Bad DataSpaceMapEntry: "+e.l+" != "+t);return r}function E8(e){var n=[];e.l+=4;for(var t=e.read_shift(4);t-- >0;)n.push(w8(e));return n}function T8(e){var n=[];e.l+=4;for(var t=e.read_shift(4);t-- >0;)n.push(e.read_shift(0,"lpp4"));return n}function I8(e){var n={};return e.read_shift(4),e.l+=4,n.id=e.read_shift(0,"lpp4"),n.name=e.read_shift(0,"lpp4"),n.R=gi(e,4),n.U=gi(e,4),n.W=gi(e,4),n}function C8(e){var n=I8(e);if(n.ename=e.read_shift(0,"8lpp4"),n.blksz=e.read_shift(4),n.cmode=e.read_shift(4),e.read_shift(4)!=4)throw new Error("Bad !Primary record");return n}function gC(e,n){var t=e.l+n,r={};r.Flags=e.read_shift(4)&63,e.l+=4,r.AlgID=e.read_shift(4);var i=!1;switch(r.AlgID){case 26126:case 26127:case 26128:i=r.Flags==36;break;case 26625:i=r.Flags==4;break;case 0:i=r.Flags==16||r.Flags==4||r.Flags==36;break;default:throw"Unrecognized encryption algorithm: "+r.AlgID}if(!i)throw new Error("Encryption Flags/AlgID mismatch");return r.AlgIDHash=e.read_shift(4),r.KeySize=e.read_shift(4),r.ProviderType=e.read_shift(4),e.l+=8,r.CSPName=e.read_shift(t-e.l>>1,"utf16le"),e.l=t,r}function vC(e,n){var t={},r=e.l+n;return e.l+=4,t.Salt=e.slice(e.l,e.l+16),e.l+=16,t.Verifier=e.slice(e.l,e.l+16),e.l+=16,e.read_shift(4),t.VerifierHash=e.slice(e.l,r),e.l=r,t}function S8(e){var n=gi(e);switch(n.Minor){case 2:return[n.Minor,D8(e,n)];case 3:return[n.Minor,b8(e,n)];case 4:return[n.Minor,A8(e,n)]}throw new Error("ECMA-376 Encrypted file unrecognized Version: "+n.Minor)}function D8(e){var n=e.read_shift(4);if((n&63)!=36)throw new Error("EncryptionInfo mismatch");var t=e.read_shift(4),r=gC(e,t),i=vC(e,e.length-e.l);return{t:"Std",h:r,v:i}}function b8(){throw new Error("File is password-protected: ECMA-376 Extensible")}function A8(e){var n=["saltSize","blockSize","keyBits","hashSize","cipherAlgorithm","cipherChaining","hashAlgorithm","saltValue"];e.l+=4;var t=e.read_shift(e.length-e.l,"utf8"),r={};return t.replace(hn,function(s){var o=Ee(s);switch(Gr(o[0])){case"<?xml":break;case"<encryption":case"</encryption>":break;case"<keyData":n.forEach(function(a){r[a]=o[a]});break;case"<dataIntegrity":r.encryptedHmacKey=o.encryptedHmacKey,r.encryptedHmacValue=o.encryptedHmacValue;break;case"<keyEncryptors>":case"<keyEncryptors":r.encs=[];break;case"</keyEncryptors>":break;case"<keyEncryptor":r.uri=o.uri;break;case"</keyEncryptor>":break;case"<encryptedKey":r.encs.push(o);break;default:throw o[0]}}),r}function k8(e,n){var t={},r=t.EncryptionVersionInfo=gi(e,4);if(n-=4,r.Minor!=2)throw new Error("unrecognized minor version code: "+r.Minor);if(r.Major>4||r.Major<2)throw new Error("unrecognized major version code: "+r.Major);t.Flags=e.read_shift(4),n-=4;var i=e.read_shift(4);return n-=4,t.EncryptionHeader=gC(e,i),n-=i,t.EncryptionVerifier=vC(e,n),t}function N8(e){var n={},t=n.EncryptionVersionInfo=gi(e,4);if(t.Major!=1||t.Minor!=1)throw"unrecognized version code "+t.Major+" : "+t.Minor;return n.Salt=e.read_shift(16),n.EncryptedVerifier=e.read_shift(16),n.EncryptedVerifierHash=e.read_shift(16),n}function R8(e){var n=0,t,r=mC(e),i=r.length+1,s,o,a,c,l;for(t=Xi(i),t[0]=r.length,s=1;s!=i;++s)t[s]=r[s-1];for(s=i-1;s>=0;--s)o=t[s],a=n&16384?1:0,c=n<<1&32767,l=a|c,n=l^o;return n^52811}var _C=function(){var e=[187,255,255,186,255,255,185,128,0,190,15,0,191,15,0],n=[57840,7439,52380,33984,4364,3600,61902,12606,6258,57657,54287,34041,10252,43370,20163],t=[44796,19929,39858,10053,20106,40212,10761,31585,63170,64933,60267,50935,40399,11199,17763,35526,1453,2906,5812,11624,23248,885,1770,3540,7080,14160,28320,56640,55369,41139,20807,41614,21821,43642,17621,28485,56970,44341,19019,38038,14605,29210,60195,50791,40175,10751,21502,43004,24537,18387,36774,3949,7898,15796,31592,63184,47201,24803,49606,37805,14203,28406,56812,17824,35648,1697,3394,6788,13576,27152,43601,17539,35078,557,1114,2228,4456,30388,60776,51953,34243,7079,14158,28316,14128,28256,56512,43425,17251,34502,7597,13105,26210,52420,35241,883,1766,3532,4129,8258,16516,33032,4657,9314,18628],r=function(o){return(o/2|o*128)&255},i=function(o,a){return r(o^a)},s=function(o){for(var a=n[o.length-1],c=104,l=o.length-1;l>=0;--l)for(var u=o[l],f=0;f!=7;++f)u&64&&(a^=t[c]),u*=2,--c;return a};return function(o){for(var a=mC(o),c=s(a),l=a.length,u=Xi(16),f=0;f!=16;++f)u[f]=0;var d,h,m;for((l&1)===1&&(d=c>>8,u[l]=i(e[0],d),--l,d=c&255,h=a[a.length-1],u[l]=i(h,d));l>0;)--l,d=c>>8,u[l]=i(a[l],d),--l,d=c&255,u[l]=i(a[l],d);for(l=15,m=15-a.length;m>0;)d=c>>8,u[l]=i(e[m],d),--l,--m,d=c&255,u[l]=i(a[l],d),--l,--m;return u}}(),M8=function(e,n,t,r,i){i||(i=n),r||(r=_C(e));var s,o;for(s=0;s!=n.length;++s)o=n[s],o^=r[t],o=(o>>5|o<<3)&255,i[s]=o,++t;return[i,t,r]},O8=function(e){var n=0,t=_C(e);return function(r){var i=M8("",r,n,t);return n=i[1],i[0]}};function F8(e,n,t,r){var i={key:At(e),verificationBytes:At(e)};return t.password&&(i.verifier=R8(t.password)),r.valid=i.verificationBytes===i.verifier,r.valid&&(r.insitu=O8(t.password)),i}function P8(e,n,t){var r=t||{};return r.Info=e.read_shift(2),e.l-=2,r.Info===1?r.Data=N8(e,n):r.Data=k8(e,n),r}function L8(e,n,t){var r={Type:t.biff>=8?e.read_shift(2):0};return r.Type?P8(e,n-2,r):F8(e,t.biff>=8?n:n-2,t,r),r}var B8=function(){function e(i,s){switch(s.type){case"base64":return n(jn(i),s);case"binary":return n(i,s);case"buffer":return n(Ue&&Buffer.isBuffer(i)?i.toString("binary"):Hs(i),s);case"array":return n(Us(i),s)}throw new Error("Unrecognized type "+s.type)}function n(i,s){var o=s||{},a=o.dense?[]:{},c=i.match(/\\trowd.*?\\row\b/g);if(!c.length)throw new Error("RTF missing table");var l={s:{c:0,r:0},e:{c:0,r:c.length-1}};return c.forEach(function(u,f){Array.isArray(a)&&(a[f]=[]);for(var d=/\\\w+\b/g,h=0,m,p=-1;m=d.exec(u);){switch(m[0]){case"\\cell":var g=u.slice(h,d.lastIndex-m[0].length);if(g[0]==" "&&(g=g.slice(1)),++p,g.length){var w={v:g,t:"s"};Array.isArray(a)?a[f][p]=w:a[Ce({r:f,c:p})]=w}break}h=d.lastIndex}p>l.e.c&&(l.e.c=p)}),a["!ref"]=Ge(l),a}function t(i,s){return Zi(e(i,s),s)}function r(i){for(var s=["{\\rtf1\\ansi"],o=_t(i["!ref"]),a,c=Array.isArray(i),l=o.s.r;l<=o.e.r;++l){s.push("\\trowd\\trautofit1");for(var u=o.s.c;u<=o.e.c;++u)s.push("\\cellx"+(u+1));for(s.push("\\pard\\intbl"),u=o.s.c;u<=o.e.c;++u){var f=Ce({r:l,c:u});a=c?(i[l]||[])[u]:i[f],!(!a||a.v==null&&(!a.f||a.F))&&(s.push(" "+(a.w||(vi(a),a.w))),s.push("\\cell"))}s.push("\\pard\\intbl\\row")}return s.join("")+"}"}return{to_workbook:t,to_sheet:e,from_sheet:r}}();function U8(e){var n=e.slice(e[0]==="#"?1:0).slice(0,6);return[parseInt(n.slice(0,2),16),parseInt(n.slice(2,4),16),parseInt(n.slice(4,6),16)]}function il(e){for(var n=0,t=1;n!=3;++n)t=t*256+(e[n]>255?255:e[n]<0?0:e[n]);return t.toString(16).toUpperCase().slice(1)}function j8(e){var n=e[0]/255,t=e[1]/255,r=e[2]/255,i=Math.max(n,t,r),s=Math.min(n,t,r),o=i-s;if(o===0)return[0,0,n];var a=0,c=0,l=i+s;switch(c=o/(l>1?2-l:l),i){case n:a=((t-r)/o+6)%6;break;case t:a=(r-n)/o+2;break;case r:a=(n-t)/o+4;break}return[a/6,c,l/2]}function V8(e){var n=e[0],t=e[1],r=e[2],i=t*2*(r<.5?r:1-r),s=r-i/2,o=[s,s,s],a=6*n,c;if(t!==0)switch(a|0){case 0:case 6:c=i*a,o[0]+=i,o[1]+=c;break;case 1:c=i*(2-a),o[0]+=c,o[1]+=i;break;case 2:c=i*(a-2),o[1]+=i,o[2]+=c;break;case 3:c=i*(4-a),o[1]+=c,o[2]+=i;break;case 4:c=i*(a-4),o[2]+=i,o[0]+=c;break;case 5:c=i*(6-a),o[2]+=c,o[0]+=i;break}for(var l=0;l!=3;++l)o[l]=Math.round(o[l]*255);return o}function Td(e,n){if(n===0)return e;var t=j8(U8(e));return n<0?t[2]=t[2]*(1+n):t[2]=1-(1-t[2])*(1-n),il(V8(t))}var xC=6,H8=15,$8=1,yn=xC;function Id(e){return Math.floor((e+Math.round(128/yn)/256)*yn)}function Cd(e){return Math.floor((e-5)/yn*100+.5)/100}function mg(e){return Math.round((e*yn+5)/yn*256)/256}function ig(e){return mg(Cd(Id(e)))}function $g(e){var n=Math.abs(e-ig(e)),t=yn;if(n>.005)for(yn=$8;yn<H8;++yn)Math.abs(e-ig(e))<=n&&(n=Math.abs(e-ig(e)),t=yn);yn=t}function la(e){e.width?(e.wpx=Id(e.width),e.wch=Cd(e.wpx),e.MDW=yn):e.wpx?(e.wch=Cd(e.wpx),e.width=mg(e.wch),e.MDW=yn):typeof e.wch=="number"&&(e.width=mg(e.wch),e.wpx=Id(e.width),e.MDW=yn),e.customWidth&&delete e.customWidth}var W8=96,yC=W8;function wC(e){return e*96/yC}function sl(e){return e*yC/96}var z8={None:"none",Solid:"solid",Gray50:"mediumGray",Gray75:"darkGray",Gray25:"lightGray",HorzStripe:"darkHorizontal",VertStripe:"darkVertical",ReverseDiagStripe:"darkDown",DiagStripe:"darkUp",DiagCross:"darkGrid",ThickDiagCross:"darkTrellis",ThinHorzStripe:"lightHorizontal",ThinVertStripe:"lightVertical",ThinReverseDiagStripe:"lightDown",ThinHorzCross:"lightGrid"};function G8(e,n,t,r){n.Borders=[];var i={},s=!1;(e[0].match(hn)||[]).forEach(function(o){var a=Ee(o);switch(Gr(a[0])){case"<borders":case"<borders>":case"</borders>":break;case"<border":case"<border>":case"<border/>":i={},a.diagonalUp&&(i.diagonalUp=ft(a.diagonalUp)),a.diagonalDown&&(i.diagonalDown=ft(a.diagonalDown)),n.Borders.push(i);break;case"</border>":break;case"<left/>":break;case"<left":case"<left>":break;case"</left>":break;case"<right/>":break;case"<right":case"<right>":break;case"</right>":break;case"<top/>":break;case"<top":case"<top>":break;case"</top>":break;case"<bottom/>":break;case"<bottom":case"<bottom>":break;case"</bottom>":break;case"<diagonal":case"<diagonal>":case"<diagonal/>":break;case"</diagonal>":break;case"<horizontal":case"<horizontal>":case"<horizontal/>":break;case"</horizontal>":break;case"<vertical":case"<vertical>":case"<vertical/>":break;case"</vertical>":break;case"<start":case"<start>":case"<start/>":break;case"</start>":break;case"<end":case"<end>":case"<end/>":break;case"</end>":break;case"<color":case"<color>":break;case"<color/>":case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;default:if(r&&r.WTF&&!s)throw new Error("unrecognized "+a[0]+" in borders")}})}function q8(e,n,t,r){n.Fills=[];var i={},s=!1;(e[0].match(hn)||[]).forEach(function(o){var a=Ee(o);switch(Gr(a[0])){case"<fills":case"<fills>":case"</fills>":break;case"<fill>":case"<fill":case"<fill/>":i={},n.Fills.push(i);break;case"</fill>":break;case"<gradientFill>":break;case"<gradientFill":case"</gradientFill>":n.Fills.push(i),i={};break;case"<patternFill":case"<patternFill>":a.patternType&&(i.patternType=a.patternType);break;case"<patternFill/>":case"</patternFill>":break;case"<bgColor":i.bgColor||(i.bgColor={}),a.indexed&&(i.bgColor.indexed=parseInt(a.indexed,10)),a.theme&&(i.bgColor.theme=parseInt(a.theme,10)),a.tint&&(i.bgColor.tint=parseFloat(a.tint)),a.rgb&&(i.bgColor.rgb=a.rgb.slice(-6));break;case"<bgColor/>":case"</bgColor>":break;case"<fgColor":i.fgColor||(i.fgColor={}),a.theme&&(i.fgColor.theme=parseInt(a.theme,10)),a.tint&&(i.fgColor.tint=parseFloat(a.tint)),a.rgb!=null&&(i.fgColor.rgb=a.rgb.slice(-6));break;case"<fgColor/>":case"</fgColor>":break;case"<stop":case"<stop/>":break;case"</stop>":break;case"<color":case"<color/>":break;case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;default:if(r&&r.WTF&&!s)throw new Error("unrecognized "+a[0]+" in fills")}})}function K8(e,n,t,r){n.Fonts=[];var i={},s=!1;(e[0].match(hn)||[]).forEach(function(o){var a=Ee(o);switch(Gr(a[0])){case"<fonts":case"<fonts>":case"</fonts>":break;case"<font":case"<font>":break;case"</font>":case"<font/>":n.Fonts.push(i),i={};break;case"<name":a.val&&(i.name=ct(a.val));break;case"<name/>":case"</name>":break;case"<b":i.bold=a.val?ft(a.val):1;break;case"<b/>":i.bold=1;break;case"<i":i.italic=a.val?ft(a.val):1;break;case"<i/>":i.italic=1;break;case"<u":switch(a.val){case"none":i.underline=0;break;case"single":i.underline=1;break;case"double":i.underline=2;break;case"singleAccounting":i.underline=33;break;case"doubleAccounting":i.underline=34;break}break;case"<u/>":i.underline=1;break;case"<strike":i.strike=a.val?ft(a.val):1;break;case"<strike/>":i.strike=1;break;case"<outline":i.outline=a.val?ft(a.val):1;break;case"<outline/>":i.outline=1;break;case"<shadow":i.shadow=a.val?ft(a.val):1;break;case"<shadow/>":i.shadow=1;break;case"<condense":i.condense=a.val?ft(a.val):1;break;case"<condense/>":i.condense=1;break;case"<extend":i.extend=a.val?ft(a.val):1;break;case"<extend/>":i.extend=1;break;case"<sz":a.val&&(i.sz=+a.val);break;case"<sz/>":case"</sz>":break;case"<vertAlign":a.val&&(i.vertAlign=a.val);break;case"<vertAlign/>":case"</vertAlign>":break;case"<family":a.val&&(i.family=parseInt(a.val,10));break;case"<family/>":case"</family>":break;case"<scheme":a.val&&(i.scheme=a.val);break;case"<scheme/>":case"</scheme>":break;case"<charset":if(a.val=="1")break;a.codepage=wg[parseInt(a.val,10)];break;case"<color":if(i.color||(i.color={}),a.auto&&(i.color.auto=ft(a.auto)),a.rgb)i.color.rgb=a.rgb.slice(-6);else if(a.indexed){i.color.index=parseInt(a.indexed,10);var c=Ls[i.color.index];i.color.index==81&&(c=Ls[1]),c||(c=Ls[1]),i.color.rgb=c[0].toString(16)+c[1].toString(16)+c[2].toString(16)}else a.theme&&(i.color.theme=parseInt(a.theme,10),a.tint&&(i.color.tint=parseFloat(a.tint)),a.theme&&t.themeElements&&t.themeElements.clrScheme&&(i.color.rgb=Td(t.themeElements.clrScheme[i.color.theme].rgb,i.color.tint||0)));break;case"<color/>":case"</color>":break;case"<AlternateContent":s=!0;break;case"</AlternateContent>":s=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;default:if(r&&r.WTF&&!s)throw new Error("unrecognized "+a[0]+" in fonts")}})}function Y8(e,n,t){n.NumberFmt=[];for(var r=zr(Ae),i=0;i<r.length;++i)n.NumberFmt[r[i]]=Ae[r[i]];var s=e[0].match(hn);if(s)for(i=0;i<s.length;++i){var o=Ee(s[i]);switch(Gr(o[0])){case"<numFmts":case"</numFmts>":case"<numFmts/>":case"<numFmts>":break;case"<numFmt":{var a=Xe(ct(o.formatCode)),c=parseInt(o.numFmtId,10);if(n.NumberFmt[c]=a,c>0){if(c>392){for(c=392;c>60&&n.NumberFmt[c]!=null;--c);n.NumberFmt[c]=a}Ps(a,c)}}break;case"</numFmt>":break;default:if(t.WTF)throw new Error("unrecognized "+o[0]+" in numFmts")}}}var hd=["numFmtId","fillId","fontId","borderId","xfId"],pd=["applyAlignment","applyBorder","applyFill","applyFont","applyNumberFormat","applyProtection","pivotButton","quotePrefix"];function X8(e,n,t){n.CellXf=[];var r,i=!1;(e[0].match(hn)||[]).forEach(function(s){var o=Ee(s),a=0;switch(Gr(o[0])){case"<cellXfs":case"<cellXfs>":case"<cellXfs/>":case"</cellXfs>":break;case"<xf":case"<xf/>":for(r=o,delete r[0],a=0;a<hd.length;++a)r[hd[a]]&&(r[hd[a]]=parseInt(r[hd[a]],10));for(a=0;a<pd.length;++a)r[pd[a]]&&(r[pd[a]]=ft(r[pd[a]]));if(n.NumberFmt&&r.numFmtId>392){for(a=392;a>60;--a)if(n.NumberFmt[r.numFmtId]==n.NumberFmt[a]){r.numFmtId=a;break}}n.CellXf.push(r);break;case"</xf>":break;case"<alignment":case"<alignment/>":var c={};o.vertical&&(c.vertical=o.vertical),o.horizontal&&(c.horizontal=o.horizontal),o.textRotation!=null&&(c.textRotation=o.textRotation),o.indent&&(c.indent=o.indent),o.wrapText&&(c.wrapText=ft(o.wrapText)),r.alignment=c;break;case"</alignment>":break;case"<protection":break;case"</protection>":case"<protection/>":break;case"<AlternateContent":i=!0;break;case"</AlternateContent>":i=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":i=!0;break;case"</ext>":i=!1;break;default:if(t&&t.WTF&&!i)throw new Error("unrecognized "+o[0]+" in cellXfs")}})}var Q8=function(){var n=/<(?:\w+:)?numFmts([^>]*)>[\S\s]*?<\/(?:\w+:)?numFmts>/,t=/<(?:\w+:)?cellXfs([^>]*)>[\S\s]*?<\/(?:\w+:)?cellXfs>/,r=/<(?:\w+:)?fills([^>]*)>[\S\s]*?<\/(?:\w+:)?fills>/,i=/<(?:\w+:)?fonts([^>]*)>[\S\s]*?<\/(?:\w+:)?fonts>/,s=/<(?:\w+:)?borders([^>]*)>[\S\s]*?<\/(?:\w+:)?borders>/;return function(a,c,l){var u={};if(!a)return u;a=a.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");var f;return(f=a.match(n))&&Y8(f,u,l),(f=a.match(i))&&K8(f,u,c,l),(f=a.match(r))&&q8(f,u,c,l),(f=a.match(s))&&G8(f,u,c,l),(f=a.match(t))&&X8(f,u,l),u}}();function Z8(e,n){var t=e.read_shift(2),r=fn(e,n-2);return[t,r]}function J8(e,n,t){var r={};r.sz=e.read_shift(2)/20;var i=l4(e,2,t);i.fItalic&&(r.italic=1),i.fCondense&&(r.condense=1),i.fExtend&&(r.extend=1),i.fShadow&&(r.shadow=1),i.fOutline&&(r.outline=1),i.fStrikeout&&(r.strike=1);var s=e.read_shift(2);switch(s===700&&(r.bold=1),e.read_shift(2)){case 1:r.vertAlign="superscript";break;case 2:r.vertAlign="subscript";break}var o=e.read_shift(1);o!=0&&(r.underline=o);var a=e.read_shift(1);a>0&&(r.family=a);var c=e.read_shift(1);switch(c>0&&(r.charset=c),e.l++,r.color=c4(e,8),e.read_shift(1)){case 1:r.scheme="major";break;case 2:r.scheme="minor";break}return r.name=fn(e,n-21),r}var eB=dn;function tB(e,n){var t=e.l+n,r=e.read_shift(2),i=e.read_shift(2);return e.l=t,{ixfe:r,numFmtId:i}}var nB=dn;function rB(e,n,t){var r={};r.NumberFmt=[];for(var i in Ae)r.NumberFmt[i]=Ae[i];r.CellXf=[],r.Fonts=[];var s=[],o=!1;return _i(e,function(c,l,u){switch(u){case 44:r.NumberFmt[c[0]]=c[1],Ps(c[1],c[0]);break;case 43:r.Fonts.push(c),c.color.theme!=null&&n&&n.themeElements&&n.themeElements.clrScheme&&(c.color.rgb=Td(n.themeElements.clrScheme[c.color.theme].rgb,c.color.tint||0));break;case 1025:break;case 45:break;case 46:break;case 47:s[s.length-1]==617&&r.CellXf.push(c);break;case 48:case 507:case 572:case 475:break;case 1171:case 2102:case 1130:case 512:case 2095:case 3072:break;case 35:o=!0;break;case 36:o=!1;break;case 37:s.push(u),o=!0;break;case 38:s.pop(),o=!1;break;default:if(l.T>0)s.push(u);else if(l.T<0)s.pop();else if(!o||t.WTF&&s[s.length-1]!=37)throw new Error("Unexpected record 0x"+u.toString(16))}}),r}var iB=["</a:lt1>","</a:dk1>","</a:lt2>","</a:dk2>","</a:accent1>","</a:accent2>","</a:accent3>","</a:accent4>","</a:accent5>","</a:accent6>","</a:hlink>","</a:folHlink>"];function sB(e,n,t){n.themeElements.clrScheme=[];var r={};(e[0].match(hn)||[]).forEach(function(i){var s=Ee(i);switch(s[0]){case"<a:clrScheme":case"</a:clrScheme>":break;case"<a:srgbClr":r.rgb=s.val;break;case"<a:sysClr":r.rgb=s.lastClr;break;case"<a:dk1>":case"</a:dk1>":case"<a:lt1>":case"</a:lt1>":case"<a:dk2>":case"</a:dk2>":case"<a:lt2>":case"</a:lt2>":case"<a:accent1>":case"</a:accent1>":case"<a:accent2>":case"</a:accent2>":case"<a:accent3>":case"</a:accent3>":case"<a:accent4>":case"</a:accent4>":case"<a:accent5>":case"</a:accent5>":case"<a:accent6>":case"</a:accent6>":case"<a:hlink>":case"</a:hlink>":case"<a:folHlink>":case"</a:folHlink>":s[0].charAt(1)==="/"?(n.themeElements.clrScheme[iB.indexOf(s[0])]=r,r={}):r.name=s[0].slice(3,s[0].length-1);break;default:if(t&&t.WTF)throw new Error("Unrecognized "+s[0]+" in clrScheme")}})}function oB(){}function aB(){}var cB=/<a:clrScheme([^>]*)>[\s\S]*<\/a:clrScheme>/,lB=/<a:fontScheme([^>]*)>[\s\S]*<\/a:fontScheme>/,uB=/<a:fmtScheme([^>]*)>[\s\S]*<\/a:fmtScheme>/;function fB(e,n,t){n.themeElements={};var r;[["clrScheme",cB,sB],["fontScheme",lB,oB],["fmtScheme",uB,aB]].forEach(function(i){if(!(r=e.match(i[1])))throw new Error(i[0]+" not found in themeElements");i[2](r,n,t)})}var dB=/<a:themeElements([^>]*)>[\s\S]*<\/a:themeElements>/;function EC(e,n){(!e||e.length===0)&&(e=hB());var t,r={};if(!(t=e.match(dB)))throw new Error("themeElements not found in theme");return fB(t[0],r,n),r.raw=e,r}function hB(e,n){if(n&&n.themeXLSX)return n.themeXLSX;if(e&&typeof e.raw=="string")return e.raw;var t=[BI];return t[t.length]='<a:theme xmlns:a="http://schemas.openxmlformats.org/drawingml/2006/main" name="Office Theme">',t[t.length]="<a:themeElements>",t[t.length]='<a:clrScheme name="Office">',t[t.length]='<a:dk1><a:sysClr val="windowText" lastClr="000000"/></a:dk1>',t[t.length]='<a:lt1><a:sysClr val="window" lastClr="FFFFFF"/></a:lt1>',t[t.length]='<a:dk2><a:srgbClr val="1F497D"/></a:dk2>',t[t.length]='<a:lt2><a:srgbClr val="EEECE1"/></a:lt2>',t[t.length]='<a:accent1><a:srgbClr val="4F81BD"/></a:accent1>',t[t.length]='<a:accent2><a:srgbClr val="C0504D"/></a:accent2>',t[t.length]='<a:accent3><a:srgbClr val="9BBB59"/></a:accent3>',t[t.length]='<a:accent4><a:srgbClr val="8064A2"/></a:accent4>',t[t.length]='<a:accent5><a:srgbClr val="4BACC6"/></a:accent5>',t[t.length]='<a:accent6><a:srgbClr val="F79646"/></a:accent6>',t[t.length]='<a:hlink><a:srgbClr val="0000FF"/></a:hlink>',t[t.length]='<a:folHlink><a:srgbClr val="800080"/></a:folHlink>',t[t.length]="</a:clrScheme>",t[t.length]='<a:fontScheme name="Office">',t[t.length]="<a:majorFont>",t[t.length]='<a:latin typeface="Cambria"/>',t[t.length]='<a:ea typeface=""/>',t[t.length]='<a:cs typeface=""/>',t[t.length]='<a:font script="Jpan" typeface="\uFF2D\uFF33 \uFF30\u30B4\u30B7\u30C3\u30AF"/>',t[t.length]='<a:font script="Hang" typeface="\uB9D1\uC740 \uACE0\uB515"/>',t[t.length]='<a:font script="Hans" typeface="\u5B8B\u4F53"/>',t[t.length]='<a:font script="Hant" typeface="\u65B0\u7D30\u660E\u9AD4"/>',t[t.length]='<a:font script="Arab" typeface="Times New Roman"/>',t[t.length]='<a:font script="Hebr" typeface="Times New Roman"/>',t[t.length]='<a:font script="Thai" typeface="Tahoma"/>',t[t.length]='<a:font script="Ethi" typeface="Nyala"/>',t[t.length]='<a:font script="Beng" typeface="Vrinda"/>',t[t.length]='<a:font script="Gujr" typeface="Shruti"/>',t[t.length]='<a:font script="Khmr" typeface="MoolBoran"/>',t[t.length]='<a:font script="Knda" typeface="Tunga"/>',t[t.length]='<a:font script="Guru" typeface="Raavi"/>',t[t.length]='<a:font script="Cans" typeface="Euphemia"/>',t[t.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',t[t.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',t[t.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',t[t.length]='<a:font script="Thaa" typeface="MV Boli"/>',t[t.length]='<a:font script="Deva" typeface="Mangal"/>',t[t.length]='<a:font script="Telu" typeface="Gautami"/>',t[t.length]='<a:font script="Taml" typeface="Latha"/>',t[t.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',t[t.length]='<a:font script="Orya" typeface="Kalinga"/>',t[t.length]='<a:font script="Mlym" typeface="Kartika"/>',t[t.length]='<a:font script="Laoo" typeface="DokChampa"/>',t[t.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',t[t.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',t[t.length]='<a:font script="Viet" typeface="Times New Roman"/>',t[t.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',t[t.length]='<a:font script="Geor" typeface="Sylfaen"/>',t[t.length]="</a:majorFont>",t[t.length]="<a:minorFont>",t[t.length]='<a:latin typeface="Calibri"/>',t[t.length]='<a:ea typeface=""/>',t[t.length]='<a:cs typeface=""/>',t[t.length]='<a:font script="Jpan" typeface="\uFF2D\uFF33 \uFF30\u30B4\u30B7\u30C3\u30AF"/>',t[t.length]='<a:font script="Hang" typeface="\uB9D1\uC740 \uACE0\uB515"/>',t[t.length]='<a:font script="Hans" typeface="\u5B8B\u4F53"/>',t[t.length]='<a:font script="Hant" typeface="\u65B0\u7D30\u660E\u9AD4"/>',t[t.length]='<a:font script="Arab" typeface="Arial"/>',t[t.length]='<a:font script="Hebr" typeface="Arial"/>',t[t.length]='<a:font script="Thai" typeface="Tahoma"/>',t[t.length]='<a:font script="Ethi" typeface="Nyala"/>',t[t.length]='<a:font script="Beng" typeface="Vrinda"/>',t[t.length]='<a:font script="Gujr" typeface="Shruti"/>',t[t.length]='<a:font script="Khmr" typeface="DaunPenh"/>',t[t.length]='<a:font script="Knda" typeface="Tunga"/>',t[t.length]='<a:font script="Guru" typeface="Raavi"/>',t[t.length]='<a:font script="Cans" typeface="Euphemia"/>',t[t.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',t[t.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',t[t.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',t[t.length]='<a:font script="Thaa" typeface="MV Boli"/>',t[t.length]='<a:font script="Deva" typeface="Mangal"/>',t[t.length]='<a:font script="Telu" typeface="Gautami"/>',t[t.length]='<a:font script="Taml" typeface="Latha"/>',t[t.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',t[t.length]='<a:font script="Orya" typeface="Kalinga"/>',t[t.length]='<a:font script="Mlym" typeface="Kartika"/>',t[t.length]='<a:font script="Laoo" typeface="DokChampa"/>',t[t.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',t[t.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',t[t.length]='<a:font script="Viet" typeface="Arial"/>',t[t.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',t[t.length]='<a:font script="Geor" typeface="Sylfaen"/>',t[t.length]="</a:minorFont>",t[t.length]="</a:fontScheme>",t[t.length]='<a:fmtScheme name="Office">',t[t.length]="<a:fillStyleLst>",t[t.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',t[t.length]='<a:gradFill rotWithShape="1">',t[t.length]="<a:gsLst>",t[t.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="50000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',t[t.length]='<a:gs pos="35000"><a:schemeClr val="phClr"><a:tint val="37000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',t[t.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="15000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',t[t.length]="</a:gsLst>",t[t.length]='<a:lin ang="16200000" scaled="1"/>',t[t.length]="</a:gradFill>",t[t.length]='<a:gradFill rotWithShape="1">',t[t.length]="<a:gsLst>",t[t.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="100000"/><a:shade val="100000"/><a:satMod val="130000"/></a:schemeClr></a:gs>',t[t.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="50000"/><a:shade val="100000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',t[t.length]="</a:gsLst>",t[t.length]='<a:lin ang="16200000" scaled="0"/>',t[t.length]="</a:gradFill>",t[t.length]="</a:fillStyleLst>",t[t.length]="<a:lnStyleLst>",t[t.length]='<a:ln w="9525" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"><a:shade val="95000"/><a:satMod val="105000"/></a:schemeClr></a:solidFill><a:prstDash val="solid"/></a:ln>',t[t.length]='<a:ln w="25400" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',t[t.length]='<a:ln w="38100" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',t[t.length]="</a:lnStyleLst>",t[t.length]="<a:effectStyleLst>",t[t.length]="<a:effectStyle>",t[t.length]="<a:effectLst>",t[t.length]='<a:outerShdw blurRad="40000" dist="20000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="38000"/></a:srgbClr></a:outerShdw>',t[t.length]="</a:effectLst>",t[t.length]="</a:effectStyle>",t[t.length]="<a:effectStyle>",t[t.length]="<a:effectLst>",t[t.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',t[t.length]="</a:effectLst>",t[t.length]="</a:effectStyle>",t[t.length]="<a:effectStyle>",t[t.length]="<a:effectLst>",t[t.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',t[t.length]="</a:effectLst>",t[t.length]='<a:scene3d><a:camera prst="orthographicFront"><a:rot lat="0" lon="0" rev="0"/></a:camera><a:lightRig rig="threePt" dir="t"><a:rot lat="0" lon="0" rev="1200000"/></a:lightRig></a:scene3d>',t[t.length]='<a:sp3d><a:bevelT w="63500" h="25400"/></a:sp3d>',t[t.length]="</a:effectStyle>",t[t.length]="</a:effectStyleLst>",t[t.length]="<a:bgFillStyleLst>",t[t.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',t[t.length]='<a:gradFill rotWithShape="1">',t[t.length]="<a:gsLst>",t[t.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="40000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',t[t.length]='<a:gs pos="40000"><a:schemeClr val="phClr"><a:tint val="45000"/><a:shade val="99000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',t[t.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="20000"/><a:satMod val="255000"/></a:schemeClr></a:gs>',t[t.length]="</a:gsLst>",t[t.length]='<a:path path="circle"><a:fillToRect l="50000" t="-80000" r="50000" b="180000"/></a:path>',t[t.length]="</a:gradFill>",t[t.length]='<a:gradFill rotWithShape="1">',t[t.length]="<a:gsLst>",t[t.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="80000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',t[t.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="30000"/><a:satMod val="200000"/></a:schemeClr></a:gs>',t[t.length]="</a:gsLst>",t[t.length]='<a:path path="circle"><a:fillToRect l="50000" t="50000" r="50000" b="50000"/></a:path>',t[t.length]="</a:gradFill>",t[t.length]="</a:bgFillStyleLst>",t[t.length]="</a:fmtScheme>",t[t.length]="</a:themeElements>",t[t.length]="<a:objectDefaults>",t[t.length]="<a:spDef>",t[t.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="1"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="3"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="2"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="lt1"/></a:fontRef></a:style>',t[t.length]="</a:spDef>",t[t.length]="<a:lnDef>",t[t.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="2"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="0"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="1"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="tx1"/></a:fontRef></a:style>',t[t.length]="</a:lnDef>",t[t.length]="</a:objectDefaults>",t[t.length]="<a:extraClrSchemeLst/>",t[t.length]="</a:theme>",t.join("")}function pB(e,n,t){var r=e.l+n,i=e.read_shift(4);if(i!==124226){if(!t.cellStyles){e.l=r;return}var s=e.slice(e.l);e.l=r;var o;try{o=LI(s,{type:"array"})}catch{return}var a=Un(o,"theme/theme/theme1.xml",!0);if(a)return EC(a,t)}}function mB(e){return e.read_shift(4)}function gB(e){var n={};switch(n.xclrType=e.read_shift(2),n.nTintShade=e.read_shift(2),n.xclrType){case 0:e.l+=4;break;case 1:n.xclrValue=vB(e,4);break;case 2:n.xclrValue=cC(e,4);break;case 3:n.xclrValue=mB(e,4);break;case 4:e.l+=4;break}return e.l+=8,n}function vB(e,n){return dn(e,n)}function _B(e,n){return dn(e,n)}function xB(e){var n=e.read_shift(2),t=e.read_shift(2)-4,r=[n];switch(n){case 4:case 5:case 7:case 8:case 9:case 10:case 11:case 13:r[1]=gB(e,t);break;case 6:r[1]=_B(e,t);break;case 14:case 15:r[1]=e.read_shift(t===1?1:2);break;default:throw new Error("Unrecognized ExtProp type: "+n+" "+t)}return r}function yB(e,n){var t=e.l+n;e.l+=2;var r=e.read_shift(2);e.l+=2;for(var i=e.read_shift(2),s=[];i-- >0;)s.push(xB(e,t-e.l));return{ixfe:r,ext:s}}function wB(e,n){n.forEach(function(t){switch(t[0]){case 4:break;case 5:break;case 6:break;case 7:break;case 8:break;case 9:break;case 10:break;case 11:break;case 13:break;case 14:break;case 15:break}})}function EB(e,n){return{flags:e.read_shift(4),version:e.read_shift(4),name:fn(e,n-8)}}function TB(e){for(var n=[],t=e.read_shift(4);t-- >0;)n.push([e.read_shift(4),e.read_shift(4)]);return n}function IB(e){return e.l+=4,e.read_shift(4)!=0}function CB(e,n,t){var r={Types:[],Cell:[],Value:[]},i=t||{},s=[],o=!1,a=2;return _i(e,function(c,l,u){switch(u){case 335:r.Types.push({name:c.name});break;case 51:c.forEach(function(f){a==1?r.Cell.push({type:r.Types[f[0]-1].name,index:f[1]}):a==0&&r.Value.push({type:r.Types[f[0]-1].name,index:f[1]})});break;case 337:a=c?1:0;break;case 338:a=2;break;case 35:s.push(u),o=!0;break;case 36:s.pop(),o=!1;break;default:if(!l.T){if(!o||i.WTF&&s[s.length-1]!=35)throw new Error("Unexpected record 0x"+u.toString(16))}}}),r}function SB(e,n,t){var r={Types:[],Cell:[],Value:[]};if(!e)return r;var i=!1,s=2,o;return e.replace(hn,function(a){var c=Ee(a);switch(Gr(c[0])){case"<?xml":break;case"<metadata":case"</metadata>":break;case"<metadataTypes":case"</metadataTypes>":break;case"<metadataType":r.Types.push({name:c.name});break;case"</metadataType>":break;case"<futureMetadata":for(var l=0;l<r.Types.length;++l)r.Types[l].name==c.name&&(o=r.Types[l]);break;case"</futureMetadata>":break;case"<bk>":break;case"</bk>":break;case"<rc":s==1?r.Cell.push({type:r.Types[c.t-1].name,index:+c.v}):s==0&&r.Value.push({type:r.Types[c.t-1].name,index:+c.v});break;case"</rc>":break;case"<cellMetadata":s=1;break;case"</cellMetadata>":s=2;break;case"<valueMetadata":s=0;break;case"</valueMetadata>":s=2;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":i=!0;break;case"</ext>":i=!1;break;case"<rvb":if(!o)break;o.offsets||(o.offsets=[]),o.offsets.push(+c.i);break;default:if(!i&&t.WTF)throw new Error("unrecognized "+c[0]+" in metadata")}return a}),r}function DB(e){var n=[];if(!e)return n;var t=1;return(e.match(hn)||[]).forEach(function(r){var i=Ee(r);switch(i[0]){case"<?xml":break;case"<calcChain":case"<calcChain>":case"</calcChain>":break;case"<c":delete i[0],i.i?t=i.i:i.i=t,n.push(i);break}}),n}function bB(e){var n={};n.i=e.read_shift(4);var t={};t.r=e.read_shift(4),t.c=e.read_shift(4),n.r=Ce(t);var r=e.read_shift(1);return r&2&&(n.l="1"),r&8&&(n.a="1"),n}function AB(e,n,t){var r=[],i=!1;return _i(e,function(o,a,c){switch(c){case 63:r.push(o);break;default:if(!a.T){if(!i||t.WTF)throw new Error("Unexpected record 0x"+c.toString(16))}}}),r}function kB(e,n,t,r){if(!e)return e;var i=r||{},s=!1,o=!1;_i(e,function(c,l,u){if(!o)switch(u){case 359:case 363:case 364:case 366:case 367:case 368:case 369:case 370:case 371:case 472:case 577:case 578:case 579:case 580:case 581:case 582:case 583:case 584:case 585:case 586:case 587:break;case 35:s=!0;break;case 36:s=!1;break;default:if(!l.T){if(!s||i.WTF)throw new Error("Unexpected record 0x"+u.toString(16))}}},i)}function NB(e,n){if(!e)return"??";var t=(e.match(/<c:chart [^>]*r:id="([^"]*)"/)||["",""])[1];return n["!id"][t].Target}function eI(e,n,t,r){var i=Array.isArray(e),s;n.forEach(function(o){var a=wn(o.ref);if(i?(e[a.r]||(e[a.r]=[]),s=e[a.r][a.c]):s=e[o.ref],!s){s={t:"z"},i?e[a.r][a.c]=s:e[o.ref]=s;var c=_t(e["!ref"]||"BDWGO1000001:A1");c.s.r>a.r&&(c.s.r=a.r),c.e.r<a.r&&(c.e.r=a.r),c.s.c>a.c&&(c.s.c=a.c),c.e.c<a.c&&(c.e.c=a.c);var l=Ge(c);l!==e["!ref"]&&(e["!ref"]=l)}s.c||(s.c=[]);var u={a:o.author,t:o.t,r:o.r,T:t};o.h&&(u.h=o.h);for(var f=s.c.length-1;f>=0;--f){if(!t&&s.c[f].T)return;t&&!s.c[f].T&&s.c.splice(f,1)}if(t&&r){for(f=0;f<r.length;++f)if(u.a==r[f].id){u.a=r[f].name||u.a;break}}s.c.push(u)})}function RB(e,n){if(e.match(/<(?:\w+:)?comments *\/>/))return[];var t=[],r=[],i=e.match(/<(?:\w+:)?authors>([\s\S]*)<\/(?:\w+:)?authors>/);i&&i[1]&&i[1].split(/<\/\w*:?author>/).forEach(function(o){if(!(o===""||o.trim()==="")){var a=o.match(/<(?:\w+:)?author[^>]*>(.*)/);a&&t.push(a[1])}});var s=e.match(/<(?:\w+:)?commentList>([\s\S]*)<\/(?:\w+:)?commentList>/);return s&&s[1]&&s[1].split(/<\/\w*:?comment>/).forEach(function(o){if(!(o===""||o.trim()==="")){var a=o.match(/<(?:\w+:)?comment[^>]*>/);if(a){var c=Ee(a[0]),l={author:c.authorId&&t[c.authorId]||"sheetjsghost",ref:c.ref,guid:c.guid},u=wn(c.ref);if(!(n.sheetRows&&n.sheetRows<=u.r)){var f=o.match(/<(?:\w+:)?text>([\s\S]*)<\/(?:\w+:)?text>/),d=!!f&&!!f[1]&&Hg(f[1])||{r:"",t:"",h:""};l.r=d.r,d.r=="<t></t>"&&(d.t=d.h=""),l.t=(d.t||"").replace(/\r\n/g,`
`).replace(/\r/g,`
`),n.cellHTML&&(l.h=d.h),r.push(l)}}}}),r}function MB(e,n){var t=[],r=!1,i={},s=0;return e.replace(hn,function(a,c){var l=Ee(a);switch(Gr(l[0])){case"<?xml":break;case"<ThreadedComments":break;case"</ThreadedComments>":break;case"<threadedComment":i={author:l.personId,guid:l.id,ref:l.ref,T:1};break;case"</threadedComment>":i.t!=null&&t.push(i);break;case"<text>":case"<text":s=c+a.length;break;case"</text>":i.t=e.slice(s,c).replace(/\r\n/g,`
`).replace(/\r/g,`
`);break;case"<mentions":case"<mentions>":r=!0;break;case"</mentions>":r=!1;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":r=!0;break;case"</ext>":r=!1;break;default:if(!r&&n.WTF)throw new Error("unrecognized "+l[0]+" in threaded comments")}return a}),t}function OB(e,n){var t=[],r=!1;return e.replace(hn,function(s){var o=Ee(s);switch(Gr(o[0])){case"<?xml":break;case"<personList":break;case"</personList>":break;case"<person":t.push({name:o.displayname,id:o.id});break;case"</person>":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":r=!0;break;case"</ext>":r=!1;break;default:if(!r&&n.WTF)throw new Error("unrecognized "+o[0]+" in threaded comments")}return s}),t}function FB(e){var n={};n.iauthor=e.read_shift(4);var t=Ws(e,16);return n.rfx=t.s,n.ref=Ce(t.s),e.l+=16,n}var PB=fn;function LB(e,n){var t=[],r=[],i={},s=!1;return _i(e,function(a,c,l){switch(l){case 632:r.push(a);break;case 635:i=a;break;case 637:i.t=a.t,i.h=a.h,i.r=a.r;break;case 636:if(i.author=r[i.iauthor],delete i.iauthor,n.sheetRows&&i.rfx&&n.sheetRows<=i.rfx.r)break;i.t||(i.t=""),delete i.rfx,t.push(i);break;case 3072:break;case 35:s=!0;break;case 36:s=!1;break;case 37:break;case 38:break;default:if(!c.T){if(!s||n.WTF)throw new Error("Unexpected record 0x"+l.toString(16))}}}),t}var BB="application/vnd.ms-office.vbaProject";function UB(e){var n=ze.utils.cfb_new({root:"R"});return e.FullPaths.forEach(function(t,r){if(!(t.slice(-1)==="/"||!t.match(/_VBA_PROJECT_CUR/))){var i=t.replace(/^[^\/]*/,"R").replace(/\/_VBA_PROJECT_CUR\u0000*/,"");ze.utils.cfb_add(n,i,e.FileIndex[r].content)}}),ze.write(n)}function jB(){return{"!type":"dialog"}}function VB(){return{"!type":"dialog"}}function HB(){return{"!type":"macro"}}function $B(){return{"!type":"macro"}}var sa=function(){var e=/(^|[^A-Za-z_])R(\[?-?\d+\]|[1-9]\d*|)C(\[?-?\d+\]|[1-9]\d*|)(?![A-Za-z0-9_])/g,n={r:0,c:0};function t(r,i,s,o){var a=!1,c=!1;s.length==0?c=!0:s.charAt(0)=="["&&(c=!0,s=s.slice(1,-1)),o.length==0?a=!0:o.charAt(0)=="["&&(a=!0,o=o.slice(1,-1));var l=s.length>0?parseInt(s,10)|0:0,u=o.length>0?parseInt(o,10)|0:0;return a?u+=n.c:--u,c?l+=n.r:--l,i+(a?"":"$")+Ot(u)+(c?"":"$")+tn(l)}return function(i,s){return n=s,i.replace(e,t)}}(),TC=/(^|[^._A-Z0-9])([$]?)([A-Z]{1,2}|[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D])([$]?)(10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})(?![_.\(A-Za-z0-9])/g,WB=function(){return function(n,t){return n.replace(TC,function(r,i,s,o,a,c){var l=Pg(o)-(s?0:t.c),u=Fg(c)-(a?0:t.r),f=u==0?"":a?u+1:"["+u+"]",d=l==0?"":s?l+1:"["+l+"]";return i+"R"+f+"C"+d})}}();function IC(e,n){return e.replace(TC,function(t,r,i,s,o,a){return r+(i=="$"?i+s:Ot(Pg(s)+n.c))+(o=="$"?o+a:tn(Fg(a)+n.r))})}function zB(e,n,t){var r=da(n),i=r.s,s=wn(t),o={r:s.r-i.r,c:s.c-i.c};return IC(e,o)}function GB(e){return e.length!=1}function tI(e){return e.replace(/_xlfn\./g,"")}function Dt(e){e.l+=1}function Qi(e,n){var t=e.read_shift(n==1?1:2);return[t&16383,t>>14&1,t>>15&1]}function CC(e,n,t){var r=2;if(t){if(t.biff>=2&&t.biff<=5)return SC(e,n,t);t.biff==12&&(r=4)}var i=e.read_shift(r),s=e.read_shift(r),o=Qi(e,2),a=Qi(e,2);return{s:{r:i,c:o[0],cRel:o[1],rRel:o[2]},e:{r:s,c:a[0],cRel:a[1],rRel:a[2]}}}function SC(e){var n=Qi(e,2),t=Qi(e,2),r=e.read_shift(1),i=e.read_shift(1);return{s:{r:n[0],c:r,cRel:n[1],rRel:n[2]},e:{r:t[0],c:i,cRel:t[1],rRel:t[2]}}}function qB(e,n,t){if(t.biff<8)return SC(e,n,t);var r=e.read_shift(t.biff==12?4:2),i=e.read_shift(t.biff==12?4:2),s=Qi(e,2),o=Qi(e,2);return{s:{r,c:s[0],cRel:s[1],rRel:s[2]},e:{r:i,c:o[0],cRel:o[1],rRel:o[2]}}}function DC(e,n,t){if(t&&t.biff>=2&&t.biff<=5)return KB(e,n,t);var r=e.read_shift(t&&t.biff==12?4:2),i=Qi(e,2);return{r,c:i[0],cRel:i[1],rRel:i[2]}}function KB(e){var n=Qi(e,2),t=e.read_shift(1);return{r:n[0],c:t,cRel:n[1],rRel:n[2]}}function YB(e){var n=e.read_shift(2),t=e.read_shift(2);return{r:n,c:t&255,fQuoted:!!(t&16384),cRel:t>>15,rRel:t>>15}}function XB(e,n,t){var r=t&&t.biff?t.biff:8;if(r>=2&&r<=5)return QB(e,n,t);var i=e.read_shift(r>=12?4:2),s=e.read_shift(2),o=(s&16384)>>14,a=(s&32768)>>15;if(s&=16383,a==1)for(;i>524287;)i-=1048576;if(o==1)for(;s>8191;)s=s-16384;return{r:i,c:s,cRel:o,rRel:a}}function QB(e){var n=e.read_shift(2),t=e.read_shift(1),r=(n&32768)>>15,i=(n&16384)>>14;return n&=16383,r==1&&n>=8192&&(n=n-16384),i==1&&t>=128&&(t=t-256),{r:n,c:t,cRel:i,rRel:r}}function ZB(e,n,t){var r=(e[e.l++]&96)>>5,i=CC(e,t.biff>=2&&t.biff<=5?6:8,t);return[r,i]}function JB(e,n,t){var r=(e[e.l++]&96)>>5,i=e.read_shift(2,"i"),s=8;if(t)switch(t.biff){case 5:e.l+=12,s=6;break;case 12:s=12;break}var o=CC(e,s,t);return[r,i,o]}function e6(e,n,t){var r=(e[e.l++]&96)>>5;return e.l+=t&&t.biff>8?12:t.biff<8?6:8,[r]}function t6(e,n,t){var r=(e[e.l++]&96)>>5,i=e.read_shift(2),s=8;if(t)switch(t.biff){case 5:e.l+=12,s=6;break;case 12:s=12;break}return e.l+=s,[r,i]}function n6(e,n,t){var r=(e[e.l++]&96)>>5,i=qB(e,n-1,t);return[r,i]}function r6(e,n,t){var r=(e[e.l++]&96)>>5;return e.l+=t.biff==2?6:t.biff==12?14:7,[r]}function nI(e){var n=e[e.l+1]&1,t=1;return e.l+=4,[n,t]}function i6(e,n,t){e.l+=2;for(var r=e.read_shift(t&&t.biff==2?1:2),i=[],s=0;s<=r;++s)i.push(e.read_shift(t&&t.biff==2?1:2));return i}function s6(e,n,t){var r=e[e.l+1]&255?1:0;return e.l+=2,[r,e.read_shift(t&&t.biff==2?1:2)]}function o6(e,n,t){var r=e[e.l+1]&255?1:0;return e.l+=2,[r,e.read_shift(t&&t.biff==2?1:2)]}function a6(e){var n=e[e.l+1]&255?1:0;return e.l+=2,[n,e.read_shift(2)]}function c6(e,n,t){var r=e[e.l+1]&255?1:0;return e.l+=t&&t.biff==2?3:4,[r]}function bC(e){var n=e.read_shift(1),t=e.read_shift(1);return[n,t]}function l6(e){return e.read_shift(2),bC(e,2)}function u6(e){return e.read_shift(2),bC(e,2)}function f6(e,n,t){var r=(e[e.l]&96)>>5;e.l+=1;var i=DC(e,0,t);return[r,i]}function d6(e,n,t){var r=(e[e.l]&96)>>5;e.l+=1;var i=XB(e,0,t);return[r,i]}function h6(e,n,t){var r=(e[e.l]&96)>>5;e.l+=1;var i=e.read_shift(2);t&&t.biff==5&&(e.l+=12);var s=DC(e,0,t);return[r,i,s]}function p6(e,n,t){var r=(e[e.l]&96)>>5;e.l+=1;var i=e.read_shift(t&&t.biff<=3?1:2);return[mU[i],NC[i],r]}function m6(e,n,t){var r=e[e.l++],i=e.read_shift(1),s=t&&t.biff<=3?[r==88?-1:0,e.read_shift(1)]:g6(e);return[i,(s[0]===0?NC:pU)[s[1]]]}function g6(e){return[e[e.l+1]>>7,e.read_shift(2)&32767]}function v6(e,n,t){e.l+=t&&t.biff==2?3:4}function _6(e,n,t){if(e.l++,t&&t.biff==12)return[e.read_shift(4,"i"),0];var r=e.read_shift(2),i=e.read_shift(t&&t.biff==2?1:2);return[r,i]}function x6(e){return e.l++,zs[e.read_shift(1)]}function y6(e){return e.l++,e.read_shift(2)}function w6(e){return e.l++,e.read_shift(1)!==0}function E6(e){return e.l++,cn(e,8)}function T6(e,n,t){return e.l++,cl(e,n-1,t)}function I6(e,n){var t=[e.read_shift(1)];if(n==12)switch(t[0]){case 2:t[0]=4;break;case 4:t[0]=16;break;case 0:t[0]=1;break;case 1:t[0]=2;break}switch(t[0]){case 4:t[1]=Tt(e,1)?"TRUE":"FALSE",n!=12&&(e.l+=7);break;case 37:case 16:t[1]=zs[e[e.l]],e.l+=n==12?4:8;break;case 0:e.l+=8;break;case 1:t[1]=cn(e,8);break;case 2:t[1]=Gs(e,0,{biff:n>0&&n<8?2:n});break;default:throw new Error("Bad SerAr: "+t[0])}return t}function C6(e,n,t){for(var r=e.read_shift(t.biff==12?4:2),i=[],s=0;s!=r;++s)i.push((t.biff==12?Ws:kd)(e,8));return i}function S6(e,n,t){var r=0,i=0;t.biff==12?(r=e.read_shift(4),i=e.read_shift(4)):(i=1+e.read_shift(1),r=1+e.read_shift(2)),t.biff>=2&&t.biff<8&&(--r,--i==0&&(i=256));for(var s=0,o=[];s!=r&&(o[s]=[]);++s)for(var a=0;a!=i;++a)o[s][a]=I6(e,t.biff);return o}function D6(e,n,t){var r=e.read_shift(1)>>>5&3,i=!t||t.biff>=8?4:2,s=e.read_shift(i);switch(t.biff){case 2:e.l+=5;break;case 3:case 4:e.l+=8;break;case 5:e.l+=12;break}return[r,0,s]}function b6(e,n,t){if(t.biff==5)return A6(e,n,t);var r=e.read_shift(1)>>>5&3,i=e.read_shift(2),s=e.read_shift(4);return[r,i,s]}function A6(e){var n=e.read_shift(1)>>>5&3,t=e.read_shift(2,"i");e.l+=8;var r=e.read_shift(2);return e.l+=12,[n,t,r]}function k6(e,n,t){var r=e.read_shift(1)>>>5&3;e.l+=t&&t.biff==2?3:4;var i=e.read_shift(t&&t.biff==2?1:2);return[r,i]}function N6(e,n,t){var r=e.read_shift(1)>>>5&3,i=e.read_shift(t&&t.biff==2?1:2);return[r,i]}function R6(e,n,t){var r=e.read_shift(1)>>>5&3;return e.l+=4,t.biff<8&&e.l--,t.biff==12&&(e.l+=2),[r]}function M6(e,n,t){var r=(e[e.l++]&96)>>5,i=e.read_shift(2),s=4;if(t)switch(t.biff){case 5:s=15;break;case 12:s=6;break}return e.l+=s,[r,i]}var O6=dn,F6=dn,P6=dn;function ul(e,n,t){return e.l+=2,[YB(e,4,t)]}function Wg(e){return e.l+=6,[]}var L6=ul,B6=Wg,U6=Wg,j6=ul;function AC(e){return e.l+=2,[At(e),e.read_shift(2)&1]}var V6=ul,H6=AC,$6=Wg,W6=ul,z6=ul,G6=["Data","All","Headers","??","?Data2","??","?DataHeaders","??","Totals","??","??","??","?DataTotals","??","??","??","?Current"];function q6(e){e.l+=2;var n=e.read_shift(2),t=e.read_shift(2),r=e.read_shift(4),i=e.read_shift(2),s=e.read_shift(2),o=G6[t>>2&31];return{ixti:n,coltype:t&3,rt:o,idx:r,c:i,C:s}}function K6(e){return e.l+=2,[e.read_shift(4)]}function Y6(e,n,t){return e.l+=5,e.l+=2,e.l+=t.biff==2?1:4,["PTGSHEET"]}function X6(e,n,t){return e.l+=t.biff==2?4:5,["PTGENDSHEET"]}function Q6(e){var n=e.read_shift(1)>>>5&3,t=e.read_shift(2);return[n,t]}function Z6(e){var n=e.read_shift(1)>>>5&3,t=e.read_shift(2);return[n,t]}function J6(e){return e.l+=4,[0,0]}var rI={1:{n:"PtgExp",f:_6},2:{n:"PtgTbl",f:P6},3:{n:"PtgAdd",f:Dt},4:{n:"PtgSub",f:Dt},5:{n:"PtgMul",f:Dt},6:{n:"PtgDiv",f:Dt},7:{n:"PtgPower",f:Dt},8:{n:"PtgConcat",f:Dt},9:{n:"PtgLt",f:Dt},10:{n:"PtgLe",f:Dt},11:{n:"PtgEq",f:Dt},12:{n:"PtgGe",f:Dt},13:{n:"PtgGt",f:Dt},14:{n:"PtgNe",f:Dt},15:{n:"PtgIsect",f:Dt},16:{n:"PtgUnion",f:Dt},17:{n:"PtgRange",f:Dt},18:{n:"PtgUplus",f:Dt},19:{n:"PtgUminus",f:Dt},20:{n:"PtgPercent",f:Dt},21:{n:"PtgParen",f:Dt},22:{n:"PtgMissArg",f:Dt},23:{n:"PtgStr",f:T6},26:{n:"PtgSheet",f:Y6},27:{n:"PtgEndSheet",f:X6},28:{n:"PtgErr",f:x6},29:{n:"PtgBool",f:w6},30:{n:"PtgInt",f:y6},31:{n:"PtgNum",f:E6},32:{n:"PtgArray",f:r6},33:{n:"PtgFunc",f:p6},34:{n:"PtgFuncVar",f:m6},35:{n:"PtgName",f:D6},36:{n:"PtgRef",f:f6},37:{n:"PtgArea",f:ZB},38:{n:"PtgMemArea",f:k6},39:{n:"PtgMemErr",f:O6},40:{n:"PtgMemNoMem",f:F6},41:{n:"PtgMemFunc",f:N6},42:{n:"PtgRefErr",f:R6},43:{n:"PtgAreaErr",f:e6},44:{n:"PtgRefN",f:d6},45:{n:"PtgAreaN",f:n6},46:{n:"PtgMemAreaN",f:Q6},47:{n:"PtgMemNoMemN",f:Z6},57:{n:"PtgNameX",f:b6},58:{n:"PtgRef3d",f:h6},59:{n:"PtgArea3d",f:JB},60:{n:"PtgRefErr3d",f:M6},61:{n:"PtgAreaErr3d",f:t6},255:{}},eU={64:32,96:32,65:33,97:33,66:34,98:34,67:35,99:35,68:36,100:36,69:37,101:37,70:38,102:38,71:39,103:39,72:40,104:40,73:41,105:41,74:42,106:42,75:43,107:43,76:44,108:44,77:45,109:45,78:46,110:46,79:47,111:47,88:34,120:34,89:57,121:57,90:58,122:58,91:59,123:59,92:60,124:60,93:61,125:61},tU={1:{n:"PtgElfLel",f:AC},2:{n:"PtgElfRw",f:W6},3:{n:"PtgElfCol",f:L6},6:{n:"PtgElfRwV",f:z6},7:{n:"PtgElfColV",f:j6},10:{n:"PtgElfRadical",f:V6},11:{n:"PtgElfRadicalS",f:$6},13:{n:"PtgElfColS",f:B6},15:{n:"PtgElfColSV",f:U6},16:{n:"PtgElfRadicalLel",f:H6},25:{n:"PtgList",f:q6},29:{n:"PtgSxName",f:K6},255:{}},nU={0:{n:"PtgAttrNoop",f:J6},1:{n:"PtgAttrSemi",f:c6},2:{n:"PtgAttrIf",f:o6},4:{n:"PtgAttrChoose",f:i6},8:{n:"PtgAttrGoto",f:s6},16:{n:"PtgAttrSum",f:v6},32:{n:"PtgAttrBaxcel",f:nI},33:{n:"PtgAttrBaxcel",f:nI},64:{n:"PtgAttrSpace",f:l6},65:{n:"PtgAttrSpaceSemi",f:u6},128:{n:"PtgAttrIfError",f:a6},255:{}};function fl(e,n,t,r){if(r.biff<8)return dn(e,n);for(var i=e.l+n,s=[],o=0;o!==t.length;++o)switch(t[o][0]){case"PtgArray":t[o][1]=S6(e,0,r),s.push(t[o][1]);break;case"PtgMemArea":t[o][2]=C6(e,t[o][1],r),s.push(t[o][2]);break;case"PtgExp":r&&r.biff==12&&(t[o][1][1]=e.read_shift(4),s.push(t[o][1]));break;case"PtgList":case"PtgElfRadicalS":case"PtgElfColS":case"PtgElfColSV":throw"Unsupported "+t[o][0];default:break}return n=i-e.l,n!==0&&s.push(dn(e,n)),s}function dl(e,n,t){for(var r=e.l+n,i,s,o=[];r!=e.l;)n=r-e.l,s=e[e.l],i=rI[s]||rI[eU[s]],(s===24||s===25)&&(i=(s===24?tU:nU)[e[e.l+1]]),!i||!i.f?dn(e,n):o.push([i.n,i.f(e,n,t)]);return o}function rU(e){for(var n=[],t=0;t<e.length;++t){for(var r=e[t],i=[],s=0;s<r.length;++s){var o=r[s];if(o)switch(o[0]){case 2:i.push('"'+o[1].replace(/"/g,'""')+'"');break;default:i.push(o[1])}else i.push("")}n.push(i.join(","))}return n.join(";")}var iU={PtgAdd:"+",PtgConcat:"&",PtgDiv:"/",PtgEq:"=",PtgGe:">=",PtgGt:">",PtgLe:"<=",PtgLt:"<",PtgMul:"*",PtgNe:"<>",PtgPower:"^",PtgSub:"-"};function sU(e,n){if(!e&&!(n&&n.biff<=5&&n.biff>=2))throw new Error("empty sheet name");return/[^\w\u4E00-\u9FFF\u3040-\u30FF]/.test(e)?"'"+e+"'":e}function kC(e,n,t){if(!e)return"SH33TJSERR0";if(t.biff>8&&(!e.XTI||!e.XTI[n]))return e.SheetNames[n];if(!e.XTI)return"SH33TJSERR6";var r=e.XTI[n];if(t.biff<8)return n>1e4&&(n-=65536),n<0&&(n=-n),n==0?"":e.XTI[n-1];if(!r)return"SH33TJSERR1";var i="";if(t.biff>8)switch(e[r[0]][0]){case 357:return i=r[1]==-1?"#REF":e.SheetNames[r[1]],r[1]==r[2]?i:i+":"+e.SheetNames[r[2]];case 358:return t.SID!=null?e.SheetNames[t.SID]:"SH33TJSSAME"+e[r[0]][0];case 355:default:return"SH33TJSSRC"+e[r[0]][0]}switch(e[r[0]][0][0]){case 1025:return i=r[1]==-1?"#REF":e.SheetNames[r[1]]||"SH33TJSERR3",r[1]==r[2]?i:i+":"+e.SheetNames[r[2]];case 14849:return e[r[0]].slice(1).map(function(s){return s.Name}).join(";;");default:return e[r[0]][0][3]?(i=r[1]==-1?"#REF":e[r[0]][0][3][r[1]]||"SH33TJSERR4",r[1]==r[2]?i:i+":"+e[r[0]][0][3][r[2]]):"SH33TJSERR2"}}function iI(e,n,t){var r=kC(e,n,t);return r=="#REF"?r:sU(r,t)}function an(e,n,t,r,i){var s=i&&i.biff||8,o={s:{c:0,r:0},e:{c:0,r:0}},a=[],c,l,u,f=0,d=0,h,m="";if(!e[0]||!e[0][0])return"";for(var p=-1,g="",w=0,C=e[0].length;w<C;++w){var _=e[0][w];switch(_[0]){case"PtgUminus":a.push("-"+a.pop());break;case"PtgUplus":a.push("+"+a.pop());break;case"PtgPercent":a.push(a.pop()+"%");break;case"PtgAdd":case"PtgConcat":case"PtgDiv":case"PtgEq":case"PtgGe":case"PtgGt":case"PtgLe":case"PtgLt":case"PtgMul":case"PtgNe":case"PtgPower":case"PtgSub":if(c=a.pop(),l=a.pop(),p>=0){switch(e[0][p][1][0]){case 0:g=vt(" ",e[0][p][1][1]);break;case 1:g=vt("\r",e[0][p][1][1]);break;default:if(g="",i.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][p][1][0])}l=l+g,p=-1}a.push(l+iU[_[0]]+c);break;case"PtgIsect":c=a.pop(),l=a.pop(),a.push(l+" "+c);break;case"PtgUnion":c=a.pop(),l=a.pop(),a.push(l+","+c);break;case"PtgRange":c=a.pop(),l=a.pop(),a.push(l+":"+c);break;case"PtgAttrChoose":break;case"PtgAttrGoto":break;case"PtgAttrIf":break;case"PtgAttrIfError":break;case"PtgRef":u=Gc(_[1][1],o,i),a.push(qc(u,s));break;case"PtgRefN":u=t?Gc(_[1][1],t,i):_[1][1],a.push(qc(u,s));break;case"PtgRef3d":f=_[1][1],u=Gc(_[1][2],o,i),m=iI(r,f,i);var M=m;a.push(m+"!"+qc(u,s));break;case"PtgFunc":case"PtgFuncVar":var V=_[1][0],A=_[1][1];V||(V=0),V&=127;var S=V==0?[]:a.slice(-V);a.length-=V,A==="User"&&(A=S.shift()),a.push(A+"("+S.join(",")+")");break;case"PtgBool":a.push(_[1]?"TRUE":"FALSE");break;case"PtgInt":a.push(_[1]);break;case"PtgNum":a.push(String(_[1]));break;case"PtgStr":a.push('"'+_[1].replace(/"/g,'""')+'"');break;case"PtgErr":a.push(_[1]);break;case"PtgAreaN":h=BT(_[1][1],t?{s:t}:o,i),a.push(ng(h,i));break;case"PtgArea":h=BT(_[1][1],o,i),a.push(ng(h,i));break;case"PtgArea3d":f=_[1][1],h=_[1][2],m=iI(r,f,i),a.push(m+"!"+ng(h,i));break;case"PtgAttrSum":a.push("SUM("+a.pop()+")");break;case"PtgAttrBaxcel":case"PtgAttrSemi":break;case"PtgName":d=_[1][2];var F=(r.names||[])[d-1]||(r[0]||[])[d],N=F?F.Name:"SH33TJSNAME"+String(d);N&&N.slice(0,6)=="_xlfn."&&!i.xlfn&&(N=N.slice(6)),a.push(N);break;case"PtgNameX":var H=_[1][1];d=_[1][2];var W;if(i.biff<=5)H<0&&(H=-H),r[H]&&(W=r[H][d]);else{var O="";if(((r[H]||[])[0]||[])[0]==14849||(((r[H]||[])[0]||[])[0]==1025?r[H][d]&&r[H][d].itab>0&&(O=r.SheetNames[r[H][d].itab-1]+"!"):O=r.SheetNames[d-1]+"!"),r[H]&&r[H][d])O+=r[H][d].Name;else if(r[0]&&r[0][d])O+=r[0][d].Name;else{var Q=(kC(r,H,i)||"").split(";;");Q[d-1]?O=Q[d-1]:O+="SH33TJSERRX"}a.push(O);break}W||(W={Name:"SH33TJSERRY"}),a.push(W.Name);break;case"PtgParen":var pe="(",ne=")";if(p>=0){switch(g="",e[0][p][1][0]){case 2:pe=vt(" ",e[0][p][1][1])+pe;break;case 3:pe=vt("\r",e[0][p][1][1])+pe;break;case 4:ne=vt(" ",e[0][p][1][1])+ne;break;case 5:ne=vt("\r",e[0][p][1][1])+ne;break;default:if(i.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][p][1][0])}p=-1}a.push(pe+a.pop()+ne);break;case"PtgRefErr":a.push("#REF!");break;case"PtgRefErr3d":a.push("#REF!");break;case"PtgExp":u={c:_[1][1],r:_[1][0]};var _e={c:t.c,r:t.r};if(r.sharedf[Ce(u)]){var fe=r.sharedf[Ce(u)];a.push(an(fe,o,_e,r,i))}else{var qe=!1;for(c=0;c!=r.arrayf.length;++c)if(l=r.arrayf[c],!(u.c<l[0].s.c||u.c>l[0].e.c)&&!(u.r<l[0].s.r||u.r>l[0].e.r)){a.push(an(l[1],o,_e,r,i)),qe=!0;break}qe||a.push(_[1])}break;case"PtgArray":a.push("{"+rU(_[1])+"}");break;case"PtgMemArea":break;case"PtgAttrSpace":case"PtgAttrSpaceSemi":p=w;break;case"PtgTbl":break;case"PtgMemErr":break;case"PtgMissArg":a.push("");break;case"PtgAreaErr":a.push("#REF!");break;case"PtgAreaErr3d":a.push("#REF!");break;case"PtgList":a.push("Table"+_[1].idx+"[#"+_[1].rt+"]");break;case"PtgMemAreaN":case"PtgMemNoMemN":case"PtgAttrNoop":case"PtgSheet":case"PtgEndSheet":break;case"PtgMemFunc":break;case"PtgMemNoMem":break;case"PtgElfCol":case"PtgElfColS":case"PtgElfColSV":case"PtgElfColV":case"PtgElfLel":case"PtgElfRadical":case"PtgElfRadicalLel":case"PtgElfRadicalS":case"PtgElfRw":case"PtgElfRwV":throw new Error("Unsupported ELFs");case"PtgSxName":throw new Error("Unrecognized Formula Token: "+String(_));default:throw new Error("Unrecognized Formula Token: "+String(_))}var se=["PtgAttrSpace","PtgAttrSpaceSemi","PtgAttrGoto"];if(i.biff!=3&&p>=0&&se.indexOf(e[0][w][0])==-1){_=e[0][p];var me=!0;switch(_[1][0]){case 4:me=!1;case 0:g=vt(" ",_[1][1]);break;case 5:me=!1;case 1:g=vt("\r",_[1][1]);break;default:if(g="",i.WTF)throw new Error("Unexpected PtgAttrSpaceType "+_[1][0])}a.push((me?g:"")+a.pop()+(me?"":g)),p=-1}}if(a.length>1&&i.WTF)throw new Error("bad formula stack");return a[0]}function oU(e,n,t){var r=e.l+n,i=t.biff==2?1:2,s,o=e.read_shift(i);if(o==65535)return[[],dn(e,n-2)];var a=dl(e,o,t);return n!==o+i&&(s=fl(e,n-o-i,a,t)),e.l=r,[a,s]}function aU(e,n,t){var r=e.l+n,i=t.biff==2?1:2,s,o=e.read_shift(i);if(o==65535)return[[],dn(e,n-2)];var a=dl(e,o,t);return n!==o+i&&(s=fl(e,n-o-i,a,t)),e.l=r,[a,s]}function cU(e,n,t,r){var i=e.l+n,s=dl(e,r,t),o;return i!==e.l&&(o=fl(e,i-e.l,s,t)),[s,o]}function lU(e,n,t){var r=e.l+n,i,s=e.read_shift(2),o=dl(e,s,t);return s==65535?[[],dn(e,n-2)]:(n!==s+2&&(i=fl(e,r-s-2,o,t)),[o,i])}function uU(e){var n;if(pi(e,e.l+6)!==65535)return[cn(e),"n"];switch(e[e.l]){case 0:return e.l+=8,["String","s"];case 1:return n=e[e.l+2]===1,e.l+=8,[n,"b"];case 2:return n=e[e.l+2],e.l+=8,[n,"e"];case 3:return e.l+=8,["","s"]}return[]}function sg(e,n,t){var r=e.l+n,i=qr(e,6);t.biff==2&&++e.l;var s=uU(e,8),o=e.read_shift(1);t.biff!=2&&(e.read_shift(1),t.biff>=5&&e.read_shift(4));var a=aU(e,r-e.l,t);return{cell:i,val:s[0],formula:a,shared:o>>3&1,tt:s[1]}}function Nd(e,n,t){var r=e.read_shift(4),i=dl(e,r,t),s=e.read_shift(4),o=s>0?fl(e,s,i,t):null;return[i,o]}var fU=Nd,Rd=Nd,dU=Nd,hU=Nd,pU={0:"BEEP",1:"OPEN",2:"OPEN.LINKS",3:"CLOSE.ALL",4:"SAVE",5:"SAVE.AS",6:"FILE.DELETE",7:"PAGE.SETUP",8:"PRINT",9:"PRINTER.SETUP",10:"QUIT",11:"NEW.WINDOW",12:"ARRANGE.ALL",13:"WINDOW.SIZE",14:"WINDOW.MOVE",15:"FULL",16:"CLOSE",17:"RUN",22:"SET.PRINT.AREA",23:"SET.PRINT.TITLES",24:"SET.PAGE.BREAK",25:"REMOVE.PAGE.BREAK",26:"FONT",27:"DISPLAY",28:"PROTECT.DOCUMENT",29:"PRECISION",30:"A1.R1C1",31:"CALCULATE.NOW",32:"CALCULATION",34:"DATA.FIND",35:"EXTRACT",36:"DATA.DELETE",37:"SET.DATABASE",38:"SET.CRITERIA",39:"SORT",40:"DATA.SERIES",41:"TABLE",42:"FORMAT.NUMBER",43:"ALIGNMENT",44:"STYLE",45:"BORDER",46:"CELL.PROTECTION",47:"COLUMN.WIDTH",48:"UNDO",49:"CUT",50:"COPY",51:"PASTE",52:"CLEAR",53:"PASTE.SPECIAL",54:"EDIT.DELETE",55:"INSERT",56:"FILL.RIGHT",57:"FILL.DOWN",61:"DEFINE.NAME",62:"CREATE.NAMES",63:"FORMULA.GOTO",64:"FORMULA.FIND",65:"SELECT.LAST.CELL",66:"SHOW.ACTIVE.CELL",67:"GALLERY.AREA",68:"GALLERY.BAR",69:"GALLERY.COLUMN",70:"GALLERY.LINE",71:"GALLERY.PIE",72:"GALLERY.SCATTER",73:"COMBINATION",74:"PREFERRED",75:"ADD.OVERLAY",76:"GRIDLINES",77:"SET.PREFERRED",78:"AXES",79:"LEGEND",80:"ATTACH.TEXT",81:"ADD.ARROW",82:"SELECT.CHART",83:"SELECT.PLOT.AREA",84:"PATTERNS",85:"MAIN.CHART",86:"OVERLAY",87:"SCALE",88:"FORMAT.LEGEND",89:"FORMAT.TEXT",90:"EDIT.REPEAT",91:"PARSE",92:"JUSTIFY",93:"HIDE",94:"UNHIDE",95:"WORKSPACE",96:"FORMULA",97:"FORMULA.FILL",98:"FORMULA.ARRAY",99:"DATA.FIND.NEXT",100:"DATA.FIND.PREV",101:"FORMULA.FIND.NEXT",102:"FORMULA.FIND.PREV",103:"ACTIVATE",104:"ACTIVATE.NEXT",105:"ACTIVATE.PREV",106:"UNLOCKED.NEXT",107:"UNLOCKED.PREV",108:"COPY.PICTURE",109:"SELECT",110:"DELETE.NAME",111:"DELETE.FORMAT",112:"VLINE",113:"HLINE",114:"VPAGE",115:"HPAGE",116:"VSCROLL",117:"HSCROLL",118:"ALERT",119:"NEW",120:"CANCEL.COPY",121:"SHOW.CLIPBOARD",122:"MESSAGE",124:"PASTE.LINK",125:"APP.ACTIVATE",126:"DELETE.ARROW",127:"ROW.HEIGHT",128:"FORMAT.MOVE",129:"FORMAT.SIZE",130:"FORMULA.REPLACE",131:"SEND.KEYS",132:"SELECT.SPECIAL",133:"APPLY.NAMES",134:"REPLACE.FONT",135:"FREEZE.PANES",136:"SHOW.INFO",137:"SPLIT",138:"ON.WINDOW",139:"ON.DATA",140:"DISABLE.INPUT",142:"OUTLINE",143:"LIST.NAMES",144:"FILE.CLOSE",145:"SAVE.WORKBOOK",146:"DATA.FORM",147:"COPY.CHART",148:"ON.TIME",149:"WAIT",150:"FORMAT.FONT",151:"FILL.UP",152:"FILL.LEFT",153:"DELETE.OVERLAY",155:"SHORT.MENUS",159:"SET.UPDATE.STATUS",161:"COLOR.PALETTE",162:"DELETE.STYLE",163:"WINDOW.RESTORE",164:"WINDOW.MAXIMIZE",166:"CHANGE.LINK",167:"CALCULATE.DOCUMENT",168:"ON.KEY",169:"APP.RESTORE",170:"APP.MOVE",171:"APP.SIZE",172:"APP.MINIMIZE",173:"APP.MAXIMIZE",174:"BRING.TO.FRONT",175:"SEND.TO.BACK",185:"MAIN.CHART.TYPE",186:"OVERLAY.CHART.TYPE",187:"SELECT.END",188:"OPEN.MAIL",189:"SEND.MAIL",190:"STANDARD.FONT",191:"CONSOLIDATE",192:"SORT.SPECIAL",193:"GALLERY.3D.AREA",194:"GALLERY.3D.COLUMN",195:"GALLERY.3D.LINE",196:"GALLERY.3D.PIE",197:"VIEW.3D",198:"GOAL.SEEK",199:"WORKGROUP",200:"FILL.GROUP",201:"UPDATE.LINK",202:"PROMOTE",203:"DEMOTE",204:"SHOW.DETAIL",206:"UNGROUP",207:"OBJECT.PROPERTIES",208:"SAVE.NEW.OBJECT",209:"SHARE",210:"SHARE.NAME",211:"DUPLICATE",212:"APPLY.STYLE",213:"ASSIGN.TO.OBJECT",214:"OBJECT.PROTECTION",215:"HIDE.OBJECT",216:"SET.EXTRACT",217:"CREATE.PUBLISHER",218:"SUBSCRIBE.TO",219:"ATTRIBUTES",220:"SHOW.TOOLBAR",222:"PRINT.PREVIEW",223:"EDIT.COLOR",224:"SHOW.LEVELS",225:"FORMAT.MAIN",226:"FORMAT.OVERLAY",227:"ON.RECALC",228:"EDIT.SERIES",229:"DEFINE.STYLE",240:"LINE.PRINT",243:"ENTER.DATA",249:"GALLERY.RADAR",250:"MERGE.STYLES",251:"EDITION.OPTIONS",252:"PASTE.PICTURE",253:"PASTE.PICTURE.LINK",254:"SPELLING",256:"ZOOM",259:"INSERT.OBJECT",260:"WINDOW.MINIMIZE",265:"SOUND.NOTE",266:"SOUND.PLAY",267:"FORMAT.SHAPE",268:"EXTEND.POLYGON",269:"FORMAT.AUTO",272:"GALLERY.3D.BAR",273:"GALLERY.3D.SURFACE",274:"FILL.AUTO",276:"CUSTOMIZE.TOOLBAR",277:"ADD.TOOL",278:"EDIT.OBJECT",279:"ON.DOUBLECLICK",280:"ON.ENTRY",281:"WORKBOOK.ADD",282:"WORKBOOK.MOVE",283:"WORKBOOK.COPY",284:"WORKBOOK.OPTIONS",285:"SAVE.WORKSPACE",288:"CHART.WIZARD",289:"DELETE.TOOL",290:"MOVE.TOOL",291:"WORKBOOK.SELECT",292:"WORKBOOK.ACTIVATE",293:"ASSIGN.TO.TOOL",295:"COPY.TOOL",296:"RESET.TOOL",297:"CONSTRAIN.NUMERIC",298:"PASTE.TOOL",302:"WORKBOOK.NEW",305:"SCENARIO.CELLS",306:"SCENARIO.DELETE",307:"SCENARIO.ADD",308:"SCENARIO.EDIT",309:"SCENARIO.SHOW",310:"SCENARIO.SHOW.NEXT",311:"SCENARIO.SUMMARY",312:"PIVOT.TABLE.WIZARD",313:"PIVOT.FIELD.PROPERTIES",314:"PIVOT.FIELD",315:"PIVOT.ITEM",316:"PIVOT.ADD.FIELDS",318:"OPTIONS.CALCULATION",319:"OPTIONS.EDIT",320:"OPTIONS.VIEW",321:"ADDIN.MANAGER",322:"MENU.EDITOR",323:"ATTACH.TOOLBARS",324:"VBAActivate",325:"OPTIONS.CHART",328:"VBA.INSERT.FILE",330:"VBA.PROCEDURE.DEFINITION",336:"ROUTING.SLIP",338:"ROUTE.DOCUMENT",339:"MAIL.LOGON",342:"INSERT.PICTURE",343:"EDIT.TOOL",344:"GALLERY.DOUGHNUT",350:"CHART.TREND",352:"PIVOT.ITEM.PROPERTIES",354:"WORKBOOK.INSERT",355:"OPTIONS.TRANSITION",356:"OPTIONS.GENERAL",370:"FILTER.ADVANCED",373:"MAIL.ADD.MAILER",374:"MAIL.DELETE.MAILER",375:"MAIL.REPLY",376:"MAIL.REPLY.ALL",377:"MAIL.FORWARD",378:"MAIL.NEXT.LETTER",379:"DATA.LABEL",380:"INSERT.TITLE",381:"FONT.PROPERTIES",382:"MACRO.OPTIONS",383:"WORKBOOK.HIDE",384:"WORKBOOK.UNHIDE",385:"WORKBOOK.DELETE",386:"WORKBOOK.NAME",388:"GALLERY.CUSTOM",390:"ADD.CHART.AUTOFORMAT",391:"DELETE.CHART.AUTOFORMAT",392:"CHART.ADD.DATA",393:"AUTO.OUTLINE",394:"TAB.ORDER",395:"SHOW.DIALOG",396:"SELECT.ALL",397:"UNGROUP.SHEETS",398:"SUBTOTAL.CREATE",399:"SUBTOTAL.REMOVE",400:"RENAME.OBJECT",412:"WORKBOOK.SCROLL",413:"WORKBOOK.NEXT",414:"WORKBOOK.PREV",415:"WORKBOOK.TAB.SPLIT",416:"FULL.SCREEN",417:"WORKBOOK.PROTECT",420:"SCROLLBAR.PROPERTIES",421:"PIVOT.SHOW.PAGES",422:"TEXT.TO.COLUMNS",423:"FORMAT.CHARTTYPE",424:"LINK.FORMAT",425:"TRACER.DISPLAY",430:"TRACER.NAVIGATE",431:"TRACER.CLEAR",432:"TRACER.ERROR",433:"PIVOT.FIELD.GROUP",434:"PIVOT.FIELD.UNGROUP",435:"CHECKBOX.PROPERTIES",436:"LABEL.PROPERTIES",437:"LISTBOX.PROPERTIES",438:"EDITBOX.PROPERTIES",439:"PIVOT.REFRESH",440:"LINK.COMBO",441:"OPEN.TEXT",442:"HIDE.DIALOG",443:"SET.DIALOG.FOCUS",444:"ENABLE.OBJECT",445:"PUSHBUTTON.PROPERTIES",446:"SET.DIALOG.DEFAULT",447:"FILTER",448:"FILTER.SHOW.ALL",449:"CLEAR.OUTLINE",450:"FUNCTION.WIZARD",451:"ADD.LIST.ITEM",452:"SET.LIST.ITEM",453:"REMOVE.LIST.ITEM",454:"SELECT.LIST.ITEM",455:"SET.CONTROL.VALUE",456:"SAVE.COPY.AS",458:"OPTIONS.LISTS.ADD",459:"OPTIONS.LISTS.DELETE",460:"SERIES.AXES",461:"SERIES.X",462:"SERIES.Y",463:"ERRORBAR.X",464:"ERRORBAR.Y",465:"FORMAT.CHART",466:"SERIES.ORDER",467:"MAIL.LOGOFF",468:"CLEAR.ROUTING.SLIP",469:"APP.ACTIVATE.MICROSOFT",470:"MAIL.EDIT.MAILER",471:"ON.SHEET",472:"STANDARD.WIDTH",473:"SCENARIO.MERGE",474:"SUMMARY.INFO",475:"FIND.FILE",476:"ACTIVE.CELL.FONT",477:"ENABLE.TIPWIZARD",478:"VBA.MAKE.ADDIN",480:"INSERTDATATABLE",481:"WORKGROUP.OPTIONS",482:"MAIL.SEND.MAILER",485:"AUTOCORRECT",489:"POST.DOCUMENT",491:"PICKLIST",493:"VIEW.SHOW",494:"VIEW.DEFINE",495:"VIEW.DELETE",509:"SHEET.BACKGROUND",510:"INSERT.MAP.OBJECT",511:"OPTIONS.MENONO",517:"MSOCHECKS",518:"NORMAL",519:"LAYOUT",520:"RM.PRINT.AREA",521:"CLEAR.PRINT.AREA",522:"ADD.PRINT.AREA",523:"MOVE.BRK",545:"HIDECURR.NOTE",546:"HIDEALL.NOTES",547:"DELETE.NOTE",548:"TRAVERSE.NOTES",549:"ACTIVATE.NOTES",620:"PROTECT.REVISIONS",621:"UNPROTECT.REVISIONS",647:"OPTIONS.ME",653:"WEB.PUBLISH",667:"NEWWEBQUERY",673:"PIVOT.TABLE.CHART",753:"OPTIONS.SAVE",755:"OPTIONS.SPELL",808:"HIDEALL.INKANNOTS"},NC={0:"COUNT",1:"IF",2:"ISNA",3:"ISERROR",4:"SUM",5:"AVERAGE",6:"MIN",7:"MAX",8:"ROW",9:"COLUMN",10:"NA",11:"NPV",12:"STDEV",13:"DOLLAR",14:"FIXED",15:"SIN",16:"COS",17:"TAN",18:"ATAN",19:"PI",20:"SQRT",21:"EXP",22:"LN",23:"LOG10",24:"ABS",25:"INT",26:"SIGN",27:"ROUND",28:"LOOKUP",29:"INDEX",30:"REPT",31:"MID",32:"LEN",33:"VALUE",34:"TRUE",35:"FALSE",36:"AND",37:"OR",38:"NOT",39:"MOD",40:"DCOUNT",41:"DSUM",42:"DAVERAGE",43:"DMIN",44:"DMAX",45:"DSTDEV",46:"VAR",47:"DVAR",48:"TEXT",49:"LINEST",50:"TREND",51:"LOGEST",52:"GROWTH",53:"GOTO",54:"HALT",55:"RETURN",56:"PV",57:"FV",58:"NPER",59:"PMT",60:"RATE",61:"MIRR",62:"IRR",63:"RAND",64:"MATCH",65:"DATE",66:"TIME",67:"DAY",68:"MONTH",69:"YEAR",70:"WEEKDAY",71:"HOUR",72:"MINUTE",73:"SECOND",74:"NOW",75:"AREAS",76:"ROWS",77:"COLUMNS",78:"OFFSET",79:"ABSREF",80:"RELREF",81:"ARGUMENT",82:"SEARCH",83:"TRANSPOSE",84:"ERROR",85:"STEP",86:"TYPE",87:"ECHO",88:"SET.NAME",89:"CALLER",90:"DEREF",91:"WINDOWS",92:"SERIES",93:"DOCUMENTS",94:"ACTIVE.CELL",95:"SELECTION",96:"RESULT",97:"ATAN2",98:"ASIN",99:"ACOS",100:"CHOOSE",101:"HLOOKUP",102:"VLOOKUP",103:"LINKS",104:"INPUT",105:"ISREF",106:"GET.FORMULA",107:"GET.NAME",108:"SET.VALUE",109:"LOG",110:"EXEC",111:"CHAR",112:"LOWER",113:"UPPER",114:"PROPER",115:"LEFT",116:"RIGHT",117:"EXACT",118:"TRIM",119:"REPLACE",120:"SUBSTITUTE",121:"CODE",122:"NAMES",123:"DIRECTORY",124:"FIND",125:"CELL",126:"ISERR",127:"ISTEXT",128:"ISNUMBER",129:"ISBLANK",130:"T",131:"N",132:"FOPEN",133:"FCLOSE",134:"FSIZE",135:"FREADLN",136:"FREAD",137:"FWRITELN",138:"FWRITE",139:"FPOS",140:"DATEVALUE",141:"TIMEVALUE",142:"SLN",143:"SYD",144:"DDB",145:"GET.DEF",146:"REFTEXT",147:"TEXTREF",148:"INDIRECT",149:"REGISTER",150:"CALL",151:"ADD.BAR",152:"ADD.MENU",153:"ADD.COMMAND",154:"ENABLE.COMMAND",155:"CHECK.COMMAND",156:"RENAME.COMMAND",157:"SHOW.BAR",158:"DELETE.MENU",159:"DELETE.COMMAND",160:"GET.CHART.ITEM",161:"DIALOG.BOX",162:"CLEAN",163:"MDETERM",164:"MINVERSE",165:"MMULT",166:"FILES",167:"IPMT",168:"PPMT",169:"COUNTA",170:"CANCEL.KEY",171:"FOR",172:"WHILE",173:"BREAK",174:"NEXT",175:"INITIATE",176:"REQUEST",177:"POKE",178:"EXECUTE",179:"TERMINATE",180:"RESTART",181:"HELP",182:"GET.BAR",183:"PRODUCT",184:"FACT",185:"GET.CELL",186:"GET.WORKSPACE",187:"GET.WINDOW",188:"GET.DOCUMENT",189:"DPRODUCT",190:"ISNONTEXT",191:"GET.NOTE",192:"NOTE",193:"STDEVP",194:"VARP",195:"DSTDEVP",196:"DVARP",197:"TRUNC",198:"ISLOGICAL",199:"DCOUNTA",200:"DELETE.BAR",201:"UNREGISTER",204:"USDOLLAR",205:"FINDB",206:"SEARCHB",207:"REPLACEB",208:"LEFTB",209:"RIGHTB",210:"MIDB",211:"LENB",212:"ROUNDUP",213:"ROUNDDOWN",214:"ASC",215:"DBCS",216:"RANK",219:"ADDRESS",220:"DAYS360",221:"TODAY",222:"VDB",223:"ELSE",224:"ELSE.IF",225:"END.IF",226:"FOR.CELL",227:"MEDIAN",228:"SUMPRODUCT",229:"SINH",230:"COSH",231:"TANH",232:"ASINH",233:"ACOSH",234:"ATANH",235:"DGET",236:"CREATE.OBJECT",237:"VOLATILE",238:"LAST.ERROR",239:"CUSTOM.UNDO",240:"CUSTOM.REPEAT",241:"FORMULA.CONVERT",242:"GET.LINK.INFO",243:"TEXT.BOX",244:"INFO",245:"GROUP",246:"GET.OBJECT",247:"DB",248:"PAUSE",251:"RESUME",252:"FREQUENCY",253:"ADD.TOOLBAR",254:"DELETE.TOOLBAR",255:"User",256:"RESET.TOOLBAR",257:"EVALUATE",258:"GET.TOOLBAR",259:"GET.TOOL",260:"SPELLING.CHECK",261:"ERROR.TYPE",262:"APP.TITLE",263:"WINDOW.TITLE",264:"SAVE.TOOLBAR",265:"ENABLE.TOOL",266:"PRESS.TOOL",267:"REGISTER.ID",268:"GET.WORKBOOK",269:"AVEDEV",270:"BETADIST",271:"GAMMALN",272:"BETAINV",273:"BINOMDIST",274:"CHIDIST",275:"CHIINV",276:"COMBIN",277:"CONFIDENCE",278:"CRITBINOM",279:"EVEN",280:"EXPONDIST",281:"FDIST",282:"FINV",283:"FISHER",284:"FISHERINV",285:"FLOOR",286:"GAMMADIST",287:"GAMMAINV",288:"CEILING",289:"HYPGEOMDIST",290:"LOGNORMDIST",291:"LOGINV",292:"NEGBINOMDIST",293:"NORMDIST",294:"NORMSDIST",295:"NORMINV",296:"NORMSINV",297:"STANDARDIZE",298:"ODD",299:"PERMUT",300:"POISSON",301:"TDIST",302:"WEIBULL",303:"SUMXMY2",304:"SUMX2MY2",305:"SUMX2PY2",306:"CHITEST",307:"CORREL",308:"COVAR",309:"FORECAST",310:"FTEST",311:"INTERCEPT",312:"PEARSON",313:"RSQ",314:"STEYX",315:"SLOPE",316:"TTEST",317:"PROB",318:"DEVSQ",319:"GEOMEAN",320:"HARMEAN",321:"SUMSQ",322:"KURT",323:"SKEW",324:"ZTEST",325:"LARGE",326:"SMALL",327:"QUARTILE",328:"PERCENTILE",329:"PERCENTRANK",330:"MODE",331:"TRIMMEAN",332:"TINV",334:"MOVIE.COMMAND",335:"GET.MOVIE",336:"CONCATENATE",337:"POWER",338:"PIVOT.ADD.DATA",339:"GET.PIVOT.TABLE",340:"GET.PIVOT.FIELD",341:"GET.PIVOT.ITEM",342:"RADIANS",343:"DEGREES",344:"SUBTOTAL",345:"SUMIF",346:"COUNTIF",347:"COUNTBLANK",348:"SCENARIO.GET",349:"OPTIONS.LISTS.GET",350:"ISPMT",351:"DATEDIF",352:"DATESTRING",353:"NUMBERSTRING",354:"ROMAN",355:"OPEN.DIALOG",356:"SAVE.DIALOG",357:"VIEW.GET",358:"GETPIVOTDATA",359:"HYPERLINK",360:"PHONETIC",361:"AVERAGEA",362:"MAXA",363:"MINA",364:"STDEVPA",365:"VARPA",366:"STDEVA",367:"VARA",368:"BAHTTEXT",369:"THAIDAYOFWEEK",370:"THAIDIGIT",371:"THAIMONTHOFYEAR",372:"THAINUMSOUND",373:"THAINUMSTRING",374:"THAISTRINGLENGTH",375:"ISTHAIDIGIT",376:"ROUNDBAHTDOWN",377:"ROUNDBAHTUP",378:"THAIYEAR",379:"RTD",380:"CUBEVALUE",381:"CUBEMEMBER",382:"CUBEMEMBERPROPERTY",383:"CUBERANKEDMEMBER",384:"HEX2BIN",385:"HEX2DEC",386:"HEX2OCT",387:"DEC2BIN",388:"DEC2HEX",389:"DEC2OCT",390:"OCT2BIN",391:"OCT2HEX",392:"OCT2DEC",393:"BIN2DEC",394:"BIN2OCT",395:"BIN2HEX",396:"IMSUB",397:"IMDIV",398:"IMPOWER",399:"IMABS",400:"IMSQRT",401:"IMLN",402:"IMLOG2",403:"IMLOG10",404:"IMSIN",405:"IMCOS",406:"IMEXP",407:"IMARGUMENT",408:"IMCONJUGATE",409:"IMAGINARY",410:"IMREAL",411:"COMPLEX",412:"IMSUM",413:"IMPRODUCT",414:"SERIESSUM",415:"FACTDOUBLE",416:"SQRTPI",417:"QUOTIENT",418:"DELTA",419:"GESTEP",420:"ISEVEN",421:"ISODD",422:"MROUND",423:"ERF",424:"ERFC",425:"BESSELJ",426:"BESSELK",427:"BESSELY",428:"BESSELI",429:"XIRR",430:"XNPV",431:"PRICEMAT",432:"YIELDMAT",433:"INTRATE",434:"RECEIVED",435:"DISC",436:"PRICEDISC",437:"YIELDDISC",438:"TBILLEQ",439:"TBILLPRICE",440:"TBILLYIELD",441:"PRICE",442:"YIELD",443:"DOLLARDE",444:"DOLLARFR",445:"NOMINAL",446:"EFFECT",447:"CUMPRINC",448:"CUMIPMT",449:"EDATE",450:"EOMONTH",451:"YEARFRAC",452:"COUPDAYBS",453:"COUPDAYS",454:"COUPDAYSNC",455:"COUPNCD",456:"COUPNUM",457:"COUPPCD",458:"DURATION",459:"MDURATION",460:"ODDLPRICE",461:"ODDLYIELD",462:"ODDFPRICE",463:"ODDFYIELD",464:"RANDBETWEEN",465:"WEEKNUM",466:"AMORDEGRC",467:"AMORLINC",468:"CONVERT",724:"SHEETJS",469:"ACCRINT",470:"ACCRINTM",471:"WORKDAY",472:"NETWORKDAYS",473:"GCD",474:"MULTINOMIAL",475:"LCM",476:"FVSCHEDULE",477:"CUBEKPIMEMBER",478:"CUBESET",479:"CUBESETCOUNT",480:"IFERROR",481:"COUNTIFS",482:"SUMIFS",483:"AVERAGEIF",484:"AVERAGEIFS"},mU={2:1,3:1,10:0,15:1,16:1,17:1,18:1,19:0,20:1,21:1,22:1,23:1,24:1,25:1,26:1,27:2,30:2,31:3,32:1,33:1,34:0,35:0,38:1,39:2,40:3,41:3,42:3,43:3,44:3,45:3,47:3,48:2,53:1,61:3,63:0,65:3,66:3,67:1,68:1,69:1,70:1,71:1,72:1,73:1,74:0,75:1,76:1,77:1,79:2,80:2,83:1,85:0,86:1,89:0,90:1,94:0,95:0,97:2,98:1,99:1,101:3,102:3,105:1,106:1,108:2,111:1,112:1,113:1,114:1,117:2,118:1,119:4,121:1,126:1,127:1,128:1,129:1,130:1,131:1,133:1,134:1,135:1,136:2,137:2,138:2,140:1,141:1,142:3,143:4,144:4,161:1,162:1,163:1,164:1,165:2,172:1,175:2,176:2,177:3,178:2,179:1,184:1,186:1,189:3,190:1,195:3,196:3,197:1,198:1,199:3,201:1,207:4,210:3,211:1,212:2,213:2,214:1,215:1,225:0,229:1,230:1,231:1,232:1,233:1,234:1,235:3,244:1,247:4,252:2,257:1,261:1,271:1,273:4,274:2,275:2,276:2,277:3,278:3,279:1,280:3,281:3,282:3,283:1,284:1,285:2,286:4,287:3,288:2,289:4,290:3,291:3,292:3,293:4,294:1,295:3,296:1,297:3,298:1,299:2,300:3,301:3,302:4,303:2,304:2,305:2,306:2,307:2,308:2,309:3,310:2,311:2,312:2,313:2,314:2,315:2,316:4,325:2,326:2,327:2,328:2,331:2,332:2,337:2,342:1,343:1,346:2,347:1,350:4,351:3,352:1,353:2,360:1,368:1,369:1,370:1,371:1,372:1,373:1,374:1,375:1,376:1,377:1,378:1,382:3,385:1,392:1,393:1,396:2,397:2,398:2,399:1,400:1,401:1,402:1,403:1,404:1,405:1,406:1,407:1,408:1,409:1,410:1,414:4,415:1,416:1,417:2,420:1,421:1,422:2,424:1,425:2,426:2,427:2,428:2,430:3,438:3,439:3,440:3,443:2,444:2,445:2,446:2,447:6,448:6,449:2,450:2,464:2,468:3,476:2,479:1,480:2,65535:0};function sI(e){return e.slice(0,3)=="of:"&&(e=e.slice(3)),e.charCodeAt(0)==61&&(e=e.slice(1),e.charCodeAt(0)==61&&(e=e.slice(1))),e=e.replace(/COM\.MICROSOFT\./g,""),e=e.replace(/\[((?:\.[A-Z]+[0-9]+)(?::\.[A-Z]+[0-9]+)?)\]/g,function(n,t){return t.replace(/\./g,"")}),e=e.replace(/\[.(#[A-Z]*[?!])\]/g,"$1"),e.replace(/[;~]/g,",").replace(/\|/g,";")}function og(e){var n=e.split(":"),t=n[0].split(".")[0];return[t,n[0].split(".")[1]+(n.length>1?":"+(n[1].split(".")[1]||n[1].split(".")[0]):"")]}var Qc={},oa={};function Zc(e,n){if(e){var t=[.7,.7,.75,.75,.3,.3];n=="xlml"&&(t=[1,1,1,1,.5,.5]),e.left==null&&(e.left=t[0]),e.right==null&&(e.right=t[1]),e.top==null&&(e.top=t[2]),e.bottom==null&&(e.bottom=t[3]),e.header==null&&(e.header=t[4]),e.footer==null&&(e.footer=t[5])}}function RC(e,n,t,r,i,s){try{r.cellNF&&(e.z=Ae[n])}catch(a){if(r.WTF)throw a}if(!(e.t==="z"&&!r.cellStyles)){if(e.t==="d"&&typeof e.v=="string"&&(e.v=Wt(e.v)),(!r||r.cellText!==!1)&&e.t!=="z")try{if(Ae[n]==null&&Ps(gL[n]||"General",n),e.t==="e")e.w=e.w||zs[e.v];else if(n===0)if(e.t==="n")(e.v|0)===e.v?e.w=e.v.toString(10):e.w=el(e.v);else if(e.t==="d"){var o=En(e.v);(o|0)===o?e.w=o.toString(10):e.w=el(o)}else{if(e.v===void 0)return"";e.w=Bs(e.v,oa)}else e.t==="d"?e.w=tr(n,En(e.v),oa):e.w=tr(n,e.v,oa)}catch(a){if(r.WTF)throw a}if(r.cellStyles&&t!=null)try{e.s=s.Fills[t],e.s.fgColor&&e.s.fgColor.theme&&!e.s.fgColor.rgb&&(e.s.fgColor.rgb=Td(i.themeElements.clrScheme[e.s.fgColor.theme].rgb,e.s.fgColor.tint||0),r.WTF&&(e.s.fgColor.raw_rgb=i.themeElements.clrScheme[e.s.fgColor.theme].rgb)),e.s.bgColor&&e.s.bgColor.theme&&(e.s.bgColor.rgb=Td(i.themeElements.clrScheme[e.s.bgColor.theme].rgb,e.s.bgColor.tint||0),r.WTF&&(e.s.bgColor.raw_rgb=i.themeElements.clrScheme[e.s.bgColor.theme].rgb))}catch(a){if(r.WTF&&s.Fills)throw a}}}function gU(e,n){var t=_t(n);t.s.r<=t.e.r&&t.s.c<=t.e.c&&t.s.r>=0&&t.s.c>=0&&(e["!ref"]=Ge(t))}var vU=/<(?:\w:)?mergeCell ref="[A-Z0-9:]+"\s*[\/]?>/g,_U=/<(?:\w+:)?sheetData[^>]*>([\s\S]*)<\/(?:\w+:)?sheetData>/,xU=/<(?:\w:)?hyperlink [^>]*>/mg,yU=/"(\w*:\w*)"/,wU=/<(?:\w:)?col\b[^>]*[\/]?>/g,EU=/<(?:\w:)?autoFilter[^>]*([\/]|>([\s\S]*)<\/(?:\w:)?autoFilter)>/g,TU=/<(?:\w:)?pageMargins[^>]*\/>/g,MC=/<(?:\w:)?sheetPr\b(?:[^>a-z][^>]*)?\/>/,IU=/<(?:\w:)?sheetPr[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetPr)>/,CU=/<(?:\w:)?sheetViews[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetViews)>/;function SU(e,n,t,r,i,s,o){if(!e)return e;r||(r={"!id":{}}),Nt!=null&&n.dense==null&&(n.dense=Nt);var a=n.dense?[]:{},c={s:{r:2e6,c:2e6},e:{r:0,c:0}},l="",u="",f=e.match(_U);f?(l=e.slice(0,f.index),u=e.slice(f.index+f[0].length)):l=u=e;var d=l.match(MC);d?zg(d[0],a,i,t):(d=l.match(IU))&&DU(d[0],d[1]||"",a,i,t,o,s);var h=(l.match(/<(?:\w*:)?dimension/)||{index:-1}).index;if(h>0){var m=l.slice(h,h+50).match(yU);m&&gU(a,m[1])}var p=l.match(CU);p&&p[1]&&MU(p[1],i);var g=[];if(n.cellStyles){var w=l.match(wU);w&&kU(g,w)}f&&OU(f[1],a,n,c,s,o);var C=u.match(EU);C&&(a["!autofilter"]=NU(C[0]));var _=[],M=u.match(vU);if(M)for(h=0;h!=M.length;++h)_[h]=_t(M[h].slice(M[h].indexOf('"')+1));var V=u.match(xU);V&&bU(a,V,r);var A=u.match(TU);if(A&&(a["!margins"]=AU(Ee(A[0]))),!a["!ref"]&&c.e.c>=c.s.c&&c.e.r>=c.s.r&&(a["!ref"]=Ge(c)),n.sheetRows>0&&a["!ref"]){var S=_t(a["!ref"]);n.sheetRows<=+S.e.r&&(S.e.r=n.sheetRows-1,S.e.r>c.e.r&&(S.e.r=c.e.r),S.e.r<S.s.r&&(S.s.r=S.e.r),S.e.c>c.e.c&&(S.e.c=c.e.c),S.e.c<S.s.c&&(S.s.c=S.e.c),a["!fullref"]=a["!ref"],a["!ref"]=Ge(S))}return g.length>0&&(a["!cols"]=g),_.length>0&&(a["!merges"]=_),a}function zg(e,n,t,r){var i=Ee(e);t.Sheets[r]||(t.Sheets[r]={}),i.codeName&&(t.Sheets[r].CodeName=Xe(ct(i.codeName)))}function DU(e,n,t,r,i){zg(e.slice(0,e.indexOf(">")),t,r,i)}function bU(e,n,t){for(var r=Array.isArray(e),i=0;i!=n.length;++i){var s=Ee(ct(n[i]),!0);if(!s.ref)return;var o=((t||{})["!id"]||[])[s.id];o?(s.Target=o.Target,s.location&&(s.Target+="#"+Xe(s.location))):(s.Target="#"+Xe(s.location),o={Target:s.Target,TargetMode:"Internal"}),s.Rel=o,s.tooltip&&(s.Tooltip=s.tooltip,delete s.tooltip);for(var a=_t(s.ref),c=a.s.r;c<=a.e.r;++c)for(var l=a.s.c;l<=a.e.c;++l){var u=Ce({c:l,r:c});r?(e[c]||(e[c]=[]),e[c][l]||(e[c][l]={t:"z",v:void 0}),e[c][l].l=s):(e[u]||(e[u]={t:"z",v:void 0}),e[u].l=s)}}}function AU(e){var n={};return["left","right","top","bottom","header","footer"].forEach(function(t){e[t]&&(n[t]=parseFloat(e[t]))}),n}function kU(e,n){for(var t=!1,r=0;r!=n.length;++r){var i=Ee(n[r],!0);i.hidden&&(i.hidden=ft(i.hidden));var s=parseInt(i.min,10)-1,o=parseInt(i.max,10)-1;for(i.outlineLevel&&(i.level=+i.outlineLevel||0),delete i.min,delete i.max,i.width=+i.width,!t&&i.width&&(t=!0,$g(i.width)),la(i);s<=o;)e[s++]=en(i)}}function NU(e){var n={ref:(e.match(/ref="([^"]*)"/)||[])[1]};return n}var RU=/<(?:\w:)?sheetView(?:[^>a-z][^>]*)?\/?>/;function MU(e,n){n.Views||(n.Views=[{}]),(e.match(RU)||[]).forEach(function(t,r){var i=Ee(t);n.Views[r]||(n.Views[r]={}),+i.zoomScale&&(n.Views[r].zoom=+i.zoomScale),ft(i.rightToLeft)&&(n.Views[r].RTL=!0)})}var OU=function(){var e=/<(?:\w+:)?c[ \/>]/,n=/<\/(?:\w+:)?row>/,t=/r=["']([^"']*)["']/,r=/<(?:\w+:)?is>([\S\s]*?)<\/(?:\w+:)?is>/,i=/ref=["']([^"']*)["']/,s=tl("v"),o=tl("f");return function(c,l,u,f,d,h){for(var m=0,p="",g=[],w=[],C=0,_=0,M=0,V="",A,S,F=0,N=0,H,W,O=0,Q=0,pe=Array.isArray(h.CellXf),ne,_e=[],fe=[],qe=Array.isArray(l),se=[],me={},G=!1,b=!!u.sheetStubs,U=c.split(n),R=0,k=U.length;R!=k;++R){p=U[R].trim();var q=p.length;if(q!==0){var ce=0;e:for(m=0;m<q;++m)switch(p[m]){case">":if(p[m-1]!="/"){++m;break e}if(u&&u.cellStyles){if(S=Ee(p.slice(ce,m),!0),F=S.r!=null?parseInt(S.r,10):F+1,N=-1,u.sheetRows&&u.sheetRows<F)continue;me={},G=!1,S.ht&&(G=!0,me.hpt=parseFloat(S.ht),me.hpx=sl(me.hpt)),S.hidden=="1"&&(G=!0,me.hidden=!0),S.outlineLevel!=null&&(G=!0,me.level=+S.outlineLevel),G&&(se[F-1]=me)}break;case"<":ce=m;break}if(ce>=m)break;if(S=Ee(p.slice(ce,m),!0),F=S.r!=null?parseInt(S.r,10):F+1,N=-1,!(u.sheetRows&&u.sheetRows<F)){f.s.r>F-1&&(f.s.r=F-1),f.e.r<F-1&&(f.e.r=F-1),u&&u.cellStyles&&(me={},G=!1,S.ht&&(G=!0,me.hpt=parseFloat(S.ht),me.hpx=sl(me.hpt)),S.hidden=="1"&&(G=!0,me.hidden=!0),S.outlineLevel!=null&&(G=!0,me.level=+S.outlineLevel),G&&(se[F-1]=me)),g=p.slice(m).split(e);for(var ie=0;ie!=g.length&&g[ie].trim().charAt(0)=="<";++ie);for(g=g.slice(ie),m=0;m!=g.length;++m)if(p=g[m].trim(),p.length!==0){if(w=p.match(t),C=m,_=0,M=0,p="<c "+(p.slice(0,1)=="<"?">":"")+p,w!=null&&w.length===2){for(C=0,V=w[1],_=0;_!=V.length&&!((M=V.charCodeAt(_)-64)<1||M>26);++_)C=26*C+M;--C,N=C}else++N;for(_=0;_!=p.length&&p.charCodeAt(_)!==62;++_);if(++_,S=Ee(p.slice(0,_),!0),S.r||(S.r=Ce({r:F-1,c:N})),V=p.slice(_),A={t:""},(w=V.match(s))!=null&&w[1]!==""&&(A.v=Xe(w[1])),u.cellFormula){if((w=V.match(o))!=null&&w[1]!==""){if(A.f=Xe(ct(w[1])).replace(/\r\n/g,`
`),u.xlfn||(A.f=tI(A.f)),w[0].indexOf('t="array"')>-1)A.F=(V.match(i)||[])[1],A.F.indexOf(":")>-1&&_e.push([_t(A.F),A.F]);else if(w[0].indexOf('t="shared"')>-1){W=Ee(w[0]);var ae=Xe(ct(w[1]));u.xlfn||(ae=tI(ae)),fe[parseInt(W.si,10)]=[W,ae,S.r]}}else(w=V.match(/<f[^>]*\/>/))&&(W=Ee(w[0]),fe[W.si]&&(A.f=zB(fe[W.si][1],fe[W.si][2],S.r)));var K=wn(S.r);for(_=0;_<_e.length;++_)K.r>=_e[_][0].s.r&&K.r<=_e[_][0].e.r&&K.c>=_e[_][0].s.c&&K.c<=_e[_][0].e.c&&(A.F=_e[_][1])}if(S.t==null&&A.v===void 0)if(A.f||A.F)A.v=0,A.t="n";else if(b)A.t="z";else continue;else A.t=S.t||"n";switch(f.s.c>N&&(f.s.c=N),f.e.c<N&&(f.e.c=N),A.t){case"n":if(A.v==""||A.v==null){if(!b)continue;A.t="z"}else A.v=parseFloat(A.v);break;case"s":if(typeof A.v>"u"){if(!b)continue;A.t="z"}else H=Qc[parseInt(A.v,10)],A.v=H.t,A.r=H.r,u.cellHTML&&(A.h=H.h);break;case"str":A.t="s",A.v=A.v!=null?ct(A.v):"",u.cellHTML&&(A.h=bg(A.v));break;case"inlineStr":w=V.match(r),A.t="s",w!=null&&(H=Hg(w[1]))?(A.v=H.t,u.cellHTML&&(A.h=H.h)):A.v="";break;case"b":A.v=ft(A.v);break;case"d":u.cellDates?A.v=Wt(A.v,1):(A.v=En(Wt(A.v,1)),A.t="n");break;case"e":(!u||u.cellText!==!1)&&(A.w=A.v),A.v=eC[A.v];break}if(O=Q=0,ne=null,pe&&S.s!==void 0&&(ne=h.CellXf[S.s],ne!=null&&(ne.numFmtId!=null&&(O=ne.numFmtId),u.cellStyles&&ne.fillId!=null&&(Q=ne.fillId))),RC(A,O,Q,u,d,h),u.cellDates&&pe&&A.t=="n"&&ua(Ae[O])&&(A.t="d",A.v=bd(A.v)),S.cm&&u.xlmeta){var je=(u.xlmeta.Cell||[])[+S.cm-1];je&&je.type=="XLDAPR"&&(A.D=!0)}if(qe){var D=wn(S.r);l[D.r]||(l[D.r]=[]),l[D.r][D.c]=A}else l[S.r]=A}}}}se.length>0&&(l["!rows"]=se)}}();function FU(e,n){var t={},r=e.l+n;t.r=e.read_shift(4),e.l+=4;var i=e.read_shift(2);e.l+=1;var s=e.read_shift(1);return e.l=r,s&7&&(t.level=s&7),s&16&&(t.hidden=!0),s&32&&(t.hpt=i/20),t}var PU=Ws;function LU(){}function BU(e,n){var t={},r=e[e.l];return++e.l,t.above=!(r&64),t.left=!(r&128),e.l+=18,t.name=o4(e,n-19),t}function UU(e){var n=nr(e);return[n]}function jU(e){var n=$s(e);return[n]}function VU(e){var n=nr(e),t=e.read_shift(1);return[n,t,"b"]}function HU(e){var n=$s(e),t=e.read_shift(1);return[n,t,"b"]}function $U(e){var n=nr(e),t=e.read_shift(1);return[n,t,"e"]}function WU(e){var n=$s(e),t=e.read_shift(1);return[n,t,"e"]}function zU(e){var n=nr(e),t=e.read_shift(4);return[n,t,"s"]}function GU(e){var n=$s(e),t=e.read_shift(4);return[n,t,"s"]}function qU(e){var n=nr(e),t=cn(e);return[n,t,"n"]}function OC(e){var n=$s(e),t=cn(e);return[n,t,"n"]}function KU(e){var n=nr(e),t=Ug(e);return[n,t,"n"]}function YU(e){var n=$s(e),t=Ug(e);return[n,t,"n"]}function XU(e){var n=nr(e),t=Lg(e);return[n,t,"is"]}function QU(e){var n=nr(e),t=fn(e);return[n,t,"str"]}function ZU(e){var n=$s(e),t=fn(e);return[n,t,"str"]}function JU(e,n,t){var r=e.l+n,i=nr(e);i.r=t["!row"];var s=e.read_shift(1),o=[i,s,"b"];if(t.cellFormula){e.l+=2;var a=Rd(e,r-e.l,t);o[3]=an(a,null,i,t.supbooks,t)}else e.l=r;return o}function e5(e,n,t){var r=e.l+n,i=nr(e);i.r=t["!row"];var s=e.read_shift(1),o=[i,s,"e"];if(t.cellFormula){e.l+=2;var a=Rd(e,r-e.l,t);o[3]=an(a,null,i,t.supbooks,t)}else e.l=r;return o}function t5(e,n,t){var r=e.l+n,i=nr(e);i.r=t["!row"];var s=cn(e),o=[i,s,"n"];if(t.cellFormula){e.l+=2;var a=Rd(e,r-e.l,t);o[3]=an(a,null,i,t.supbooks,t)}else e.l=r;return o}function n5(e,n,t){var r=e.l+n,i=nr(e);i.r=t["!row"];var s=fn(e),o=[i,s,"str"];if(t.cellFormula){e.l+=2;var a=Rd(e,r-e.l,t);o[3]=an(a,null,i,t.supbooks,t)}else e.l=r;return o}var r5=Ws;function i5(e,n){var t=e.l+n,r=Ws(e,16),i=Bg(e),s=fn(e),o=fn(e),a=fn(e);e.l=t;var c={rfx:r,relId:i,loc:s,display:a};return o&&(c.Tooltip=o),c}function s5(){}function o5(e,n,t){var r=e.l+n,i=QI(e,16),s=e.read_shift(1),o=[i];if(o[2]=s,t.cellFormula){var a=fU(e,r-e.l,t);o[1]=a}else e.l=r;return o}function a5(e,n,t){var r=e.l+n,i=Ws(e,16),s=[i];if(t.cellFormula){var o=hU(e,r-e.l,t);s[1]=o,e.l=r}else e.l=r;return s}var c5=["left","right","top","bottom","header","footer"];function l5(e){var n={};return c5.forEach(function(t){n[t]=cn(e,8)}),n}function u5(e){var n=e.read_shift(2);return e.l+=28,{RTL:n&32}}function f5(){}function d5(){}function h5(e,n,t,r,i,s,o){if(!e)return e;var a=n||{};r||(r={"!id":{}}),Nt!=null&&a.dense==null&&(a.dense=Nt);var c=a.dense?[]:{},l,u={s:{r:2e6,c:2e6},e:{r:0,c:0}},f=[],d=!1,h=!1,m,p,g,w,C,_,M,V,A,S=[];a.biff=12,a["!row"]=0;var F=0,N=!1,H=[],W={},O=a.supbooks||i.supbooks||[[]];if(O.sharedf=W,O.arrayf=H,O.SheetNames=i.SheetNames||i.Sheets.map(function(me){return me.name}),!a.supbooks&&(a.supbooks=O,i.Names))for(var Q=0;Q<i.Names.length;++Q)O[0][Q+1]=i.Names[Q];var pe=[],ne=[],_e=!1;Sd[16]={n:"BrtShortReal",f:OC};var fe,qe;if(_i(e,function(G,b,U){if(!h)switch(U){case 148:l=G;break;case 0:m=G,a.sheetRows&&a.sheetRows<=m.r&&(h=!0),V=tn(w=m.r),a["!row"]=m.r,(G.hidden||G.hpt||G.level!=null)&&(G.hpt&&(G.hpx=sl(G.hpt)),ne[G.r]=G);break;case 2:case 3:case 4:case 5:case 6:case 7:case 8:case 9:case 10:case 11:case 13:case 14:case 15:case 16:case 17:case 18:case 62:switch(p={t:G[2]},G[2]){case"n":p.v=G[1];break;case"s":M=Qc[G[1]],p.v=M.t,p.r=M.r;break;case"b":p.v=!!G[1];break;case"e":p.v=G[1],a.cellText!==!1&&(p.w=zs[p.v]);break;case"str":p.t="s",p.v=G[1];break;case"is":p.t="s",p.v=G[1].t;break}if((g=o.CellXf[G[0].iStyleRef])&&RC(p,g.numFmtId,null,a,s,o),C=G[0].c==-1?C+1:G[0].c,a.dense?(c[w]||(c[w]=[]),c[w][C]=p):c[Ot(C)+V]=p,a.cellFormula){for(N=!1,F=0;F<H.length;++F){var R=H[F];m.r>=R[0].s.r&&m.r<=R[0].e.r&&C>=R[0].s.c&&C<=R[0].e.c&&(p.F=Ge(R[0]),N=!0)}!N&&G.length>3&&(p.f=G[3])}if(u.s.r>m.r&&(u.s.r=m.r),u.s.c>C&&(u.s.c=C),u.e.r<m.r&&(u.e.r=m.r),u.e.c<C&&(u.e.c=C),a.cellDates&&g&&p.t=="n"&&ua(Ae[g.numFmtId])){var k=Fs(p.v);k&&(p.t="d",p.v=new Date(k.y,k.m-1,k.d,k.H,k.M,k.S,k.u))}fe&&(fe.type=="XLDAPR"&&(p.D=!0),fe=void 0),qe&&(qe=void 0);break;case 1:case 12:if(!a.sheetStubs||d)break;p={t:"z",v:void 0},C=G[0].c==-1?C+1:G[0].c,a.dense?(c[w]||(c[w]=[]),c[w][C]=p):c[Ot(C)+V]=p,u.s.r>m.r&&(u.s.r=m.r),u.s.c>C&&(u.s.c=C),u.e.r<m.r&&(u.e.r=m.r),u.e.c<C&&(u.e.c=C),fe&&(fe.type=="XLDAPR"&&(p.D=!0),fe=void 0),qe&&(qe=void 0);break;case 176:S.push(G);break;case 49:fe=((a.xlmeta||{}).Cell||[])[G-1];break;case 494:var q=r["!id"][G.relId];for(q?(G.Target=q.Target,G.loc&&(G.Target+="#"+G.loc),G.Rel=q):G.relId==""&&(G.Target="#"+G.loc),w=G.rfx.s.r;w<=G.rfx.e.r;++w)for(C=G.rfx.s.c;C<=G.rfx.e.c;++C)a.dense?(c[w]||(c[w]=[]),c[w][C]||(c[w][C]={t:"z",v:void 0}),c[w][C].l=G):(_=Ce({c:C,r:w}),c[_]||(c[_]={t:"z",v:void 0}),c[_].l=G);break;case 426:if(!a.cellFormula)break;H.push(G),A=a.dense?c[w][C]:c[Ot(C)+V],A.f=an(G[1],u,{r:m.r,c:C},O,a),A.F=Ge(G[0]);break;case 427:if(!a.cellFormula)break;W[Ce(G[0].s)]=G[1],A=a.dense?c[w][C]:c[Ot(C)+V],A.f=an(G[1],u,{r:m.r,c:C},O,a);break;case 60:if(!a.cellStyles)break;for(;G.e>=G.s;)pe[G.e--]={width:G.w/256,hidden:!!(G.flags&1),level:G.level},_e||(_e=!0,$g(G.w/256)),la(pe[G.e+1]);break;case 161:c["!autofilter"]={ref:Ge(G)};break;case 476:c["!margins"]=G;break;case 147:i.Sheets[t]||(i.Sheets[t]={}),G.name&&(i.Sheets[t].CodeName=G.name),(G.above||G.left)&&(c["!outline"]={above:G.above,left:G.left});break;case 137:i.Views||(i.Views=[{}]),i.Views[0]||(i.Views[0]={}),G.RTL&&(i.Views[0].RTL=!0);break;case 485:break;case 64:case 1053:break;case 151:break;case 152:case 175:case 644:case 625:case 562:case 396:case 1112:case 1146:case 471:case 1050:case 649:case 1105:case 589:case 607:case 564:case 1055:case 168:case 174:case 1180:case 499:case 507:case 550:case 171:case 167:case 1177:case 169:case 1181:case 551:case 552:case 661:case 639:case 478:case 537:case 477:case 536:case 1103:case 680:case 1104:case 1024:case 663:case 535:case 678:case 504:case 1043:case 428:case 170:case 3072:case 50:case 2070:case 1045:break;case 35:d=!0;break;case 36:d=!1;break;case 37:f.push(U),d=!0;break;case 38:f.pop(),d=!1;break;default:if(!b.T){if(!d||a.WTF)throw new Error("Unexpected record 0x"+U.toString(16))}}},a),delete a.supbooks,delete a["!row"],!c["!ref"]&&(u.s.r<2e6||l&&(l.e.r>0||l.e.c>0||l.s.r>0||l.s.c>0))&&(c["!ref"]=Ge(l||u)),a.sheetRows&&c["!ref"]){var se=_t(c["!ref"]);a.sheetRows<=+se.e.r&&(se.e.r=a.sheetRows-1,se.e.r>u.e.r&&(se.e.r=u.e.r),se.e.r<se.s.r&&(se.s.r=se.e.r),se.e.c>u.e.c&&(se.e.c=u.e.c),se.e.c<se.s.c&&(se.s.c=se.e.c),c["!fullref"]=c["!ref"],c["!ref"]=Ge(se))}return S.length>0&&(c["!merges"]=S),pe.length>0&&(c["!cols"]=pe),ne.length>0&&(c["!rows"]=ne),c}function p5(e){var n=[],t=e.match(/^<c:numCache>/),r;(e.match(/<c:pt idx="(\d*)">(.*?)<\/c:pt>/mg)||[]).forEach(function(s){var o=s.match(/<c:pt idx="(\d*?)"><c:v>(.*)<\/c:v><\/c:pt>/);o&&(n[+o[1]]=t?+o[2]:o[2])});var i=Xe((e.match(/<c:formatCode>([\s\S]*?)<\/c:formatCode>/)||["","General"])[1]);return(e.match(/<c:f>(.*?)<\/c:f>/mg)||[]).forEach(function(s){r=s.replace(/<.*?>/g,"")}),[n,i,r]}function m5(e,n,t,r,i,s){var o=s||{"!type":"chart"};if(!e)return s;var a=0,c=0,l="A",u={s:{r:2e6,c:2e6},e:{r:0,c:0}};return(e.match(/<c:numCache>[\s\S]*?<\/c:numCache>/gm)||[]).forEach(function(f){var d=p5(f);u.s.r=u.s.c=0,u.e.c=a,l=Ot(a),d[0].forEach(function(h,m){o[l+tn(m)]={t:"n",v:h,z:d[1]},c=m}),u.e.r<c&&(u.e.r=c),++a}),a>0&&(o["!ref"]=Ge(u)),o}function g5(e,n,t,r,i){if(!e)return e;r||(r={"!id":{}});var s={"!type":"chart","!drawel":null,"!rel":""},o,a=e.match(MC);return a&&zg(a[0],s,i,t),(o=e.match(/drawing r:id="(.*?)"/))&&(s["!rel"]=o[1]),r["!id"][s["!rel"]]&&(s["!drawel"]=r["!id"][s["!rel"]]),s}function v5(e,n){e.l+=10;var t=fn(e,n-10);return{name:t}}function _5(e,n,t,r,i){if(!e)return e;r||(r={"!id":{}});var s={"!type":"chart","!drawel":null,"!rel":""},o=[],a=!1;return _i(e,function(l,u,f){switch(f){case 550:s["!rel"]=l;break;case 651:i.Sheets[t]||(i.Sheets[t]={}),l.name&&(i.Sheets[t].CodeName=l.name);break;case 562:case 652:case 669:case 679:case 551:case 552:case 476:case 3072:break;case 35:a=!0;break;case 36:a=!1;break;case 37:o.push(f);break;case 38:o.pop();break;default:if(u.T>0)o.push(f);else if(u.T<0)o.pop();else if(!a||n.WTF)throw new Error("Unexpected record 0x"+f.toString(16))}},n),r["!id"][s["!rel"]]&&(s["!drawel"]=r["!id"][s["!rel"]]),s}var FC=[["allowRefreshQuery",!1,"bool"],["autoCompressPictures",!0,"bool"],["backupFile",!1,"bool"],["checkCompatibility",!1,"bool"],["CodeName",""],["date1904",!1,"bool"],["defaultThemeVersion",0,"int"],["filterPrivacy",!1,"bool"],["hidePivotFieldList",!1,"bool"],["promptedSolutions",!1,"bool"],["publishItems",!1,"bool"],["refreshAllConnections",!1,"bool"],["saveExternalLinkValues",!0,"bool"],["showBorderUnselectedTables",!0,"bool"],["showInkAnnotation",!0,"bool"],["showObjects","all"],["showPivotChartFilter",!1,"bool"],["updateLinks","userSet"]],x5=[["activeTab",0,"int"],["autoFilterDateGrouping",!0,"bool"],["firstSheet",0,"int"],["minimized",!1,"bool"],["showHorizontalScroll",!0,"bool"],["showSheetTabs",!0,"bool"],["showVerticalScroll",!0,"bool"],["tabRatio",600,"int"],["visibility","visible"]],y5=[],w5=[["calcCompleted","true"],["calcMode","auto"],["calcOnSave","true"],["concurrentCalc","true"],["fullCalcOnLoad","false"],["fullPrecision","true"],["iterate","false"],["iterateCount","100"],["iterateDelta","0.001"],["refMode","A1"]];function oI(e,n){for(var t=0;t!=e.length;++t)for(var r=e[t],i=0;i!=n.length;++i){var s=n[i];if(r[s[0]]==null)r[s[0]]=s[1];else switch(s[2]){case"bool":typeof r[s[0]]=="string"&&(r[s[0]]=ft(r[s[0]]));break;case"int":typeof r[s[0]]=="string"&&(r[s[0]]=parseInt(r[s[0]],10));break}}}function aI(e,n){for(var t=0;t!=n.length;++t){var r=n[t];if(e[r[0]]==null)e[r[0]]=r[1];else switch(r[2]){case"bool":typeof e[r[0]]=="string"&&(e[r[0]]=ft(e[r[0]]));break;case"int":typeof e[r[0]]=="string"&&(e[r[0]]=parseInt(e[r[0]],10));break}}}function PC(e){aI(e.WBProps,FC),aI(e.CalcPr,w5),oI(e.WBView,x5),oI(e.Sheets,y5),oa.date1904=ft(e.WBProps.date1904)}var E5="][*?/\\".split("");function T5(e,n){if(e.length>31){if(n)return!1;throw new Error("Sheet names cannot exceed 31 chars")}var t=!0;return E5.forEach(function(r){if(e.indexOf(r)!=-1){if(!n)throw new Error("Sheet name cannot contain : \\ / ? * [ ]");t=!1}}),t}var I5=/<\w+:workbook/;function C5(e,n){if(!e)throw new Error("Could not find file");var t={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},Names:[],xmlns:""},r=!1,i="xmlns",s={},o=0;if(e.replace(hn,function(c,l){var u=Ee(c);switch(Gr(u[0])){case"<?xml":break;case"<workbook":c.match(I5)&&(i="xmlns"+c.match(/<(\w+):/)[1]),t.xmlns=u[i];break;case"</workbook>":break;case"<fileVersion":delete u[0],t.AppVersion=u;break;case"<fileVersion/>":case"</fileVersion>":break;case"<fileSharing":break;case"<fileSharing/>":break;case"<workbookPr":case"<workbookPr/>":FC.forEach(function(f){if(u[f[0]]!=null)switch(f[2]){case"bool":t.WBProps[f[0]]=ft(u[f[0]]);break;case"int":t.WBProps[f[0]]=parseInt(u[f[0]],10);break;default:t.WBProps[f[0]]=u[f[0]]}}),u.codeName&&(t.WBProps.CodeName=ct(u.codeName));break;case"</workbookPr>":break;case"<workbookProtection":break;case"<workbookProtection/>":break;case"<bookViews":case"<bookViews>":case"</bookViews>":break;case"<workbookView":case"<workbookView/>":delete u[0],t.WBView.push(u);break;case"</workbookView>":break;case"<sheets":case"<sheets>":case"</sheets>":break;case"<sheet":switch(u.state){case"hidden":u.Hidden=1;break;case"veryHidden":u.Hidden=2;break;default:u.Hidden=0}delete u.state,u.name=Xe(ct(u.name)),delete u[0],t.Sheets.push(u);break;case"</sheet>":break;case"<functionGroups":case"<functionGroups/>":break;case"<functionGroup":break;case"<externalReferences":case"</externalReferences>":case"<externalReferences>":break;case"<externalReference":break;case"<definedNames/>":break;case"<definedNames>":case"<definedNames":r=!0;break;case"</definedNames>":r=!1;break;case"<definedName":s={},s.Name=ct(u.name),u.comment&&(s.Comment=u.comment),u.localSheetId&&(s.Sheet=+u.localSheetId),ft(u.hidden||"0")&&(s.Hidden=!0),o=l+c.length;break;case"</definedName>":s.Ref=Xe(ct(e.slice(o,l))),t.Names.push(s);break;case"<definedName/>":break;case"<calcPr":delete u[0],t.CalcPr=u;break;case"<calcPr/>":delete u[0],t.CalcPr=u;break;case"</calcPr>":break;case"<oleSize":break;case"<customWorkbookViews>":case"</customWorkbookViews>":case"<customWorkbookViews":break;case"<customWorkbookView":case"</customWorkbookView>":break;case"<pivotCaches>":case"</pivotCaches>":case"<pivotCaches":break;case"<pivotCache":break;case"<smartTagPr":case"<smartTagPr/>":break;case"<smartTagTypes":case"<smartTagTypes>":case"</smartTagTypes>":break;case"<smartTagType":break;case"<webPublishing":case"<webPublishing/>":break;case"<fileRecoveryPr":case"<fileRecoveryPr/>":break;case"<webPublishObjects>":case"<webPublishObjects":case"</webPublishObjects>":break;case"<webPublishObject":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":r=!0;break;case"</ext>":r=!1;break;case"<ArchID":break;case"<AlternateContent":case"<AlternateContent>":r=!0;break;case"</AlternateContent>":r=!1;break;case"<revisionPtr":break;default:if(!r&&n.WTF)throw new Error("unrecognized "+u[0]+" in workbook")}return c}),HL.indexOf(t.xmlns)===-1)throw new Error("Unknown Namespace: "+t.xmlns);return PC(t),t}function S5(e,n){var t={};return t.Hidden=e.read_shift(4),t.iTabID=e.read_shift(4),t.strRelID=dg(e,n-8),t.name=fn(e),t}function D5(e,n){var t={},r=e.read_shift(4);t.defaultThemeVersion=e.read_shift(4);var i=n>8?fn(e):"";return i.length>0&&(t.CodeName=i),t.autoCompressPictures=!!(r&65536),t.backupFile=!!(r&64),t.checkCompatibility=!!(r&4096),t.date1904=!!(r&1),t.filterPrivacy=!!(r&8),t.hidePivotFieldList=!!(r&1024),t.promptedSolutions=!!(r&16),t.publishItems=!!(r&2048),t.refreshAllConnections=!!(r&262144),t.saveExternalLinkValues=!!(r&128),t.showBorderUnselectedTables=!!(r&4),t.showInkAnnotation=!!(r&32),t.showObjects=["all","placeholders","none"][r>>13&3],t.showPivotChartFilter=!!(r&32768),t.updateLinks=["userSet","never","always"][r>>8&3],t}function b5(e,n){var t={};return e.read_shift(4),t.ArchID=e.read_shift(4),e.l+=n-8,t}function A5(e,n,t){var r=e.l+n;e.l+=4,e.l+=1;var i=e.read_shift(4),s=a4(e),o=dU(e,0,t),a=Bg(e);e.l=r;var c={Name:s,Ptg:o};return i<268435455&&(c.Sheet=i),a&&(c.Comment=a),c}function k5(e,n){var t={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},xmlns:""},r=[],i=!1;n||(n={}),n.biff=12;var s=[],o=[[]];return o.SheetNames=[],o.XTI=[],Sd[16]={n:"BrtFRTArchID$",f:b5},_i(e,function(c,l,u){switch(u){case 156:o.SheetNames.push(c.name),t.Sheets.push(c);break;case 153:t.WBProps=c;break;case 39:c.Sheet!=null&&(n.SID=c.Sheet),c.Ref=an(c.Ptg,null,null,o,n),delete n.SID,delete c.Ptg,s.push(c);break;case 1036:break;case 357:case 358:case 355:case 667:o[0].length?o.push([u,c]):o[0]=[u,c],o[o.length-1].XTI=[];break;case 362:o.length===0&&(o[0]=[],o[0].XTI=[]),o[o.length-1].XTI=o[o.length-1].XTI.concat(c),o.XTI=o.XTI.concat(c);break;case 361:break;case 2071:case 158:case 143:case 664:case 353:break;case 3072:case 3073:case 534:case 677:case 157:case 610:case 2050:case 155:case 548:case 676:case 128:case 665:case 2128:case 2125:case 549:case 2053:case 596:case 2076:case 2075:case 2082:case 397:case 154:case 1117:case 553:case 2091:break;case 35:r.push(u),i=!0;break;case 36:r.pop(),i=!1;break;case 37:r.push(u),i=!0;break;case 38:r.pop(),i=!1;break;case 16:break;default:if(!l.T){if(!i||n.WTF&&r[r.length-1]!=37&&r[r.length-1]!=35)throw new Error("Unexpected record 0x"+u.toString(16))}}},n),PC(t),t.Names=s,t.supbooks=o,t}function N5(e,n,t){return n.slice(-4)===".bin"?k5(e,t):C5(e,t)}function R5(e,n,t,r,i,s,o,a){return n.slice(-4)===".bin"?h5(e,r,t,i,s,o,a):SU(e,r,t,i,s,o,a)}function M5(e,n,t,r,i,s,o,a){return n.slice(-4)===".bin"?_5(e,r,t,i,s,o,a):g5(e,r,t,i,s,o,a)}function O5(e,n,t,r,i,s,o,a){return n.slice(-4)===".bin"?HB(e,r,t,i,s,o,a):$B(e,r,t,i,s,o,a)}function F5(e,n,t,r,i,s,o,a){return n.slice(-4)===".bin"?jB(e,r,t,i,s,o,a):VB(e,r,t,i,s,o,a)}function P5(e,n,t,r){return n.slice(-4)===".bin"?rB(e,t,r):Q8(e,t,r)}function L5(e,n,t){return EC(e,t)}function B5(e,n,t){return n.slice(-4)===".bin"?x8(e,t):v8(e,t)}function U5(e,n,t){return n.slice(-4)===".bin"?LB(e,t):RB(e,t)}function j5(e,n,t){return n.slice(-4)===".bin"?AB(e,n,t):DB(e,n,t)}function V5(e,n,t,r){return t.slice(-4)===".bin"?kB(e,n,t,r):void 0}function H5(e,n,t){return n.slice(-4)===".bin"?CB(e,n,t):SB(e,n,t)}var LC=/([\w:]+)=((?:")([^"]*)(?:")|(?:')([^']*)(?:'))/g,BC=/([\w:]+)=((?:")(?:[^"]*)(?:")|(?:')(?:[^']*)(?:'))/;function gr(e,n){var t=e.split(/\s+/),r=[];if(n||(r[0]=t[0]),t.length===1)return r;var i=e.match(LC),s,o,a,c;if(i)for(c=0;c!=i.length;++c)s=i[c].match(BC),(o=s[1].indexOf(":"))===-1?r[s[1]]=s[2].slice(1,s[2].length-1):(s[1].slice(0,6)==="xmlns:"?a="xmlns"+s[1].slice(6):a=s[1].slice(o+1),r[a]=s[2].slice(1,s[2].length-1));return r}function $5(e){var n=e.split(/\s+/),t={};if(n.length===1)return t;var r=e.match(LC),i,s,o,a;if(r)for(a=0;a!=r.length;++a)i=r[a].match(BC),(s=i[1].indexOf(":"))===-1?t[i[1]]=i[2].slice(1,i[2].length-1):(i[1].slice(0,6)==="xmlns:"?o="xmlns"+i[1].slice(6):o=i[1].slice(s+1),t[o]=i[2].slice(1,i[2].length-1));return t}var Jc;function W5(e,n){var t=Jc[e]||Xe(e);return t==="General"?Bs(n):tr(t,n)}function z5(e,n,t,r){var i=r;switch((t[0].match(/dt:dt="([\w.]+)"/)||["",""])[1]){case"boolean":i=ft(r);break;case"i2":case"int":i=parseInt(r,10);break;case"r4":case"float":i=parseFloat(r);break;case"date":case"dateTime.tz":i=Wt(r);break;case"i8":case"string":case"fixed":case"uuid":case"bin.base64":break;default:throw new Error("bad custprop:"+t[0])}e[Xe(n)]=i}function G5(e,n,t){if(e.t!=="z"){if(!t||t.cellText!==!1)try{e.t==="e"?e.w=e.w||zs[e.v]:n==="General"?e.t==="n"?(e.v|0)===e.v?e.w=e.v.toString(10):e.w=el(e.v):e.w=Bs(e.v):e.w=W5(n||"General",e.v)}catch(s){if(t.WTF)throw s}try{var r=Jc[n]||n||"General";if(t.cellNF&&(e.z=r),t.cellDates&&e.t=="n"&&ua(r)){var i=Fs(e.v);i&&(e.t="d",e.v=new Date(i.y,i.m-1,i.d,i.H,i.M,i.S,i.u))}}catch(s){if(t.WTF)throw s}}}function q5(e,n,t){if(t.cellStyles&&n.Interior){var r=n.Interior;r.Pattern&&(r.patternType=z8[r.Pattern]||r.Pattern)}e[n.ID]=n}function K5(e,n,t,r,i,s,o,a,c,l){var u="General",f=r.StyleID,d={};l=l||{};var h=[],m=0;for(f===void 0&&a&&(f=a.StyleID),f===void 0&&o&&(f=o.StyleID);s[f]!==void 0&&(s[f].nf&&(u=s[f].nf),s[f].Interior&&h.push(s[f].Interior),!!s[f].Parent);)f=s[f].Parent;switch(t.Type){case"Boolean":r.t="b",r.v=ft(e);break;case"String":r.t="s",r.r=AT(Xe(e)),r.v=e.indexOf("<")>-1?Xe(n||e).replace(/<.*?>/g,""):r.r;break;case"DateTime":e.slice(-1)!="Z"&&(e+="Z"),r.v=(Wt(e)-new Date(Date.UTC(1899,11,30)))/(24*60*60*1e3),r.v!==r.v?r.v=Xe(e):r.v<60&&(r.v=r.v-1),(!u||u=="General")&&(u="yyyy-mm-dd");case"Number":r.v===void 0&&(r.v=+e),r.t||(r.t="n");break;case"Error":r.t="e",r.v=eC[e],l.cellText!==!1&&(r.w=e);break;default:e==""&&n==""?r.t="z":(r.t="s",r.v=AT(n||e));break}if(G5(r,u,l),l.cellFormula!==!1)if(r.Formula){var p=Xe(r.Formula);p.charCodeAt(0)==61&&(p=p.slice(1)),r.f=sa(p,i),delete r.Formula,r.ArrayRange=="RC"?r.F=sa("RC:RC",i):r.ArrayRange&&(r.F=sa(r.ArrayRange,i),c.push([_t(r.F),r.F]))}else for(m=0;m<c.length;++m)i.r>=c[m][0].s.r&&i.r<=c[m][0].e.r&&i.c>=c[m][0].s.c&&i.c<=c[m][0].e.c&&(r.F=c[m][1]);l.cellStyles&&(h.forEach(function(g){!d.patternType&&g.patternType&&(d.patternType=g.patternType)}),r.s=d),r.StyleID!==void 0&&(r.ixfe=r.StyleID)}function Y5(e){e.t=e.v||"",e.t=e.t.replace(/\r\n/g,`
`).replace(/\r/g,`
`),e.v=e.w=e.ixfe=void 0}function ag(e,n){var t=n||{};kI();var r=Vc(Ag(e));(t.type=="binary"||t.type=="array"||t.type=="base64")&&(typeof nt<"u"?r=nt.utils.decode(65001,ug(r)):r=ct(r));var i=r.slice(0,1024).toLowerCase(),s=!1;if(i=i.replace(/".*?"/g,""),(i.indexOf(">")&1023)>Math.min(i.indexOf(",")&1023,i.indexOf(";")&1023)){var o=en(t);return o.type="string",rl.to_workbook(r,o)}if(i.indexOf("<?xml")==-1&&["html","table","head","meta","script","style","div"].forEach(function(xt){i.indexOf("<"+xt)>=0&&(s=!0)}),s)return ij(r,t);Jc={"General Number":"General","General Date":Ae[22],"Long Date":"dddd, mmmm dd, yyyy","Medium Date":Ae[15],"Short Date":Ae[14],"Long Time":Ae[19],"Medium Time":Ae[18],"Short Time":Ae[20],Currency:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',Fixed:Ae[2],Standard:Ae[4],Percent:Ae[10],Scientific:Ae[11],"Yes/No":'"Yes";"Yes";"No";@',"True/False":'"True";"True";"False";@',"On/Off":'"Yes";"Yes";"No";@'};var a,c=[],l;Nt!=null&&t.dense==null&&(t.dense=Nt);var u={},f=[],d=t.dense?[]:{},h="",m={},p={},g=gr('<Data ss:Type="String">'),w=0,C=0,_=0,M={s:{r:2e6,c:2e6},e:{r:0,c:0}},V={},A={},S="",F=0,N=[],H={},W={},O=0,Q=[],pe=[],ne={},_e=[],fe,qe=!1,se=[],me=[],G={},b=0,U=0,R={Sheets:[],WBProps:{date1904:!1}},k={};nl.lastIndex=0,r=r.replace(/<!--([\s\S]*?)-->/mg,"");for(var q="";a=nl.exec(r);)switch(a[3]=(q=a[3]).toLowerCase()){case"data":if(q=="data"){if(a[1]==="/"){if((l=c.pop())[0]!==a[3])throw new Error("Bad state: "+l.join("|"))}else a[0].charAt(a[0].length-2)!=="/"&&c.push([a[3],!0]);break}if(c[c.length-1][1])break;a[1]==="/"?K5(r.slice(w,a.index),S,g,c[c.length-1][0]=="comment"?ne:m,{c:C,r:_},V,_e[C],p,se,t):(S="",g=gr(a[0]),w=a.index+a[0].length);break;case"cell":if(a[1]==="/")if(pe.length>0&&(m.c=pe),(!t.sheetRows||t.sheetRows>_)&&m.v!==void 0&&(t.dense?(d[_]||(d[_]=[]),d[_][C]=m):d[Ot(C)+tn(_)]=m),m.HRef&&(m.l={Target:Xe(m.HRef)},m.HRefScreenTip&&(m.l.Tooltip=m.HRefScreenTip),delete m.HRef,delete m.HRefScreenTip),(m.MergeAcross||m.MergeDown)&&(b=C+(parseInt(m.MergeAcross,10)|0),U=_+(parseInt(m.MergeDown,10)|0),N.push({s:{c:C,r:_},e:{c:b,r:U}})),!t.sheetStubs)m.MergeAcross?C=b+1:++C;else if(m.MergeAcross||m.MergeDown){for(var ce=C;ce<=b;++ce)for(var ie=_;ie<=U;++ie)(ce>C||ie>_)&&(t.dense?(d[ie]||(d[ie]=[]),d[ie][ce]={t:"z"}):d[Ot(ce)+tn(ie)]={t:"z"});C=b+1}else++C;else m=$5(a[0]),m.Index&&(C=+m.Index-1),C<M.s.c&&(M.s.c=C),C>M.e.c&&(M.e.c=C),a[0].slice(-2)==="/>"&&++C,pe=[];break;case"row":a[1]==="/"||a[0].slice(-2)==="/>"?(_<M.s.r&&(M.s.r=_),_>M.e.r&&(M.e.r=_),a[0].slice(-2)==="/>"&&(p=gr(a[0]),p.Index&&(_=+p.Index-1)),C=0,++_):(p=gr(a[0]),p.Index&&(_=+p.Index-1),G={},(p.AutoFitHeight=="0"||p.Height)&&(G.hpx=parseInt(p.Height,10),G.hpt=wC(G.hpx),me[_]=G),p.Hidden=="1"&&(G.hidden=!0,me[_]=G));break;case"worksheet":if(a[1]==="/"){if((l=c.pop())[0]!==a[3])throw new Error("Bad state: "+l.join("|"));f.push(h),M.s.r<=M.e.r&&M.s.c<=M.e.c&&(d["!ref"]=Ge(M),t.sheetRows&&t.sheetRows<=M.e.r&&(d["!fullref"]=d["!ref"],M.e.r=t.sheetRows-1,d["!ref"]=Ge(M))),N.length&&(d["!merges"]=N),_e.length>0&&(d["!cols"]=_e),me.length>0&&(d["!rows"]=me),u[h]=d}else M={s:{r:2e6,c:2e6},e:{r:0,c:0}},_=C=0,c.push([a[3],!1]),l=gr(a[0]),h=Xe(l.Name),d=t.dense?[]:{},N=[],se=[],me=[],k={name:h,Hidden:0},R.Sheets.push(k);break;case"table":if(a[1]==="/"){if((l=c.pop())[0]!==a[3])throw new Error("Bad state: "+l.join("|"))}else{if(a[0].slice(-2)=="/>")break;c.push([a[3],!1]),_e=[],qe=!1}break;case"style":a[1]==="/"?q5(V,A,t):A=gr(a[0]);break;case"numberformat":A.nf=Xe(gr(a[0]).Format||"General"),Jc[A.nf]&&(A.nf=Jc[A.nf]);for(var ae=0;ae!=392&&Ae[ae]!=A.nf;++ae);if(ae==392){for(ae=57;ae!=392;++ae)if(Ae[ae]==null){Ps(A.nf,ae);break}}break;case"column":if(c[c.length-1][0]!=="table")break;if(fe=gr(a[0]),fe.Hidden&&(fe.hidden=!0,delete fe.Hidden),fe.Width&&(fe.wpx=parseInt(fe.Width,10)),!qe&&fe.wpx>10){qe=!0,yn=xC;for(var K=0;K<_e.length;++K)_e[K]&&la(_e[K])}qe&&la(fe),_e[fe.Index-1||_e.length]=fe;for(var je=0;je<+fe.Span;++je)_e[_e.length]=en(fe);break;case"namedrange":if(a[1]==="/")break;R.Names||(R.Names=[]);var D=Ee(a[0]),dt={Name:D.Name,Ref:sa(D.RefersTo.slice(1),{r:0,c:0})};R.Sheets.length>0&&(dt.Sheet=R.Sheets.length-1),R.Names.push(dt);break;case"namedcell":break;case"b":break;case"i":break;case"u":break;case"s":break;case"em":break;case"h2":break;case"h3":break;case"sub":break;case"sup":break;case"span":break;case"alignment":break;case"borders":break;case"border":break;case"font":if(a[0].slice(-2)==="/>")break;a[1]==="/"?S+=r.slice(F,a.index):F=a.index+a[0].length;break;case"interior":if(!t.cellStyles)break;A.Interior=gr(a[0]);break;case"protection":break;case"author":case"title":case"description":case"created":case"keywords":case"subject":case"category":case"company":case"lastauthor":case"lastsaved":case"lastprinted":case"version":case"revision":case"totaltime":case"hyperlinkbase":case"manager":case"contentstatus":case"identifier":case"language":case"appname":if(a[0].slice(-2)==="/>")break;a[1]==="/"?R4(H,q,r.slice(O,a.index)):O=a.index+a[0].length;break;case"paragraphs":break;case"styles":case"workbook":if(a[1]==="/"){if((l=c.pop())[0]!==a[3])throw new Error("Bad state: "+l.join("|"))}else c.push([a[3],!1]);break;case"comment":if(a[1]==="/"){if((l=c.pop())[0]!==a[3])throw new Error("Bad state: "+l.join("|"));Y5(ne),pe.push(ne)}else c.push([a[3],!1]),l=gr(a[0]),ne={a:l.Author};break;case"autofilter":if(a[1]==="/"){if((l=c.pop())[0]!==a[3])throw new Error("Bad state: "+l.join("|"))}else if(a[0].charAt(a[0].length-2)!=="/"){var Ke=gr(a[0]);d["!autofilter"]={ref:sa(Ke.Range).replace(/\$/g,"")},c.push([a[3],!0])}break;case"name":break;case"datavalidation":if(a[1]==="/"){if((l=c.pop())[0]!==a[3])throw new Error("Bad state: "+l.join("|"))}else a[0].charAt(a[0].length-2)!=="/"&&c.push([a[3],!0]);break;case"pixelsperinch":break;case"componentoptions":case"documentproperties":case"customdocumentproperties":case"officedocumentsettings":case"pivottable":case"pivotcache":case"names":case"mapinfo":case"pagebreaks":case"querytable":case"sorting":case"schema":case"conditionalformatting":case"smarttagtype":case"smarttags":case"excelworkbook":case"workbookoptions":case"worksheetoptions":if(a[1]==="/"){if((l=c.pop())[0]!==a[3])throw new Error("Bad state: "+l.join("|"))}else a[0].charAt(a[0].length-2)!=="/"&&c.push([a[3],!0]);break;case"null":break;default:if(c.length==0&&a[3]=="document"||c.length==0&&a[3]=="uof")return hI(r,t);var st=!0;switch(c[c.length-1][0]){case"officedocumentsettings":switch(a[3]){case"allowpng":break;case"removepersonalinformation":break;case"downloadcomponents":break;case"locationofcomponents":break;case"colors":break;case"color":break;case"index":break;case"rgb":break;case"targetscreensize":break;case"readonlyrecommended":break;default:st=!1}break;case"componentoptions":switch(a[3]){case"toolbar":break;case"hideofficelogo":break;case"spreadsheetautofit":break;case"label":break;case"caption":break;case"maxheight":break;case"maxwidth":break;case"nextsheetnumber":break;default:st=!1}break;case"excelworkbook":switch(a[3]){case"date1904":R.WBProps.date1904=!0;break;case"windowheight":break;case"windowwidth":break;case"windowtopx":break;case"windowtopy":break;case"tabratio":break;case"protectstructure":break;case"protectwindow":break;case"protectwindows":break;case"activesheet":break;case"displayinknotes":break;case"firstvisiblesheet":break;case"supbook":break;case"sheetname":break;case"sheetindex":break;case"sheetindexfirst":break;case"sheetindexlast":break;case"dll":break;case"acceptlabelsinformulas":break;case"donotsavelinkvalues":break;case"iteration":break;case"maxiterations":break;case"maxchange":break;case"path":break;case"xct":break;case"count":break;case"selectedsheets":break;case"calculation":break;case"uncalced":break;case"startupprompt":break;case"crn":break;case"externname":break;case"formula":break;case"colfirst":break;case"collast":break;case"wantadvise":break;case"boolean":break;case"error":break;case"text":break;case"ole":break;case"noautorecover":break;case"publishobjects":break;case"donotcalculatebeforesave":break;case"number":break;case"refmoder1c1":break;case"embedsavesmarttags":break;default:st=!1}break;case"workbookoptions":switch(a[3]){case"owcversion":break;case"height":break;case"width":break;default:st=!1}break;case"worksheetoptions":switch(a[3]){case"visible":if(a[0].slice(-2)!=="/>")if(a[1]==="/")switch(r.slice(O,a.index)){case"SheetHidden":k.Hidden=1;break;case"SheetVeryHidden":k.Hidden=2;break}else O=a.index+a[0].length;break;case"header":d["!margins"]||Zc(d["!margins"]={},"xlml"),isNaN(+Ee(a[0]).Margin)||(d["!margins"].header=+Ee(a[0]).Margin);break;case"footer":d["!margins"]||Zc(d["!margins"]={},"xlml"),isNaN(+Ee(a[0]).Margin)||(d["!margins"].footer=+Ee(a[0]).Margin);break;case"pagemargins":var Pe=Ee(a[0]);d["!margins"]||Zc(d["!margins"]={},"xlml"),isNaN(+Pe.Top)||(d["!margins"].top=+Pe.Top),isNaN(+Pe.Left)||(d["!margins"].left=+Pe.Left),isNaN(+Pe.Right)||(d["!margins"].right=+Pe.Right),isNaN(+Pe.Bottom)||(d["!margins"].bottom=+Pe.Bottom);break;case"displayrighttoleft":R.Views||(R.Views=[]),R.Views[0]||(R.Views[0]={}),R.Views[0].RTL=!0;break;case"freezepanes":break;case"frozennosplit":break;case"splithorizontal":case"splitvertical":break;case"donotdisplaygridlines":break;case"activerow":break;case"activecol":break;case"toprowbottompane":break;case"leftcolumnrightpane":break;case"unsynced":break;case"print":break;case"printerrors":break;case"panes":break;case"scale":break;case"pane":break;case"number":break;case"layout":break;case"pagesetup":break;case"selected":break;case"protectobjects":break;case"enableselection":break;case"protectscenarios":break;case"validprinterinfo":break;case"horizontalresolution":break;case"verticalresolution":break;case"numberofcopies":break;case"activepane":break;case"toprowvisible":break;case"leftcolumnvisible":break;case"fittopage":break;case"rangeselection":break;case"papersizeindex":break;case"pagelayoutzoom":break;case"pagebreakzoom":break;case"filteron":break;case"fitwidth":break;case"fitheight":break;case"commentslayout":break;case"zoom":break;case"lefttoright":break;case"gridlines":break;case"allowsort":break;case"allowfilter":break;case"allowinsertrows":break;case"allowdeleterows":break;case"allowinsertcols":break;case"allowdeletecols":break;case"allowinserthyperlinks":break;case"allowformatcells":break;case"allowsizecols":break;case"allowsizerows":break;case"nosummaryrowsbelowdetail":d["!outline"]||(d["!outline"]={}),d["!outline"].above=!0;break;case"tabcolorindex":break;case"donotdisplayheadings":break;case"showpagelayoutzoom":break;case"nosummarycolumnsrightdetail":d["!outline"]||(d["!outline"]={}),d["!outline"].left=!0;break;case"blackandwhite":break;case"donotdisplayzeros":break;case"displaypagebreak":break;case"rowcolheadings":break;case"donotdisplayoutline":break;case"noorientation":break;case"allowusepivottables":break;case"zeroheight":break;case"viewablerange":break;case"selection":break;case"protectcontents":break;default:st=!1}break;case"pivottable":case"pivotcache":switch(a[3]){case"immediateitemsondrop":break;case"showpagemultipleitemlabel":break;case"compactrowindent":break;case"location":break;case"pivotfield":break;case"orientation":break;case"layoutform":break;case"layoutsubtotallocation":break;case"layoutcompactrow":break;case"position":break;case"pivotitem":break;case"datatype":break;case"datafield":break;case"sourcename":break;case"parentfield":break;case"ptlineitems":break;case"ptlineitem":break;case"countofsameitems":break;case"item":break;case"itemtype":break;case"ptsource":break;case"cacheindex":break;case"consolidationreference":break;case"filename":break;case"reference":break;case"nocolumngrand":break;case"norowgrand":break;case"blanklineafteritems":break;case"hidden":break;case"subtotal":break;case"basefield":break;case"mapchilditems":break;case"function":break;case"refreshonfileopen":break;case"printsettitles":break;case"mergelabels":break;case"defaultversion":break;case"refreshname":break;case"refreshdate":break;case"refreshdatecopy":break;case"versionlastrefresh":break;case"versionlastupdate":break;case"versionupdateablemin":break;case"versionrefreshablemin":break;case"calculation":break;default:st=!1}break;case"pagebreaks":switch(a[3]){case"colbreaks":break;case"colbreak":break;case"rowbreaks":break;case"rowbreak":break;case"colstart":break;case"colend":break;case"rowend":break;default:st=!1}break;case"autofilter":switch(a[3]){case"autofiltercolumn":break;case"autofiltercondition":break;case"autofilterand":break;case"autofilteror":break;default:st=!1}break;case"querytable":switch(a[3]){case"id":break;case"autoformatfont":break;case"autoformatpattern":break;case"querysource":break;case"querytype":break;case"enableredirections":break;case"refreshedinxl9":break;case"urlstring":break;case"htmltables":break;case"connection":break;case"commandtext":break;case"refreshinfo":break;case"notitles":break;case"nextid":break;case"columninfo":break;case"overwritecells":break;case"donotpromptforfile":break;case"textwizardsettings":break;case"source":break;case"number":break;case"decimal":break;case"thousandseparator":break;case"trailingminusnumbers":break;case"formatsettings":break;case"fieldtype":break;case"delimiters":break;case"tab":break;case"comma":break;case"autoformatname":break;case"versionlastedit":break;case"versionlastrefresh":break;default:st=!1}break;case"datavalidation":switch(a[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;case"cellrangelist":break;default:st=!1}break;case"sorting":case"conditionalformatting":switch(a[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"cellrangelist":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;default:st=!1}break;case"mapinfo":case"schema":case"data":switch(a[3]){case"map":break;case"entry":break;case"range":break;case"xpath":break;case"field":break;case"xsdtype":break;case"filteron":break;case"aggregate":break;case"elementtype":break;case"attributetype":break;case"schema":case"element":case"complextype":case"datatype":case"all":case"attribute":case"extends":break;case"row":break;default:st=!1}break;case"smarttags":break;default:st=!1;break}if(st||a[3].match(/!\[CDATA/))break;if(!c[c.length-1][1])throw"Unrecognized tag: "+a[3]+"|"+c.join("|");if(c[c.length-1][0]==="customdocumentproperties"){if(a[0].slice(-2)==="/>")break;a[1]==="/"?z5(W,q,Q,r.slice(O,a.index)):(Q=a,O=a.index+a[0].length);break}if(t.WTF)throw"Unrecognized tag: "+a[3]+"|"+c.join("|")}var oe={};return!t.bookSheets&&!t.bookProps&&(oe.Sheets=u),oe.SheetNames=f,oe.Workbook=R,oe.SSF=en(Ae),oe.Props=H,oe.Custprops=W,oe}function gg(e,n){switch(Kg(n=n||{}),n.type||"base64"){case"base64":return ag(jn(e),n);case"binary":case"buffer":case"file":return ag(e,n);case"array":return ag(Hs(e),n)}}function X5(e){var n={},t=e.content;if(t.l=28,n.AnsiUserType=t.read_shift(0,"lpstr-ansi"),n.AnsiClipboardFormat=u4(t),t.length-t.l<=4)return n;var r=t.read_shift(4);if(r==0||r>40||(t.l-=4,n.Reserved1=t.read_shift(0,"lpstr-ansi"),t.length-t.l<=4)||(r=t.read_shift(4),r!==1907505652)||(n.UnicodeClipboardFormat=f4(t),r=t.read_shift(4),r==0||r>40))return n;t.l-=4,n.Reserved2=t.read_shift(0,"lpwstr")}var Q5=[60,1084,2066,2165,2175];function Z5(e,n,t,r,i){var s=r,o=[],a=t.slice(t.l,t.l+s);if(i&&i.enc&&i.enc.insitu&&a.length>0)switch(e){case 9:case 521:case 1033:case 2057:case 47:case 405:case 225:case 406:case 312:case 404:case 10:break;case 133:break;default:i.enc.insitu(a)}o.push(a),t.l+=s;for(var c=pi(t,t.l),l=vg[c],u=0;l!=null&&Q5.indexOf(c)>-1;)s=pi(t,t.l+2),u=t.l+4,c==2066?u+=4:(c==2165||c==2175)&&(u+=12),a=t.slice(u,t.l+4+s),o.push(a),t.l+=4+s,l=vg[c=pi(t,t.l)];var f=Gi(o);Jt(f,0);var d=0;f.lens=[];for(var h=0;h<o.length;++h)f.lens.push(d),d+=o[h].length;if(f.length<r)throw"XLS Record 0x"+e.toString(16)+" Truncated: "+f.length+" < "+r;return n.f(f,f.length,i)}function Hr(e,n,t){if(e.t!=="z"&&e.XF){var r=0;try{r=e.z||e.XF.numFmtId||0,n.cellNF&&(e.z=Ae[r])}catch(s){if(n.WTF)throw s}if(!n||n.cellText!==!1)try{e.t==="e"?e.w=e.w||zs[e.v]:r===0||r=="General"?e.t==="n"?(e.v|0)===e.v?e.w=e.v.toString(10):e.w=el(e.v):e.w=Bs(e.v):e.w=tr(r,e.v,{date1904:!!t,dateNF:n&&n.dateNF})}catch(s){if(n.WTF)throw s}if(n.cellDates&&r&&e.t=="n"&&ua(Ae[r]||String(r))){var i=Fs(e.v);i&&(e.t="d",e.v=new Date(i.y,i.m-1,i.d,i.H,i.M,i.S,i.u))}}}function md(e,n,t){return{v:e,ixfe:n,t}}function J5(e,n){var t={opts:{}},r={};Nt!=null&&n.dense==null&&(n.dense=Nt);var i=n.dense?[]:{},s={},o={},a=null,c=[],l="",u={},f,d="",h,m,p,g,w={},C=[],_,M,V=[],A=[],S={Sheets:[],WBProps:{date1904:!1},Views:[{}]},F={},N=function(Re){return Re<8?Ls[Re]:Re<64&&A[Re-8]||Ls[Re]},H=function(Re,yt,$n){var Mt=yt.XF.data;if(!(!Mt||!Mt.patternType||!$n||!$n.cellStyles)){yt.s={},yt.s.patternType=Mt.patternType;var fs;(fs=il(N(Mt.icvFore)))&&(yt.s.fgColor={rgb:fs}),(fs=il(N(Mt.icvBack)))&&(yt.s.bgColor={rgb:fs})}},W=function(Re,yt,$n){if(!(G>1)&&!($n.sheetRows&&Re.r>=$n.sheetRows)){if($n.cellStyles&&yt.XF&&yt.XF.data&&H(Re,yt,$n),delete yt.ixfe,delete yt.XF,f=Re,d=Ce(Re),(!o||!o.s||!o.e)&&(o={s:{r:0,c:0},e:{r:0,c:0}}),Re.r<o.s.r&&(o.s.r=Re.r),Re.c<o.s.c&&(o.s.c=Re.c),Re.r+1>o.e.r&&(o.e.r=Re.r+1),Re.c+1>o.e.c&&(o.e.c=Re.c+1),$n.cellFormula&&yt.f){for(var Mt=0;Mt<C.length;++Mt)if(!(C[Mt][0].s.c>Re.c||C[Mt][0].s.r>Re.r)&&!(C[Mt][0].e.c<Re.c||C[Mt][0].e.r<Re.r)){yt.F=Ge(C[Mt][0]),(C[Mt][0].s.c!=Re.c||C[Mt][0].s.r!=Re.r)&&delete yt.f,yt.f&&(yt.f=""+an(C[Mt][1],o,Re,se,O));break}}$n.dense?(i[Re.r]||(i[Re.r]=[]),i[Re.r][Re.c]=yt):i[d]=yt}},O={enc:!1,sbcch:0,snames:[],sharedf:w,arrayf:C,rrtabid:[],lastuser:"",biff:8,codepage:0,winlocked:0,cellStyles:!!n&&!!n.cellStyles,WTF:!!n&&!!n.wtf};n.password&&(O.password=n.password);var Q,pe=[],ne=[],_e=[],fe=[],qe=!1,se=[];se.SheetNames=O.snames,se.sharedf=O.sharedf,se.arrayf=O.arrayf,se.names=[],se.XTI=[];var me=0,G=0,b=0,U=[],R=[],k;O.codepage=1200,xr(1200);for(var q=!1;e.l<e.length-1;){var ce=e.l,ie=e.read_shift(2);if(ie===0&&me===10)break;var ae=e.l===e.length?0:e.read_shift(2),K=vg[ie];if(K&&K.f){if(n.bookSheets&&me===133&&ie!==133)break;if(me=ie,K.r===2||K.r==12){var je=e.read_shift(2);if(ae-=2,!O.enc&&je!==ie&&((je&255)<<8|je>>8)!==ie)throw new Error("rt mismatch: "+je+"!="+ie);K.r==12&&(e.l+=10,ae-=10)}var D={};if(ie===10?D=K.f(e,ae,O):D=Z5(ie,K,e,ae,O),G==0&&[9,521,1033,2057].indexOf(me)===-1)continue;switch(ie){case 34:t.opts.Date1904=S.WBProps.date1904=D;break;case 134:t.opts.WriteProtect=!0;break;case 47:if(O.enc||(e.l=0),O.enc=D,!n.password)throw new Error("File is password-protected");if(D.valid==null)throw new Error("Encryption scheme unsupported");if(!D.valid)throw new Error("Password is incorrect");break;case 92:O.lastuser=D;break;case 66:var dt=Number(D);switch(dt){case 21010:dt=1200;break;case 32768:dt=1e4;break;case 32769:dt=1252;break}xr(O.codepage=dt),q=!0;break;case 317:O.rrtabid=D;break;case 25:O.winlocked=D;break;case 439:t.opts.RefreshAll=D;break;case 12:t.opts.CalcCount=D;break;case 16:t.opts.CalcDelta=D;break;case 17:t.opts.CalcIter=D;break;case 13:t.opts.CalcMode=D;break;case 14:t.opts.CalcPrecision=D;break;case 95:t.opts.CalcSaveRecalc=D;break;case 15:O.CalcRefMode=D;break;case 2211:t.opts.FullCalc=D;break;case 129:D.fDialog&&(i["!type"]="dialog"),D.fBelow||((i["!outline"]||(i["!outline"]={})).above=!0),D.fRight||((i["!outline"]||(i["!outline"]={})).left=!0);break;case 224:V.push(D);break;case 430:se.push([D]),se[se.length-1].XTI=[];break;case 35:case 547:se[se.length-1].push(D);break;case 24:case 536:k={Name:D.Name,Ref:an(D.rgce,o,null,se,O)},D.itab>0&&(k.Sheet=D.itab-1),se.names.push(k),se[0]||(se[0]=[],se[0].XTI=[]),se[se.length-1].push(D),D.Name=="_xlnm._FilterDatabase"&&D.itab>0&&D.rgce&&D.rgce[0]&&D.rgce[0][0]&&D.rgce[0][0][0]=="PtgArea3d"&&(R[D.itab-1]={ref:Ge(D.rgce[0][0][1][2])});break;case 22:O.ExternCount=D;break;case 23:se.length==0&&(se[0]=[],se[0].XTI=[]),se[se.length-1].XTI=se[se.length-1].XTI.concat(D),se.XTI=se.XTI.concat(D);break;case 2196:if(O.biff<8)break;k!=null&&(k.Comment=D[1]);break;case 18:i["!protect"]=D;break;case 19:D!==0&&O.WTF&&console.error("Password verifier: "+D);break;case 133:s[D.pos]=D,O.snames.push(D.name);break;case 10:{if(--G)break;if(o.e){if(o.e.r>0&&o.e.c>0){if(o.e.r--,o.e.c--,i["!ref"]=Ge(o),n.sheetRows&&n.sheetRows<=o.e.r){var Ke=o.e.r;o.e.r=n.sheetRows-1,i["!fullref"]=i["!ref"],i["!ref"]=Ge(o),o.e.r=Ke}o.e.r++,o.e.c++}pe.length>0&&(i["!merges"]=pe),ne.length>0&&(i["!objects"]=ne),_e.length>0&&(i["!cols"]=_e),fe.length>0&&(i["!rows"]=fe),S.Sheets.push(F)}l===""?u=i:r[l]=i,i=n.dense?[]:{}}break;case 9:case 521:case 1033:case 2057:{if(O.biff===8&&(O.biff={9:2,521:3,1033:4}[ie]||{512:2,768:3,1024:4,1280:5,1536:8,2:2,7:2}[D.BIFFVer]||8),O.biffguess=D.BIFFVer==0,D.BIFFVer==0&&D.dt==4096&&(O.biff=5,q=!0,xr(O.codepage=28591)),O.biff==8&&D.BIFFVer==0&&D.dt==16&&(O.biff=2),G++)break;if(i=n.dense?[]:{},O.biff<8&&!q&&(q=!0,xr(O.codepage=n.codepage||1252)),O.biff<5||D.BIFFVer==0&&D.dt==4096){l===""&&(l="Sheet1"),o={s:{r:0,c:0},e:{r:0,c:0}};var st={pos:e.l-ae,name:l};s[st.pos]=st,O.snames.push(l)}else l=(s[ce]||{name:""}).name;D.dt==32&&(i["!type"]="chart"),D.dt==64&&(i["!type"]="macro"),pe=[],ne=[],O.arrayf=C=[],_e=[],fe=[],qe=!1,F={Hidden:(s[ce]||{hs:0}).hs,name:l}}break;case 515:case 3:case 2:i["!type"]=="chart"&&(n.dense?(i[D.r]||[])[D.c]:i[Ce({c:D.c,r:D.r})])&&++D.c,_={ixfe:D.ixfe,XF:V[D.ixfe]||{},v:D.val,t:"n"},b>0&&(_.z=U[_.ixfe>>8&63]),Hr(_,n,t.opts.Date1904),W({c:D.c,r:D.r},_,n);break;case 5:case 517:_={ixfe:D.ixfe,XF:V[D.ixfe],v:D.val,t:D.t},b>0&&(_.z=U[_.ixfe>>8&63]),Hr(_,n,t.opts.Date1904),W({c:D.c,r:D.r},_,n);break;case 638:_={ixfe:D.ixfe,XF:V[D.ixfe],v:D.rknum,t:"n"},b>0&&(_.z=U[_.ixfe>>8&63]),Hr(_,n,t.opts.Date1904),W({c:D.c,r:D.r},_,n);break;case 189:for(var Pe=D.c;Pe<=D.C;++Pe){var oe=D.rkrec[Pe-D.c][0];_={ixfe:oe,XF:V[oe],v:D.rkrec[Pe-D.c][1],t:"n"},b>0&&(_.z=U[_.ixfe>>8&63]),Hr(_,n,t.opts.Date1904),W({c:Pe,r:D.r},_,n)}break;case 6:case 518:case 1030:{if(D.val=="String"){a=D;break}if(_=md(D.val,D.cell.ixfe,D.tt),_.XF=V[_.ixfe],n.cellFormula){var xt=D.formula;if(xt&&xt[0]&&xt[0][0]&&xt[0][0][0]=="PtgExp"){var Hn=xt[0][0][1][0],Dr=xt[0][0][1][1],Jr=Ce({r:Hn,c:Dr});w[Jr]?_.f=""+an(D.formula,o,D.cell,se,O):_.F=((n.dense?(i[Hn]||[])[Dr]:i[Jr])||{}).F}else _.f=""+an(D.formula,o,D.cell,se,O)}b>0&&(_.z=U[_.ixfe>>8&63]),Hr(_,n,t.opts.Date1904),W(D.cell,_,n),a=D}break;case 7:case 519:if(a)a.val=D,_=md(D,a.cell.ixfe,"s"),_.XF=V[_.ixfe],n.cellFormula&&(_.f=""+an(a.formula,o,a.cell,se,O)),b>0&&(_.z=U[_.ixfe>>8&63]),Hr(_,n,t.opts.Date1904),W(a.cell,_,n),a=null;else throw new Error("String record expects Formula");break;case 33:case 545:{C.push(D);var Ma=Ce(D[0].s);if(h=n.dense?(i[D[0].s.r]||[])[D[0].s.c]:i[Ma],n.cellFormula&&h){if(!a||!Ma||!h)break;h.f=""+an(D[1],o,D[0],se,O),h.F=Ge(D[0])}}break;case 1212:{if(!n.cellFormula)break;if(d){if(!a)break;w[Ce(a.cell)]=D[0],h=n.dense?(i[a.cell.r]||[])[a.cell.c]:i[Ce(a.cell)],(h||{}).f=""+an(D[0],o,f,se,O)}}break;case 253:_=md(c[D.isst].t,D.ixfe,"s"),c[D.isst].h&&(_.h=c[D.isst].h),_.XF=V[_.ixfe],b>0&&(_.z=U[_.ixfe>>8&63]),Hr(_,n,t.opts.Date1904),W({c:D.c,r:D.r},_,n);break;case 513:n.sheetStubs&&(_={ixfe:D.ixfe,XF:V[D.ixfe],t:"z"},b>0&&(_.z=U[_.ixfe>>8&63]),Hr(_,n,t.opts.Date1904),W({c:D.c,r:D.r},_,n));break;case 190:if(n.sheetStubs)for(var Ti=D.c;Ti<=D.C;++Ti){var Mn=D.ixfe[Ti-D.c];_={ixfe:Mn,XF:V[Mn],t:"z"},b>0&&(_.z=U[_.ixfe>>8&63]),Hr(_,n,t.opts.Date1904),W({c:Ti,r:D.r},_,n)}break;case 214:case 516:case 4:_=md(D.val,D.ixfe,"s"),_.XF=V[_.ixfe],b>0&&(_.z=U[_.ixfe>>8&63]),Hr(_,n,t.opts.Date1904),W({c:D.c,r:D.r},_,n);break;case 0:case 512:G===1&&(o=D);break;case 252:c=D;break;case 1054:if(O.biff==4){U[b++]=D[1];for(var ei=0;ei<b+163&&Ae[ei]!=D[1];++ei);ei>=163&&Ps(D[1],b+163)}else Ps(D[1],D[0]);break;case 30:{U[b++]=D;for(var Ii=0;Ii<b+163&&Ae[Ii]!=D;++Ii);Ii>=163&&Ps(D,b+163)}break;case 229:pe=pe.concat(D);break;case 93:ne[D.cmo[0]]=O.lastobj=D;break;case 438:O.lastobj.TxO=D;break;case 127:O.lastobj.ImData=D;break;case 440:for(g=D[0].s.r;g<=D[0].e.r;++g)for(p=D[0].s.c;p<=D[0].e.c;++p)h=n.dense?(i[g]||[])[p]:i[Ce({c:p,r:g})],h&&(h.l=D[1]);break;case 2048:for(g=D[0].s.r;g<=D[0].e.r;++g)for(p=D[0].s.c;p<=D[0].e.c;++p)h=n.dense?(i[g]||[])[p]:i[Ce({c:p,r:g})],h&&h.l&&(h.l.Tooltip=D[1]);break;case 28:{if(O.biff<=5&&O.biff>=2)break;h=n.dense?(i[D[0].r]||[])[D[0].c]:i[Ce(D[0])];var Oa=ne[D[2]];h||(n.dense?(i[D[0].r]||(i[D[0].r]=[]),h=i[D[0].r][D[0].c]={t:"z"}):h=i[Ce(D[0])]={t:"z"},o.e.r=Math.max(o.e.r,D[0].r),o.s.r=Math.min(o.s.r,D[0].r),o.e.c=Math.max(o.e.c,D[0].c),o.s.c=Math.min(o.s.c,D[0].c)),h.c||(h.c=[]),m={a:D[1],t:Oa.TxO.t},h.c.push(m)}break;case 2173:wB(V[D.ixfe],D.ext);break;case 125:{if(!O.cellStyles)break;for(;D.e>=D.s;)_e[D.e--]={width:D.w/256,level:D.level||0,hidden:!!(D.flags&1)},qe||(qe=!0,$g(D.w/256)),la(_e[D.e+1])}break;case 520:{var mn={};D.level!=null&&(fe[D.r]=mn,mn.level=D.level),D.hidden&&(fe[D.r]=mn,mn.hidden=!0),D.hpt&&(fe[D.r]=mn,mn.hpt=D.hpt,mn.hpx=sl(D.hpt))}break;case 38:case 39:case 40:case 41:i["!margins"]||Zc(i["!margins"]={}),i["!margins"][{38:"left",39:"right",40:"top",41:"bottom"}[ie]]=D;break;case 161:i["!margins"]||Zc(i["!margins"]={}),i["!margins"].header=D.header,i["!margins"].footer=D.footer;break;case 574:D.RTL&&(S.Views[0].RTL=!0);break;case 146:A=D;break;case 2198:Q=D;break;case 140:M=D;break;case 442:l?F.CodeName=D||F.name:S.WBProps.CodeName=D||"ThisWorkbook";break}}else K||console.error("Missing Info for XLS Record 0x"+ie.toString(16)),e.l+=ae}return t.SheetNames=zr(s).sort(function(br,Re){return Number(br)-Number(Re)}).map(function(br){return s[br].name}),n.bookSheets||(t.Sheets=r),!t.SheetNames.length&&u["!ref"]?(t.SheetNames.push("Sheet1"),t.Sheets&&(t.Sheets.Sheet1=u)):t.Preamble=u,t.Sheets&&R.forEach(function(br,Re){t.Sheets[t.SheetNames[Re]]["!autofilter"]=br}),t.Strings=c,t.SSF=en(Ae),O.enc&&(t.Encryption=O.enc),Q&&(t.Themes=Q),t.Metadata={},M!==void 0&&(t.Metadata.Country=M),se.names.length>0&&(S.Names=se.names),t.Workbook=S,t}var cI={SI:"e0859ff2f94f6810ab9108002b27b3d9",DSI:"02d5cdd59c2e1b10939708002b2cf9ae",UDI:"05d5cdd59c2e1b10939708002b2cf9ae"};function ej(e,n,t){var r=ze.find(e,"/!DocumentSummaryInformation");if(r&&r.size>0)try{var i=zT(r,v4,cI.DSI);for(var s in i)n[s]=i[s]}catch(l){if(t.WTF)throw l}var o=ze.find(e,"/!SummaryInformation");if(o&&o.size>0)try{var a=zT(o,_4,cI.SI);for(var c in a)n[c]==null&&(n[c]=a[c])}catch(l){if(t.WTF)throw l}n.HeadingPairs&&n.TitlesOfParts&&(nC(n.HeadingPairs,n.TitlesOfParts,n,t),delete n.HeadingPairs,delete n.TitlesOfParts)}function UC(e,n){n||(n={}),Kg(n),_I(),n.codepage&&Eg(n.codepage);var t,r;if(e.FullPaths){if(ze.find(e,"/encryption"))throw new Error("File is password-protected");t=ze.find(e,"!CompObj"),r=ze.find(e,"/Workbook")||ze.find(e,"/Book")}else{switch(n.type){case"base64":e=_r(jn(e));break;case"binary":e=_r(e);break;case"buffer":break;case"array":Array.isArray(e)||(e=Array.prototype.slice.call(e));break}Jt(e,0),r={content:e}}var i,s;if(t&&X5(t),n.bookProps&&!n.bookSheets)i={};else{var o=Ue?"buffer":"array";if(r&&r.content)i=J5(r.content,n);else if((s=ze.find(e,"PerfectOffice_MAIN"))&&s.content)i=Xc.to_workbook(s.content,(n.type=o,n));else if((s=ze.find(e,"NativeContent_MAIN"))&&s.content)i=Xc.to_workbook(s.content,(n.type=o,n));else throw(s=ze.find(e,"MN0"))&&s.content?new Error("Unsupported Works 4 for Mac file"):new Error("Cannot find Workbook stream");n.bookVBA&&e.FullPaths&&ze.find(e,"/_VBA_PROJECT_CUR/VBA/dir")&&(i.vbaraw=UB(e))}var a={};return e.FullPaths&&ej(e,a,n),i.Props=i.Custprops=a,n.bookFiles&&(i.cfb=e),i}var Sd={0:{f:FU},1:{f:UU},2:{f:KU},3:{f:$U},4:{f:VU},5:{f:qU},6:{f:QU},7:{f:zU},8:{f:n5},9:{f:t5},10:{f:JU},11:{f:e5},12:{f:jU},13:{f:YU},14:{f:WU},15:{f:HU},16:{f:OC},17:{f:ZU},18:{f:GU},19:{f:Lg},20:{},21:{},22:{},23:{},24:{},25:{},26:{},27:{},28:{},29:{},30:{},31:{},32:{},33:{},34:{},35:{T:1},36:{T:-1},37:{T:1},38:{T:-1},39:{f:A5},40:{},42:{},43:{f:J8},44:{f:Z8},45:{f:eB},46:{f:nB},47:{f:tB},48:{},49:{f:r4},50:{},51:{f:TB},52:{T:1},53:{T:-1},54:{T:1},55:{T:-1},56:{T:1},57:{T:-1},58:{},59:{},60:{f:pC},62:{f:XU},63:{f:bB},64:{f:f5},65:{},66:{},67:{},68:{},69:{},70:{},128:{},129:{T:1},130:{T:-1},131:{T:1,f:dn,p:0},132:{T:-1},133:{T:1},134:{T:-1},135:{T:1},136:{T:-1},137:{T:1,f:u5},138:{T:-1},139:{T:1},140:{T:-1},141:{T:1},142:{T:-1},143:{T:1},144:{T:-1},145:{T:1},146:{T:-1},147:{f:BU},148:{f:PU,p:16},151:{f:s5},152:{},153:{f:D5},154:{},155:{},156:{f:S5},157:{},158:{},159:{T:1,f:_8},160:{T:-1},161:{T:1,f:Ws},162:{T:-1},163:{T:1},164:{T:-1},165:{T:1},166:{T:-1},167:{},168:{},169:{},170:{},171:{},172:{T:1},173:{T:-1},174:{},175:{},176:{f:r5},177:{T:1},178:{T:-1},179:{T:1},180:{T:-1},181:{T:1},182:{T:-1},183:{T:1},184:{T:-1},185:{T:1},186:{T:-1},187:{T:1},188:{T:-1},189:{T:1},190:{T:-1},191:{T:1},192:{T:-1},193:{T:1},194:{T:-1},195:{T:1},196:{T:-1},197:{T:1},198:{T:-1},199:{T:1},200:{T:-1},201:{T:1},202:{T:-1},203:{T:1},204:{T:-1},205:{T:1},206:{T:-1},207:{T:1},208:{T:-1},209:{T:1},210:{T:-1},211:{T:1},212:{T:-1},213:{T:1},214:{T:-1},215:{T:1},216:{T:-1},217:{T:1},218:{T:-1},219:{T:1},220:{T:-1},221:{T:1},222:{T:-1},223:{T:1},224:{T:-1},225:{T:1},226:{T:-1},227:{T:1},228:{T:-1},229:{T:1},230:{T:-1},231:{T:1},232:{T:-1},233:{T:1},234:{T:-1},235:{T:1},236:{T:-1},237:{T:1},238:{T:-1},239:{T:1},240:{T:-1},241:{T:1},242:{T:-1},243:{T:1},244:{T:-1},245:{T:1},246:{T:-1},247:{T:1},248:{T:-1},249:{T:1},250:{T:-1},251:{T:1},252:{T:-1},253:{T:1},254:{T:-1},255:{T:1},256:{T:-1},257:{T:1},258:{T:-1},259:{T:1},260:{T:-1},261:{T:1},262:{T:-1},263:{T:1},264:{T:-1},265:{T:1},266:{T:-1},267:{T:1},268:{T:-1},269:{T:1},270:{T:-1},271:{T:1},272:{T:-1},273:{T:1},274:{T:-1},275:{T:1},276:{T:-1},277:{},278:{T:1},279:{T:-1},280:{T:1},281:{T:-1},282:{T:1},283:{T:1},284:{T:-1},285:{T:1},286:{T:-1},287:{T:1},288:{T:-1},289:{T:1},290:{T:-1},291:{T:1},292:{T:-1},293:{T:1},294:{T:-1},295:{T:1},296:{T:-1},297:{T:1},298:{T:-1},299:{T:1},300:{T:-1},301:{T:1},302:{T:-1},303:{T:1},304:{T:-1},305:{T:1},306:{T:-1},307:{T:1},308:{T:-1},309:{T:1},310:{T:-1},311:{T:1},312:{T:-1},313:{T:-1},314:{T:1},315:{T:-1},316:{T:1},317:{T:-1},318:{T:1},319:{T:-1},320:{T:1},321:{T:-1},322:{T:1},323:{T:-1},324:{T:1},325:{T:-1},326:{T:1},327:{T:-1},328:{T:1},329:{T:-1},330:{T:1},331:{T:-1},332:{T:1},333:{T:-1},334:{T:1},335:{f:EB},336:{T:-1},337:{f:IB,T:1},338:{T:-1},339:{T:1},340:{T:-1},341:{T:1},342:{T:-1},343:{T:1},344:{T:-1},345:{T:1},346:{T:-1},347:{T:1},348:{T:-1},349:{T:1},350:{T:-1},351:{},352:{},353:{T:1},354:{T:-1},355:{f:dg},357:{},358:{},359:{},360:{T:1},361:{},362:{f:hC},363:{},364:{},366:{},367:{},368:{},369:{},370:{},371:{},372:{T:1},373:{T:-1},374:{T:1},375:{T:-1},376:{T:1},377:{T:-1},378:{T:1},379:{T:-1},380:{T:1},381:{T:-1},382:{T:1},383:{T:-1},384:{T:1},385:{T:-1},386:{T:1},387:{T:-1},388:{T:1},389:{T:-1},390:{T:1},391:{T:-1},392:{T:1},393:{T:-1},394:{T:1},395:{T:-1},396:{},397:{},398:{},399:{},400:{},401:{T:1},403:{},404:{},405:{},406:{},407:{},408:{},409:{},410:{},411:{},412:{},413:{},414:{},415:{},416:{},417:{},418:{},419:{},420:{},421:{},422:{T:1},423:{T:1},424:{T:-1},425:{T:-1},426:{f:o5},427:{f:a5},428:{},429:{T:1},430:{T:-1},431:{T:1},432:{T:-1},433:{T:1},434:{T:-1},435:{T:1},436:{T:-1},437:{T:1},438:{T:-1},439:{T:1},440:{T:-1},441:{T:1},442:{T:-1},443:{T:1},444:{T:-1},445:{T:1},446:{T:-1},447:{T:1},448:{T:-1},449:{T:1},450:{T:-1},451:{T:1},452:{T:-1},453:{T:1},454:{T:-1},455:{T:1},456:{T:-1},457:{T:1},458:{T:-1},459:{T:1},460:{T:-1},461:{T:1},462:{T:-1},463:{T:1},464:{T:-1},465:{T:1},466:{T:-1},467:{T:1},468:{T:-1},469:{T:1},470:{T:-1},471:{},472:{},473:{T:1},474:{T:-1},475:{},476:{f:l5},477:{},478:{},479:{T:1},480:{T:-1},481:{T:1},482:{T:-1},483:{T:1},484:{T:-1},485:{f:LU},486:{T:1},487:{T:-1},488:{T:1},489:{T:-1},490:{T:1},491:{T:-1},492:{T:1},493:{T:-1},494:{f:i5},495:{T:1},496:{T:-1},497:{T:1},498:{T:-1},499:{},500:{T:1},501:{T:-1},502:{T:1},503:{T:-1},504:{},505:{T:1},506:{T:-1},507:{},508:{T:1},509:{T:-1},510:{T:1},511:{T:-1},512:{},513:{},514:{T:1},515:{T:-1},516:{T:1},517:{T:-1},518:{T:1},519:{T:-1},520:{T:1},521:{T:-1},522:{},523:{},524:{},525:{},526:{},527:{},528:{T:1},529:{T:-1},530:{T:1},531:{T:-1},532:{T:1},533:{T:-1},534:{},535:{},536:{},537:{},538:{T:1},539:{T:-1},540:{T:1},541:{T:-1},542:{T:1},548:{},549:{},550:{f:dg},551:{},552:{},553:{},554:{T:1},555:{T:-1},556:{T:1},557:{T:-1},558:{T:1},559:{T:-1},560:{T:1},561:{T:-1},562:{},564:{},565:{T:1},566:{T:-1},569:{T:1},570:{T:-1},572:{},573:{T:1},574:{T:-1},577:{},578:{},579:{},580:{},581:{},582:{},583:{},584:{},585:{},586:{},587:{},588:{T:-1},589:{},590:{T:1},591:{T:-1},592:{T:1},593:{T:-1},594:{T:1},595:{T:-1},596:{},597:{T:1},598:{T:-1},599:{T:1},600:{T:-1},601:{T:1},602:{T:-1},603:{T:1},604:{T:-1},605:{T:1},606:{T:-1},607:{},608:{T:1},609:{T:-1},610:{},611:{T:1},612:{T:-1},613:{T:1},614:{T:-1},615:{T:1},616:{T:-1},617:{T:1},618:{T:-1},619:{T:1},620:{T:-1},625:{},626:{T:1},627:{T:-1},628:{T:1},629:{T:-1},630:{T:1},631:{T:-1},632:{f:PB},633:{T:1},634:{T:-1},635:{T:1,f:FB},636:{T:-1},637:{f:s4},638:{T:1},639:{},640:{T:-1},641:{T:1},642:{T:-1},643:{T:1},644:{},645:{T:-1},646:{T:1},648:{T:1},649:{},650:{T:-1},651:{f:v5},652:{},653:{T:1},654:{T:-1},655:{T:1},656:{T:-1},657:{T:1},658:{T:-1},659:{},660:{T:1},661:{},662:{T:-1},663:{},664:{T:1},665:{},666:{T:-1},667:{},668:{},669:{},671:{T:1},672:{T:-1},673:{T:1},674:{T:-1},675:{},676:{},677:{},678:{},679:{},680:{},681:{},1024:{},1025:{},1026:{T:1},1027:{T:-1},1028:{T:1},1029:{T:-1},1030:{},1031:{T:1},1032:{T:-1},1033:{T:1},1034:{T:-1},1035:{},1036:{},1037:{},1038:{T:1},1039:{T:-1},1040:{},1041:{T:1},1042:{T:-1},1043:{},1044:{},1045:{},1046:{T:1},1047:{T:-1},1048:{T:1},1049:{T:-1},1050:{},1051:{T:1},1052:{T:1},1053:{f:d5},1054:{T:1},1055:{},1056:{T:1},1057:{T:-1},1058:{T:1},1059:{T:-1},1061:{},1062:{T:1},1063:{T:-1},1064:{T:1},1065:{T:-1},1066:{T:1},1067:{T:-1},1068:{T:1},1069:{T:-1},1070:{T:1},1071:{T:-1},1072:{T:1},1073:{T:-1},1075:{T:1},1076:{T:-1},1077:{T:1},1078:{T:-1},1079:{T:1},1080:{T:-1},1081:{T:1},1082:{T:-1},1083:{T:1},1084:{T:-1},1085:{},1086:{T:1},1087:{T:-1},1088:{T:1},1089:{T:-1},1090:{T:1},1091:{T:-1},1092:{T:1},1093:{T:-1},1094:{T:1},1095:{T:-1},1096:{},1097:{T:1},1098:{},1099:{T:-1},1100:{T:1},1101:{T:-1},1102:{},1103:{},1104:{},1105:{},1111:{},1112:{},1113:{T:1},1114:{T:-1},1115:{T:1},1116:{T:-1},1117:{},1118:{T:1},1119:{T:-1},1120:{T:1},1121:{T:-1},1122:{T:1},1123:{T:-1},1124:{T:1},1125:{T:-1},1126:{},1128:{T:1},1129:{T:-1},1130:{},1131:{T:1},1132:{T:-1},1133:{T:1},1134:{T:-1},1135:{T:1},1136:{T:-1},1137:{T:1},1138:{T:-1},1139:{T:1},1140:{T:-1},1141:{},1142:{T:1},1143:{T:-1},1144:{T:1},1145:{T:-1},1146:{},1147:{T:1},1148:{T:-1},1149:{T:1},1150:{T:-1},1152:{T:1},1153:{T:-1},1154:{T:-1},1155:{T:-1},1156:{T:-1},1157:{T:1},1158:{T:-1},1159:{T:1},1160:{T:-1},1161:{T:1},1162:{T:-1},1163:{T:1},1164:{T:-1},1165:{T:1},1166:{T:-1},1167:{T:1},1168:{T:-1},1169:{T:1},1170:{T:-1},1171:{},1172:{T:1},1173:{T:-1},1177:{},1178:{T:1},1180:{},1181:{},1182:{},2048:{T:1},2049:{T:-1},2050:{},2051:{T:1},2052:{T:-1},2053:{},2054:{},2055:{T:1},2056:{T:-1},2057:{T:1},2058:{T:-1},2060:{},2067:{},2068:{T:1},2069:{T:-1},2070:{},2071:{},2072:{T:1},2073:{T:-1},2075:{},2076:{},2077:{T:1},2078:{T:-1},2079:{},2080:{T:1},2081:{T:-1},2082:{},2083:{T:1},2084:{T:-1},2085:{T:1},2086:{T:-1},2087:{T:1},2088:{T:-1},2089:{T:1},2090:{T:-1},2091:{},2092:{},2093:{T:1},2094:{T:-1},2095:{},2096:{T:1},2097:{T:-1},2098:{T:1},2099:{T:-1},2100:{T:1},2101:{T:-1},2102:{},2103:{T:1},2104:{T:-1},2105:{},2106:{T:1},2107:{T:-1},2108:{},2109:{T:1},2110:{T:-1},2111:{T:1},2112:{T:-1},2113:{T:1},2114:{T:-1},2115:{},2116:{},2117:{},2118:{T:1},2119:{T:-1},2120:{},2121:{T:1},2122:{T:-1},2123:{T:1},2124:{T:-1},2125:{},2126:{T:1},2127:{T:-1},2128:{},2129:{T:1},2130:{T:-1},2131:{T:1},2132:{T:-1},2133:{T:1},2134:{},2135:{},2136:{},2137:{T:1},2138:{T:-1},2139:{T:1},2140:{T:-1},2141:{},3072:{},3073:{},4096:{T:1},4097:{T:-1},5002:{T:1},5003:{T:-1},5081:{T:1},5082:{T:-1},5083:{},5084:{T:1},5085:{T:-1},5086:{T:1},5087:{T:-1},5088:{},5089:{},5090:{},5092:{T:1},5093:{T:-1},5094:{},5095:{T:1},5096:{T:-1},5097:{},5099:{},65535:{n:""}},vg={6:{f:sg},10:{f:zi},12:{f:At},13:{f:At},14:{f:Tt},15:{f:Tt},16:{f:cn},17:{f:Tt},18:{f:Tt},19:{f:At},20:{f:YT},21:{f:YT},23:{f:hC},24:{f:QT},25:{f:Tt},26:{},27:{},28:{f:M3},29:{},34:{f:Tt},35:{f:XT},38:{f:cn},39:{f:cn},40:{f:cn},41:{f:cn},42:{f:Tt},43:{f:Tt},47:{f:L8},49:{f:p3},51:{f:At},60:{},61:{f:f3},64:{f:Tt},65:{f:h3},66:{f:At},77:{},80:{},81:{},82:{},85:{f:At},89:{},90:{},91:{},92:{f:r3},93:{f:F3},94:{},95:{f:Tt},96:{},97:{},99:{f:Tt},125:{f:pC},128:{f:I3},129:{f:i3},130:{f:At},131:{f:Tt},132:{f:Tt},133:{f:s3},134:{},140:{f:V3},141:{f:At},144:{},146:{f:$3},151:{},152:{},153:{},154:{},155:{},156:{f:At},157:{},158:{},160:{f:K3},161:{f:z3},174:{},175:{},176:{},177:{},178:{},180:{},181:{},182:{},184:{},185:{},189:{f:y3},190:{f:w3},193:{f:zi},197:{},198:{},199:{},200:{},201:{},202:{f:Tt},203:{},204:{},205:{},206:{},207:{},208:{},209:{},210:{},211:{},213:{},215:{},216:{},217:{},218:{f:At},220:{},221:{f:Tt},222:{},224:{f:T3},225:{f:n3},226:{f:zi},227:{},229:{f:O3},233:{},235:{},236:{},237:{},239:{},240:{},241:{},242:{},244:{},245:{},246:{},247:{},248:{},249:{},251:{},252:{f:o3},253:{f:m3},255:{f:a3},256:{},259:{},290:{},311:{},312:{},315:{},317:{f:aC},318:{},319:{},320:{},330:{},331:{},333:{},334:{},335:{},336:{},337:{},338:{},339:{},340:{},351:{},352:{f:Tt},353:{f:zi},401:{},402:{},403:{},404:{},405:{},406:{},407:{},408:{},425:{},426:{},427:{},428:{},429:{},430:{f:S3},431:{f:Tt},432:{},433:{},434:{},437:{},438:{f:B3},439:{f:Tt},440:{f:U3},441:{},442:{f:ll},443:{},444:{f:At},445:{},446:{},448:{f:zi},449:{f:u3,r:2},450:{f:zi},512:{f:qT},513:{f:q3},515:{f:C3},516:{f:g3},517:{f:KT},519:{f:Y3},520:{f:c3},523:{},545:{f:ZT},549:{f:GT},566:{},574:{f:d3},638:{f:x3},659:{},1048:{},1054:{f:v3},1084:{},1212:{f:k3},2048:{f:j3},2049:{},2050:{},2051:{},2052:{},2053:{},2054:{},2055:{},2056:{},2057:{f:dd},2058:{},2059:{},2060:{},2061:{},2062:{},2063:{},2064:{},2066:{},2067:{},2128:{},2129:{},2130:{},2131:{},2132:{},2133:{},2134:{},2135:{},2136:{},2137:{},2138:{},2146:{},2147:{r:12},2148:{},2149:{},2150:{},2151:{f:zi},2152:{},2154:{},2155:{},2156:{},2161:{},2162:{},2164:{},2165:{},2166:{},2167:{},2168:{},2169:{},2170:{},2171:{},2172:{f:W3,r:12},2173:{f:yB,r:12},2174:{},2175:{},2180:{},2181:{},2182:{},2183:{},2184:{},2185:{},2186:{},2187:{},2188:{f:Tt,r:12},2189:{},2190:{r:12},2191:{},2192:{},2194:{},2195:{},2196:{f:A3,r:12},2197:{},2198:{f:pB,r:12},2199:{},2200:{},2201:{},2202:{f:N3,r:12},2203:{f:zi},2204:{},2205:{},2206:{},2207:{},2211:{f:l3},2212:{},2213:{},2214:{},2215:{},4097:{},4098:{},4099:{},4102:{},4103:{},4105:{},4106:{},4107:{},4108:{},4109:{},4116:{},4117:{},4118:{},4119:{},4120:{},4121:{},4122:{},4123:{},4124:{},4125:{},4126:{},4127:{},4128:{},4129:{},4130:{},4132:{},4133:{},4134:{f:At},4135:{},4146:{},4147:{},4148:{},4149:{},4154:{},4156:{},4157:{},4158:{},4159:{},4160:{},4161:{},4163:{},4164:{f:G3},4165:{},4166:{},4168:{},4170:{},4171:{},4174:{},4175:{},4176:{},4177:{},4187:{},4188:{f:H3},4189:{},4191:{},4192:{},4193:{},4194:{},4195:{},4196:{},4197:{},4198:{},4199:{},4200:{},0:{f:qT},1:{},2:{f:J3},3:{f:Z3},4:{f:Q3},5:{f:KT},7:{f:e8},8:{},9:{f:dd},11:{},22:{f:At},30:{f:_3},31:{},32:{},33:{f:ZT},36:{},37:{f:GT},50:{f:t8},62:{},52:{},67:{},68:{f:At},69:{},86:{},126:{},127:{f:X3},135:{},136:{},137:{},145:{},148:{},149:{},150:{},169:{},171:{},188:{},191:{},192:{},194:{},195:{},214:{f:n8},223:{},234:{},354:{},421:{},518:{f:sg},521:{f:dd},536:{f:QT},547:{f:XT},561:{},579:{},1030:{f:sg},1033:{f:dd},1091:{},2157:{},2163:{},2177:{},2240:{},2241:{},2242:{},2243:{},2244:{},2245:{},2246:{},2247:{},2248:{},2249:{},2250:{},2251:{},2262:{r:12},29282:{}};function vr(e,n,t,r){var i=n;if(!isNaN(i)){var s=r||(t||[]).length||0,o=e.next(4);o.write_shift(2,i),o.write_shift(2,s),s>0&&KI(t)&&e.push(t)}}function lI(e,n){var t=n||{};Nt!=null&&t.dense==null&&(t.dense=Nt);var r=t.dense?[]:{};e=e.replace(/<!--.*?-->/g,"");var i=e.match(/<table/i);if(!i)throw new Error("Invalid HTML: could not find <table>");var s=e.match(/<\/table/i),o=i.index,a=s&&s.index||e.length,c=CL(e.slice(o,a),/(:?<tr[^>]*>)/i,"<tr>"),l=-1,u=0,f=0,d=0,h={s:{r:1e7,c:1e7},e:{r:0,c:0}},m=[];for(o=0;o<c.length;++o){var p=c[o].trim(),g=p.slice(0,3).toLowerCase();if(g=="<tr"){if(++l,t.sheetRows&&t.sheetRows<=l){--l;break}u=0;continue}if(!(g!="<td"&&g!="<th")){var w=p.split(/<\/t[dh]>/i);for(a=0;a<w.length;++a){var C=w[a].trim();if(C.match(/<t[dh]/i)){for(var _=C,M=0;_.charAt(0)=="<"&&(M=_.indexOf(">"))>-1;)_=_.slice(M+1);for(var V=0;V<m.length;++V){var A=m[V];A.s.c==u&&A.s.r<l&&l<=A.e.r&&(u=A.e.c+1,V=-1)}var S=Ee(C.slice(0,C.indexOf(">")));d=S.colspan?+S.colspan:1,((f=+S.rowspan)>1||d>1)&&m.push({s:{r:l,c:u},e:{r:l+(f||1)-1,c:u+d-1}});var F=S.t||S["data-t"]||"";if(!_.length){u+=d;continue}if(_=jI(_),h.s.r>l&&(h.s.r=l),h.e.r<l&&(h.e.r=l),h.s.c>u&&(h.s.c=u),h.e.c<u&&(h.e.c=u),!_.length){u+=d;continue}var N={t:"s",v:_};t.raw||!_.trim().length||F=="s"||(_==="TRUE"?N={t:"b",v:!0}:_==="FALSE"?N={t:"b",v:!1}:isNaN(wr(_))?isNaN(ca(_).getDate())||(N={t:"d",v:Wt(_)},t.cellDates||(N={t:"n",v:En(N.v)}),N.z=t.dateNF||Ae[14]):N={t:"n",v:wr(_)}),t.dense?(r[l]||(r[l]=[]),r[l][u]=N):r[Ce({r:l,c:u})]=N,u+=d}}}}return r["!ref"]=Ge(h),m.length&&(r["!merges"]=m),r}function tj(e,n,t,r){for(var i=e["!merges"]||[],s=[],o=n.s.c;o<=n.e.c;++o){for(var a=0,c=0,l=0;l<i.length;++l)if(!(i[l].s.r>t||i[l].s.c>o)&&!(i[l].e.r<t||i[l].e.c<o)){if(i[l].s.r<t||i[l].s.c<o){a=-1;break}a=i[l].e.r-i[l].s.r+1,c=i[l].e.c-i[l].s.c+1;break}if(!(a<0)){var u=Ce({r:t,c:o}),f=r.dense?(e[t]||[])[o]:e[u],d=f&&f.v!=null&&(f.h||bg(f.w||(vi(f),f.w)||""))||"",h={};a>1&&(h.rowspan=a),c>1&&(h.colspan=c),r.editable?d='<span contenteditable="true">'+d+"</span>":f&&(h["data-t"]=f&&f.t||"z",f.v!=null&&(h["data-v"]=f.v),f.z!=null&&(h["data-z"]=f.z),f.l&&(f.l.Target||"#").charAt(0)!="#"&&(d='<a href="'+f.l.Target+'">'+d+"</a>")),h.id=(r.id||"sjs")+"-"+u,s.push(jL("td",d,h))}}var m="<tr>";return m+s.join("")+"</tr>"}var nj='<html><head><meta charset="utf-8"/><title>SheetJS Table Export</title></head><body>',rj="</body></html>";function ij(e,n){var t=e.match(/<table[\s\S]*?>[\s\S]*?<\/table>/gi);if(!t||t.length==0)throw new Error("Invalid HTML: could not find <table>");if(t.length==1)return Zi(lI(t[0],n),n);var r=Xg();return t.forEach(function(i,s){Qg(r,lI(i,n),"Sheet"+(s+1))}),r}function sj(e,n,t){var r=[];return r.join("")+"<table"+(t&&t.id?' id="'+t.id+'"':"")+">"}function oj(e,n){var t=n||{},r=t.header!=null?t.header:nj,i=t.footer!=null?t.footer:rj,s=[r],o=da(e["!ref"]);t.dense=Array.isArray(e),s.push(sj(e,o,t));for(var a=o.s.r;a<=o.e.r;++a)s.push(tj(e,o,a,t));return s.push("</table>"+i),s.join("")}function jC(e,n,t){var r=t||{};Nt!=null&&(r.dense=Nt);var i=0,s=0;if(r.origin!=null)if(typeof r.origin=="number")i=r.origin;else{var o=typeof r.origin=="string"?wn(r.origin):r.origin;i=o.r,s=o.c}var a=n.getElementsByTagName("tr"),c=Math.min(r.sheetRows||1e7,a.length),l={s:{r:0,c:0},e:{r:i,c:s}};if(e["!ref"]){var u=da(e["!ref"]);l.s.r=Math.min(l.s.r,u.s.r),l.s.c=Math.min(l.s.c,u.s.c),l.e.r=Math.max(l.e.r,u.e.r),l.e.c=Math.max(l.e.c,u.e.c),i==-1&&(l.e.r=i=u.e.r+1)}var f=[],d=0,h=e["!rows"]||(e["!rows"]=[]),m=0,p=0,g=0,w=0,C=0,_=0;for(e["!cols"]||(e["!cols"]=[]);m<a.length&&p<c;++m){var M=a[m];if(uI(M)){if(r.display)continue;h[p]={hidden:!0}}var V=M.children;for(g=w=0;g<V.length;++g){var A=V[g];if(!(r.display&&uI(A))){var S=A.hasAttribute("data-v")?A.getAttribute("data-v"):A.hasAttribute("v")?A.getAttribute("v"):jI(A.innerHTML),F=A.getAttribute("data-z")||A.getAttribute("z");for(d=0;d<f.length;++d){var N=f[d];N.s.c==w+s&&N.s.r<p+i&&p+i<=N.e.r&&(w=N.e.c+1-s,d=-1)}_=+A.getAttribute("colspan")||1,((C=+A.getAttribute("rowspan")||1)>1||_>1)&&f.push({s:{r:p+i,c:w+s},e:{r:p+i+(C||1)-1,c:w+s+(_||1)-1}});var H={t:"s",v:S},W=A.getAttribute("data-t")||A.getAttribute("t")||"";S!=null&&(S.length==0?H.t=W||"z":r.raw||S.trim().length==0||W=="s"||(S==="TRUE"?H={t:"b",v:!0}:S==="FALSE"?H={t:"b",v:!1}:isNaN(wr(S))?isNaN(ca(S).getDate())||(H={t:"d",v:Wt(S)},r.cellDates||(H={t:"n",v:En(H.v)}),H.z=r.dateNF||Ae[14]):H={t:"n",v:wr(S)})),H.z===void 0&&F!=null&&(H.z=F);var O="",Q=A.getElementsByTagName("A");if(Q&&Q.length)for(var pe=0;pe<Q.length&&!(Q[pe].hasAttribute("href")&&(O=Q[pe].getAttribute("href"),O.charAt(0)!="#"));++pe);O&&O.charAt(0)!="#"&&(H.l={Target:O}),r.dense?(e[p+i]||(e[p+i]=[]),e[p+i][w+s]=H):e[Ce({c:w+s,r:p+i})]=H,l.e.c<w+s&&(l.e.c=w+s),w+=_}}++p}return f.length&&(e["!merges"]=(e["!merges"]||[]).concat(f)),l.e.r=Math.max(l.e.r,p-1+i),e["!ref"]=Ge(l),p>=c&&(e["!fullref"]=Ge((l.e.r=a.length-m+p-1+i,l))),e}function VC(e,n){var t=n||{},r=t.dense?[]:{};return jC(r,e,n)}function aj(e,n){return Zi(VC(e,n),n)}function uI(e){var n="",t=cj(e);return t&&(n=t(e).getPropertyValue("display")),n||(n=e.style&&e.style.display),n==="none"}function cj(e){return e.ownerDocument.defaultView&&typeof e.ownerDocument.defaultView.getComputedStyle=="function"?e.ownerDocument.defaultView.getComputedStyle:typeof getComputedStyle=="function"?getComputedStyle:null}function lj(e){var n=e.replace(/[\t\r\n]/g," ").trim().replace(/ +/g," ").replace(/<text:s\/>/g," ").replace(/<text:s text:c="(\d+)"\/>/g,function(r,i){return Array(parseInt(i,10)+1).join(" ")}).replace(/<text:tab[^>]*\/>/g,"	").replace(/<text:line-break\/>/g,`
`),t=Xe(n.replace(/<[^>]*>/g,""));return[t]}var fI={day:["d","dd"],month:["m","mm"],year:["y","yy"],hours:["h","hh"],minutes:["m","mm"],seconds:["s","ss"],"am-pm":["A/P","AM/PM"],"day-of-week":["ddd","dddd"],era:["e","ee"],quarter:["\\Qm",'m\\"th quarter"']};function HC(e,n){var t=n||{};Nt!=null&&t.dense==null&&(t.dense=Nt);var r=Ag(e),i=[],s,o,a={name:""},c="",l=0,u,f,d={},h=[],m=t.dense?[]:{},p,g,w={value:""},C="",_=0,M,V=[],A=-1,S=-1,F={s:{r:1e6,c:1e7},e:{r:0,c:0}},N=0,H={},W=[],O={},Q=0,pe=0,ne=[],_e=1,fe=1,qe=[],se={Names:[]},me={},G=["",""],b=[],U={},R="",k=0,q=!1,ce=!1,ie=0;for(nl.lastIndex=0,r=r.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");p=nl.exec(r);)switch(p[3]=p[3].replace(/_.*$/,"")){case"table":case"\u5DE5\u4F5C\u8868":p[1]==="/"?(F.e.c>=F.s.c&&F.e.r>=F.s.r?m["!ref"]=Ge(F):m["!ref"]="A1:A1",t.sheetRows>0&&t.sheetRows<=F.e.r&&(m["!fullref"]=m["!ref"],F.e.r=t.sheetRows-1,m["!ref"]=Ge(F)),W.length&&(m["!merges"]=W),ne.length&&(m["!rows"]=ne),u.name=u.\u540D\u79F0||u.name,typeof JSON<"u"&&JSON.stringify(u),h.push(u.name),d[u.name]=m,ce=!1):p[0].charAt(p[0].length-2)!=="/"&&(u=Ee(p[0],!1),A=S=-1,F.s.r=F.s.c=1e7,F.e.r=F.e.c=0,m=t.dense?[]:{},W=[],ne=[],ce=!0);break;case"table-row-group":p[1]==="/"?--N:++N;break;case"table-row":case"\u884C":if(p[1]==="/"){A+=_e,_e=1;break}if(f=Ee(p[0],!1),f.\u884C\u53F7?A=f.\u884C\u53F7-1:A==-1&&(A=0),_e=+f["number-rows-repeated"]||1,_e<10)for(ie=0;ie<_e;++ie)N>0&&(ne[A+ie]={level:N});S=-1;break;case"covered-table-cell":p[1]!=="/"&&++S,t.sheetStubs&&(t.dense?(m[A]||(m[A]=[]),m[A][S]={t:"z"}):m[Ce({r:A,c:S})]={t:"z"}),C="",V=[];break;case"table-cell":case"\u6570\u636E":if(p[0].charAt(p[0].length-2)==="/")++S,w=Ee(p[0],!1),fe=parseInt(w["number-columns-repeated"]||"1",10),g={t:"z",v:null},w.formula&&t.cellFormula!=!1&&(g.f=sI(Xe(w.formula))),(w.\u6570\u636E\u7C7B\u578B||w["value-type"])=="string"&&(g.t="s",g.v=Xe(w["string-value"]||""),t.dense?(m[A]||(m[A]=[]),m[A][S]=g):m[Ce({r:A,c:S})]=g),S+=fe-1;else if(p[1]!=="/"){++S,C="",_=0,V=[],fe=1;var ae=_e?A+_e-1:A;if(S>F.e.c&&(F.e.c=S),S<F.s.c&&(F.s.c=S),A<F.s.r&&(F.s.r=A),ae>F.e.r&&(F.e.r=ae),w=Ee(p[0],!1),b=[],U={},g={t:w.\u6570\u636E\u7C7B\u578B||w["value-type"],v:null},t.cellFormula)if(w.formula&&(w.formula=Xe(w.formula)),w["number-matrix-columns-spanned"]&&w["number-matrix-rows-spanned"]&&(Q=parseInt(w["number-matrix-rows-spanned"],10)||0,pe=parseInt(w["number-matrix-columns-spanned"],10)||0,O={s:{r:A,c:S},e:{r:A+Q-1,c:S+pe-1}},g.F=Ge(O),qe.push([O,g.F])),w.formula)g.f=sI(w.formula);else for(ie=0;ie<qe.length;++ie)A>=qe[ie][0].s.r&&A<=qe[ie][0].e.r&&S>=qe[ie][0].s.c&&S<=qe[ie][0].e.c&&(g.F=qe[ie][1]);switch((w["number-columns-spanned"]||w["number-rows-spanned"])&&(Q=parseInt(w["number-rows-spanned"],10)||0,pe=parseInt(w["number-columns-spanned"],10)||0,O={s:{r:A,c:S},e:{r:A+Q-1,c:S+pe-1}},W.push(O)),w["number-columns-repeated"]&&(fe=parseInt(w["number-columns-repeated"],10)),g.t){case"boolean":g.t="b",g.v=ft(w["boolean-value"]);break;case"float":g.t="n",g.v=parseFloat(w.value);break;case"percentage":g.t="n",g.v=parseFloat(w.value);break;case"currency":g.t="n",g.v=parseFloat(w.value);break;case"date":g.t="d",g.v=Wt(w["date-value"]),t.cellDates||(g.t="n",g.v=En(g.v)),g.z="m/d/yy";break;case"time":g.t="n",g.v=EL(w["time-value"])/86400,t.cellDates&&(g.t="d",g.v=bd(g.v)),g.z="HH:MM:SS";break;case"number":g.t="n",g.v=parseFloat(w.\u6570\u636E\u6570\u503C);break;default:if(g.t==="string"||g.t==="text"||!g.t)g.t="s",w["string-value"]!=null&&(C=Xe(w["string-value"]),V=[]);else throw new Error("Unsupported value type "+g.t)}}else{if(q=!1,g.t==="s"&&(g.v=C||"",V.length&&(g.R=V),q=_==0),me.Target&&(g.l=me),b.length>0&&(g.c=b,b=[]),C&&t.cellText!==!1&&(g.w=C),q&&(g.t="z",delete g.v),(!q||t.sheetStubs)&&!(t.sheetRows&&t.sheetRows<=A))for(var K=0;K<_e;++K){if(fe=parseInt(w["number-columns-repeated"]||"1",10),t.dense)for(m[A+K]||(m[A+K]=[]),m[A+K][S]=K==0?g:en(g);--fe>0;)m[A+K][S+fe]=en(g);else for(m[Ce({r:A+K,c:S})]=g;--fe>0;)m[Ce({r:A+K,c:S+fe})]=en(g);F.e.c<=S&&(F.e.c=S)}fe=parseInt(w["number-columns-repeated"]||"1",10),S+=fe-1,fe=0,g={},C="",V=[]}me={};break;case"document":case"document-content":case"\u7535\u5B50\u8868\u683C\u6587\u6863":case"spreadsheet":case"\u4E3B\u4F53":case"scripts":case"styles":case"font-face-decls":case"master-styles":if(p[1]==="/"){if((s=i.pop())[0]!==p[3])throw"Bad state: "+s}else p[0].charAt(p[0].length-2)!=="/"&&i.push([p[3],!0]);break;case"annotation":if(p[1]==="/"){if((s=i.pop())[0]!==p[3])throw"Bad state: "+s;U.t=C,V.length&&(U.R=V),U.a=R,b.push(U)}else p[0].charAt(p[0].length-2)!=="/"&&i.push([p[3],!1]);R="",k=0,C="",_=0,V=[];break;case"creator":p[1]==="/"?R=r.slice(k,p.index):k=p.index+p[0].length;break;case"meta":case"\u5143\u6570\u636E":case"settings":case"config-item-set":case"config-item-map-indexed":case"config-item-map-entry":case"config-item-map-named":case"shapes":case"frame":case"text-box":case"image":case"data-pilot-tables":case"list-style":case"form":case"dde-links":case"event-listeners":case"chart":if(p[1]==="/"){if((s=i.pop())[0]!==p[3])throw"Bad state: "+s}else p[0].charAt(p[0].length-2)!=="/"&&i.push([p[3],!1]);C="",_=0,V=[];break;case"scientific-number":break;case"currency-symbol":break;case"currency-style":break;case"number-style":case"percentage-style":case"date-style":case"time-style":if(p[1]==="/"){if(H[a.name]=c,(s=i.pop())[0]!==p[3])throw"Bad state: "+s}else p[0].charAt(p[0].length-2)!=="/"&&(c="",a=Ee(p[0],!1),i.push([p[3],!0]));break;case"script":break;case"libraries":break;case"automatic-styles":break;case"default-style":case"page-layout":break;case"style":break;case"map":break;case"font-face":break;case"paragraph-properties":break;case"table-properties":break;case"table-column-properties":break;case"table-row-properties":break;case"table-cell-properties":break;case"number":switch(i[i.length-1][0]){case"time-style":case"date-style":o=Ee(p[0],!1),c+=fI[p[3]][o.style==="long"?1:0];break}break;case"fraction":break;case"day":case"month":case"year":case"era":case"day-of-week":case"week-of-year":case"quarter":case"hours":case"minutes":case"seconds":case"am-pm":switch(i[i.length-1][0]){case"time-style":case"date-style":o=Ee(p[0],!1),c+=fI[p[3]][o.style==="long"?1:0];break}break;case"boolean-style":break;case"boolean":break;case"text-style":break;case"text":if(p[0].slice(-2)==="/>")break;if(p[1]==="/")switch(i[i.length-1][0]){case"number-style":case"date-style":case"time-style":c+=r.slice(l,p.index);break}else l=p.index+p[0].length;break;case"named-range":o=Ee(p[0],!1),G=og(o["cell-range-address"]);var je={Name:o.name,Ref:G[0]+"!"+G[1]};ce&&(je.Sheet=h.length),se.Names.push(je);break;case"text-content":break;case"text-properties":break;case"embedded-text":break;case"body":case"\u7535\u5B50\u8868\u683C":break;case"forms":break;case"table-column":break;case"table-header-rows":break;case"table-rows":break;case"table-column-group":break;case"table-header-columns":break;case"table-columns":break;case"null-date":break;case"graphic-properties":break;case"calculation-settings":break;case"named-expressions":break;case"label-range":break;case"label-ranges":break;case"named-expression":break;case"sort":break;case"sort-by":break;case"sort-groups":break;case"tab":break;case"line-break":break;case"span":break;case"p":case"\u6587\u672C\u4E32":if(["master-styles"].indexOf(i[i.length-1][0])>-1)break;if(p[1]==="/"&&(!w||!w["string-value"])){var D=lj(r.slice(_,p.index),M);C=(C.length>0?C+`
`:"")+D[0]}else M=Ee(p[0],!1),_=p.index+p[0].length;break;case"s":break;case"database-range":if(p[1]==="/")break;try{G=og(Ee(p[0])["target-range-address"]),d[G[0]]["!autofilter"]={ref:G[1]}}catch{}break;case"date":break;case"object":break;case"title":case"\u6807\u9898":break;case"desc":break;case"binary-data":break;case"table-source":break;case"scenario":break;case"iteration":break;case"content-validations":break;case"content-validation":break;case"help-message":break;case"error-message":break;case"database-ranges":break;case"filter":break;case"filter-and":break;case"filter-or":break;case"filter-condition":break;case"list-level-style-bullet":break;case"list-level-style-number":break;case"list-level-properties":break;case"sender-firstname":case"sender-lastname":case"sender-initials":case"sender-title":case"sender-position":case"sender-email":case"sender-phone-private":case"sender-fax":case"sender-company":case"sender-phone-work":case"sender-street":case"sender-city":case"sender-postal-code":case"sender-country":case"sender-state-or-province":case"author-name":case"author-initials":case"chapter":case"file-name":case"template-name":case"sheet-name":break;case"event-listener":break;case"initial-creator":case"creation-date":case"print-date":case"generator":case"document-statistic":case"user-defined":case"editing-duration":case"editing-cycles":break;case"config-item":break;case"page-number":break;case"page-count":break;case"time":break;case"cell-range-source":break;case"detective":break;case"operation":break;case"highlighted-range":break;case"data-pilot-table":case"source-cell-range":case"source-service":case"data-pilot-field":case"data-pilot-level":case"data-pilot-subtotals":case"data-pilot-subtotal":case"data-pilot-members":case"data-pilot-member":case"data-pilot-display-info":case"data-pilot-sort-info":case"data-pilot-layout-info":case"data-pilot-field-reference":case"data-pilot-groups":case"data-pilot-group":case"data-pilot-group-member":break;case"rect":break;case"dde-connection-decls":case"dde-connection-decl":case"dde-link":case"dde-source":break;case"properties":break;case"property":break;case"a":if(p[1]!=="/"){if(me=Ee(p[0],!1),!me.href)break;me.Target=Xe(me.href),delete me.href,me.Target.charAt(0)=="#"&&me.Target.indexOf(".")>-1?(G=og(me.Target.slice(1)),me.Target="#"+G[0]+"!"+G[1]):me.Target.match(/^\.\.[\\\/]/)&&(me.Target=me.Target.slice(3))}break;case"table-protection":break;case"data-pilot-grand-total":break;case"office-document-common-attrs":break;default:switch(p[2]){case"dc:":case"calcext:":case"loext:":case"ooo:":case"chartooo:":case"draw:":case"style:":case"chart:":case"form:":case"uof:":case"\u8868:":case"\u5B57:":break;default:if(t.WTF)throw new Error(p)}}var dt={Sheets:d,SheetNames:h,Workbook:se};return t.bookSheets&&delete dt.Sheets,dt}function dI(e,n){n=n||{},er(e,"META-INF/manifest.xml")&&C4(bt(e,"META-INF/manifest.xml"),n);var t=Un(e,"content.xml");if(!t)throw new Error("Missing content.xml in ODS / UOF file");var r=HC(ct(t),n);return er(e,"meta.xml")&&(r.Props=tC(bt(e,"meta.xml"))),r}function hI(e,n){return HC(e,n)}function Gg(e){return new DataView(e.buffer,e.byteOffset,e.byteLength)}function _g(e){return typeof TextDecoder<"u"?new TextDecoder().decode(e):ct(Hs(e))}function xg(e){var n=e.reduce(function(i,s){return i+s.length},0),t=new Uint8Array(n),r=0;return e.forEach(function(i){t.set(i,r),r+=i.length}),t}function pI(e){return e-=e>>1&1431655765,e=(e&858993459)+(e>>2&858993459),(e+(e>>4)&252645135)*16843009>>>24}function uj(e,n){for(var t=(e[n+15]&127)<<7|e[n+14]>>1,r=e[n+14]&1,i=n+13;i>=n;--i)r=r*256+e[i];return(e[n+15]&128?-r:r)*Math.pow(10,t-6176)}function ol(e,n){var t=n?n[0]:0,r=e[t]&127;e:if(e[t++]>=128&&(r|=(e[t]&127)<<7,e[t++]<128||(r|=(e[t]&127)<<14,e[t++]<128)||(r|=(e[t]&127)<<21,e[t++]<128)||(r+=(e[t]&127)*Math.pow(2,28),++t,e[t++]<128)||(r+=(e[t]&127)*Math.pow(2,35),++t,e[t++]<128)||(r+=(e[t]&127)*Math.pow(2,42),++t,e[t++]<128)))break e;return n&&(n[0]=t),r}function Ft(e){var n=0,t=e[n]&127;e:if(e[n++]>=128){if(t|=(e[n]&127)<<7,e[n++]<128||(t|=(e[n]&127)<<14,e[n++]<128)||(t|=(e[n]&127)<<21,e[n++]<128))break e;t|=(e[n]&127)<<28}return t}function ln(e){for(var n=[],t=[0];t[0]<e.length;){var r=t[0],i=ol(e,t),s=i&7;i=Math.floor(i/8);var o=0,a;if(i==0)break;switch(s){case 0:{for(var c=t[0];e[t[0]++]>=128;);a=e.slice(c,t[0])}break;case 5:o=4,a=e.slice(t[0],t[0]+o),t[0]+=o;break;case 1:o=8,a=e.slice(t[0],t[0]+o),t[0]+=o;break;case 2:o=ol(e,t),a=e.slice(t[0],t[0]+o),t[0]+=o;break;case 3:case 4:default:throw new Error("PB Type ".concat(s," for Field ").concat(i," at offset ").concat(r))}var l={data:a,type:s};n[i]==null?n[i]=[l]:n[i].push(l)}return n}function qg(e,n){return e?.map(function(t){return n(t.data)})||[]}function fj(e){for(var n,t=[],r=[0];r[0]<e.length;){var i=ol(e,r),s=ln(e.slice(r[0],r[0]+i));r[0]+=i;var o={id:Ft(s[1][0].data),messages:[]};s[2].forEach(function(a){var c=ln(a.data),l=Ft(c[3][0].data);o.messages.push({meta:c,data:e.slice(r[0],r[0]+l)}),r[0]+=l}),(n=s[3])!=null&&n[0]&&(o.merge=Ft(s[3][0].data)>>>0>0),t.push(o)}return t}function dj(e,n){if(e!=0)throw new Error("Unexpected Snappy chunk type ".concat(e));for(var t=[0],r=ol(n,t),i=[];t[0]<n.length;){var s=n[t[0]]&3;if(s==0){var o=n[t[0]++]>>2;if(o<60)++o;else{var a=o-59;o=n[t[0]],a>1&&(o|=n[t[0]+1]<<8),a>2&&(o|=n[t[0]+2]<<16),a>3&&(o|=n[t[0]+3]<<24),o>>>=0,o++,t[0]+=a}i.push(n.slice(t[0],t[0]+o)),t[0]+=o;continue}else{var c=0,l=0;if(s==1?(l=(n[t[0]]>>2&7)+4,c=(n[t[0]++]&224)<<3,c|=n[t[0]++]):(l=(n[t[0]++]>>2)+1,s==2?(c=n[t[0]]|n[t[0]+1]<<8,t[0]+=2):(c=(n[t[0]]|n[t[0]+1]<<8|n[t[0]+2]<<16|n[t[0]+3]<<24)>>>0,t[0]+=4)),i=[xg(i)],c==0)throw new Error("Invalid offset 0");if(c>i[0].length)throw new Error("Invalid offset beyond length");if(l>=c)for(i.push(i[0].slice(-c)),l-=c;l>=i[i.length-1].length;)i.push(i[i.length-1]),l-=i[i.length-1].length;i.push(i[0].slice(-c,-c+l))}}var u=xg(i);if(u.length!=r)throw new Error("Unexpected length: ".concat(u.length," != ").concat(r));return u}function hj(e){for(var n=[],t=0;t<e.length;){var r=e[t++],i=e[t]|e[t+1]<<8|e[t+2]<<16;t+=3,n.push(dj(r,e.slice(t,t+i))),t+=i}if(t!==e.length)throw new Error("data is not a valid framed stream!");return xg(n)}function pj(e,n,t,r){var i=Gg(e),s=i.getUint32(4,!0),o=(r>1?12:8)+pI(s&(r>1?3470:398))*4,a=-1,c=-1,l=NaN,u=new Date(2001,0,1);s&512&&(a=i.getUint32(o,!0),o+=4),o+=pI(s&(r>1?12288:4096))*4,s&16&&(c=i.getUint32(o,!0),o+=4),s&32&&(l=i.getFloat64(o,!0),o+=8),s&64&&(u.setTime(u.getTime()+i.getFloat64(o,!0)*1e3),o+=8);var f;switch(e[2]){case 0:break;case 2:f={t:"n",v:l};break;case 3:f={t:"s",v:n[c]};break;case 5:f={t:"d",v:u};break;case 6:f={t:"b",v:l>0};break;case 7:f={t:"n",v:l/86400};break;case 8:f={t:"e",v:0};break;case 9:if(a>-1)f={t:"s",v:t[a]};else if(c>-1)f={t:"s",v:n[c]};else if(!isNaN(l))f={t:"n",v:l};else throw new Error("Unsupported cell type ".concat(e.slice(0,4)));break;default:throw new Error("Unsupported cell type ".concat(e.slice(0,4)))}return f}function mj(e,n,t){var r=Gg(e),i=r.getUint32(8,!0),s=12,o=-1,a=-1,c=NaN,l=NaN,u=new Date(2001,0,1);i&1&&(c=uj(e,s),s+=16),i&2&&(l=r.getFloat64(s,!0),s+=8),i&4&&(u.setTime(u.getTime()+r.getFloat64(s,!0)*1e3),s+=8),i&8&&(a=r.getUint32(s,!0),s+=4),i&16&&(o=r.getUint32(s,!0),s+=4);var f;switch(e[1]){case 0:break;case 2:f={t:"n",v:c};break;case 3:f={t:"s",v:n[a]};break;case 5:f={t:"d",v:u};break;case 6:f={t:"b",v:l>0};break;case 7:f={t:"n",v:l/86400};break;case 8:f={t:"e",v:0};break;case 9:if(o>-1)f={t:"s",v:t[o]};else throw new Error("Unsupported cell type ".concat(e[1]," : ").concat(i&31," : ").concat(e.slice(0,4)));break;case 10:f={t:"n",v:c};break;default:throw new Error("Unsupported cell type ".concat(e[1]," : ").concat(i&31," : ").concat(e.slice(0,4)))}return f}function gj(e,n,t){switch(e[0]){case 0:case 1:case 2:case 3:return pj(e,n,t,e[0]);case 5:return mj(e,n,t);default:throw new Error("Unsupported payload version ".concat(e[0]))}}function Yi(e){var n=ln(e);return ol(n[1][0].data)}function mI(e,n){var t=ln(n.data),r=Ft(t[1][0].data),i=t[3],s=[];return(i||[]).forEach(function(o){var a=ln(o.data),c=Ft(a[1][0].data)>>>0;switch(r){case 1:s[c]=_g(a[3][0].data);break;case 8:{var l=e[Yi(a[9][0].data)][0],u=ln(l.data),f=e[Yi(u[1][0].data)][0],d=Ft(f.meta[1][0].data);if(d!=2001)throw new Error("2000 unexpected reference to ".concat(d));var h=ln(f.data);s[c]=h[3].map(function(m){return _g(m.data)}).join("")}break}}),s}function vj(e,n){var t,r,i,s,o,a,c,l,u,f,d,h,m,p,g=ln(e),w=Ft(g[1][0].data)>>>0,C=Ft(g[2][0].data)>>>0,_=((r=(t=g[8])==null?void 0:t[0])==null?void 0:r.data)&&Ft(g[8][0].data)>0||!1,M,V;if((s=(i=g[7])==null?void 0:i[0])!=null&&s.data&&n!=0)M=(a=(o=g[7])==null?void 0:o[0])==null?void 0:a.data,V=(l=(c=g[6])==null?void 0:c[0])==null?void 0:l.data;else if((f=(u=g[4])==null?void 0:u[0])!=null&&f.data&&n!=1)M=(h=(d=g[4])==null?void 0:d[0])==null?void 0:h.data,V=(p=(m=g[3])==null?void 0:m[0])==null?void 0:p.data;else throw"NUMBERS Tile missing ".concat(n," cell storage");for(var A=_?4:1,S=Gg(M),F=[],N=0;N<M.length/2;++N){var H=S.getUint16(N*2,!0);H<65535&&F.push([N,H])}if(F.length!=C)throw"Expected ".concat(C," cells, found ").concat(F.length);var W=[];for(N=0;N<F.length-1;++N)W[F[N][0]]=V.subarray(F[N][1]*A,F[N+1][1]*A);return F.length>=1&&(W[F[F.length-1][0]]=V.subarray(F[F.length-1][1]*A)),{R:w,cells:W}}function _j(e,n){var t,r=ln(n.data),i=(t=r?.[7])!=null&&t[0]?Ft(r[7][0].data)>>>0>0?1:0:-1,s=qg(r[5],function(o){return vj(o,i)});return{nrows:Ft(r[4][0].data)>>>0,data:s.reduce(function(o,a){return o[a.R]||(o[a.R]=[]),a.cells.forEach(function(c,l){if(o[a.R][l])throw new Error("Duplicate cell r=".concat(a.R," c=").concat(l));o[a.R][l]=c}),o},[])}}function xj(e,n,t){var r,i=ln(n.data),s={s:{r:0,c:0},e:{r:0,c:0}};if(s.e.r=(Ft(i[6][0].data)>>>0)-1,s.e.r<0)throw new Error("Invalid row varint ".concat(i[6][0].data));if(s.e.c=(Ft(i[7][0].data)>>>0)-1,s.e.c<0)throw new Error("Invalid col varint ".concat(i[7][0].data));t["!ref"]=Ge(s);var o=ln(i[4][0].data),a=mI(e,e[Yi(o[4][0].data)][0]),c=(r=o[17])!=null&&r[0]?mI(e,e[Yi(o[17][0].data)][0]):[],l=ln(o[3][0].data),u=0;l[1].forEach(function(f){var d=ln(f.data),h=e[Yi(d[2][0].data)][0],m=Ft(h.meta[1][0].data);if(m!=6002)throw new Error("6001 unexpected reference to ".concat(m));var p=_j(e,h);p.data.forEach(function(g,w){g.forEach(function(C,_){var M=Ce({r:u+w,c:_}),V=gj(C,a,c);V&&(t[M]=V)})}),u+=p.nrows})}function yj(e,n){var t=ln(n.data),r={"!ref":"A1"},i=e[Yi(t[2][0].data)],s=Ft(i[0].meta[1][0].data);if(s!=6001)throw new Error("6000 unexpected reference to ".concat(s));return xj(e,i[0],r),r}function wj(e,n){var t,r=ln(n.data),i={name:(t=r[1])!=null&&t[0]?_g(r[1][0].data):"",sheets:[]},s=qg(r[2],Yi);return s.forEach(function(o){e[o].forEach(function(a){var c=Ft(a.meta[1][0].data);c==6e3&&i.sheets.push(yj(e,a))})}),i}function Ej(e,n){var t=Xg(),r=ln(n.data),i=qg(r[1],Yi);if(i.forEach(function(s){e[s].forEach(function(o){var a=Ft(o.meta[1][0].data);if(a==2){var c=wj(e,o);c.sheets.forEach(function(l,u){Qg(t,l,u==0?c.name:c.name+"_"+u,!0)})}})}),t.SheetNames.length==0)throw new Error("Empty NUMBERS file");return t}function cg(e){var n,t,r,i,s={},o=[];if(e.FullPaths.forEach(function(c){if(c.match(/\.iwpv2/))throw new Error("Unsupported password protection")}),e.FileIndex.forEach(function(c){if(c.name.match(/\.iwa$/)){var l;try{l=hj(c.content)}catch(f){return console.log("?? "+c.content.length+" "+(f.message||f))}var u;try{u=fj(l)}catch(f){return console.log("## "+(f.message||f))}u.forEach(function(f){s[f.id]=f.messages,o.push(f.id)})}}),!o.length)throw new Error("File has no messages");var a=((i=(r=(t=(n=s?.[1])==null?void 0:n[0])==null?void 0:t.meta)==null?void 0:r[1])==null?void 0:i[0].data)&&Ft(s[1][0].meta[1][0].data)==1&&s[1][0];if(a||o.forEach(function(c){s[c].forEach(function(l){var u=Ft(l.meta[1][0].data)>>>0;if(u==1)if(!a)a=l;else throw new Error("Document has multiple roots")})}),!a)throw new Error("Cannot find Document root");return Ej(s,a)}function Tj(e){return function(t){for(var r=0;r!=e.length;++r){var i=e[r];t[i[0]]===void 0&&(t[i[0]]=i[1]),i[2]==="n"&&(t[i[0]]=Number(t[i[0]]))}}}function Kg(e){Tj([["cellNF",!1],["cellHTML",!0],["cellFormula",!0],["cellStyles",!1],["cellText",!0],["cellDates",!1],["sheetStubs",!1],["sheetRows",0,"n"],["bookDeps",!1],["bookSheets",!1],["bookProps",!1],["bookFiles",!1],["bookVBA",!1],["password",""],["WTF",!1]])(e)}function Ij(e){return hi.WS.indexOf(e)>-1?"sheet":hi.CS&&e==hi.CS?"chart":hi.DS&&e==hi.DS?"dialog":hi.MS&&e==hi.MS?"macro":e&&e.length?e:"sheet"}function Cj(e,n){if(!e)return 0;try{e=n.map(function(r){return r.id||(r.id=r.strRelID),[r.name,e["!id"][r.id].Target,Ij(e["!id"][r.id].Type)]})}catch{return null}return!e||e.length===0?null:e}function Sj(e,n,t,r,i,s,o,a,c,l,u,f){try{s[r]=Kc(Un(e,t,!0),n);var d=bt(e,n),h;switch(a){case"sheet":h=R5(d,n,i,c,s[r],l,u,f);break;case"chart":if(h=M5(d,n,i,c,s[r],l,u,f),!h||!h["!drawel"])break;var m=$c(h["!drawel"].Target,n),p=hg(m),g=NB(Un(e,m,!0),Kc(Un(e,p,!0),m)),w=$c(g,m),C=hg(w);h=m5(Un(e,w,!0),w,c,Kc(Un(e,C,!0),w),l,h);break;case"macro":h=O5(d,n,i,c,s[r],l,u,f);break;case"dialog":h=F5(d,n,i,c,s[r],l,u,f);break;default:throw new Error("Unrecognized sheet type "+a)}o[r]=h;var _=[];s&&s[r]&&zr(s[r]).forEach(function(M){var V="";if(s[r][M].Type==hi.CMNT){V=$c(s[r][M].Target,n);var A=U5(bt(e,V,!0),V,c);if(!A||!A.length)return;eI(h,A,!1)}s[r][M].Type==hi.TCMNT&&(V=$c(s[r][M].Target,n),_=_.concat(MB(bt(e,V,!0),c)))}),_&&_.length&&eI(h,_,!0,c.people||[])}catch(M){if(c.WTF)throw M}}function Zn(e){return e.charAt(0)=="/"?e.slice(1):e}function Dj(e,n){if(kI(),n=n||{},Kg(n),er(e,"META-INF/manifest.xml")||er(e,"objectdata.xml"))return dI(e,n);if(er(e,"Index/Document.iwa")){if(typeof Uint8Array>"u")throw new Error("NUMBERS file parsing requires Uint8Array support");if(typeof cg<"u"){if(e.FileIndex)return cg(e);var t=ze.utils.cfb_new();return DT(e).forEach(function(pe){DL(t,pe,PI(e,pe))}),cg(t)}throw new Error("Unsupported NUMBERS file")}if(!er(e,"[Content_Types].xml"))throw er(e,"index.xml.gz")?new Error("Unsupported NUMBERS 08 file"):er(e,"index.xml")?new Error("Unsupported NUMBERS 09 file"):new Error("Unsupported ZIP file");var r=DT(e),i=T4(Un(e,"[Content_Types].xml")),s=!1,o,a;if(i.workbooks.length===0&&(a="xl/workbook.xml",bt(e,a,!0)&&i.workbooks.push(a)),i.workbooks.length===0){if(a="xl/workbook.bin",!bt(e,a,!0))throw new Error("Could not find workbook");i.workbooks.push(a),s=!0}i.workbooks[0].slice(-3)=="bin"&&(s=!0);var c={},l={};if(!n.bookSheets&&!n.bookProps){if(Qc=[],i.sst)try{Qc=B5(bt(e,Zn(i.sst)),i.sst,n)}catch(pe){if(n.WTF)throw pe}n.cellStyles&&i.themes.length&&(c=L5(Un(e,i.themes[0].replace(/^\//,""),!0)||"",i.themes[0],n)),i.style&&(l=P5(bt(e,Zn(i.style)),i.style,c,n))}i.links.map(function(pe){try{var ne=Kc(Un(e,hg(Zn(pe))),pe);return V5(bt(e,Zn(pe)),ne,pe,n)}catch{}});var u=N5(bt(e,Zn(i.workbooks[0])),i.workbooks[0],n),f={},d="";i.coreprops.length&&(d=bt(e,Zn(i.coreprops[0]),!0),d&&(f=tC(d)),i.extprops.length!==0&&(d=bt(e,Zn(i.extprops[0]),!0),d&&b4(d,f,n)));var h={};(!n.bookSheets||n.bookProps)&&i.custprops.length!==0&&(d=Un(e,Zn(i.custprops[0]),!0),d&&(h=k4(d,n)));var m={};if((n.bookSheets||n.bookProps)&&(u.Sheets?o=u.Sheets.map(function(ne){return ne.name}):f.Worksheets&&f.SheetNames.length>0&&(o=f.SheetNames),n.bookProps&&(m.Props=f,m.Custprops=h),n.bookSheets&&typeof o<"u"&&(m.SheetNames=o),n.bookSheets?m.SheetNames:n.bookProps))return m;o={};var p={};n.bookDeps&&i.calcchain&&(p=j5(bt(e,Zn(i.calcchain)),i.calcchain,n));var g=0,w={},C,_;{var M=u.Sheets;f.Worksheets=M.length,f.SheetNames=[];for(var V=0;V!=M.length;++V)f.SheetNames[V]=M[V].name}var A=s?"bin":"xml",S=i.workbooks[0].lastIndexOf("/"),F=(i.workbooks[0].slice(0,S+1)+"_rels/"+i.workbooks[0].slice(S+1)+".rels").replace(/^\//,"");er(e,F)||(F="xl/_rels/workbook."+A+".rels");var N=Kc(Un(e,F,!0),F.replace(/_rels.*/,"s5s"));(i.metadata||[]).length>=1&&(n.xlmeta=H5(bt(e,Zn(i.metadata[0])),i.metadata[0],n)),(i.people||[]).length>=1&&(n.people=OB(bt(e,Zn(i.people[0])),n)),N&&(N=Cj(N,u.Sheets));var H=bt(e,"xl/worksheets/sheet.xml",!0)?1:0;e:for(g=0;g!=f.Worksheets;++g){var W="sheet";if(N&&N[g]?(C="xl/"+N[g][1].replace(/[\/]?xl\//,""),er(e,C)||(C=N[g][1]),er(e,C)||(C=F.replace(/_rels\/.*$/,"")+N[g][1]),W=N[g][2]):(C="xl/worksheets/sheet"+(g+1-H)+"."+A,C=C.replace(/sheet0\./,"sheet.")),_=C.replace(/^(.*)(\/)([^\/]*)$/,"$1/_rels/$3.rels"),n&&n.sheets!=null)switch(typeof n.sheets){case"number":if(g!=n.sheets)continue e;break;case"string":if(f.SheetNames[g].toLowerCase()!=n.sheets.toLowerCase())continue e;break;default:if(Array.isArray&&Array.isArray(n.sheets)){for(var O=!1,Q=0;Q!=n.sheets.length;++Q)typeof n.sheets[Q]=="number"&&n.sheets[Q]==g&&(O=1),typeof n.sheets[Q]=="string"&&n.sheets[Q].toLowerCase()==f.SheetNames[g].toLowerCase()&&(O=1);if(!O)continue e}}Sj(e,C,_,f.SheetNames[g],g,w,o,W,n,u,c,l)}return m={Directory:i,Workbook:u,Props:f,Custprops:h,Deps:p,Sheets:o,SheetNames:f.SheetNames,Strings:Qc,Styles:l,Themes:c,SSF:en(Ae)},n&&n.bookFiles&&(e.files?(m.keys=r,m.files=e.files):(m.keys=[],m.files={},e.FullPaths.forEach(function(pe,ne){pe=pe.replace(/^Root Entry[\/]/,""),m.keys.push(pe),m.files[pe]=e.FileIndex[ne]}))),n&&n.bookVBA&&(i.vba.length>0?m.vbaraw=bt(e,Zn(i.vba[0]),!0):i.defaults&&i.defaults.bin===BB&&(m.vbaraw=bt(e,"xl/vbaProject.bin",!0))),m}function bj(e,n){var t=n||{},r="Workbook",i=ze.find(e,r);try{if(r="/!DataSpaces/Version",i=ze.find(e,r),!i||!i.content)throw new Error("ECMA-376 Encrypted file missing "+r);if(y8(i.content),r="/!DataSpaces/DataSpaceMap",i=ze.find(e,r),!i||!i.content)throw new Error("ECMA-376 Encrypted file missing "+r);var s=E8(i.content);if(s.length!==1||s[0].comps.length!==1||s[0].comps[0].t!==0||s[0].name!=="StrongEncryptionDataSpace"||s[0].comps[0].v!=="EncryptedPackage")throw new Error("ECMA-376 Encrypted file bad "+r);if(r="/!DataSpaces/DataSpaceInfo/StrongEncryptionDataSpace",i=ze.find(e,r),!i||!i.content)throw new Error("ECMA-376 Encrypted file missing "+r);var o=T8(i.content);if(o.length!=1||o[0]!="StrongEncryptionTransform")throw new Error("ECMA-376 Encrypted file bad "+r);if(r="/!DataSpaces/TransformInfo/StrongEncryptionTransform/!Primary",i=ze.find(e,r),!i||!i.content)throw new Error("ECMA-376 Encrypted file missing "+r);C8(i.content)}catch{}if(r="/EncryptionInfo",i=ze.find(e,r),!i||!i.content)throw new Error("ECMA-376 Encrypted file missing "+r);var a=S8(i.content);if(r="/EncryptedPackage",i=ze.find(e,r),!i||!i.content)throw new Error("ECMA-376 Encrypted file missing "+r);if(a[0]==4&&typeof decrypt_agile<"u")return decrypt_agile(a[1],i.content,t.password||"",t);if(a[0]==2&&typeof decrypt_std76<"u")return decrypt_std76(a[1],i.content,t.password||"",t);throw new Error("File is password-protected")}function Yg(e,n){var t="";switch((n||{}).type||"base64"){case"buffer":return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7]];case"base64":t=jn(e.slice(0,12));break;case"binary":t=e;break;case"array":return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7]];default:throw new Error("Unrecognized type "+(n&&n.type||"undefined"))}return[t.charCodeAt(0),t.charCodeAt(1),t.charCodeAt(2),t.charCodeAt(3),t.charCodeAt(4),t.charCodeAt(5),t.charCodeAt(6),t.charCodeAt(7)]}function Aj(e,n){return ze.find(e,"EncryptedPackage")?bj(e,n):UC(e,n)}function kj(e,n){var t,r=e,i=n||{};return i.type||(i.type=Ue&&Buffer.isBuffer(e)?"buffer":"base64"),t=LI(r,i),Dj(t,i)}function $C(e,n){var t=0;e:for(;t<e.length;)switch(e.charCodeAt(t)){case 10:case 13:case 32:++t;break;case 60:return gg(e.slice(t),n);default:break e}return rl.to_workbook(e,n)}function Nj(e,n){var t="",r=Yg(e,n);switch(n.type){case"base64":t=jn(e);break;case"binary":t=e;break;case"buffer":t=e.toString("binary");break;case"array":t=Us(e);break;default:throw new Error("Unrecognized type "+n.type)}return r[0]==239&&r[1]==187&&r[2]==191&&(t=ct(t)),n.type="binary",$C(t,n)}function Rj(e,n){var t=e;return n.type=="base64"&&(t=jn(t)),t=nt.utils.decode(1200,t.slice(2),"str"),n.type="binary",$C(t,n)}function Mj(e){return e.match(/[^\x00-\x7F]/)?Wc(e):e}function lg(e,n,t,r){return r?(t.type="string",rl.to_workbook(e,t)):rl.to_workbook(n,t)}function Dd(e,n){_I();var t=n||{};if(typeof ArrayBuffer<"u"&&e instanceof ArrayBuffer)return Dd(new Uint8Array(e),(t=en(t),t.type="array",t));typeof Uint8Array<"u"&&e instanceof Uint8Array&&!t.type&&(t.type=typeof Deno<"u"?"buffer":"array");var r=e,i=[0,0,0,0],s=!1;if(t.cellStyles&&(t.cellNF=!0,t.sheetStubs=!0),oa={},t.dateNF&&(oa.dateNF=t.dateNF),t.type||(t.type=Ue&&Buffer.isBuffer(e)?"buffer":"base64"),t.type=="file"&&(t.type=Ue?"buffer":"binary",r=yL(e),typeof Uint8Array<"u"&&!Ue&&(t.type="array")),t.type=="string"&&(s=!0,t.type="binary",t.codepage=65001,r=Mj(e)),t.type=="array"&&typeof Uint8Array<"u"&&e instanceof Uint8Array&&typeof ArrayBuffer<"u"){var o=new ArrayBuffer(3),a=new Uint8Array(o);if(a.foo="bar",!a.foo)return t=en(t),t.type="array",Dd(Tg(r),t)}switch((i=Yg(r,t))[0]){case 208:if(i[1]===207&&i[2]===17&&i[3]===224&&i[4]===161&&i[5]===177&&i[6]===26&&i[7]===225)return Aj(ze.read(r,t),t);break;case 9:if(i[1]<=8)return UC(r,t);break;case 60:return gg(r,t);case 73:if(i[1]===73&&i[2]===42&&i[3]===0)throw new Error("TIFF Image File is not a spreadsheet");if(i[1]===68)return a8(r,t);break;case 84:if(i[1]===65&&i[2]===66&&i[3]===76)return s8.to_workbook(r,t);break;case 80:return i[1]===75&&i[2]<9&&i[3]<9?kj(r,t):lg(e,r,t,s);case 239:return i[3]===60?gg(r,t):lg(e,r,t,s);case 255:if(i[1]===254)return Rj(r,t);if(i[1]===0&&i[2]===2&&i[3]===0)return Xc.to_workbook(r,t);break;case 0:if(i[1]===0&&(i[2]>=2&&i[3]===0||i[2]===0&&(i[3]===8||i[3]===9)))return Xc.to_workbook(r,t);break;case 3:case 131:case 139:case 140:return JT.to_workbook(r,t);case 123:if(i[1]===92&&i[2]===114&&i[3]===116)return B8.to_workbook(r,t);break;case 10:case 13:case 32:return Nj(r,t);case 137:if(i[1]===80&&i[2]===78&&i[3]===71)throw new Error("PNG Image File is not a spreadsheet");break}return r8.indexOf(i[0])>-1&&i[2]<=12&&i[3]<=31?JT.to_workbook(r,t):lg(e,r,t,s)}function Oj(e,n,t,r,i,s,o,a){var c=tn(t),l=a.defval,u=a.raw||!Object.prototype.hasOwnProperty.call(a,"raw"),f=!0,d=i===1?[]:{};if(i!==1)if(Object.defineProperty)try{Object.defineProperty(d,"__rowNum__",{value:t,enumerable:!1})}catch{d.__rowNum__=t}else d.__rowNum__=t;if(!o||e[t])for(var h=n.s.c;h<=n.e.c;++h){var m=o?e[t][h]:e[r[h]+c];if(m===void 0||m.t===void 0){if(l===void 0)continue;s[h]!=null&&(d[s[h]]=l);continue}var p=m.v;switch(m.t){case"z":if(p==null)break;continue;case"e":p=p==0?null:void 0;break;case"s":case"d":case"b":case"n":break;default:throw new Error("unrecognized type "+m.t)}if(s[h]!=null){if(p==null)if(m.t=="e"&&p===null)d[s[h]]=null;else if(l!==void 0)d[s[h]]=l;else if(u&&p===null)d[s[h]]=null;else continue;else d[s[h]]=u&&(m.t!=="n"||m.t==="n"&&a.rawNumbers!==!1)?p:vi(m,p,a);p!=null&&(f=!1)}}return{row:d,isempty:f}}function yg(e,n){if(e==null||e["!ref"]==null)return[];var t={t:"n",v:0},r=0,i=1,s=[],o=0,a="",c={s:{r:0,c:0},e:{r:0,c:0}},l=n||{},u=l.range!=null?l.range:e["!ref"];switch(l.header===1?r=1:l.header==="A"?r=2:Array.isArray(l.header)?r=3:l.header==null&&(r=0),typeof u){case"string":c=_t(u);break;case"number":c=_t(e["!ref"]),c.s.r=u;break;default:c=u}r>0&&(i=0);var f=tn(c.s.r),d=[],h=[],m=0,p=0,g=Array.isArray(e),w=c.s.r,C=0,_={};g&&!e[w]&&(e[w]=[]);var M=l.skipHidden&&e["!cols"]||[],V=l.skipHidden&&e["!rows"]||[];for(C=c.s.c;C<=c.e.c;++C)if(!(M[C]||{}).hidden)switch(d[C]=Ot(C),t=g?e[w][C]:e[d[C]+f],r){case 1:s[C]=C-c.s.c;break;case 2:s[C]=d[C];break;case 3:s[C]=l.header[C-c.s.c];break;default:if(t==null&&(t={w:"__EMPTY",t:"s"}),a=o=vi(t,null,l),p=_[o]||0,!p)_[o]=1;else{do a=o+"_"+p++;while(_[a]);_[o]=p,_[a]=1}s[C]=a}for(w=c.s.r+i;w<=c.e.r;++w)if(!(V[w]||{}).hidden){var A=Oj(e,c,w,d,r,s,g,l);(A.isempty===!1||(r===1?l.blankrows!==!1:l.blankrows))&&(h[m++]=A.row)}return h.length=m,h}var gI=/"/g;function Fj(e,n,t,r,i,s,o,a){for(var c=!0,l=[],u="",f=tn(t),d=n.s.c;d<=n.e.c;++d)if(r[d]){var h=a.dense?(e[t]||[])[d]:e[r[d]+f];if(h==null)u="";else if(h.v!=null){c=!1,u=""+(a.rawNumbers&&h.t=="n"?h.v:vi(h,null,a));for(var m=0,p=0;m!==u.length;++m)if((p=u.charCodeAt(m))===i||p===s||p===34||a.forceQuotes){u='"'+u.replace(gI,'""')+'"';break}u=="ID"&&(u='"ID"')}else h.f!=null&&!h.F?(c=!1,u="="+h.f,u.indexOf(",")>=0&&(u='"'+u.replace(gI,'""')+'"')):u="";l.push(u)}return a.blankrows===!1&&c?null:l.join(o)}function WC(e,n){var t=[],r=n??{};if(e==null||e["!ref"]==null)return"";var i=_t(e["!ref"]),s=r.FS!==void 0?r.FS:",",o=s.charCodeAt(0),a=r.RS!==void 0?r.RS:`
`,c=a.charCodeAt(0),l=new RegExp((s=="|"?"\\|":s)+"+$"),u="",f=[];r.dense=Array.isArray(e);for(var d=r.skipHidden&&e["!cols"]||[],h=r.skipHidden&&e["!rows"]||[],m=i.s.c;m<=i.e.c;++m)(d[m]||{}).hidden||(f[m]=Ot(m));for(var p=0,g=i.s.r;g<=i.e.r;++g)(h[g]||{}).hidden||(u=Fj(e,i,g,f,o,c,s,r),u!=null&&(r.strip&&(u=u.replace(l,"")),(u||r.blankrows!==!1)&&t.push((p++?a:"")+u)));return delete r.dense,t.join("")}function Pj(e,n){n||(n={}),n.FS="	",n.RS=`
`;var t=WC(e,n);if(typeof nt>"u"||n.type=="string")return t;var r=nt.utils.encode(1200,t,"str");return"\xFF\xFE"+r}function Lj(e){var n="",t,r="";if(e==null||e["!ref"]==null)return[];var i=_t(e["!ref"]),s="",o=[],a,c=[],l=Array.isArray(e);for(a=i.s.c;a<=i.e.c;++a)o[a]=Ot(a);for(var u=i.s.r;u<=i.e.r;++u)for(s=tn(u),a=i.s.c;a<=i.e.c;++a)if(n=o[a]+s,t=l?(e[u]||[])[a]:e[n],r="",t!==void 0){if(t.F!=null){if(n=t.F,!t.f)continue;r=t.f,n.indexOf(":")==-1&&(n=n+":"+n)}if(t.f!=null)r=t.f;else{if(t.t=="z")continue;if(t.t=="n"&&t.v!=null)r=""+t.v;else if(t.t=="b")r=t.v?"TRUE":"FALSE";else if(t.w!==void 0)r="'"+t.w;else{if(t.v===void 0)continue;t.t=="s"?r="'"+t.v:r=""+t.v}}c[c.length]=n+"="+r}return c}function zC(e,n,t){var r=t||{},i=+!r.skipHeader,s=e||{},o=0,a=0;if(s&&r.origin!=null)if(typeof r.origin=="number")o=r.origin;else{var c=typeof r.origin=="string"?wn(r.origin):r.origin;o=c.r,a=c.c}var l,u={s:{c:0,r:0},e:{c:a,r:o+n.length-1+i}};if(s["!ref"]){var f=_t(s["!ref"]);u.e.c=Math.max(u.e.c,f.e.c),u.e.r=Math.max(u.e.r,f.e.r),o==-1&&(o=f.e.r+1,u.e.r=o+n.length-1+i)}else o==-1&&(o=0,u.e.r=n.length-1+i);var d=r.header||[],h=0;n.forEach(function(p,g){zr(p).forEach(function(w){(h=d.indexOf(w))==-1&&(d[h=d.length]=w);var C=p[w],_="z",M="",V=Ce({c:a+h,r:o+g+i});l=al(s,V),C&&typeof C=="object"&&!(C instanceof Date)?s[V]=C:(typeof C=="number"?_="n":typeof C=="boolean"?_="b":typeof C=="string"?_="s":C instanceof Date?(_="d",r.cellDates||(_="n",C=En(C)),M=r.dateNF||Ae[14]):C===null&&r.nullError&&(_="e",C=0),l?(l.t=_,l.v=C,delete l.w,delete l.R,M&&(l.z=M)):s[V]=l={t:_,v:C},M&&(l.z=M))})}),u.e.c=Math.max(u.e.c,a+d.length-1);var m=tn(o);if(i)for(h=0;h<d.length;++h)s[Ot(h+a)+m]={t:"s",v:d[h]};return s["!ref"]=Ge(u),s}function Bj(e,n){return zC(null,e,n)}function al(e,n,t){if(typeof n=="string"){if(Array.isArray(e)){var r=wn(n);return e[r.r]||(e[r.r]=[]),e[r.r][r.c]||(e[r.r][r.c]={t:"z"})}return e[n]||(e[n]={t:"z"})}return typeof n!="number"?al(e,Ce(n)):al(e,Ce({r:n,c:t||0}))}function Uj(e,n){if(typeof n=="number"){if(n>=0&&e.SheetNames.length>n)return n;throw new Error("Cannot find sheet # "+n)}else if(typeof n=="string"){var t=e.SheetNames.indexOf(n);if(t>-1)return t;throw new Error("Cannot find sheet name |"+n+"|")}else throw new Error("Cannot find sheet |"+n+"|")}function Xg(){return{SheetNames:[],Sheets:{}}}function Qg(e,n,t,r){var i=1;if(!t)for(;i<=65535&&e.SheetNames.indexOf(t="Sheet"+i)!=-1;++i,t=void 0);if(!t||e.SheetNames.length>=65535)throw new Error("Too many worksheets");if(r&&e.SheetNames.indexOf(t)>=0){var s=t.match(/(^.*?)(\d+)$/);i=s&&+s[2]||0;var o=s&&s[1]||t;for(++i;i<=65535&&e.SheetNames.indexOf(t=o+i)!=-1;++i);}if(T5(t),e.SheetNames.indexOf(t)>=0)throw new Error("Worksheet with name |"+t+"| already exists!");return e.SheetNames.push(t),e.Sheets[t]=n,t}function jj(e,n,t){e.Workbook||(e.Workbook={}),e.Workbook.Sheets||(e.Workbook.Sheets=[]);var r=Uj(e,n);switch(e.Workbook.Sheets[r]||(e.Workbook.Sheets[r]={}),t){case 0:case 1:case 2:break;default:throw new Error("Bad sheet visibility setting "+t)}e.Workbook.Sheets[r].Hidden=t}function Vj(e,n){return e.z=n,e}function GC(e,n,t){return n?(e.l={Target:n},t&&(e.l.Tooltip=t)):delete e.l,e}function Hj(e,n,t){return GC(e,"#"+n,t)}function $j(e,n,t){e.c||(e.c=[]),e.c.push({t:n,a:t||"SheetJS"})}function Wj(e,n,t,r){for(var i=typeof n!="string"?n:_t(n),s=typeof n=="string"?n:Ge(n),o=i.s.r;o<=i.e.r;++o)for(var a=i.s.c;a<=i.e.c;++a){var c=al(e,o,a);c.t="n",c.F=s,delete c.v,o==i.s.r&&a==i.s.c&&(c.f=t,r&&(c.D=!0))}return e}var qC={encode_col:Ot,encode_row:tn,encode_cell:Ce,encode_range:Ge,decode_col:Pg,decode_row:Fg,split_cell:n4,decode_cell:wn,decode_range:da,format_cell:vi,sheet_add_aoa:XI,sheet_add_json:zC,sheet_add_dom:jC,aoa_to_sheet:ha,json_to_sheet:Bj,table_to_sheet:VC,table_to_book:aj,sheet_to_csv:WC,sheet_to_txt:Pj,sheet_to_json:yg,sheet_to_html:oj,sheet_to_formulae:Lj,sheet_to_row_object_array:yg,sheet_get_cell:al,book_new:Xg,book_append_sheet:Qg,book_set_sheet_visibility:jj,cell_set_number_format:Vj,cell_set_hyperlink:GC,cell_set_internal_link:Hj,cell_add_comment:$j,sheet_set_array_formula:Wj,consts:{SHEET_VISIBLE:0,SHEET_HIDDEN:1,SHEET_VERY_HIDDEN:2}};var FZ=vI.version;var Ji=(()=>{class e{constructor(t){this.http=t,this.csvUrl="https://docs.google.com/spreadsheets/d/e/2PACX-1vTdwZJNAFoTR_PONHMqGGw92Q5hVYPR3aAYIhj-8JelGX-R7HJPc4FigCihvqxhKrvH8cobQwaO59kf/pub?output=csv",this.dataSubject=new Ua(1),this.dataLoaded=!1}loadData(){this.dataLoaded||this.http.get(this.csvUrl,{responseType:"text"}).pipe(be(t=>{let r=Dd(t,{type:"string"}),i=r.SheetNames[0],s=r.Sheets[i];return qC.sheet_to_json(s,{defval:""}).map(a=>({kategorija:a.Kategorija,naziv:a.Naziv,cena:Number(a.Cena),opis:a.Opis,glavnakategorija:a.GlavnaKategorija,dodaci:this.parseDodaci(a.Dodaci)}))})).subscribe(t=>{this.dataSubject.next(t),this.dataLoaded=!0})}getMenuItems(){return this.dataSubject.asObservable()}parseDodaci(t){return t?t.split(";").map(r=>{let[i,s]=r.split(":");return{naziv:i.trim(),cena:Number(s)}}):[]}static{this.\u0275fac=function(r){return new(r||e)(ue(rm))}}static{this.\u0275prov=he({token:e,factory:e.\u0275fac,providedIn:"root"})}}return e})();var KC=(()=>{class e{constructor(t){this.excelService=t,this.excelService.loadData()}static{this.\u0275fac=function(r){return new(r||e)(at(Ji))}}static{this.\u0275cmp=bn({type:e,selectors:[["app-menu"]],decls:14,vars:0,consts:[[1,"menu-title"],["routerLink","/pages/food-category",1,"menu-card"],["src","assets/hrana1.png","alt","Hrana"],["routerLink","/pages/drinks-alcohol",1,"menu-card"],["src","assets/alkohol.png","alt","Alkoholna pi\u0107a"],["routerLink","/pages/drinks-non-alcohol",1,"menu-card"],["src","assets/bezalkohol.png","alt","Bezalkoholna pi\u0107a"]],template:function(r,i){r&1&&(ye(0,"h1",0),Je(1,"MENI"),we(),ye(2,"div",1),Pr(3,"img",2),ye(4,"span"),Je(5,"Hrana"),we()(),ye(6,"div",3),Pr(7,"img",4),ye(8,"span"),Je(9,"Alkoholna pi\u0107a"),we()(),ye(10,"div",5),Pr(11,"img",6),ye(12,"span"),Je(13,"Bezalkoholna pi\u0107a"),we()())},dependencies:[od],styles:[".cafe-name[_ngcontent-%COMP%]{display:block;height:60px;margin-inline:auto}.menu-title[_ngcontent-%COMP%]{text-align:center;font-size:1.9rem;margin-bottom:1.5rem;margin-top:-10px;color:#222;font-weight:600;letter-spacing:1px;font-family:Playfair Display SC,serif}.menu-card[_ngcontent-%COMP%]{position:relative;width:100%;height:144px;border-radius:1rem;overflow:hidden;margin-bottom:1.3rem;cursor:pointer;box-shadow:0 4px 12px #0000001a;transition:transform .2s ease-in-out;display:flex;align-items:center;justify-content:center}.menu-card[_ngcontent-%COMP%]:hover{transform:scale(1.02)}.menu-card[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{position:absolute;width:100%;height:100%;object-fit:cover;filter:brightness(.5);z-index:1}.menu-card[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{position:relative;z-index:2;color:#fff;font-weight:700;font-size:1.2rem;text-transform:uppercase;letter-spacing:1px;text-shadow:2px 2px 4px rgba(0,0,0,.7)}.menu-header-text[_ngcontent-%COMP%]{text-align:center;font-size:1.6rem;font-weight:600;margin-bottom:1.8rem;color:#222;font-family:Playfair Display,serif;letter-spacing:2px}@media (min-width: 768px){.menu-content[_ngcontent-%COMP%]{max-width:500px;margin:0 auto}}"]})}}return e})();function Gj(e,n){if(e&1){let t=Vo();ye(0,"a",4),li("click",function(){let i=Bo(t).$implicit,s=Qt();return Uo(s.filtrirajPoKategoriji(i))}),Je(1),we()}if(e&2){let t=n.$implicit,r=Qt();Ds("active",t===r.selektovanaKategorija),ke(),jt(" ",t," ")}}function qj(e,n){if(e&1&&(ye(0,"p"),Je(1),we()),e&2){let t=Qt().$implicit;ke(),Lr(t.opis)}}function Kj(e,n){if(e&1&&(ye(0,"li"),Je(1),we()),e&2){let t=n.$implicit;ke(),bs(" + ",t.naziv," (",t.cena," RSD) ")}}function Yj(e,n){if(e&1&&(ye(0,"ul"),Ut(1,Kj,2,2,"li",9),we()),e&2){let t=Qt().$implicit;ke(),Et("ngForOf",t.dodaci)}}function Xj(e,n){if(e&1&&(ye(0,"div",5)(1,"div",6)(2,"h3"),Je(3),we(),Ut(4,qj,2,1,"p",7)(5,Yj,2,1,"ul",7),we(),ye(6,"div",8),Je(7),we()()),e&2){let t=n.$implicit;ke(3),Lr(t.naziv),ke(),Et("ngIf",t.opis),ke(),Et("ngIf",t.dodaci&&t.dodaci.length>0),ke(2),jt(" ",t.cena," RSD ")}}var YC=(()=>{class e{constructor(t){this.excelService=t,this.allItems=[],this.filteredItems=[],this.podkategorije=[],this.selektovanaKategorija=null,this.excelService.loadData()}ngOnInit(){this.excelService.getMenuItems().subscribe(t=>{this.allItems=t.filter(r=>r.glavnakategorija==="Hrana"),this.filteredItems=[...this.allItems],this.podkategorije=[...new Set(this.allItems.map(r=>r.kategorija))]})}filtrirajPoKategoriji(t){this.selektovanaKategorija===t?(this.selektovanaKategorija=null,this.filteredItems=[...this.allItems]):(this.selektovanaKategorija=t,this.filteredItems=this.allItems.filter(r=>r.kategorija===t))}static{this.\u0275fac=function(r){return new(r||e)(at(Ji))}}static{this.\u0275cmp=bn({type:e,selectors:[["app-food-category"]],decls:4,vars:2,consts:[[1,"food-nav"],[3,"active","click",4,"ngFor","ngForOf"],[1,"food-list"],["class","menu-box",4,"ngFor","ngForOf"],[3,"click"],[1,"menu-box"],[1,"menu-box-content"],[4,"ngIf"],[1,"menu-price-badge"],[4,"ngFor","ngForOf"]],template:function(r,i){r&1&&(ye(0,"div",0),Ut(1,Gj,2,3,"a",1),we(),ye(2,"div",2),Ut(3,Xj,8,4,"div",3),we()),r&2&&(ke(),Et("ngForOf",i.podkategorije),ke(2),Et("ngForOf",i.filteredItems))},dependencies:[Wo,Ui],styles:[".food-list[_ngcontent-%COMP%]{padding:1.5rem 1rem;display:flex;flex-direction:column;gap:2rem}.menu-box[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:space-between;background:#fff5e9;border-radius:1.5rem;padding:1.2rem 1.5rem;box-shadow:0 4px 12px #0000001a;position:relative}.menu-box-content[_ngcontent-%COMP%]{flex:1;padding-right:1rem}.menu-box-content[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{margin:0;font-size:1.1rem;font-weight:700;color:#333}.menu-box-content[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin:.3rem 0 0;font-size:.95rem;color:#666;font-style:italic}.menu-box-content[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]{margin-top:.6rem;padding-left:1rem;border-top:1px dashed #ccc;padding-top:.5rem;list-style:none}.menu-box-content[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]{font-size:.9rem;margin-bottom:.3rem;color:#444}.menu-price-badge[_ngcontent-%COMP%]{position:absolute;background-color:#fb8c00;color:#fff;font-weight:700;padding:.6rem 1.2rem;border-radius:2rem;box-shadow:2px 3px #000;white-space:nowrap;font-size:1rem;bottom:-19px;right:-8px}"]})}}return e})();function Qj(e,n){if(e&1){let t=Vo();ye(0,"a",4),li("click",function(){let i=Bo(t).$implicit,s=Qt();return Uo(s.filtrirajPoKategoriji(i))}),Je(1),we()}if(e&2){let t=n.$implicit,r=Qt();Ds("active",t===r.selektovanaKategorija),ke(),jt(" ",t," ")}}function Zj(e,n){if(e&1&&(ye(0,"p"),Je(1),we()),e&2){let t=Qt().$implicit;ke(),Lr(t.opis)}}function Jj(e,n){if(e&1&&(ye(0,"li"),Je(1),we()),e&2){let t=n.$implicit;ke(),bs(" + ",t.naziv," (",t.cena," RSD) ")}}function eV(e,n){if(e&1&&(ye(0,"ul",10),Ut(1,Jj,2,2,"li",11),we()),e&2){let t=Qt().$implicit;ke(),Et("ngForOf",t.dodaci)}}function tV(e,n){if(e&1&&(ye(0,"div",5)(1,"div",6)(2,"h3"),Je(3),we(),Ut(4,Zj,2,1,"p",7)(5,eV,2,1,"ul",8),we(),ye(6,"div",9),Je(7),we()()),e&2){let t=n.$implicit;ke(3),Lr(t.naziv),ke(),Et("ngIf",t.opis),ke(),Et("ngIf",t.dodaci&&t.dodaci.length>0),ke(2),jt(" ",t.cena," RSD ")}}var XC=(()=>{class e{constructor(t){this.excelService=t,this.allItems=[],this.filteredItems=[],this.podkategorije=[],this.selektovanaKategorija=null,this.excelService.loadData()}ngOnInit(){this.excelService.getMenuItems().subscribe(t=>{this.allItems=t.filter(r=>r.glavnakategorija==="Bezalkoholna pi\u0107a"),this.filteredItems=[...this.allItems],this.podkategorije=[...new Set(this.allItems.map(r=>r.kategorija))]})}filtrirajPoKategoriji(t){this.selektovanaKategorija===t?(this.selektovanaKategorija=null,this.filteredItems=[...this.allItems]):(this.selektovanaKategorija=t,this.filteredItems=this.allItems.filter(r=>r.kategorija===t))}static{this.\u0275fac=function(r){return new(r||e)(at(Ji))}}static{this.\u0275cmp=bn({type:e,selectors:[["app-drinks-non-alcohol"]],decls:4,vars:2,consts:[[1,"food-nav"],[3,"active","click",4,"ngFor","ngForOf"],[1,"food-list"],["class","menu-box",4,"ngFor","ngForOf"],[3,"click"],[1,"menu-box"],[1,"menu-box-content"],[4,"ngIf"],["class","menu-item-addons",4,"ngIf"],[1,"menu-price-badge"],[1,"menu-item-addons"],[4,"ngFor","ngForOf"]],template:function(r,i){r&1&&(ye(0,"div",0),Ut(1,Qj,2,3,"a",1),we(),ye(2,"div",2),Ut(3,tV,8,4,"div",3),we()),r&2&&(ke(),Et("ngForOf",i.podkategorije),ke(2),Et("ngForOf",i.filteredItems))},dependencies:[Wo,Ui],styles:[".food-list[_ngcontent-%COMP%]{padding:1.5rem 1rem;display:flex;flex-direction:column;gap:2rem}.menu-box[_ngcontent-%COMP%]{position:relative;background:#fff5e9;border-radius:1.5rem;padding:1.2rem 1.5rem;box-shadow:0 4px 12px #0000001a;transition:transform .2s ease}.menu-box[_ngcontent-%COMP%]:hover{transform:translateY(-2px)}.menu-box-content[_ngcontent-%COMP%]{padding-right:5rem}.menu-box-content[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{margin:0;font-size:1.1rem;font-weight:700;color:#333}.menu-box-content[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin:.3rem 0 0;font-size:.95rem;color:#666;font-style:italic}.menu-box-content[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]{margin-top:.6rem;padding-left:1rem;border-top:1px dashed #ccc;padding-top:.5rem;list-style:none}.menu-box-content[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]{font-size:.9rem;margin-bottom:.3rem;color:#444}.menu-price-badge[_ngcontent-%COMP%]{position:absolute;background-color:#fb8c00;color:#fff;font-weight:700;padding:.6rem 1.2rem;border-radius:2rem;box-shadow:2px 3px #000;white-space:nowrap;font-size:1rem;bottom:-19px;right:-8px}.food-nav[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap;gap:.5rem;margin-bottom:1rem;justify-content:center}.food-nav[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{padding:.4rem 1rem;background-color:#eee;border-radius:1rem;font-size:.95rem;color:#333;cursor:pointer;text-decoration:none;transition:background-color .2s ease}.food-nav[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]:hover{background-color:#ffa726;color:#fff}.food-nav[_ngcontent-%COMP%]   a.active[_ngcontent-%COMP%]{background-color:#fb8c00;color:#fff}"]})}}return e})();function nV(e,n){if(e&1){let t=Vo();ye(0,"a",4),li("click",function(){let i=Bo(t).$implicit,s=Qt();return Uo(s.filtrirajPoKategoriji(i))}),Je(1),we()}if(e&2){let t=n.$implicit,r=Qt();Ds("active",t===r.selektovanaKategorija),ke(),jt(" ",t," ")}}function rV(e,n){if(e&1&&(ye(0,"p"),Je(1),we()),e&2){let t=Qt().$implicit;ke(),Lr(t.opis)}}function iV(e,n){if(e&1&&(ye(0,"li"),Je(1),we()),e&2){let t=n.$implicit;ke(),bs(" + ",t.naziv," (",t.cena," RSD) ")}}function sV(e,n){if(e&1&&(ye(0,"ul",10),Ut(1,iV,2,2,"li",11),we()),e&2){let t=Qt().$implicit;ke(),Et("ngForOf",t.dodaci)}}function oV(e,n){if(e&1&&(ye(0,"div",5)(1,"div",6)(2,"h3"),Je(3),we(),Ut(4,rV,2,1,"p",7)(5,sV,2,1,"ul",8),we(),ye(6,"div",9),Je(7),we()()),e&2){let t=n.$implicit;ke(3),Lr(t.naziv),ke(),Et("ngIf",t.opis),ke(),Et("ngIf",t.dodaci&&t.dodaci.length>0),ke(2),jt(" ",t.cena," RSD ")}}var QC=(()=>{class e{constructor(t){this.excelService=t,this.allItems=[],this.filteredItems=[],this.podkategorije=[],this.selektovanaKategorija=null,this.excelService.loadData()}ngOnInit(){this.excelService.getMenuItems().subscribe(t=>{this.allItems=t.filter(r=>r.glavnakategorija==="Alkoholna pi\u0107a"),this.filteredItems=[...this.allItems],this.podkategorije=[...new Set(this.allItems.map(r=>r.kategorija))]})}filtrirajPoKategoriji(t){this.selektovanaKategorija===t?(this.selektovanaKategorija=null,this.filteredItems=[...this.allItems]):(this.selektovanaKategorija=t,this.filteredItems=this.allItems.filter(r=>r.kategorija===t))}static{this.\u0275fac=function(r){return new(r||e)(at(Ji))}}static{this.\u0275cmp=bn({type:e,selectors:[["app-drinks-alcohol"]],decls:4,vars:2,consts:[[1,"food-nav"],[3,"active","click",4,"ngFor","ngForOf"],[1,"food-list"],["class","menu-box",4,"ngFor","ngForOf"],[3,"click"],[1,"menu-box"],[1,"menu-box-content"],[4,"ngIf"],["class","menu-item-addons",4,"ngIf"],[1,"menu-price-badge"],[1,"menu-item-addons"],[4,"ngFor","ngForOf"]],template:function(r,i){r&1&&(ye(0,"div",0),Ut(1,nV,2,3,"a",1),we(),ye(2,"div",2),Ut(3,oV,8,4,"div",3),we()),r&2&&(ke(),Et("ngForOf",i.podkategorije),ke(2),Et("ngForOf",i.filteredItems))},dependencies:[Wo,Ui],styles:[".food-list[_ngcontent-%COMP%]{padding:1.5rem 1rem;display:flex;flex-direction:column;gap:2rem}.menu-box[_ngcontent-%COMP%]{position:relative;background:#fff5e9;border-radius:1.5rem;padding:1.2rem 1.5rem;box-shadow:0 4px 12px #0000001a;transition:transform .2s ease}.menu-box[_ngcontent-%COMP%]:hover{transform:translateY(-2px)}.menu-box-content[_ngcontent-%COMP%]{padding-right:5rem}.menu-box-content[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{margin:0;font-size:1.1rem;font-weight:700;color:#333}.menu-box-content[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin:.3rem 0 0;font-size:.95rem;color:#666;font-style:italic}.menu-box-content[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]{margin-top:.6rem;padding-left:1rem;border-top:1px dashed #ccc;padding-top:.5rem;list-style:none}.menu-box-content[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]{font-size:.9rem;margin-bottom:.3rem;color:#444}.menu-price-badge[_ngcontent-%COMP%]{position:absolute;background-color:#fb8c00;color:#fff;font-weight:700;padding:.6rem 1.2rem;border-radius:2rem;box-shadow:2px 3px #000;white-space:nowrap;font-size:1rem;bottom:-19px;right:-8px}.food-nav[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap;gap:.5rem;margin-bottom:1rem;justify-content:center}.food-nav[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{padding:.4rem 1rem;background-color:#eee;border-radius:1rem;font-size:.95rem;color:#333;cursor:pointer;text-decoration:none;transition:background-color .2s ease}.food-nav[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]:hover{background-color:#ffa726;color:#fff}.food-nav[_ngcontent-%COMP%]   a.active[_ngcontent-%COMP%]{background-color:#fb8c00;color:#fff}.back-link[_ngcontent-%COMP%]{display:inline-flex;align-items:center;gap:.4rem;margin-bottom:1.5rem;padding:.5rem 1rem;background-color:#f7f8fa;color:#444;font-weight:600;font-size:.95rem;text-decoration:none;border:2px solid #d1d3e2;border-radius:2rem;transition:all .2s ease}.back-link[_ngcontent-%COMP%]:hover{background-color:#ffa726;color:#fff;border-color:#ffa726}.back-link[_ngcontent-%COMP%]   .arrow[_ngcontent-%COMP%]{font-size:1.2rem;transform:translateY(-1px)}"]})}}return e})();var Jg={NODE_CLIENT:!1,NODE_ADMIN:!1,SDK_VERSION:"${JSCORE_VERSION}"};var X=function(e,n){if(!e)throw qs(n)},qs=function(e){return new Error("Firebase Database ("+Jg.SDK_VERSION+") INTERNAL ASSERT FAILED: "+e)};var JC=function(e){let n=[],t=0;for(let r=0;r<e.length;r++){let i=e.charCodeAt(r);i<128?n[t++]=i:i<2048?(n[t++]=i>>6|192,n[t++]=i&63|128):(i&64512)===55296&&r+1<e.length&&(e.charCodeAt(r+1)&64512)===56320?(i=65536+((i&1023)<<10)+(e.charCodeAt(++r)&1023),n[t++]=i>>18|240,n[t++]=i>>12&63|128,n[t++]=i>>6&63|128,n[t++]=i&63|128):(n[t++]=i>>12|224,n[t++]=i>>6&63|128,n[t++]=i&63|128)}return n},aV=function(e){let n=[],t=0,r=0;for(;t<e.length;){let i=e[t++];if(i<128)n[r++]=String.fromCharCode(i);else if(i>191&&i<224){let s=e[t++];n[r++]=String.fromCharCode((i&31)<<6|s&63)}else if(i>239&&i<365){let s=e[t++],o=e[t++],a=e[t++],c=((i&7)<<18|(s&63)<<12|(o&63)<<6|a&63)-65536;n[r++]=String.fromCharCode(55296+(c>>10)),n[r++]=String.fromCharCode(56320+(c&1023))}else{let s=e[t++],o=e[t++];n[r++]=String.fromCharCode((i&15)<<12|(s&63)<<6|o&63)}}return n.join("")},Fd={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(e,n){if(!Array.isArray(e))throw Error("encodeByteArray takes an array as a parameter");this.init_();let t=n?this.byteToCharMapWebSafe_:this.byteToCharMap_,r=[];for(let i=0;i<e.length;i+=3){let s=e[i],o=i+1<e.length,a=o?e[i+1]:0,c=i+2<e.length,l=c?e[i+2]:0,u=s>>2,f=(s&3)<<4|a>>4,d=(a&15)<<2|l>>6,h=l&63;c||(h=64,o||(d=64)),r.push(t[u],t[f],t[d],t[h])}return r.join("")},encodeString(e,n){return this.HAS_NATIVE_SUPPORT&&!n?btoa(e):this.encodeByteArray(JC(e),n)},decodeString(e,n){return this.HAS_NATIVE_SUPPORT&&!n?atob(e):aV(this.decodeStringToByteArray(e,n))},decodeStringToByteArray(e,n){this.init_();let t=n?this.charToByteMapWebSafe_:this.charToByteMap_,r=[];for(let i=0;i<e.length;){let s=t[e.charAt(i++)],a=i<e.length?t[e.charAt(i)]:0;++i;let l=i<e.length?t[e.charAt(i)]:64;++i;let f=i<e.length?t[e.charAt(i)]:64;if(++i,s==null||a==null||l==null||f==null)throw new ev;let d=s<<2|a>>4;if(r.push(d),l!==64){let h=a<<4&240|l>>2;if(r.push(h),f!==64){let m=l<<6&192|f;r.push(m)}}}return r},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let e=0;e<this.ENCODED_VALS.length;e++)this.byteToCharMap_[e]=this.ENCODED_VALS.charAt(e),this.charToByteMap_[this.byteToCharMap_[e]]=e,this.byteToCharMapWebSafe_[e]=this.ENCODED_VALS_WEBSAFE.charAt(e),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[e]]=e,e>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(e)]=e,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(e)]=e)}}},ev=class extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}},nv=function(e){let n=JC(e);return Fd.encodeByteArray(n,!0)},hl=function(e){return nv(e).replace(/\./g,"")},pl=function(e){try{return Fd.decodeString(e,!0)}catch(n){console.error("base64Decode failed: ",n)}return null};function eS(e){return tS(void 0,e)}function tS(e,n){if(!(n instanceof Object))return n;switch(n.constructor){case Date:let t=n;return new Date(t.getTime());case Object:e===void 0&&(e={});break;case Array:e=[];break;default:return n}for(let t in n)!n.hasOwnProperty(t)||!cV(t)||(e[t]=tS(e[t],n[t]));return e}function cV(e){return e!=="__proto__"}function lV(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}var uV=()=>lV().__FIREBASE_DEFAULTS__,fV=()=>{if(typeof process>"u"||typeof process.env>"u")return;let e=process.env.__FIREBASE_DEFAULTS__;if(e)return JSON.parse(e)},dV=()=>{if(typeof document>"u")return;let e;try{e=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}let n=e&&pl(e[1]);return n&&JSON.parse(n)},rv=()=>{try{return uV()||fV()||dV()}catch(e){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${e}`);return}},nS=e=>{var n,t;return(t=(n=rv())===null||n===void 0?void 0:n.emulatorHosts)===null||t===void 0?void 0:t[e]},rS=e=>{let n=nS(e);if(!n)return;let t=n.lastIndexOf(":");if(t<=0||t+1===n.length)throw new Error(`Invalid host ${n} with no separate hostname and port!`);let r=parseInt(n.substring(t+1),10);return n[0]==="["?[n.substring(1,t-1),r]:[n.substring(0,t),r]},iv=()=>{var e;return(e=rv())===null||e===void 0?void 0:e.config},iS=e=>{var n;return(n=rv())===null||n===void 0?void 0:n[`_${e}`]};var es=class{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((n,t)=>{this.resolve=n,this.reject=t})}wrapCallback(n){return(t,r)=>{t?this.reject(t):this.resolve(r),typeof n=="function"&&(this.promise.catch(()=>{}),n.length===1?n(t):n(t,r))}}};function sS(e,n){if(e.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');let t={alg:"none",type:"JWT"},r=n||"demo-project",i=e.iat||0,s=e.sub||e.user_id;if(!s)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");let o=Object.assign({iss:`https://securetoken.google.com/${r}`,aud:r,iat:i,exp:i+3600,auth_time:i,sub:s,user_id:s,firebase:{sign_in_provider:"custom",identities:{}}},e);return[hl(JSON.stringify(t)),hl(JSON.stringify(o)),""].join(".")}function Er(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function ml(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(Er())}function oS(){return typeof navigator<"u"&&navigator.userAgent==="Cloudflare-Workers"}function aS(){let e=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof e=="object"&&e.id!==void 0}function Pd(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function Yr(){return Jg.NODE_CLIENT===!0||Jg.NODE_ADMIN===!0}function cS(){try{return typeof indexedDB=="object"}catch{return!1}}function lS(){return new Promise((e,n)=>{try{let t=!0,r="validate-browser-context-for-indexeddb-analytics-module",i=self.indexedDB.open(r);i.onsuccess=()=>{i.result.close(),t||self.indexedDB.deleteDatabase(r),e(!0)},i.onupgradeneeded=()=>{t=!1},i.onerror=()=>{var s;n(((s=i.error)===null||s===void 0?void 0:s.message)||"")}}catch(t){n(t)}})}var hV="FirebaseError",Kr=class e extends Error{constructor(n,t,r){super(t),this.code=n,this.customData=r,this.name=hV,Object.setPrototypeOf(this,e.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,xi.prototype.create)}},xi=class{constructor(n,t,r){this.service=n,this.serviceName=t,this.errors=r}create(n,...t){let r=t[0]||{},i=`${this.service}/${n}`,s=this.errors[n],o=s?pV(s,r):"Error",a=`${this.serviceName}: ${o} (${i}).`;return new Kr(i,a,r)}};function pV(e,n){return e.replace(mV,(t,r)=>{let i=n[r];return i!=null?String(i):`<${r}?>`})}var mV=/\{\$([^}]+)}/g;function pa(e){return JSON.parse(e)}function Rt(e){return JSON.stringify(e)}var uS=function(e){let n={},t={},r={},i="";try{let s=e.split(".");n=pa(pl(s[0])||""),t=pa(pl(s[1])||""),i=s[2],r=t.d||{},delete t.d}catch{}return{header:n,claims:t,data:r,signature:i}};var fS=function(e){let n=uS(e),t=n.claims;return!!t&&typeof t=="object"&&t.hasOwnProperty("iat")},dS=function(e){let n=uS(e).claims;return typeof n=="object"&&n.admin===!0};function rr(e,n){return Object.prototype.hasOwnProperty.call(e,n)}function ts(e,n){if(Object.prototype.hasOwnProperty.call(e,n))return e[n]}function Ld(e){for(let n in e)if(Object.prototype.hasOwnProperty.call(e,n))return!1;return!0}function gl(e,n,t){let r={};for(let i in e)Object.prototype.hasOwnProperty.call(e,i)&&(r[i]=n.call(t,e[i],i,e));return r}function vl(e,n){if(e===n)return!0;let t=Object.keys(e),r=Object.keys(n);for(let i of t){if(!r.includes(i))return!1;let s=e[i],o=n[i];if(ZC(s)&&ZC(o)){if(!vl(s,o))return!1}else if(s!==o)return!1}for(let i of r)if(!t.includes(i))return!1;return!0}function ZC(e){return e!==null&&typeof e=="object"}function _l(e){let n=[];for(let[t,r]of Object.entries(e))Array.isArray(r)?r.forEach(i=>{n.push(encodeURIComponent(t)+"="+encodeURIComponent(i))}):n.push(encodeURIComponent(t)+"="+encodeURIComponent(r));return n.length?"&"+n.join("&"):""}var Od=class{constructor(){this.chain_=[],this.buf_=[],this.W_=[],this.pad_=[],this.inbuf_=0,this.total_=0,this.blockSize=512/8,this.pad_[0]=128;for(let n=1;n<this.blockSize;++n)this.pad_[n]=0;this.reset()}reset(){this.chain_[0]=1732584193,this.chain_[1]=4023233417,this.chain_[2]=2562383102,this.chain_[3]=271733878,this.chain_[4]=3285377520,this.inbuf_=0,this.total_=0}compress_(n,t){t||(t=0);let r=this.W_;if(typeof n=="string")for(let f=0;f<16;f++)r[f]=n.charCodeAt(t)<<24|n.charCodeAt(t+1)<<16|n.charCodeAt(t+2)<<8|n.charCodeAt(t+3),t+=4;else for(let f=0;f<16;f++)r[f]=n[t]<<24|n[t+1]<<16|n[t+2]<<8|n[t+3],t+=4;for(let f=16;f<80;f++){let d=r[f-3]^r[f-8]^r[f-14]^r[f-16];r[f]=(d<<1|d>>>31)&4294967295}let i=this.chain_[0],s=this.chain_[1],o=this.chain_[2],a=this.chain_[3],c=this.chain_[4],l,u;for(let f=0;f<80;f++){f<40?f<20?(l=a^s&(o^a),u=1518500249):(l=s^o^a,u=1859775393):f<60?(l=s&o|a&(s|o),u=2400959708):(l=s^o^a,u=3395469782);let d=(i<<5|i>>>27)+l+c+u+r[f]&4294967295;c=a,a=o,o=(s<<30|s>>>2)&4294967295,s=i,i=d}this.chain_[0]=this.chain_[0]+i&4294967295,this.chain_[1]=this.chain_[1]+s&4294967295,this.chain_[2]=this.chain_[2]+o&4294967295,this.chain_[3]=this.chain_[3]+a&4294967295,this.chain_[4]=this.chain_[4]+c&4294967295}update(n,t){if(n==null)return;t===void 0&&(t=n.length);let r=t-this.blockSize,i=0,s=this.buf_,o=this.inbuf_;for(;i<t;){if(o===0)for(;i<=r;)this.compress_(n,i),i+=this.blockSize;if(typeof n=="string"){for(;i<t;)if(s[o]=n.charCodeAt(i),++o,++i,o===this.blockSize){this.compress_(s),o=0;break}}else for(;i<t;)if(s[o]=n[i],++o,++i,o===this.blockSize){this.compress_(s),o=0;break}}this.inbuf_=o,this.total_+=t}digest(){let n=[],t=this.total_*8;this.inbuf_<56?this.update(this.pad_,56-this.inbuf_):this.update(this.pad_,this.blockSize-(this.inbuf_-56));for(let i=this.blockSize-1;i>=56;i--)this.buf_[i]=t&255,t/=256;this.compress_(this.buf_);let r=0;for(let i=0;i<5;i++)for(let s=24;s>=0;s-=8)n[r]=this.chain_[i]>>s&255,++r;return n}};function hS(e,n){let t=new tv(e,n);return t.subscribe.bind(t)}var tv=class{constructor(n,t){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=t,this.task.then(()=>{n(this)}).catch(r=>{this.error(r)})}next(n){this.forEachObserver(t=>{t.next(n)})}error(n){this.forEachObserver(t=>{t.error(n)}),this.close(n)}complete(){this.forEachObserver(n=>{n.complete()}),this.close()}subscribe(n,t,r){let i;if(n===void 0&&t===void 0&&r===void 0)throw new Error("Missing Observer.");gV(n,["next","error","complete"])?i=n:i={next:n,error:t,complete:r},i.next===void 0&&(i.next=Zg),i.error===void 0&&(i.error=Zg),i.complete===void 0&&(i.complete=Zg);let s=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?i.error(this.finalError):i.complete()}catch{}}),this.observers.push(i),s}unsubscribeOne(n){this.observers===void 0||this.observers[n]===void 0||(delete this.observers[n],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(n){if(!this.finalized)for(let t=0;t<this.observers.length;t++)this.sendOne(t,n)}sendOne(n,t){this.task.then(()=>{if(this.observers!==void 0&&this.observers[n]!==void 0)try{t(this.observers[n])}catch(r){typeof console<"u"&&console.error&&console.error(r)}})}close(n){this.finalized||(this.finalized=!0,n!==void 0&&(this.finalError=n),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}};function gV(e,n){if(typeof e!="object"||e===null)return!1;for(let t of n)if(t in e&&typeof e[t]=="function")return!0;return!1}function Zg(){}function sv(e,n){return`${e} failed: ${n} argument `}var pS=function(e){let n=[],t=0;for(let r=0;r<e.length;r++){let i=e.charCodeAt(r);if(i>=55296&&i<=56319){let s=i-55296;r++,X(r<e.length,"Surrogate pair missing trail surrogate.");let o=e.charCodeAt(r)-56320;i=65536+(s<<10)+o}i<128?n[t++]=i:i<2048?(n[t++]=i>>6|192,n[t++]=i&63|128):i<65536?(n[t++]=i>>12|224,n[t++]=i>>6&63|128,n[t++]=i&63|128):(n[t++]=i>>18|240,n[t++]=i>>12&63|128,n[t++]=i>>6&63|128,n[t++]=i&63|128)}return n},xl=function(e){let n=0;for(let t=0;t<e.length;t++){let r=e.charCodeAt(t);r<128?n++:r<2048?n+=2:r>=55296&&r<=56319?(n+=4,t++):n+=3}return n};var VZ=4*60*60*1e3;function ir(e){return e&&e._delegate?e._delegate:e}var sr=class{constructor(n,t,r){this.name=n,this.instanceFactory=t,this.type=r,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(n){return this.instantiationMode=n,this}setMultipleInstances(n){return this.multipleInstances=n,this}setServiceProps(n){return this.serviceProps=n,this}setInstanceCreatedCallback(n){return this.onInstanceCreated=n,this}};var Ks="[DEFAULT]";var Bd=class{constructor(n,t){this.name=n,this.container=t,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(n){let t=this.normalizeInstanceIdentifier(n);if(!this.instancesDeferred.has(t)){let r=new es;if(this.instancesDeferred.set(t,r),this.isInitialized(t)||this.shouldAutoInitialize())try{let i=this.getOrInitializeService({instanceIdentifier:t});i&&r.resolve(i)}catch{}}return this.instancesDeferred.get(t).promise}getImmediate(n){var t;let r=this.normalizeInstanceIdentifier(n?.identifier),i=(t=n?.optional)!==null&&t!==void 0?t:!1;if(this.isInitialized(r)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:r})}catch(s){if(i)return null;throw s}else{if(i)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(n){if(n.name!==this.name)throw Error(`Mismatching Component ${n.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=n,!!this.shouldAutoInitialize()){if(_V(n))try{this.getOrInitializeService({instanceIdentifier:Ks})}catch{}for(let[t,r]of this.instancesDeferred.entries()){let i=this.normalizeInstanceIdentifier(t);try{let s=this.getOrInitializeService({instanceIdentifier:i});r.resolve(s)}catch{}}}}clearInstance(n=Ks){this.instancesDeferred.delete(n),this.instancesOptions.delete(n),this.instances.delete(n)}delete(){return Z(this,null,function*(){let n=Array.from(this.instances.values());yield Promise.all([...n.filter(t=>"INTERNAL"in t).map(t=>t.INTERNAL.delete()),...n.filter(t=>"_delete"in t).map(t=>t._delete())])})}isComponentSet(){return this.component!=null}isInitialized(n=Ks){return this.instances.has(n)}getOptions(n=Ks){return this.instancesOptions.get(n)||{}}initialize(n={}){let{options:t={}}=n,r=this.normalizeInstanceIdentifier(n.instanceIdentifier);if(this.isInitialized(r))throw Error(`${this.name}(${r}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);let i=this.getOrInitializeService({instanceIdentifier:r,options:t});for(let[s,o]of this.instancesDeferred.entries()){let a=this.normalizeInstanceIdentifier(s);r===a&&o.resolve(i)}return i}onInit(n,t){var r;let i=this.normalizeInstanceIdentifier(t),s=(r=this.onInitCallbacks.get(i))!==null&&r!==void 0?r:new Set;s.add(n),this.onInitCallbacks.set(i,s);let o=this.instances.get(i);return o&&n(o,i),()=>{s.delete(n)}}invokeOnInitCallbacks(n,t){let r=this.onInitCallbacks.get(t);if(r)for(let i of r)try{i(n,t)}catch{}}getOrInitializeService({instanceIdentifier:n,options:t={}}){let r=this.instances.get(n);if(!r&&this.component&&(r=this.component.instanceFactory(this.container,{instanceIdentifier:vV(n),options:t}),this.instances.set(n,r),this.instancesOptions.set(n,t),this.invokeOnInitCallbacks(r,n),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,n,r)}catch{}return r||null}normalizeInstanceIdentifier(n=Ks){return this.component?this.component.multipleInstances?n:Ks:n}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}};function vV(e){return e===Ks?void 0:e}function _V(e){return e.instantiationMode==="EAGER"}var yl=class{constructor(n){this.name=n,this.providers=new Map}addComponent(n){let t=this.getProvider(n.name);if(t.isComponentSet())throw new Error(`Component ${n.name} has already been registered with ${this.name}`);t.setComponent(n)}addOrOverwriteComponent(n){this.getProvider(n.name).isComponentSet()&&this.providers.delete(n.name),this.addComponent(n)}getProvider(n){if(this.providers.has(n))return this.providers.get(n);let t=new Bd(n,this);return this.providers.set(n,t),t}getProviders(){return Array.from(this.providers.values())}};var xV=[],rt=function(e){return e[e.DEBUG=0]="DEBUG",e[e.VERBOSE=1]="VERBOSE",e[e.INFO=2]="INFO",e[e.WARN=3]="WARN",e[e.ERROR=4]="ERROR",e[e.SILENT=5]="SILENT",e}(rt||{}),yV={debug:rt.DEBUG,verbose:rt.VERBOSE,info:rt.INFO,warn:rt.WARN,error:rt.ERROR,silent:rt.SILENT},wV=rt.INFO,EV={[rt.DEBUG]:"log",[rt.VERBOSE]:"log",[rt.INFO]:"info",[rt.WARN]:"warn",[rt.ERROR]:"error"},TV=(e,n,...t)=>{if(n<e.logLevel)return;let r=new Date().toISOString(),i=EV[n];if(i)console[i](`[${r}]  ${e.name}:`,...t);else throw new Error(`Attempted to log a message with an invalid logType (value: ${n})`)},ns=class{constructor(n){this.name=n,this._logLevel=wV,this._logHandler=TV,this._userLogHandler=null,xV.push(this)}get logLevel(){return this._logLevel}set logLevel(n){if(!(n in rt))throw new TypeError(`Invalid value "${n}" assigned to \`logLevel\``);this._logLevel=n}setLogLevel(n){this._logLevel=typeof n=="string"?yV[n]:n}get logHandler(){return this._logHandler}set logHandler(n){if(typeof n!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=n}get userLogHandler(){return this._userLogHandler}set userLogHandler(n){this._userLogHandler=n}debug(...n){this._userLogHandler&&this._userLogHandler(this,rt.DEBUG,...n),this._logHandler(this,rt.DEBUG,...n)}log(...n){this._userLogHandler&&this._userLogHandler(this,rt.VERBOSE,...n),this._logHandler(this,rt.VERBOSE,...n)}info(...n){this._userLogHandler&&this._userLogHandler(this,rt.INFO,...n),this._logHandler(this,rt.INFO,...n)}warn(...n){this._userLogHandler&&this._userLogHandler(this,rt.WARN,...n),this._logHandler(this,rt.WARN,...n)}error(...n){this._userLogHandler&&this._userLogHandler(this,rt.ERROR,...n),this._logHandler(this,rt.ERROR,...n)}};var IV=(e,n)=>n.some(t=>e instanceof t),mS,gS;function CV(){return mS||(mS=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function SV(){return gS||(gS=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}var vS=new WeakMap,av=new WeakMap,_S=new WeakMap,ov=new WeakMap,lv=new WeakMap;function DV(e){let n=new Promise((t,r)=>{let i=()=>{e.removeEventListener("success",s),e.removeEventListener("error",o)},s=()=>{t(Xr(e.result)),i()},o=()=>{r(e.error),i()};e.addEventListener("success",s),e.addEventListener("error",o)});return n.then(t=>{t instanceof IDBCursor&&vS.set(t,e)}).catch(()=>{}),lv.set(n,e),n}function bV(e){if(av.has(e))return;let n=new Promise((t,r)=>{let i=()=>{e.removeEventListener("complete",s),e.removeEventListener("error",o),e.removeEventListener("abort",o)},s=()=>{t(),i()},o=()=>{r(e.error||new DOMException("AbortError","AbortError")),i()};e.addEventListener("complete",s),e.addEventListener("error",o),e.addEventListener("abort",o)});av.set(e,n)}var cv={get(e,n,t){if(e instanceof IDBTransaction){if(n==="done")return av.get(e);if(n==="objectStoreNames")return e.objectStoreNames||_S.get(e);if(n==="store")return t.objectStoreNames[1]?void 0:t.objectStore(t.objectStoreNames[0])}return Xr(e[n])},set(e,n,t){return e[n]=t,!0},has(e,n){return e instanceof IDBTransaction&&(n==="done"||n==="store")?!0:n in e}};function xS(e){cv=e(cv)}function AV(e){return e===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(n,...t){let r=e.call(Ud(this),n,...t);return _S.set(r,n.sort?n.sort():[n]),Xr(r)}:SV().includes(e)?function(...n){return e.apply(Ud(this),n),Xr(vS.get(this))}:function(...n){return Xr(e.apply(Ud(this),n))}}function kV(e){return typeof e=="function"?AV(e):(e instanceof IDBTransaction&&bV(e),IV(e,CV())?new Proxy(e,cv):e)}function Xr(e){if(e instanceof IDBRequest)return DV(e);if(ov.has(e))return ov.get(e);let n=kV(e);return n!==e&&(ov.set(e,n),lv.set(n,e)),n}var Ud=e=>lv.get(e);function wS(e,n,{blocked:t,upgrade:r,blocking:i,terminated:s}={}){let o=indexedDB.open(e,n),a=Xr(o);return r&&o.addEventListener("upgradeneeded",c=>{r(Xr(o.result),c.oldVersion,c.newVersion,Xr(o.transaction),c)}),t&&o.addEventListener("blocked",c=>t(c.oldVersion,c.newVersion,c)),a.then(c=>{s&&c.addEventListener("close",()=>s()),i&&c.addEventListener("versionchange",l=>i(l.oldVersion,l.newVersion,l))}).catch(()=>{}),a}var NV=["get","getKey","getAll","getAllKeys","count"],RV=["put","add","delete","clear"],uv=new Map;function yS(e,n){if(!(e instanceof IDBDatabase&&!(n in e)&&typeof n=="string"))return;if(uv.get(n))return uv.get(n);let t=n.replace(/FromIndex$/,""),r=n!==t,i=RV.includes(t);if(!(t in(r?IDBIndex:IDBObjectStore).prototype)||!(i||NV.includes(t)))return;let s=function(o,...a){return Z(this,null,function*(){let c=this.transaction(o,i?"readwrite":"readonly"),l=c.store;return r&&(l=l.index(a.shift())),(yield Promise.all([l[t](...a),i&&c.done]))[0]})};return uv.set(n,s),s}xS(e=>gt(de({},e),{get:(n,t,r)=>yS(n,t)||e.get(n,t,r),has:(n,t)=>!!yS(n,t)||e.has(n,t)}));var dv=class{constructor(n){this.container=n}getPlatformInfoString(){return this.container.getProviders().map(t=>{if(MV(t)){let r=t.getImmediate();return`${r.library}/${r.version}`}else return null}).filter(t=>t).join(" ")}};function MV(e){let n=e.getComponent();return n?.type==="VERSION"}var hv="@firebase/app",ES="0.10.13";var yi=new ns("@firebase/app"),OV="@firebase/app-compat",FV="@firebase/analytics-compat",PV="@firebase/analytics",LV="@firebase/app-check-compat",BV="@firebase/app-check",UV="@firebase/auth",jV="@firebase/auth-compat",VV="@firebase/database",HV="@firebase/data-connect",$V="@firebase/database-compat",WV="@firebase/functions",zV="@firebase/functions-compat",GV="@firebase/installations",qV="@firebase/installations-compat",KV="@firebase/messaging",YV="@firebase/messaging-compat",XV="@firebase/performance",QV="@firebase/performance-compat",ZV="@firebase/remote-config",JV="@firebase/remote-config-compat",eH="@firebase/storage",tH="@firebase/storage-compat",nH="@firebase/firestore",rH="@firebase/vertexai-preview",iH="@firebase/firestore-compat",sH="firebase",oH="10.14.1";var pv="[DEFAULT]",aH={[hv]:"fire-core",[OV]:"fire-core-compat",[PV]:"fire-analytics",[FV]:"fire-analytics-compat",[BV]:"fire-app-check",[LV]:"fire-app-check-compat",[UV]:"fire-auth",[jV]:"fire-auth-compat",[VV]:"fire-rtdb",[HV]:"fire-data-connect",[$V]:"fire-rtdb-compat",[WV]:"fire-fn",[zV]:"fire-fn-compat",[GV]:"fire-iid",[qV]:"fire-iid-compat",[KV]:"fire-fcm",[YV]:"fire-fcm-compat",[XV]:"fire-perf",[QV]:"fire-perf-compat",[ZV]:"fire-rc",[JV]:"fire-rc-compat",[eH]:"fire-gcs",[tH]:"fire-gcs-compat",[nH]:"fire-fst",[iH]:"fire-fst-compat",[rH]:"fire-vertex","fire-js":"fire-js",[sH]:"fire-js-all"};var wl=new Map,cH=new Map,mv=new Map;function TS(e,n){try{e.container.addComponent(n)}catch(t){yi.debug(`Component ${n.name} failed to register with FirebaseApp ${e.name}`,t)}}function is(e){let n=e.name;if(mv.has(n))return yi.debug(`There were multiple attempts to register component ${n}.`),!1;mv.set(n,e);for(let t of wl.values())TS(t,e);for(let t of cH.values())TS(t,e);return!0}function xv(e,n){let t=e.container.getProvider("heartbeat").getImmediate({optional:!0});return t&&t.triggerHeartbeat(),e.container.getProvider(n)}function ma(e){return e.settings!==void 0}var lH={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},rs=new xi("app","Firebase",lH);var gv=class{constructor(n,t,r){this._isDeleted=!1,this._options=Object.assign({},n),this._config=Object.assign({},t),this._name=t.name,this._automaticDataCollectionEnabled=t.automaticDataCollectionEnabled,this._container=r,this.container.addComponent(new sr("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(n){this.checkDestroyed(),this._automaticDataCollectionEnabled=n}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(n){this._isDeleted=n}checkDestroyed(){if(this.isDeleted)throw rs.create("app-deleted",{appName:this._name})}};var ga=oH;function yv(e,n={}){let t=e;typeof n!="object"&&(n={name:n});let r=Object.assign({name:pv,automaticDataCollectionEnabled:!1},n),i=r.name;if(typeof i!="string"||!i)throw rs.create("bad-app-name",{appName:String(i)});if(t||(t=iv()),!t)throw rs.create("no-options");let s=wl.get(i);if(s){if(vl(t,s.options)&&vl(r,s.config))return s;throw rs.create("duplicate-app",{appName:i})}let o=new yl(i);for(let c of mv.values())o.addComponent(c);let a=new gv(t,r,o);return wl.set(i,a),a}function Tl(e=pv){let n=wl.get(e);if(!n&&e===pv&&iv())return yv();if(!n)throw rs.create("no-app",{appName:e});return n}function jd(){return Array.from(wl.values())}function zt(e,n,t){var r;let i=(r=aH[e])!==null&&r!==void 0?r:e;t&&(i+=`-${t}`);let s=i.match(/\s|\//),o=n.match(/\s|\//);if(s||o){let a=[`Unable to register library "${i}" with version "${n}":`];s&&a.push(`library name "${i}" contains illegal characters (whitespace or "/")`),s&&o&&a.push("and"),o&&a.push(`version name "${n}" contains illegal characters (whitespace or "/")`),yi.warn(a.join(" "));return}is(new sr(`${i}-version`,()=>({library:i,version:n}),"VERSION"))}var uH="firebase-heartbeat-database",fH=1,El="firebase-heartbeat-store",fv=null;function DS(){return fv||(fv=wS(uH,fH,{upgrade:(e,n)=>{switch(n){case 0:try{e.createObjectStore(El)}catch(t){console.warn(t)}}}}).catch(e=>{throw rs.create("idb-open",{originalErrorMessage:e.message})})),fv}function dH(e){return Z(this,null,function*(){try{let t=(yield DS()).transaction(El),r=yield t.objectStore(El).get(bS(e));return yield t.done,r}catch(n){if(n instanceof Kr)yi.warn(n.message);else{let t=rs.create("idb-get",{originalErrorMessage:n?.message});yi.warn(t.message)}}})}function IS(e,n){return Z(this,null,function*(){try{let r=(yield DS()).transaction(El,"readwrite");yield r.objectStore(El).put(n,bS(e)),yield r.done}catch(t){if(t instanceof Kr)yi.warn(t.message);else{let r=rs.create("idb-set",{originalErrorMessage:t?.message});yi.warn(r.message)}}})}function bS(e){return`${e.name}!${e.options.appId}`}var hH=1024,pH=30*24*60*60*1e3,vv=class{constructor(n){this.container=n,this._heartbeatsCache=null;let t=this.container.getProvider("app").getImmediate();this._storage=new _v(t),this._heartbeatsCachePromise=this._storage.read().then(r=>(this._heartbeatsCache=r,r))}triggerHeartbeat(){return Z(this,null,function*(){var n,t;try{let i=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),s=CS();return((n=this._heartbeatsCache)===null||n===void 0?void 0:n.heartbeats)==null&&(this._heartbeatsCache=yield this._heartbeatsCachePromise,((t=this._heartbeatsCache)===null||t===void 0?void 0:t.heartbeats)==null)||this._heartbeatsCache.lastSentHeartbeatDate===s||this._heartbeatsCache.heartbeats.some(o=>o.date===s)?void 0:(this._heartbeatsCache.heartbeats.push({date:s,agent:i}),this._heartbeatsCache.heartbeats=this._heartbeatsCache.heartbeats.filter(o=>{let a=new Date(o.date).valueOf();return Date.now()-a<=pH}),this._storage.overwrite(this._heartbeatsCache))}catch(r){yi.warn(r)}})}getHeartbeatsHeader(){return Z(this,null,function*(){var n;try{if(this._heartbeatsCache===null&&(yield this._heartbeatsCachePromise),((n=this._heartbeatsCache)===null||n===void 0?void 0:n.heartbeats)==null||this._heartbeatsCache.heartbeats.length===0)return"";let t=CS(),{heartbeatsToSend:r,unsentEntries:i}=mH(this._heartbeatsCache.heartbeats),s=hl(JSON.stringify({version:2,heartbeats:r}));return this._heartbeatsCache.lastSentHeartbeatDate=t,i.length>0?(this._heartbeatsCache.heartbeats=i,yield this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),s}catch(t){return yi.warn(t),""}})}};function CS(){return new Date().toISOString().substring(0,10)}function mH(e,n=hH){let t=[],r=e.slice();for(let i of e){let s=t.find(o=>o.agent===i.agent);if(s){if(s.dates.push(i.date),SS(t)>n){s.dates.pop();break}}else if(t.push({agent:i.agent,dates:[i.date]}),SS(t)>n){t.pop();break}r=r.slice(1)}return{heartbeatsToSend:t,unsentEntries:r}}var _v=class{constructor(n){this.app=n,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}runIndexedDBEnvironmentCheck(){return Z(this,null,function*(){return cS()?lS().then(()=>!0).catch(()=>!1):!1})}read(){return Z(this,null,function*(){if(yield this._canUseIndexedDBPromise){let t=yield dH(this.app);return t?.heartbeats?t:{heartbeats:[]}}else return{heartbeats:[]}})}overwrite(n){return Z(this,null,function*(){var t;if(yield this._canUseIndexedDBPromise){let i=yield this.read();return IS(this.app,{lastSentHeartbeatDate:(t=n.lastSentHeartbeatDate)!==null&&t!==void 0?t:i.lastSentHeartbeatDate,heartbeats:n.heartbeats})}else return})}add(n){return Z(this,null,function*(){var t;if(yield this._canUseIndexedDBPromise){let i=yield this.read();return IS(this.app,{lastSentHeartbeatDate:(t=n.lastSentHeartbeatDate)!==null&&t!==void 0?t:i.lastSentHeartbeatDate,heartbeats:[...i.heartbeats,...n.heartbeats]})}else return})}};function SS(e){return hl(JSON.stringify({version:2,heartbeats:e})).length}function gH(e){is(new sr("platform-logger",n=>new dv(n),"PRIVATE")),is(new sr("heartbeat",n=>new vv(n),"PRIVATE")),zt(hv,ES,e),zt(hv,ES,"esm2017"),zt("fire-js","")}gH("");var vH="firebase",_H="10.14.1";zt(vH,_H,"app");var _a=new Pi("ANGULARFIRE2_VERSION");function Ev(e,n,t){if(n){if(n.length===1)return n[0];let s=n.filter(o=>o.app===t);if(s.length===1)return s[0]}return t.container.getProvider(e).getImmediate({optional:!0})}var Cl=(e,n)=>{let t=n?[n]:jd(),r=[];return t.forEach(i=>{i.container.getProvider(e).instances.forEach(o=>{r.includes(o)||r.push(o)})}),r},Il=class{constructor(){return Cl(xH)}},xH="app-check";function va(){}var Vd=class{zone;delegate;constructor(n,t=Zh){this.zone=n,this.delegate=t}now(){return this.delegate.now()}schedule(n,t,r){let i=this.zone,s=function(o){i.runGuarded(()=>{n.apply(this,[o])})};return this.delegate.schedule(s,t,r)}},wv=class{zone;task=null;constructor(n){this.zone=n}call(n,t){let r=this.unscheduleTask.bind(this);return this.task=this.zone.run(()=>Zone.current.scheduleMacroTask("firebaseZoneBlock",va,{},va,va)),t.pipe(St({next:r,complete:r,error:r})).subscribe(n).add(r)}unscheduleTask(){setTimeout(()=>{this.task!=null&&this.task.state==="scheduled"&&(this.task.invoke(),this.task=null)},10)}},Sl=(()=>{class e{ngZone;outsideAngular;insideAngular;constructor(t){this.ngZone=t,this.outsideAngular=t.runOutsideAngular(()=>new Vd(Zone.current)),this.insideAngular=t.run(()=>new Vd(Zone.current,Qh)),globalThis.\u0275AngularFireScheduler||=this}static \u0275fac=function(r){return new(r||e)(ue(Ye))};static \u0275prov=he({token:e,factory:e.\u0275fac,providedIn:"root"})}return e})();function Hd(){let e=globalThis.\u0275AngularFireScheduler;if(!e)throw new Error(`Either AngularFireModule has not been provided in your AppModule (this can be done manually or implictly using
provideFirebaseApp) or you're calling an AngularFire method outside of an NgModule (which is not supported).`);return e}function yH(e){return Hd().ngZone.runOutsideAngular(()=>e())}function Ys(e){return Hd().ngZone.run(()=>e())}function wH(e){return EH(Hd())(e)}function EH(e){return function(t){return t=t.lift(new wv(e.ngZone)),t.pipe(Di(e.outsideAngular),Si(e.insideAngular))}}var TH=(e,n)=>function(){let r=arguments;return n&&setTimeout(()=>{n.state==="scheduled"&&n.invoke()},10),Ys(()=>e.apply(void 0,r))},ss=(e,n)=>function(){let t,r=arguments;for(let s=0;s<arguments.length;s++)typeof r[s]=="function"&&(n&&(t||=Ys(()=>Zone.current.scheduleMacroTask("firebaseZoneBlock",va,{},va,va))),r[s]=TH(r[s],t));let i=yH(()=>e.apply(this,r));if(!n)if(i instanceof Ve){let s=Hd();return i.pipe(Di(s.outsideAngular),Si(s.insideAngular))}else return Ys(()=>i);return i instanceof Ve?i.pipe(wH):i instanceof Promise?Ys(()=>new Promise((s,o)=>i.then(a=>Ys(()=>s(a)),a=>Ys(()=>o(a))))):typeof i=="function"&&t?function(){return setTimeout(()=>{t&&t.state==="scheduled"&&t.invoke()},10),i.apply(this,arguments)}:Ys(()=>i)};var Xs=class{constructor(n){return n}},Dl=class{constructor(){return jd()}};function IH(e){return e&&e.length===1?e[0]:new Xs(Tl())}var Tv=new ge("angularfire2._apps"),CH={provide:Xs,useFactory:IH,deps:[[new qn,Tv]]},SH={provide:Dl,deps:[[new qn,Tv]]};function DH(e){return(n,t)=>{let r=n.runOutsideAngular(()=>e(t));return new Xs(r)}}var bH=(()=>{class e{constructor(t){zt("angularfire",_a.full,"core"),zt("angularfire",_a.full,"app"),zt("angular",Pw.full,t.toString())}static \u0275fac=function(r){return new(r||e)(ue(Xn))};static \u0275mod=Xt({type:e});static \u0275inj=Yt({providers:[CH,SH]})}return e})();function AS(e,...n){return{ngModule:bH,providers:[{provide:Tv,useFactory:DH(e),multi:!0,deps:[Ye,An,Sl,...n]}]}}var kS=ss(yv,!0);function BS(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}var US=BS,jS=new xi("auth","Firebase",BS());var Gd=new ns("@firebase/auth");function AH(e,...n){Gd.logLevel<=rt.WARN&&Gd.warn(`Auth (${ga}): ${e}`,...n)}function Wd(e,...n){Gd.logLevel<=rt.ERROR&&Gd.error(`Auth (${ga}): ${e}`,...n)}function NS(e,...n){throw Fv(e,...n)}function Ov(e,...n){return Fv(e,...n)}function VS(e,n,t){let r=Object.assign(Object.assign({},US()),{[n]:t});return new xi("auth","Firebase",r).create(n,{appName:e.name})}function zd(e){return VS(e,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function Fv(e,...n){if(typeof e!="string"){let t=n[0],r=[...n.slice(1)];return r[0]&&(r[0].appName=e.name),e._errorFactory.create(t,...r)}return jS.create(e,...n)}function et(e,n,...t){if(!e)throw Fv(n,...t)}function bl(e){let n="INTERNAL ASSERTION FAILED: "+e;throw Wd(n),new Error(n)}function qd(e,n){e||bl(n)}function kH(){return RS()==="http:"||RS()==="https:"}function RS(){var e;return typeof self<"u"&&((e=self.location)===null||e===void 0?void 0:e.protocol)||null}function NH(){return typeof navigator<"u"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(kH()||aS()||"connection"in navigator)?navigator.onLine:!0}function RH(){if(typeof navigator>"u")return null;let e=navigator;return e.languages&&e.languages[0]||e.language||null}var Zs=class{constructor(n,t){this.shortDelay=n,this.longDelay=t,qd(t>n,"Short delay should be less than long delay!"),this.isMobile=ml()||Pd()}get(){return NH()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}};function MH(e,n){qd(e.emulator,"Emulator should always be set here");let{url:t}=e.emulator;return n?`${t}${n.startsWith("/")?n.slice(1):n}`:t}var Kd=class{static initialize(n,t,r){this.fetchImpl=n,t&&(this.headersImpl=t),r&&(this.responseImpl=r)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<"u"&&"fetch"in self)return self.fetch;if(typeof globalThis<"u"&&globalThis.fetch)return globalThis.fetch;if(typeof fetch<"u")return fetch;bl("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<"u"&&"Headers"in self)return self.Headers;if(typeof globalThis<"u"&&globalThis.Headers)return globalThis.Headers;if(typeof Headers<"u")return Headers;bl("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<"u"&&"Response"in self)return self.Response;if(typeof globalThis<"u"&&globalThis.Response)return globalThis.Response;if(typeof Response<"u")return Response;bl("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}};var OH={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"};var FH=new Zs(3e4,6e4);function HS(e,n){return e.tenantId&&!n.tenantId?Object.assign(Object.assign({},n),{tenantId:e.tenantId}):n}function Zd(s,o,a,c){return Z(this,arguments,function*(e,n,t,r,i={}){return $S(e,i,()=>Z(this,null,function*(){let l={},u={};r&&(n==="GET"?u=r:l={body:JSON.stringify(r)});let f=_l(Object.assign({key:e.config.apiKey},u)).slice(1),d=yield e._getAdditionalHeaders();d["Content-Type"]="application/json",e.languageCode&&(d["X-Firebase-Locale"]=e.languageCode);let h=Object.assign({method:n,headers:d},l);return oS()||(h.referrerPolicy="no-referrer"),Kd.fetch()(WS(e,e.config.apiHost,t,f),h)}))})}function $S(e,n,t){return Z(this,null,function*(){e._canInitEmulator=!1;let r=Object.assign(Object.assign({},OH),n);try{let i=new Sv(e),s=yield Promise.race([t(),i.promise]);i.clearNetworkTimeout();let o=yield s.json();if("needConfirmation"in o)throw $d(e,"account-exists-with-different-credential",o);if(s.ok&&!("errorMessage"in o))return o;{let a=s.ok?o.errorMessage:o.error.message,[c,l]=a.split(" : ");if(c==="FEDERATED_USER_ID_ALREADY_LINKED")throw $d(e,"credential-already-in-use",o);if(c==="EMAIL_EXISTS")throw $d(e,"email-already-in-use",o);if(c==="USER_DISABLED")throw $d(e,"user-disabled",o);let u=r[c]||c.toLowerCase().replace(/[_\s]+/g,"-");if(l)throw VS(e,u,l);NS(e,u)}}catch(i){if(i instanceof Kr)throw i;NS(e,"network-request-failed",{message:String(i)})}})}function WS(e,n,t,r){let i=`${n}${t}?${r}`;return e.config.emulator?MH(e.config,i):`${e.config.apiScheme}://${i}`}var Sv=class{constructor(n){this.auth=n,this.timer=null,this.promise=new Promise((t,r)=>{this.timer=setTimeout(()=>r(Ov(this.auth,"network-request-failed")),FH.get())})}clearNetworkTimeout(){clearTimeout(this.timer)}};function $d(e,n,t){let r={appName:e.name};t.email&&(r.email=t.email),t.phoneNumber&&(r.phoneNumber=t.phoneNumber);let i=Ov(e,n,r);return i.customData._tokenResponse=t,i}function PH(e,n){return Z(this,null,function*(){return Zd(e,"POST","/v1/accounts:delete",n)})}function zS(e,n){return Z(this,null,function*(){return Zd(e,"POST","/v1/accounts:lookup",n)})}function Al(e){if(e)try{let n=new Date(Number(e));if(!isNaN(n.getTime()))return n.toUTCString()}catch{}}function Pv(e,n=!1){return Z(this,null,function*(){let t=ir(e),r=yield t.getIdToken(n),i=GS(r);et(i&&i.exp&&i.auth_time&&i.iat,t.auth,"internal-error");let s=typeof i.firebase=="object"?i.firebase:void 0,o=s?.sign_in_provider;return{claims:i,token:r,authTime:Al(Iv(i.auth_time)),issuedAtTime:Al(Iv(i.iat)),expirationTime:Al(Iv(i.exp)),signInProvider:o||null,signInSecondFactor:s?.sign_in_second_factor||null}})}function Iv(e){return Number(e)*1e3}function GS(e){let[n,t,r]=e.split(".");if(n===void 0||t===void 0||r===void 0)return Wd("JWT malformed, contained fewer than 3 sections"),null;try{let i=pl(t);return i?JSON.parse(i):(Wd("Failed to decode base64 JWT payload"),null)}catch(i){return Wd("Caught error parsing JWT payload as JSON",i?.toString()),null}}function MS(e){let n=GS(e);return et(n,"internal-error"),et(typeof n.exp<"u","internal-error"),et(typeof n.iat<"u","internal-error"),Number(n.exp)-Number(n.iat)}function Dv(e,n,t=!1){return Z(this,null,function*(){if(t)return n;try{return yield n}catch(r){throw r instanceof Kr&&LH(r)&&e.auth.currentUser===e&&(yield e.auth.signOut()),r}})}function LH({code:e}){return e==="auth/user-disabled"||e==="auth/user-token-expired"}var bv=class{constructor(n){this.user=n,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(n){var t;if(n){let r=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),r}else{this.errorBackoff=3e4;let i=((t=this.user.stsTokenManager.expirationTime)!==null&&t!==void 0?t:0)-Date.now()-3e5;return Math.max(0,i)}}schedule(n=!1){if(!this.isRunning)return;let t=this.getInterval(n);this.timerId=setTimeout(()=>Z(this,null,function*(){yield this.iteration()}),t)}iteration(){return Z(this,null,function*(){try{yield this.user.getIdToken(!0)}catch(n){n?.code==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()})}};var Nl=class{constructor(n,t){this.createdAt=n,this.lastLoginAt=t,this._initializeTime()}_initializeTime(){this.lastSignInTime=Al(this.lastLoginAt),this.creationTime=Al(this.createdAt)}_copy(n){this.createdAt=n.createdAt,this.lastLoginAt=n.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}};function Yd(e){return Z(this,null,function*(){var n;let t=e.auth,r=yield e.getIdToken(),i=yield Dv(e,zS(t,{idToken:r}));et(i?.users.length,t,"internal-error");let s=i.users[0];e._notifyReloadListener(s);let o=!((n=s.providerUserInfo)===null||n===void 0)&&n.length?qS(s.providerUserInfo):[],a=BH(e.providerData,o),c=e.isAnonymous,l=!(e.email&&s.passwordHash)&&!a?.length,u=c?l:!1,f={uid:s.localId,displayName:s.displayName||null,photoURL:s.photoUrl||null,email:s.email||null,emailVerified:s.emailVerified||!1,phoneNumber:s.phoneNumber||null,tenantId:s.tenantId||null,providerData:a,metadata:new Nl(s.createdAt,s.lastLoginAt),isAnonymous:u};Object.assign(e,f)})}function Lv(e){return Z(this,null,function*(){let n=ir(e);yield Yd(n),yield n.auth._persistUserIfCurrent(n),n.auth._notifyListenersIfCurrent(n)})}function BH(e,n){return[...e.filter(r=>!n.some(i=>i.providerId===r.providerId)),...n]}function qS(e){return e.map(n=>{var{providerId:t}=n,r=Jh(n,["providerId"]);return{providerId:t,uid:r.rawId||"",displayName:r.displayName||null,email:r.email||null,phoneNumber:r.phoneNumber||null,photoURL:r.photoUrl||null}})}function UH(e,n){return Z(this,null,function*(){let t=yield $S(e,{},()=>Z(this,null,function*(){let r=_l({grant_type:"refresh_token",refresh_token:n}).slice(1),{tokenApiHost:i,apiKey:s}=e.config,o=WS(e,i,"/v1/token",`key=${s}`),a=yield e._getAdditionalHeaders();return a["Content-Type"]="application/x-www-form-urlencoded",Kd.fetch()(o,{method:"POST",headers:a,body:r})}));return{accessToken:t.access_token,expiresIn:t.expires_in,refreshToken:t.refresh_token}})}function jH(e,n){return Z(this,null,function*(){return Zd(e,"POST","/v2/accounts:revokeToken",HS(e,n))})}var kl=class e{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(n){et(n.idToken,"internal-error"),et(typeof n.idToken<"u","internal-error"),et(typeof n.refreshToken<"u","internal-error");let t="expiresIn"in n&&typeof n.expiresIn<"u"?Number(n.expiresIn):MS(n.idToken);this.updateTokensAndExpiration(n.idToken,n.refreshToken,t)}updateFromIdToken(n){et(n.length!==0,"internal-error");let t=MS(n);this.updateTokensAndExpiration(n,null,t)}getToken(n,t=!1){return Z(this,null,function*(){return!t&&this.accessToken&&!this.isExpired?this.accessToken:(et(this.refreshToken,n,"user-token-expired"),this.refreshToken?(yield this.refresh(n,this.refreshToken),this.accessToken):null)})}clearRefreshToken(){this.refreshToken=null}refresh(n,t){return Z(this,null,function*(){let{accessToken:r,refreshToken:i,expiresIn:s}=yield UH(n,t);this.updateTokensAndExpiration(r,i,Number(s))})}updateTokensAndExpiration(n,t,r){this.refreshToken=t||null,this.accessToken=n||null,this.expirationTime=Date.now()+r*1e3}static fromJSON(n,t){let{refreshToken:r,accessToken:i,expirationTime:s}=t,o=new e;return r&&(et(typeof r=="string","internal-error",{appName:n}),o.refreshToken=r),i&&(et(typeof i=="string","internal-error",{appName:n}),o.accessToken=i),s&&(et(typeof s=="number","internal-error",{appName:n}),o.expirationTime=s),o}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(n){this.accessToken=n.accessToken,this.refreshToken=n.refreshToken,this.expirationTime=n.expirationTime}_clone(){return Object.assign(new e,this.toJSON())}_performRefresh(){return bl("not implemented")}};function os(e,n){et(typeof e=="string"||typeof e>"u","internal-error",{appName:n})}var Rl=class e{constructor(n){var{uid:t,auth:r,stsTokenManager:i}=n,s=Jh(n,["uid","auth","stsTokenManager"]);this.providerId="firebase",this.proactiveRefresh=new bv(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=t,this.auth=r,this.stsTokenManager=i,this.accessToken=i.accessToken,this.displayName=s.displayName||null,this.email=s.email||null,this.emailVerified=s.emailVerified||!1,this.phoneNumber=s.phoneNumber||null,this.photoURL=s.photoURL||null,this.isAnonymous=s.isAnonymous||!1,this.tenantId=s.tenantId||null,this.providerData=s.providerData?[...s.providerData]:[],this.metadata=new Nl(s.createdAt||void 0,s.lastLoginAt||void 0)}getIdToken(n){return Z(this,null,function*(){let t=yield Dv(this,this.stsTokenManager.getToken(this.auth,n));return et(t,this.auth,"internal-error"),this.accessToken!==t&&(this.accessToken=t,yield this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),t})}getIdTokenResult(n){return Pv(this,n)}reload(){return Lv(this)}_assign(n){this!==n&&(et(this.uid===n.uid,this.auth,"internal-error"),this.displayName=n.displayName,this.photoURL=n.photoURL,this.email=n.email,this.emailVerified=n.emailVerified,this.phoneNumber=n.phoneNumber,this.isAnonymous=n.isAnonymous,this.tenantId=n.tenantId,this.providerData=n.providerData.map(t=>Object.assign({},t)),this.metadata._copy(n.metadata),this.stsTokenManager._assign(n.stsTokenManager))}_clone(n){let t=new e(Object.assign(Object.assign({},this),{auth:n,stsTokenManager:this.stsTokenManager._clone()}));return t.metadata._copy(this.metadata),t}_onReload(n){et(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=n,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(n){this.reloadListener?this.reloadListener(n):this.reloadUserInfo=n}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}_updateTokensIfNecessary(n,t=!1){return Z(this,null,function*(){let r=!1;n.idToken&&n.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(n),r=!0),t&&(yield Yd(this)),yield this.auth._persistUserIfCurrent(this),r&&this.auth._notifyListenersIfCurrent(this)})}delete(){return Z(this,null,function*(){if(ma(this.auth.app))return Promise.reject(zd(this.auth));let n=yield this.getIdToken();return yield Dv(this,PH(this.auth,{idToken:n})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()})}toJSON(){return Object.assign(Object.assign({uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(n=>Object.assign({},n)),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId},this.metadata.toJSON()),{apiKey:this.auth.config.apiKey,appName:this.auth.name})}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(n,t){var r,i,s,o,a,c,l,u;let f=(r=t.displayName)!==null&&r!==void 0?r:void 0,d=(i=t.email)!==null&&i!==void 0?i:void 0,h=(s=t.phoneNumber)!==null&&s!==void 0?s:void 0,m=(o=t.photoURL)!==null&&o!==void 0?o:void 0,p=(a=t.tenantId)!==null&&a!==void 0?a:void 0,g=(c=t._redirectEventId)!==null&&c!==void 0?c:void 0,w=(l=t.createdAt)!==null&&l!==void 0?l:void 0,C=(u=t.lastLoginAt)!==null&&u!==void 0?u:void 0,{uid:_,emailVerified:M,isAnonymous:V,providerData:A,stsTokenManager:S}=t;et(_&&S,n,"internal-error");let F=kl.fromJSON(this.name,S);et(typeof _=="string",n,"internal-error"),os(f,n.name),os(d,n.name),et(typeof M=="boolean",n,"internal-error"),et(typeof V=="boolean",n,"internal-error"),os(h,n.name),os(m,n.name),os(p,n.name),os(g,n.name),os(w,n.name),os(C,n.name);let N=new e({uid:_,auth:n,email:d,emailVerified:M,displayName:f,isAnonymous:V,photoURL:m,phoneNumber:h,tenantId:p,stsTokenManager:F,createdAt:w,lastLoginAt:C});return A&&Array.isArray(A)&&(N.providerData=A.map(H=>Object.assign({},H))),g&&(N._redirectEventId=g),N}static _fromIdTokenResponse(n,t,r=!1){return Z(this,null,function*(){let i=new kl;i.updateFromServerResponse(t);let s=new e({uid:t.localId,auth:n,stsTokenManager:i,isAnonymous:r});return yield Yd(s),s})}static _fromGetAccountInfoResponse(n,t,r){return Z(this,null,function*(){let i=t.users[0];et(i.localId!==void 0,"internal-error");let s=i.providerUserInfo!==void 0?qS(i.providerUserInfo):[],o=!(i.email&&i.passwordHash)&&!s?.length,a=new kl;a.updateFromIdToken(r);let c=new e({uid:i.localId,auth:n,stsTokenManager:a,isAnonymous:o}),l={uid:i.localId,displayName:i.displayName||null,photoURL:i.photoUrl||null,email:i.email||null,emailVerified:i.emailVerified||!1,phoneNumber:i.phoneNumber||null,tenantId:i.tenantId||null,providerData:s,metadata:new Nl(i.createdAt,i.lastLoginAt),isAnonymous:!(i.email&&i.passwordHash)&&!s?.length};return Object.assign(c,l),c})}};var OS=new Map;function Qs(e){qd(e instanceof Function,"Expected a class definition");let n=OS.get(e);return n?(qd(n instanceof e,"Instance stored in cache mismatched with class"),n):(n=new e,OS.set(e,n),n)}var VH=(()=>{class e{constructor(){this.type="NONE",this.storage={}}_isAvailable(){return Z(this,null,function*(){return!0})}_set(t,r){return Z(this,null,function*(){this.storage[t]=r})}_get(t){return Z(this,null,function*(){let r=this.storage[t];return r===void 0?null:r})}_remove(t){return Z(this,null,function*(){delete this.storage[t]})}_addListener(t,r){}_removeListener(t,r){}}return e.type="NONE",e})(),Av=VH;function Cv(e,n,t){return`firebase:${e}:${n}:${t}`}var Xd=class e{constructor(n,t,r){this.persistence=n,this.auth=t,this.userKey=r;let{config:i,name:s}=this.auth;this.fullUserKey=Cv(this.userKey,i.apiKey,s),this.fullPersistenceKey=Cv("persistence",i.apiKey,s),this.boundEventHandler=t._onStorageEvent.bind(t),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(n){return this.persistence._set(this.fullUserKey,n.toJSON())}getCurrentUser(){return Z(this,null,function*(){let n=yield this.persistence._get(this.fullUserKey);return n?Rl._fromJSON(this.auth,n):null})}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}setPersistence(n){return Z(this,null,function*(){if(this.persistence===n)return;let t=yield this.getCurrentUser();if(yield this.removeCurrentUser(),this.persistence=n,t)return this.setCurrentUser(t)})}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static create(n,t,r="authUser"){return Z(this,null,function*(){if(!t.length)return new e(Qs(Av),n,r);let i=(yield Promise.all(t.map(l=>Z(this,null,function*(){if(yield l._isAvailable())return l})))).filter(l=>l),s=i[0]||Qs(Av),o=Cv(r,n.config.apiKey,n.name),a=null;for(let l of t)try{let u=yield l._get(o);if(u){let f=Rl._fromJSON(n,u);l!==s&&(a=f),s=l;break}}catch{}let c=i.filter(l=>l._shouldAllowMigration);return!s._shouldAllowMigration||!c.length?new e(s,n,r):(s=c[0],a&&(yield s._set(o,a.toJSON())),yield Promise.all(t.map(l=>Z(this,null,function*(){if(l!==s)try{yield l._remove(o)}catch{}}))),new e(s,n,r))})}};function FS(e){let n=e.toLowerCase();if(n.includes("opera/")||n.includes("opr/")||n.includes("opios/"))return"Opera";if(zH(n))return"IEMobile";if(n.includes("msie")||n.includes("trident/"))return"IE";if(n.includes("edge/"))return"Edge";if(HH(n))return"Firefox";if(n.includes("silk/"))return"Silk";if(qH(n))return"Blackberry";if(KH(n))return"Webos";if($H(n))return"Safari";if((n.includes("chrome/")||WH(n))&&!n.includes("edge/"))return"Chrome";if(GH(n))return"Android";{let t=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,r=e.match(t);if(r?.length===2)return r[1]}return"Other"}function HH(e=Er()){return/firefox\//i.test(e)}function $H(e=Er()){let n=e.toLowerCase();return n.includes("safari/")&&!n.includes("chrome/")&&!n.includes("crios/")&&!n.includes("android")}function WH(e=Er()){return/crios\//i.test(e)}function zH(e=Er()){return/iemobile/i.test(e)}function GH(e=Er()){return/android/i.test(e)}function qH(e=Er()){return/blackberry/i.test(e)}function KH(e=Er()){return/webos/i.test(e)}function KS(e,n=[]){let t;switch(e){case"Browser":t=FS(Er());break;case"Worker":t=`${FS(Er())}-${e}`;break;default:t=e}let r=n.length?n.join(","):"FirebaseCore-web";return`${t}/JsCore/${ga}/${r}`}var kv=class{constructor(n){this.auth=n,this.queue=[]}pushCallback(n,t){let r=s=>new Promise((o,a)=>{try{let c=n(s);o(c)}catch(c){a(c)}});r.onAbort=t,this.queue.push(r);let i=this.queue.length-1;return()=>{this.queue[i]=()=>Promise.resolve()}}runMiddleware(n){return Z(this,null,function*(){if(this.auth.currentUser===n)return;let t=[];try{for(let r of this.queue)yield r(n),r.onAbort&&t.push(r.onAbort)}catch(r){t.reverse();for(let i of t)try{i()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:r?.message})}})}};function YH(t){return Z(this,arguments,function*(e,n={}){return Zd(e,"GET","/v2/passwordPolicy",HS(e,n))})}var XH=6,Nv=class{constructor(n){var t,r,i,s;let o=n.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=(t=o.minPasswordLength)!==null&&t!==void 0?t:XH,o.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=o.maxPasswordLength),o.containsLowercaseCharacter!==void 0&&(this.customStrengthOptions.containsLowercaseLetter=o.containsLowercaseCharacter),o.containsUppercaseCharacter!==void 0&&(this.customStrengthOptions.containsUppercaseLetter=o.containsUppercaseCharacter),o.containsNumericCharacter!==void 0&&(this.customStrengthOptions.containsNumericCharacter=o.containsNumericCharacter),o.containsNonAlphanumericCharacter!==void 0&&(this.customStrengthOptions.containsNonAlphanumericCharacter=o.containsNonAlphanumericCharacter),this.enforcementState=n.enforcementState,this.enforcementState==="ENFORCEMENT_STATE_UNSPECIFIED"&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=(i=(r=n.allowedNonAlphanumericCharacters)===null||r===void 0?void 0:r.join(""))!==null&&i!==void 0?i:"",this.forceUpgradeOnSignin=(s=n.forceUpgradeOnSignin)!==null&&s!==void 0?s:!1,this.schemaVersion=n.schemaVersion}validatePassword(n){var t,r,i,s,o,a;let c={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(n,c),this.validatePasswordCharacterOptions(n,c),c.isValid&&(c.isValid=(t=c.meetsMinPasswordLength)!==null&&t!==void 0?t:!0),c.isValid&&(c.isValid=(r=c.meetsMaxPasswordLength)!==null&&r!==void 0?r:!0),c.isValid&&(c.isValid=(i=c.containsLowercaseLetter)!==null&&i!==void 0?i:!0),c.isValid&&(c.isValid=(s=c.containsUppercaseLetter)!==null&&s!==void 0?s:!0),c.isValid&&(c.isValid=(o=c.containsNumericCharacter)!==null&&o!==void 0?o:!0),c.isValid&&(c.isValid=(a=c.containsNonAlphanumericCharacter)!==null&&a!==void 0?a:!0),c}validatePasswordLengthOptions(n,t){let r=this.customStrengthOptions.minPasswordLength,i=this.customStrengthOptions.maxPasswordLength;r&&(t.meetsMinPasswordLength=n.length>=r),i&&(t.meetsMaxPasswordLength=n.length<=i)}validatePasswordCharacterOptions(n,t){this.updatePasswordCharacterOptionsStatuses(t,!1,!1,!1,!1);let r;for(let i=0;i<n.length;i++)r=n.charAt(i),this.updatePasswordCharacterOptionsStatuses(t,r>="a"&&r<="z",r>="A"&&r<="Z",r>="0"&&r<="9",this.allowedNonAlphanumericCharacters.includes(r))}updatePasswordCharacterOptionsStatuses(n,t,r,i,s){this.customStrengthOptions.containsLowercaseLetter&&(n.containsLowercaseLetter||(n.containsLowercaseLetter=t)),this.customStrengthOptions.containsUppercaseLetter&&(n.containsUppercaseLetter||(n.containsUppercaseLetter=r)),this.customStrengthOptions.containsNumericCharacter&&(n.containsNumericCharacter||(n.containsNumericCharacter=i)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(n.containsNonAlphanumericCharacter||(n.containsNonAlphanumericCharacter=s))}};var Rv=class{constructor(n,t,r,i){this.app=n,this.heartbeatServiceProvider=t,this.appCheckServiceProvider=r,this.config=i,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new Qd(this),this.idTokenSubscription=new Qd(this),this.beforeStateQueue=new kv(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=jS,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=n.name,this.clientVersion=i.sdkClientVersion}_initializeWithPersistence(n,t){return t&&(this._popupRedirectResolver=Qs(t)),this._initializationPromise=this.queue(()=>Z(this,null,function*(){var r,i;if(!this._deleted&&(this.persistenceManager=yield Xd.create(this,n),!this._deleted)){if(!((r=this._popupRedirectResolver)===null||r===void 0)&&r._shouldInitProactively)try{yield this._popupRedirectResolver._initialize(this)}catch{}yield this.initializeCurrentUser(t),this.lastNotifiedUid=((i=this.currentUser)===null||i===void 0?void 0:i.uid)||null,!this._deleted&&(this._isInitialized=!0)}})),this._initializationPromise}_onStorageEvent(){return Z(this,null,function*(){if(this._deleted)return;let n=yield this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!n)){if(this.currentUser&&n&&this.currentUser.uid===n.uid){this._currentUser._assign(n),yield this.currentUser.getIdToken();return}yield this._updateCurrentUser(n,!0)}})}initializeCurrentUserFromIdToken(n){return Z(this,null,function*(){try{let t=yield zS(this,{idToken:n}),r=yield Rl._fromGetAccountInfoResponse(this,t,n);yield this.directlySetCurrentUser(r)}catch(t){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",t),yield this.directlySetCurrentUser(null)}})}initializeCurrentUser(n){return Z(this,null,function*(){var t;if(ma(this.app)){let o=this.app.settings.authIdToken;return o?new Promise(a=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(o).then(a,a))}):this.directlySetCurrentUser(null)}let r=yield this.assertedPersistence.getCurrentUser(),i=r,s=!1;if(n&&this.config.authDomain){yield this.getOrInitRedirectPersistenceManager();let o=(t=this.redirectUser)===null||t===void 0?void 0:t._redirectEventId,a=i?._redirectEventId,c=yield this.tryRedirectSignIn(n);(!o||o===a)&&c?.user&&(i=c.user,s=!0)}if(!i)return this.directlySetCurrentUser(null);if(!i._redirectEventId){if(s)try{yield this.beforeStateQueue.runMiddleware(i)}catch(o){i=r,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(o))}return i?this.reloadAndSetCurrentUserOrClear(i):this.directlySetCurrentUser(null)}return et(this._popupRedirectResolver,this,"argument-error"),yield this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===i._redirectEventId?this.directlySetCurrentUser(i):this.reloadAndSetCurrentUserOrClear(i)})}tryRedirectSignIn(n){return Z(this,null,function*(){let t=null;try{t=yield this._popupRedirectResolver._completeRedirectFn(this,n,!0)}catch{yield this._setRedirectUser(null)}return t})}reloadAndSetCurrentUserOrClear(n){return Z(this,null,function*(){try{yield Yd(n)}catch(t){if(t?.code!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(n)})}useDeviceLanguage(){this.languageCode=RH()}_delete(){return Z(this,null,function*(){this._deleted=!0})}updateCurrentUser(n){return Z(this,null,function*(){if(ma(this.app))return Promise.reject(zd(this));let t=n?ir(n):null;return t&&et(t.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(t&&t._clone(this))})}_updateCurrentUser(n,t=!1){return Z(this,null,function*(){if(!this._deleted)return n&&et(this.tenantId===n.tenantId,this,"tenant-id-mismatch"),t||(yield this.beforeStateQueue.runMiddleware(n)),this.queue(()=>Z(this,null,function*(){yield this.directlySetCurrentUser(n),this.notifyAuthListeners()}))})}signOut(){return Z(this,null,function*(){return ma(this.app)?Promise.reject(zd(this)):(yield this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&(yield this._setRedirectUser(null)),this._updateCurrentUser(null,!0))})}setPersistence(n){return ma(this.app)?Promise.reject(zd(this)):this.queue(()=>Z(this,null,function*(){yield this.assertedPersistence.setPersistence(Qs(n))}))}_getRecaptchaConfig(){return this.tenantId==null?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}validatePassword(n){return Z(this,null,function*(){this._getPasswordPolicyInternal()||(yield this._updatePasswordPolicy());let t=this._getPasswordPolicyInternal();return t.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):t.validatePassword(n)})}_getPasswordPolicyInternal(){return this.tenantId===null?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}_updatePasswordPolicy(){return Z(this,null,function*(){let n=yield YH(this),t=new Nv(n);this.tenantId===null?this._projectPasswordPolicy=t:this._tenantPasswordPolicies[this.tenantId]=t})}_getPersistence(){return this.assertedPersistence.persistence.type}_updateErrorMap(n){this._errorFactory=new xi("auth","Firebase",n())}onAuthStateChanged(n,t,r){return this.registerStateListener(this.authStateSubscription,n,t,r)}beforeAuthStateChanged(n,t){return this.beforeStateQueue.pushCallback(n,t)}onIdTokenChanged(n,t,r){return this.registerStateListener(this.idTokenSubscription,n,t,r)}authStateReady(){return new Promise((n,t)=>{if(this.currentUser)n();else{let r=this.onAuthStateChanged(()=>{r(),n()},t)}})}revokeAccessToken(n){return Z(this,null,function*(){if(this.currentUser){let t=yield this.currentUser.getIdToken(),r={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:n,idToken:t};this.tenantId!=null&&(r.tenantId=this.tenantId),yield jH(this,r)}})}toJSON(){var n;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:(n=this._currentUser)===null||n===void 0?void 0:n.toJSON()}}_setRedirectUser(n,t){return Z(this,null,function*(){let r=yield this.getOrInitRedirectPersistenceManager(t);return n===null?r.removeCurrentUser():r.setCurrentUser(n)})}getOrInitRedirectPersistenceManager(n){return Z(this,null,function*(){if(!this.redirectPersistenceManager){let t=n&&Qs(n)||this._popupRedirectResolver;et(t,this,"argument-error"),this.redirectPersistenceManager=yield Xd.create(this,[Qs(t._redirectPersistence)],"redirectUser"),this.redirectUser=yield this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager})}_redirectUserForId(n){return Z(this,null,function*(){var t,r;return this._isInitialized&&(yield this.queue(()=>Z(this,null,function*(){}))),((t=this._currentUser)===null||t===void 0?void 0:t._redirectEventId)===n?this._currentUser:((r=this.redirectUser)===null||r===void 0?void 0:r._redirectEventId)===n?this.redirectUser:null})}_persistUserIfCurrent(n){return Z(this,null,function*(){if(n===this.currentUser)return this.queue(()=>Z(this,null,function*(){return this.directlySetCurrentUser(n)}))})}_notifyListenersIfCurrent(n){n===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){var n,t;if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);let r=(t=(n=this.currentUser)===null||n===void 0?void 0:n.uid)!==null&&t!==void 0?t:null;this.lastNotifiedUid!==r&&(this.lastNotifiedUid=r,this.authStateSubscription.next(this.currentUser))}registerStateListener(n,t,r,i){if(this._deleted)return()=>{};let s=typeof t=="function"?t:t.next.bind(t),o=!1,a=this._isInitialized?Promise.resolve():this._initializationPromise;if(et(a,this,"internal-error"),a.then(()=>{o||s(this.currentUser)}),typeof t=="function"){let c=n.addObserver(t,r,i);return()=>{o=!0,c()}}else{let c=n.addObserver(t);return()=>{o=!0,c()}}}directlySetCurrentUser(n){return Z(this,null,function*(){this.currentUser&&this.currentUser!==n&&this._currentUser._stopProactiveRefresh(),n&&this.isProactiveRefreshEnabled&&n._startProactiveRefresh(),this.currentUser=n,n?yield this.assertedPersistence.setCurrentUser(n):yield this.assertedPersistence.removeCurrentUser()})}queue(n){return this.operations=this.operations.then(n,n),this.operations}get assertedPersistence(){return et(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(n){!n||this.frameworks.includes(n)||(this.frameworks.push(n),this.frameworks.sort(),this.clientVersion=KS(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}_getAdditionalHeaders(){return Z(this,null,function*(){var n;let t={"X-Client-Version":this.clientVersion};this.app.options.appId&&(t["X-Firebase-gmpid"]=this.app.options.appId);let r=yield(n=this.heartbeatServiceProvider.getImmediate({optional:!0}))===null||n===void 0?void 0:n.getHeartbeatsHeader();r&&(t["X-Firebase-Client"]=r);let i=yield this._getAppCheckToken();return i&&(t["X-Firebase-AppCheck"]=i),t})}_getAppCheckToken(){return Z(this,null,function*(){var n;let t=yield(n=this.appCheckServiceProvider.getImmediate({optional:!0}))===null||n===void 0?void 0:n.getToken();return t?.error&&AH(`Error while retrieving App Check token: ${t.error}`),t?.token})}};function QH(e){return ir(e)}var Qd=class{constructor(n){this.auth=n,this.observer=null,this.addObserver=hS(t=>this.observer=t)}get next(){return et(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}};var ZH={loadJS(){return Z(this,null,function*(){throw new Error("Unable to load external scripts")})},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function JH(e){ZH=e}function e$(e){return`__${e}${Math.floor(Math.random()*1e6)}`}function t$(e,n){let t=n?.persistence||[],r=(Array.isArray(t)?t:[t]).map(Qs);n?.errorMap&&e._updateErrorMap(n.errorMap),e._initializeWithPersistence(r,n?.popupRedirectResolver)}var LJ=e$("rcb"),BJ=new Zs(3e4,6e4);var UJ=new Zs(2e3,1e4);var jJ=10*60*1e3;var VJ=new Zs(3e4,6e4);var HJ=new Zs(5e3,15e3);var $J=encodeURIComponent("fac");var PS="@firebase/auth",LS="1.7.9";var Mv=class{constructor(n){this.auth=n,this.internalListeners=new Map}getUid(){var n;return this.assertAuthConfigured(),((n=this.auth.currentUser)===null||n===void 0?void 0:n.uid)||null}getToken(n){return Z(this,null,function*(){return this.assertAuthConfigured(),yield this.auth._initializationPromise,this.auth.currentUser?{accessToken:yield this.auth.currentUser.getIdToken(n)}:null})}addAuthTokenListener(n){if(this.assertAuthConfigured(),this.internalListeners.has(n))return;let t=this.auth.onIdTokenChanged(r=>{n(r?.stsTokenManager.accessToken||null)});this.internalListeners.set(n,t),this.updateProactiveRefresh()}removeAuthTokenListener(n){this.assertAuthConfigured();let t=this.internalListeners.get(n);t&&(this.internalListeners.delete(n),t(),this.updateProactiveRefresh())}assertAuthConfigured(){et(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}};function n$(e){switch(e){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}function r$(e){is(new sr("auth",(n,{options:t})=>{let r=n.getProvider("app").getImmediate(),i=n.getProvider("heartbeat"),s=n.getProvider("app-check-internal"),{apiKey:o,authDomain:a}=r.options;et(o&&!o.includes(":"),"invalid-api-key",{appName:r.name});let c={apiKey:o,authDomain:a,clientPlatform:e,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:KS(e)},l=new Rv(r,i,s,c);return t$(l,t),l},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((n,t,r)=>{n.getProvider("auth-internal").initialize()})),is(new sr("auth-internal",n=>{let t=QH(n.getProvider("auth").getImmediate());return(r=>new Mv(r))(t)},"PRIVATE").setInstantiationMode("EXPLICIT")),zt(PS,LS,n$(e)),zt(PS,LS,"esm2017")}var i$=5*60,WJ=iS("authIdTokenMaxAge")||i$;function s$(){var e,n;return(n=(e=document.getElementsByTagName("head"))===null||e===void 0?void 0:e[0])!==null&&n!==void 0?n:document}JH({loadJS(e){return new Promise((n,t)=>{let r=document.createElement("script");r.setAttribute("src",e),r.onload=n,r.onerror=i=>{let s=Ov("internal-error");s.customData=i,t(s)},r.type="text/javascript",r.charset="UTF-8",s$().appendChild(r)})},gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="});r$("Browser");var i9="auth";var Jd=class{constructor(){return Cl(i9)}};var YS="@firebase/database",XS="1.0.8";var U_="";function s9(e){U_=e}var zv=class{constructor(n){this.domStorage_=n,this.prefix_="firebase:"}set(n,t){t==null?this.domStorage_.removeItem(this.prefixedName_(n)):this.domStorage_.setItem(this.prefixedName_(n),Rt(t))}get(n){let t=this.domStorage_.getItem(this.prefixedName_(n));return t==null?null:pa(t)}remove(n){this.domStorage_.removeItem(this.prefixedName_(n))}prefixedName_(n){return this.prefix_+n}toString(){return this.domStorage_.toString()}};var Gv=class{constructor(){this.cache_={},this.isInMemoryStorage=!0}set(n,t){t==null?delete this.cache_[n]:this.cache_[n]=t}get(n){return rr(this.cache_,n)?this.cache_[n]:null}remove(n){delete this.cache_[n]}};var bD=function(e){try{if(typeof window<"u"&&typeof window[e]<"u"){let n=window[e];return n.setItem("firebase:sentinel","cache"),n.removeItem("firebase:sentinel"),new zv(n)}}catch{}return new Gv},eo=bD("localStorage"),qv=bD("sessionStorage");var Ea=new ns("@firebase/database"),AD=function(){let e=1;return function(){return e++}}(),kD=function(e){let n=pS(e),t=new Od;t.update(n);let r=t.digest();return Fd.encodeByteArray(r)},Xl=function(...e){let n="";for(let t=0;t<e.length;t++){let r=e[t];Array.isArray(r)||r&&typeof r=="object"&&typeof r.length=="number"?n+=Xl.apply(null,r):typeof r=="object"?n+=Rt(r):n+=r,n+=" "}return n},to=null,QS=!0,o9=function(e,n){X(!n||e===!0||e===!1,"Can't turn on custom loggers persistently."),e===!0?(Ea.logLevel=rt.VERBOSE,to=Ea.log.bind(Ea),n&&qv.set("logging_enabled",!0)):typeof e=="function"?to=e:(to=null,qv.remove("logging_enabled"))},pn=function(...e){if(QS===!0&&(QS=!1,to===null&&qv.get("logging_enabled")===!0&&o9(!0)),to){let n=Xl.apply(null,e);to(n)}},Ql=function(e){return function(...n){pn(e,...n)}},Kv=function(...e){let n="FIREBASE INTERNAL ERROR: "+Xl(...e);Ea.error(n)},wi=function(...e){let n=`FIREBASE FATAL ERROR: ${Xl(...e)}`;throw Ea.error(n),new Error(n)},Vn=function(...e){let n="FIREBASE WARNING: "+Xl(...e);Ea.warn(n)},a9=function(){typeof window<"u"&&window.location&&window.location.protocol&&window.location.protocol.indexOf("https:")!==-1&&Vn("Insecure Firebase access from a secure page. Please use https in calls to new Firebase().")},j_=function(e){return typeof e=="number"&&(e!==e||e===Number.POSITIVE_INFINITY||e===Number.NEGATIVE_INFINITY)},c9=function(e){if(Yr()||document.readyState==="complete")e();else{let n=!1,t=function(){if(!document.body){setTimeout(t,Math.floor(10));return}n||(n=!0,e())};document.addEventListener?(document.addEventListener("DOMContentLoaded",t,!1),window.addEventListener("load",t,!1)):document.attachEvent&&(document.attachEvent("onreadystatechange",()=>{document.readyState==="complete"&&t()}),window.attachEvent("onload",t))}},Ia="[MIN_NAME]",no="[MAX_NAME]",Ra=function(e,n){if(e===n)return 0;if(e===Ia||n===no)return-1;if(n===Ia||e===no)return 1;{let t=ZS(e),r=ZS(n);return t!==null?r!==null?t-r===0?e.length-n.length:t-r:-1:r!==null?1:e<n?-1:1}},l9=function(e,n){return e===n?0:e<n?-1:1},Ml=function(e,n){if(n&&e in n)return n[e];throw new Error("Missing required key ("+e+") in object: "+Rt(n))},V_=function(e){if(typeof e!="object"||e===null)return Rt(e);let n=[];for(let r in e)n.push(r);n.sort();let t="{";for(let r=0;r<n.length;r++)r!==0&&(t+=","),t+=Rt(n[r]),t+=":",t+=V_(e[n[r]]);return t+="}",t},ND=function(e,n){let t=e.length;if(t<=n)return[e];let r=[];for(let i=0;i<t;i+=n)i+n>t?r.push(e.substring(i,t)):r.push(e.substring(i,i+n));return r};function Nn(e,n){for(let t in e)e.hasOwnProperty(t)&&n(t,e[t])}var RD=function(e){X(!j_(e),"Invalid JSON number");let n=11,t=52,r=(1<<n-1)-1,i,s,o,a,c;e===0?(s=0,o=0,i=1/e===-1/0?1:0):(i=e<0,e=Math.abs(e),e>=Math.pow(2,1-r)?(a=Math.min(Math.floor(Math.log(e)/Math.LN2),r),s=a+r,o=Math.round(e*Math.pow(2,t-a)-Math.pow(2,t))):(s=0,o=Math.round(e/Math.pow(2,1-r-t))));let l=[];for(c=t;c;c-=1)l.push(o%2?1:0),o=Math.floor(o/2);for(c=n;c;c-=1)l.push(s%2?1:0),s=Math.floor(s/2);l.push(i?1:0),l.reverse();let u=l.join(""),f="";for(c=0;c<64;c+=8){let d=parseInt(u.substr(c,8),2).toString(16);d.length===1&&(d="0"+d),f=f+d}return f.toLowerCase()},u9=function(){return!!(typeof window=="object"&&window.chrome&&window.chrome.extension&&!/^chrome/.test(window.location.href))},f9=function(){return typeof Windows=="object"&&typeof Windows.UI=="object"};function d9(e,n){let t="Unknown Error";e==="too_big"?t="The data requested exceeds the maximum size that can be accessed with a single request.":e==="permission_denied"?t="Client doesn't have permission to access the desired data.":e==="unavailable"&&(t="The service is unavailable");let r=new Error(e+" at "+n._path.toString()+": "+t);return r.code=e.toUpperCase(),r}var h9=new RegExp("^-?(0*)\\d{1,10}$"),p9=-2147483648,m9=2147483647,ZS=function(e){if(h9.test(e)){let n=Number(e);if(n>=p9&&n<=m9)return n}return null},Zl=function(e){try{e()}catch(n){setTimeout(()=>{let t=n.stack||"";throw Vn("Exception was thrown by user callback.",t),n},Math.floor(0))}},g9=function(){return(typeof window=="object"&&window.navigator&&window.navigator.userAgent||"").search(/googlebot|google webmaster tools|bingbot|yahoo! slurp|baiduspider|yandexbot|duckduckbot/i)>=0},Bl=function(e,n){let t=setTimeout(e,n);return typeof t=="number"&&typeof Deno<"u"&&Deno.unrefTimer?Deno.unrefTimer(t):typeof t=="object"&&t.unref&&t.unref(),t};var Yv=class{constructor(n,t){this.appName_=n,this.appCheckProvider=t,this.appCheck=t?.getImmediate({optional:!0}),this.appCheck||t?.get().then(r=>this.appCheck=r)}getToken(n){return this.appCheck?this.appCheck.getToken(n):new Promise((t,r)=>{setTimeout(()=>{this.appCheck?this.getToken(n).then(t,r):t(null)},0)})}addTokenChangeListener(n){var t;(t=this.appCheckProvider)===null||t===void 0||t.get().then(r=>r.addTokenListener(n))}notifyForInvalidToken(){Vn(`Provided AppCheck credentials for the app named "${this.appName_}" are invalid. This usually indicates your app was not initialized correctly.`)}};var Xv=class{constructor(n,t,r){this.appName_=n,this.firebaseOptions_=t,this.authProvider_=r,this.auth_=null,this.auth_=r.getImmediate({optional:!0}),this.auth_||r.onInit(i=>this.auth_=i)}getToken(n){return this.auth_?this.auth_.getToken(n).catch(t=>t&&t.code==="auth/token-not-initialized"?(pn("Got auth/token-not-initialized error.  Treating as null token."),null):Promise.reject(t)):new Promise((t,r)=>{setTimeout(()=>{this.auth_?this.getToken(n).then(t,r):t(null)},0)})}addTokenChangeListener(n){this.auth_?this.auth_.addAuthTokenListener(n):this.authProvider_.get().then(t=>t.addAuthTokenListener(n))}removeTokenChangeListener(n){this.authProvider_.get().then(t=>t.removeAuthTokenListener(n))}notifyForInvalidToken(){let n='Provided authentication credentials for the app named "'+this.appName_+'" are invalid. This usually indicates your app was not initialized correctly. ';"credential"in this.firebaseOptions_?n+='Make sure the "credential" property provided to initializeApp() is authorized to access the specified "databaseURL" and is from the correct project.':"serviceAccount"in this.firebaseOptions_?n+='Make sure the "serviceAccount" property provided to initializeApp() is authorized to access the specified "databaseURL" and is from the correct project.':n+='Make sure the "apiKey" and "databaseURL" properties provided to initializeApp() match the values provided for your app at https://console.firebase.google.com/.',Vn(n)}},Ul=(()=>{class e{constructor(t){this.accessToken=t}getToken(t){return Promise.resolve({accessToken:this.accessToken})}addTokenChangeListener(t){t(this.accessToken)}removeTokenChangeListener(t){}notifyForInvalidToken(){}}e.OWNER="owner";return e})(),th="5",MD="v",OD="s",FD="r",PD="f",LD=/(console\.firebase|firebase-console-\w+\.corp|firebase\.corp)\.google\.com/,BD="ls",UD="p",Qv="ac",jD="websocket",VD="long_polling";var nh=class{constructor(n,t,r,i,s=!1,o="",a=!1,c=!1){this.secure=t,this.namespace=r,this.webSocketOnly=i,this.nodeAdmin=s,this.persistenceKey=o,this.includeNamespaceInQueryParams=a,this.isUsingEmulator=c,this._host=n.toLowerCase(),this._domain=this._host.substr(this._host.indexOf(".")+1),this.internalHost=eo.get("host:"+n)||this._host}isCacheableHost(){return this.internalHost.substr(0,2)==="s-"}isCustomHost(){return this._domain!=="firebaseio.com"&&this._domain!=="firebaseio-demo.com"}get host(){return this._host}set host(n){n!==this.internalHost&&(this.internalHost=n,this.isCacheableHost()&&eo.set("host:"+this._host,this.internalHost))}toString(){let n=this.toURLString();return this.persistenceKey&&(n+="<"+this.persistenceKey+">"),n}toURLString(){let n=this.secure?"https://":"http://",t=this.includeNamespaceInQueryParams?`?ns=${this.namespace}`:"";return`${n}${this.host}/${t}`}};function v9(e){return e.host!==e.internalHost||e.isCustomHost()||e.includeNamespaceInQueryParams}function HD(e,n,t){X(typeof n=="string","typeof type must == string"),X(typeof t=="object","typeof params must == object");let r;if(n===jD)r=(e.secure?"wss://":"ws://")+e.internalHost+"/.ws?";else if(n===VD)r=(e.secure?"https://":"http://")+e.internalHost+"/.lp?";else throw new Error("Unknown connection type: "+n);v9(e)&&(t.ns=e.namespace);let i=[];return Nn(t,(s,o)=>{i.push(s+"="+o)}),r+i.join("&")}var Zv=class{constructor(){this.counters_={}}incrementCounter(n,t=1){rr(this.counters_,n)||(this.counters_[n]=0),this.counters_[n]+=t}get(){return eS(this.counters_)}};var Bv={},Uv={};function H_(e){let n=e.toString();return Bv[n]||(Bv[n]=new Zv),Bv[n]}function _9(e,n){let t=e.toString();return Uv[t]||(Uv[t]=n()),Uv[t]}var Jv=class{constructor(n){this.onMessage_=n,this.pendingResponses=[],this.currentResponseNum=0,this.closeAfterResponse=-1,this.onClose=null}closeAfter(n,t){this.closeAfterResponse=n,this.onClose=t,this.closeAfterResponse<this.currentResponseNum&&(this.onClose(),this.onClose=null)}handleResponse(n,t){for(this.pendingResponses[n]=t;this.pendingResponses[this.currentResponseNum];){let r=this.pendingResponses[this.currentResponseNum];delete this.pendingResponses[this.currentResponseNum];for(let i=0;i<r.length;++i)r[i]&&Zl(()=>{this.onMessage_(r[i])});if(this.currentResponseNum===this.closeAfterResponse){this.onClose&&(this.onClose(),this.onClose=null);break}this.currentResponseNum++}}};var JS="start",x9="close",y9="pLPCommand",w9="pRTLPCB",$D="id",WD="pw",zD="ser",E9="cb",T9="seg",I9="ts",C9="d",S9="dframe",GD=1870,qD=30,D9=GD-qD,b9=25e3,A9=3e4,e_=class e{constructor(n,t,r,i,s,o,a){this.connId=n,this.repoInfo=t,this.applicationId=r,this.appCheckToken=i,this.authToken=s,this.transportSessionId=o,this.lastSessionId=a,this.bytesSent=0,this.bytesReceived=0,this.everConnected_=!1,this.log_=Ql(n),this.stats_=H_(t),this.urlFn=c=>(this.appCheckToken&&(c[Qv]=this.appCheckToken),HD(t,VD,c))}open(n,t){this.curSegmentNum=0,this.onDisconnect_=t,this.myPacketOrderer=new Jv(n),this.isClosed_=!1,this.connectTimeoutTimer_=setTimeout(()=>{this.log_("Timed out trying to connect."),this.onClosed_(),this.connectTimeoutTimer_=null},Math.floor(A9)),c9(()=>{if(this.isClosed_)return;this.scriptTagHolder=new t_((...s)=>{let[o,a,c,l,u]=s;if(this.incrementIncomingBytes_(s),!!this.scriptTagHolder)if(this.connectTimeoutTimer_&&(clearTimeout(this.connectTimeoutTimer_),this.connectTimeoutTimer_=null),this.everConnected_=!0,o===JS)this.id=a,this.password=c;else if(o===x9)a?(this.scriptTagHolder.sendNewPolls=!1,this.myPacketOrderer.closeAfter(a,()=>{this.onClosed_()})):this.onClosed_();else throw new Error("Unrecognized command received: "+o)},(...s)=>{let[o,a]=s;this.incrementIncomingBytes_(s),this.myPacketOrderer.handleResponse(o,a)},()=>{this.onClosed_()},this.urlFn);let r={};r[JS]="t",r[zD]=Math.floor(Math.random()*1e8),this.scriptTagHolder.uniqueCallbackIdentifier&&(r[E9]=this.scriptTagHolder.uniqueCallbackIdentifier),r[MD]=th,this.transportSessionId&&(r[OD]=this.transportSessionId),this.lastSessionId&&(r[BD]=this.lastSessionId),this.applicationId&&(r[UD]=this.applicationId),this.appCheckToken&&(r[Qv]=this.appCheckToken),typeof location<"u"&&location.hostname&&LD.test(location.hostname)&&(r[FD]=PD);let i=this.urlFn(r);this.log_("Connecting via long-poll to "+i),this.scriptTagHolder.addTag(i,()=>{})})}start(){this.scriptTagHolder.startLongPoll(this.id,this.password),this.addDisconnectPingFrame(this.id,this.password)}static forceAllow(){e.forceAllow_=!0}static forceDisallow(){e.forceDisallow_=!0}static isAvailable(){return Yr()?!1:e.forceAllow_?!0:!e.forceDisallow_&&typeof document<"u"&&document.createElement!=null&&!u9()&&!f9()}markConnectionHealthy(){}shutdown_(){this.isClosed_=!0,this.scriptTagHolder&&(this.scriptTagHolder.close(),this.scriptTagHolder=null),this.myDisconnFrame&&(document.body.removeChild(this.myDisconnFrame),this.myDisconnFrame=null),this.connectTimeoutTimer_&&(clearTimeout(this.connectTimeoutTimer_),this.connectTimeoutTimer_=null)}onClosed_(){this.isClosed_||(this.log_("Longpoll is closing itself"),this.shutdown_(),this.onDisconnect_&&(this.onDisconnect_(this.everConnected_),this.onDisconnect_=null))}close(){this.isClosed_||(this.log_("Longpoll is being closed."),this.shutdown_())}send(n){let t=Rt(n);this.bytesSent+=t.length,this.stats_.incrementCounter("bytes_sent",t.length);let r=nv(t),i=ND(r,D9);for(let s=0;s<i.length;s++)this.scriptTagHolder.enqueueSegment(this.curSegmentNum,i.length,i[s]),this.curSegmentNum++}addDisconnectPingFrame(n,t){if(Yr())return;this.myDisconnFrame=document.createElement("iframe");let r={};r[S9]="t",r[$D]=n,r[WD]=t,this.myDisconnFrame.src=this.urlFn(r),this.myDisconnFrame.style.display="none",document.body.appendChild(this.myDisconnFrame)}incrementIncomingBytes_(n){let t=Rt(n).length;this.bytesReceived+=t,this.stats_.incrementCounter("bytes_received",t)}},t_=class e{constructor(n,t,r,i){if(this.onDisconnect=r,this.urlFn=i,this.outstandingRequests=new Set,this.pendingSegs=[],this.currentSerial=Math.floor(Math.random()*1e8),this.sendNewPolls=!0,Yr())this.commandCB=n,this.onMessageCB=t;else{this.uniqueCallbackIdentifier=AD(),window[y9+this.uniqueCallbackIdentifier]=n,window[w9+this.uniqueCallbackIdentifier]=t,this.myIFrame=e.createIFrame_();let s="";this.myIFrame.src&&this.myIFrame.src.substr(0,11)==="javascript:"&&(s='<script>document.domain="'+document.domain+'";<\/script>');let o="<html><body>"+s+"</body></html>";try{this.myIFrame.doc.open(),this.myIFrame.doc.write(o),this.myIFrame.doc.close()}catch(a){pn("frame writing exception"),a.stack&&pn(a.stack),pn(a)}}}static createIFrame_(){let n=document.createElement("iframe");if(n.style.display="none",document.body){document.body.appendChild(n);try{n.contentWindow.document||pn("No IE domain setting required")}catch{let r=document.domain;n.src="javascript:void((function(){document.open();document.domain='"+r+"';document.close();})())"}}else throw"Document body has not initialized. Wait to initialize Firebase until after the document is ready.";return n.contentDocument?n.doc=n.contentDocument:n.contentWindow?n.doc=n.contentWindow.document:n.document&&(n.doc=n.document),n}close(){this.alive=!1,this.myIFrame&&(this.myIFrame.doc.body.textContent="",setTimeout(()=>{this.myIFrame!==null&&(document.body.removeChild(this.myIFrame),this.myIFrame=null)},Math.floor(0)));let n=this.onDisconnect;n&&(this.onDisconnect=null,n())}startLongPoll(n,t){for(this.myID=n,this.myPW=t,this.alive=!0;this.newRequest_(););}newRequest_(){if(this.alive&&this.sendNewPolls&&this.outstandingRequests.size<(this.pendingSegs.length>0?2:1)){this.currentSerial++;let n={};n[$D]=this.myID,n[WD]=this.myPW,n[zD]=this.currentSerial;let t=this.urlFn(n),r="",i=0;for(;this.pendingSegs.length>0&&this.pendingSegs[0].d.length+qD+r.length<=GD;){let o=this.pendingSegs.shift();r=r+"&"+T9+i+"="+o.seg+"&"+I9+i+"="+o.ts+"&"+C9+i+"="+o.d,i++}return t=t+r,this.addLongPollTag_(t,this.currentSerial),!0}else return!1}enqueueSegment(n,t,r){this.pendingSegs.push({seg:n,ts:t,d:r}),this.alive&&this.newRequest_()}addLongPollTag_(n,t){this.outstandingRequests.add(t);let r=()=>{this.outstandingRequests.delete(t),this.newRequest_()},i=setTimeout(r,Math.floor(b9)),s=()=>{clearTimeout(i),r()};this.addTag(n,s)}addTag(n,t){Yr()?this.doNodeLongPoll(n,t):setTimeout(()=>{try{if(!this.sendNewPolls)return;let r=this.myIFrame.doc.createElement("script");r.type="text/javascript",r.async=!0,r.src=n,r.onload=r.onreadystatechange=function(){let i=r.readyState;(!i||i==="loaded"||i==="complete")&&(r.onload=r.onreadystatechange=null,r.parentNode&&r.parentNode.removeChild(r),t())},r.onerror=()=>{pn("Long-poll script failed to load: "+n),this.sendNewPolls=!1,this.close()},this.myIFrame.doc.body.appendChild(r)}catch{}},Math.floor(1))}};var k9=16384,N9=45e3,rh=null;typeof MozWebSocket<"u"?rh=MozWebSocket:typeof WebSocket<"u"&&(rh=WebSocket);var Ol=(()=>{class e{constructor(t,r,i,s,o,a,c){this.connId=t,this.applicationId=i,this.appCheckToken=s,this.authToken=o,this.keepaliveTimer=null,this.frames=null,this.totalFrames=0,this.bytesSent=0,this.bytesReceived=0,this.log_=Ql(this.connId),this.stats_=H_(r),this.connURL=e.connectionURL_(r,a,c,s,i),this.nodeAdmin=r.nodeAdmin}static connectionURL_(t,r,i,s,o){let a={};return a[MD]=th,!Yr()&&typeof location<"u"&&location.hostname&&LD.test(location.hostname)&&(a[FD]=PD),r&&(a[OD]=r),i&&(a[BD]=i),s&&(a[Qv]=s),o&&(a[UD]=o),HD(t,jD,a)}open(t,r){this.onDisconnect=r,this.onMessage=t,this.log_("Websocket connecting to "+this.connURL),this.everConnected_=!1,eo.set("previous_websocket_failure",!0);try{let i;if(Yr()){let s=this.nodeAdmin?"AdminNode":"Node";i={headers:{"User-Agent":`Firebase/${th}/${U_}/${process.platform}/${s}`,"X-Firebase-GMPID":this.applicationId||""}},this.authToken&&(i.headers.Authorization=`Bearer ${this.authToken}`),this.appCheckToken&&(i.headers["X-Firebase-AppCheck"]=this.appCheckToken);let o=process.env,a=this.connURL.indexOf("wss://")===0?o.HTTPS_PROXY||o.https_proxy:o.HTTP_PROXY||o.http_proxy;a&&(i.proxy={origin:a})}this.mySock=new rh(this.connURL,[],i)}catch(i){this.log_("Error instantiating WebSocket.");let s=i.message||i.data;s&&this.log_(s),this.onClosed_();return}this.mySock.onopen=()=>{this.log_("Websocket connected."),this.everConnected_=!0},this.mySock.onclose=()=>{this.log_("Websocket connection was disconnected."),this.mySock=null,this.onClosed_()},this.mySock.onmessage=i=>{this.handleIncomingFrame(i)},this.mySock.onerror=i=>{this.log_("WebSocket error.  Closing connection.");let s=i.message||i.data;s&&this.log_(s),this.onClosed_()}}start(){}static forceDisallow(){e.forceDisallow_=!0}static isAvailable(){let t=!1;if(typeof navigator<"u"&&navigator.userAgent){let r=/Android ([0-9]{0,}\.[0-9]{0,})/,i=navigator.userAgent.match(r);i&&i.length>1&&parseFloat(i[1])<4.4&&(t=!0)}return!t&&rh!==null&&!e.forceDisallow_}static previouslyFailed(){return eo.isInMemoryStorage||eo.get("previous_websocket_failure")===!0}markConnectionHealthy(){eo.remove("previous_websocket_failure")}appendFrame_(t){if(this.frames.push(t),this.frames.length===this.totalFrames){let r=this.frames.join("");this.frames=null;let i=pa(r);this.onMessage(i)}}handleNewFrameCount_(t){this.totalFrames=t,this.frames=[]}extractFrameCount_(t){if(X(this.frames===null,"We already have a frame buffer"),t.length<=6){let r=Number(t);if(!isNaN(r))return this.handleNewFrameCount_(r),null}return this.handleNewFrameCount_(1),t}handleIncomingFrame(t){if(this.mySock===null)return;let r=t.data;if(this.bytesReceived+=r.length,this.stats_.incrementCounter("bytes_received",r.length),this.resetKeepAlive(),this.frames!==null)this.appendFrame_(r);else{let i=this.extractFrameCount_(r);i!==null&&this.appendFrame_(i)}}send(t){this.resetKeepAlive();let r=Rt(t);this.bytesSent+=r.length,this.stats_.incrementCounter("bytes_sent",r.length);let i=ND(r,k9);i.length>1&&this.sendString_(String(i.length));for(let s=0;s<i.length;s++)this.sendString_(i[s])}shutdown_(){this.isClosed_=!0,this.keepaliveTimer&&(clearInterval(this.keepaliveTimer),this.keepaliveTimer=null),this.mySock&&(this.mySock.close(),this.mySock=null)}onClosed_(){this.isClosed_||(this.log_("WebSocket is closing itself"),this.shutdown_(),this.onDisconnect&&(this.onDisconnect(this.everConnected_),this.onDisconnect=null))}close(){this.isClosed_||(this.log_("WebSocket is being closed"),this.shutdown_())}resetKeepAlive(){clearInterval(this.keepaliveTimer),this.keepaliveTimer=setInterval(()=>{this.mySock&&this.sendString_("0"),this.resetKeepAlive()},Math.floor(N9))}sendString_(t){try{this.mySock.send(t)}catch(r){this.log_("Exception thrown from WebSocket.send():",r.message||r.data,"Closing connection."),setTimeout(this.onClosed_.bind(this),0)}}}e.responsesRequiredToBeHealthy=2,e.healthyTimeout=3e4;return e})(),R9=(()=>{class e{constructor(t){this.initTransports_(t)}static get ALL_TRANSPORTS(){return[e_,Ol]}static get IS_TRANSPORT_INITIALIZED(){return this.globalTransportInitialized_}initTransports_(t){let r=Ol&&Ol.isAvailable(),i=r&&!Ol.previouslyFailed();if(t.webSocketOnly&&(r||Vn("wss:// URL used, but browser isn't known to support websockets.  Trying anyway."),i=!0),i)this.transports_=[Ol];else{let s=this.transports_=[];for(let o of e.ALL_TRANSPORTS)o&&o.isAvailable()&&s.push(o);e.globalTransportInitialized_=!0}}initialTransport(){if(this.transports_.length>0)return this.transports_[0];throw new Error("No transports available")}upgradeTransport(){return this.transports_.length>1?this.transports_[1]:null}}e.globalTransportInitialized_=!1;return e})(),M9=6e4,O9=5e3,F9=10*1024,P9=100*1024,jv="t",eD="d",L9="s",tD="r",B9="e",nD="o",rD="a",iD="n",sD="p",U9="h",n_=class{constructor(n,t,r,i,s,o,a,c,l,u){this.id=n,this.repoInfo_=t,this.applicationId_=r,this.appCheckToken_=i,this.authToken_=s,this.onMessage_=o,this.onReady_=a,this.onDisconnect_=c,this.onKill_=l,this.lastSessionId=u,this.connectionCount=0,this.pendingDataMessages=[],this.state_=0,this.log_=Ql("c:"+this.id+":"),this.transportManager_=new R9(t),this.log_("Connection created"),this.start_()}start_(){let n=this.transportManager_.initialTransport();this.conn_=new n(this.nextTransportId_(),this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,null,this.lastSessionId),this.primaryResponsesRequired_=n.responsesRequiredToBeHealthy||0;let t=this.connReceiver_(this.conn_),r=this.disconnReceiver_(this.conn_);this.tx_=this.conn_,this.rx_=this.conn_,this.secondaryConn_=null,this.isHealthy_=!1,setTimeout(()=>{this.conn_&&this.conn_.open(t,r)},Math.floor(0));let i=n.healthyTimeout||0;i>0&&(this.healthyTimeout_=Bl(()=>{this.healthyTimeout_=null,this.isHealthy_||(this.conn_&&this.conn_.bytesReceived>P9?(this.log_("Connection exceeded healthy timeout but has received "+this.conn_.bytesReceived+" bytes.  Marking connection healthy."),this.isHealthy_=!0,this.conn_.markConnectionHealthy()):this.conn_&&this.conn_.bytesSent>F9?this.log_("Connection exceeded healthy timeout but has sent "+this.conn_.bytesSent+" bytes.  Leaving connection alive."):(this.log_("Closing unhealthy connection after timeout."),this.close()))},Math.floor(i)))}nextTransportId_(){return"c:"+this.id+":"+this.connectionCount++}disconnReceiver_(n){return t=>{n===this.conn_?this.onConnectionLost_(t):n===this.secondaryConn_?(this.log_("Secondary connection lost."),this.onSecondaryConnectionLost_()):this.log_("closing an old connection")}}connReceiver_(n){return t=>{this.state_!==2&&(n===this.rx_?this.onPrimaryMessageReceived_(t):n===this.secondaryConn_?this.onSecondaryMessageReceived_(t):this.log_("message on old connection"))}}sendRequest(n){let t={t:"d",d:n};this.sendData_(t)}tryCleanupConnection(){this.tx_===this.secondaryConn_&&this.rx_===this.secondaryConn_&&(this.log_("cleaning up and promoting a connection: "+this.secondaryConn_.connId),this.conn_=this.secondaryConn_,this.secondaryConn_=null)}onSecondaryControl_(n){if(jv in n){let t=n[jv];t===rD?this.upgradeIfSecondaryHealthy_():t===tD?(this.log_("Got a reset on secondary, closing it"),this.secondaryConn_.close(),(this.tx_===this.secondaryConn_||this.rx_===this.secondaryConn_)&&this.close()):t===nD&&(this.log_("got pong on secondary."),this.secondaryResponsesRequired_--,this.upgradeIfSecondaryHealthy_())}}onSecondaryMessageReceived_(n){let t=Ml("t",n),r=Ml("d",n);if(t==="c")this.onSecondaryControl_(r);else if(t==="d")this.pendingDataMessages.push(r);else throw new Error("Unknown protocol layer: "+t)}upgradeIfSecondaryHealthy_(){this.secondaryResponsesRequired_<=0?(this.log_("Secondary connection is healthy."),this.isHealthy_=!0,this.secondaryConn_.markConnectionHealthy(),this.proceedWithUpgrade_()):(this.log_("sending ping on secondary."),this.secondaryConn_.send({t:"c",d:{t:sD,d:{}}}))}proceedWithUpgrade_(){this.secondaryConn_.start(),this.log_("sending client ack on secondary"),this.secondaryConn_.send({t:"c",d:{t:rD,d:{}}}),this.log_("Ending transmission on primary"),this.conn_.send({t:"c",d:{t:iD,d:{}}}),this.tx_=this.secondaryConn_,this.tryCleanupConnection()}onPrimaryMessageReceived_(n){let t=Ml("t",n),r=Ml("d",n);t==="c"?this.onControl_(r):t==="d"&&this.onDataMessage_(r)}onDataMessage_(n){this.onPrimaryResponse_(),this.onMessage_(n)}onPrimaryResponse_(){this.isHealthy_||(this.primaryResponsesRequired_--,this.primaryResponsesRequired_<=0&&(this.log_("Primary connection is healthy."),this.isHealthy_=!0,this.conn_.markConnectionHealthy()))}onControl_(n){let t=Ml(jv,n);if(eD in n){let r=n[eD];if(t===U9){let i=Object.assign({},r);this.repoInfo_.isUsingEmulator&&(i.h=this.repoInfo_.host),this.onHandshake_(i)}else if(t===iD){this.log_("recvd end transmission on primary"),this.rx_=this.secondaryConn_;for(let i=0;i<this.pendingDataMessages.length;++i)this.onDataMessage_(this.pendingDataMessages[i]);this.pendingDataMessages=[],this.tryCleanupConnection()}else t===L9?this.onConnectionShutdown_(r):t===tD?this.onReset_(r):t===B9?Kv("Server Error: "+r):t===nD?(this.log_("got pong on primary."),this.onPrimaryResponse_(),this.sendPingOnPrimaryIfNecessary_()):Kv("Unknown control packet command: "+t)}}onHandshake_(n){let t=n.ts,r=n.v,i=n.h;this.sessionId=n.s,this.repoInfo_.host=i,this.state_===0&&(this.conn_.start(),this.onConnectionEstablished_(this.conn_,t),th!==r&&Vn("Protocol version mismatch detected"),this.tryStartUpgrade_())}tryStartUpgrade_(){let n=this.transportManager_.upgradeTransport();n&&this.startUpgrade_(n)}startUpgrade_(n){this.secondaryConn_=new n(this.nextTransportId_(),this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,this.sessionId),this.secondaryResponsesRequired_=n.responsesRequiredToBeHealthy||0;let t=this.connReceiver_(this.secondaryConn_),r=this.disconnReceiver_(this.secondaryConn_);this.secondaryConn_.open(t,r),Bl(()=>{this.secondaryConn_&&(this.log_("Timed out trying to upgrade."),this.secondaryConn_.close())},Math.floor(M9))}onReset_(n){this.log_("Reset packet received.  New host: "+n),this.repoInfo_.host=n,this.state_===1?this.close():(this.closeConnections_(),this.start_())}onConnectionEstablished_(n,t){this.log_("Realtime connection established."),this.conn_=n,this.state_=1,this.onReady_&&(this.onReady_(t,this.sessionId),this.onReady_=null),this.primaryResponsesRequired_===0?(this.log_("Primary connection is healthy."),this.isHealthy_=!0):Bl(()=>{this.sendPingOnPrimaryIfNecessary_()},Math.floor(O9))}sendPingOnPrimaryIfNecessary_(){!this.isHealthy_&&this.state_===1&&(this.log_("sending ping on primary."),this.sendData_({t:"c",d:{t:sD,d:{}}}))}onSecondaryConnectionLost_(){let n=this.secondaryConn_;this.secondaryConn_=null,(this.tx_===n||this.rx_===n)&&this.close()}onConnectionLost_(n){this.conn_=null,!n&&this.state_===0?(this.log_("Realtime connection failed."),this.repoInfo_.isCacheableHost()&&(eo.remove("host:"+this.repoInfo_.host),this.repoInfo_.internalHost=this.repoInfo_.host)):this.state_===1&&this.log_("Realtime connection lost."),this.close()}onConnectionShutdown_(n){this.log_("Connection shutdown command received. Shutting down..."),this.onKill_&&(this.onKill_(n),this.onKill_=null),this.onDisconnect_=null,this.close()}sendData_(n){if(this.state_!==1)throw"Connection is not connected";this.tx_.send(n)}close(){this.state_!==2&&(this.log_("Closing realtime connection."),this.state_=2,this.closeConnections_(),this.onDisconnect_&&(this.onDisconnect_(),this.onDisconnect_=null))}closeConnections_(){this.log_("Shutting down all connections"),this.conn_&&(this.conn_.close(),this.conn_=null),this.secondaryConn_&&(this.secondaryConn_.close(),this.secondaryConn_=null),this.healthyTimeout_&&(clearTimeout(this.healthyTimeout_),this.healthyTimeout_=null)}};var ih=class{put(n,t,r,i){}merge(n,t,r,i){}refreshAuthToken(n){}refreshAppCheckToken(n){}onDisconnectPut(n,t,r){}onDisconnectMerge(n,t,r){}onDisconnectCancel(n,t){}reportStats(n){}};var sh=class{constructor(n){this.allowedEvents_=n,this.listeners_={},X(Array.isArray(n)&&n.length>0,"Requires a non-empty array")}trigger(n,...t){if(Array.isArray(this.listeners_[n])){let r=[...this.listeners_[n]];for(let i=0;i<r.length;i++)r[i].callback.apply(r[i].context,t)}}on(n,t,r){this.validateEventType_(n),this.listeners_[n]=this.listeners_[n]||[],this.listeners_[n].push({callback:t,context:r});let i=this.getInitialEvent(n);i&&t.apply(r,i)}off(n,t,r){this.validateEventType_(n);let i=this.listeners_[n]||[];for(let s=0;s<i.length;s++)if(i[s].callback===t&&(!r||r===i[s].context)){i.splice(s,1);return}}validateEventType_(n){X(this.allowedEvents_.find(t=>t===n),"Unknown event: "+n)}};var oh=class e extends sh{constructor(){super(["online"]),this.online_=!0,typeof window<"u"&&typeof window.addEventListener<"u"&&!ml()&&(window.addEventListener("online",()=>{this.online_||(this.online_=!0,this.trigger("online",!0))},!1),window.addEventListener("offline",()=>{this.online_&&(this.online_=!1,this.trigger("online",!1))},!1))}static getInstance(){return new e}getInitialEvent(n){return X(n==="online","Unknown event type: "+n),[this.online_]}currentlyOnline(){return this.online_}};var oD=32,aD=768,it=class{constructor(n,t){if(t===void 0){this.pieces_=n.split("/");let r=0;for(let i=0;i<this.pieces_.length;i++)this.pieces_[i].length>0&&(this.pieces_[r]=this.pieces_[i],r++);this.pieces_.length=r,this.pieceNum_=0}else this.pieces_=n,this.pieceNum_=t}toString(){let n="";for(let t=this.pieceNum_;t<this.pieces_.length;t++)this.pieces_[t]!==""&&(n+="/"+this.pieces_[t]);return n||"/"}};function Qe(){return new it("")}function Oe(e){return e.pieceNum_>=e.pieces_.length?null:e.pieces_[e.pieceNum_]}function ls(e){return e.pieces_.length-e.pieceNum_}function lt(e){let n=e.pieceNum_;return n<e.pieces_.length&&n++,new it(e.pieces_,n)}function KD(e){return e.pieceNum_<e.pieces_.length?e.pieces_[e.pieces_.length-1]:null}function j9(e){let n="";for(let t=e.pieceNum_;t<e.pieces_.length;t++)e.pieces_[t]!==""&&(n+="/"+encodeURIComponent(String(e.pieces_[t])));return n||"/"}function YD(e,n=0){return e.pieces_.slice(e.pieceNum_+n)}function XD(e){if(e.pieceNum_>=e.pieces_.length)return null;let n=[];for(let t=e.pieceNum_;t<e.pieces_.length-1;t++)n.push(e.pieces_[t]);return new it(n,0)}function Pt(e,n){let t=[];for(let r=e.pieceNum_;r<e.pieces_.length;r++)t.push(e.pieces_[r]);if(n instanceof it)for(let r=n.pieceNum_;r<n.pieces_.length;r++)t.push(n.pieces_[r]);else{let r=n.split("/");for(let i=0;i<r.length;i++)r[i].length>0&&t.push(r[i])}return new it(t,0)}function Be(e){return e.pieceNum_>=e.pieces_.length}function Tn(e,n){let t=Oe(e),r=Oe(n);if(t===null)return n;if(t===r)return Tn(lt(e),lt(n));throw new Error("INTERNAL ERROR: innerPath ("+n+") is not within outerPath ("+e+")")}function $_(e,n){if(ls(e)!==ls(n))return!1;for(let t=e.pieceNum_,r=n.pieceNum_;t<=e.pieces_.length;t++,r++)if(e.pieces_[t]!==n.pieces_[r])return!1;return!0}function Ir(e,n){let t=e.pieceNum_,r=n.pieceNum_;if(ls(e)>ls(n))return!1;for(;t<e.pieces_.length;){if(e.pieces_[t]!==n.pieces_[r])return!1;++t,++r}return!0}var r_=class{constructor(n,t){this.errorPrefix_=t,this.parts_=YD(n,0),this.byteLength_=Math.max(1,this.parts_.length);for(let r=0;r<this.parts_.length;r++)this.byteLength_+=xl(this.parts_[r]);QD(this)}};function V9(e,n){e.parts_.length>0&&(e.byteLength_+=1),e.parts_.push(n),e.byteLength_+=xl(n),QD(e)}function H9(e){let n=e.parts_.pop();e.byteLength_-=xl(n),e.parts_.length>0&&(e.byteLength_-=1)}function QD(e){if(e.byteLength_>aD)throw new Error(e.errorPrefix_+"has a key path longer than "+aD+" bytes ("+e.byteLength_+").");if(e.parts_.length>oD)throw new Error(e.errorPrefix_+"path specified exceeds the maximum depth that can be written ("+oD+") or object contains a cycle "+Js(e))}function Js(e){return e.parts_.length===0?"":"in property '"+e.parts_.join(".")+"'"}var i_=class e extends sh{constructor(){super(["visible"]);let n,t;typeof document<"u"&&typeof document.addEventListener<"u"&&(typeof document.hidden<"u"?(t="visibilitychange",n="hidden"):typeof document.mozHidden<"u"?(t="mozvisibilitychange",n="mozHidden"):typeof document.msHidden<"u"?(t="msvisibilitychange",n="msHidden"):typeof document.webkitHidden<"u"&&(t="webkitvisibilitychange",n="webkitHidden")),this.visible_=!0,t&&document.addEventListener(t,()=>{let r=!document[n];r!==this.visible_&&(this.visible_=r,this.trigger("visible",r))},!1)}static getInstance(){return new e}getInitialEvent(n){return X(n==="visible","Unknown event type: "+n),[this.visible_]}};var Fl=1e3,$9=60*5*1e3,cD=30*1e3,W9=1.3,z9=3e4,G9="server_kill",lD=3,W_=(()=>{class e extends ih{constructor(t,r,i,s,o,a,c,l){if(super(),this.repoInfo_=t,this.applicationId_=r,this.onDataUpdate_=i,this.onConnectStatus_=s,this.onServerInfoUpdate_=o,this.authTokenProvider_=a,this.appCheckTokenProvider_=c,this.authOverride_=l,this.id=e.nextPersistentConnectionId_++,this.log_=Ql("p:"+this.id+":"),this.interruptReasons_={},this.listens=new Map,this.outstandingPuts_=[],this.outstandingGets_=[],this.outstandingPutCount_=0,this.outstandingGetCount_=0,this.onDisconnectRequestQueue_=[],this.connected_=!1,this.reconnectDelay_=Fl,this.maxReconnectDelay_=$9,this.securityDebugCallback_=null,this.lastSessionId=null,this.establishConnectionTimer_=null,this.visible_=!1,this.requestCBHash_={},this.requestNumber_=0,this.realtime_=null,this.authToken_=null,this.appCheckToken_=null,this.forceTokenRefresh_=!1,this.invalidAuthTokenCount_=0,this.invalidAppCheckTokenCount_=0,this.firstConnection_=!0,this.lastConnectionAttemptTime_=null,this.lastConnectionEstablishedTime_=null,l&&!Yr())throw new Error("Auth override specified in options, but not supported on non Node.js platforms");i_.getInstance().on("visible",this.onVisible_,this),t.host.indexOf("fblocal")===-1&&oh.getInstance().on("online",this.onOnline_,this)}sendRequest(t,r,i){let s=++this.requestNumber_,o={r:s,a:t,b:r};this.log_(Rt(o)),X(this.connected_,"sendRequest call when we're not connected not allowed."),this.realtime_.sendRequest(o),i&&(this.requestCBHash_[s]=i)}get(t){this.initConnection_();let r=new es,s={action:"g",request:{p:t._path.toString(),q:t._queryObject},onComplete:a=>{let c=a.d;a.s==="ok"?r.resolve(c):r.reject(c)}};this.outstandingGets_.push(s),this.outstandingGetCount_++;let o=this.outstandingGets_.length-1;return this.connected_&&this.sendGet_(o),r.promise}listen(t,r,i,s){this.initConnection_();let o=t._queryIdentifier,a=t._path.toString();this.log_("Listen called for "+a+" "+o),this.listens.has(a)||this.listens.set(a,new Map),X(t._queryParams.isDefault()||!t._queryParams.loadsAllData(),"listen() called for non-default but complete query"),X(!this.listens.get(a).has(o),"listen() called twice for same path/queryId.");let c={onComplete:s,hashFn:r,query:t,tag:i};this.listens.get(a).set(o,c),this.connected_&&this.sendListen_(c)}sendGet_(t){let r=this.outstandingGets_[t];this.sendRequest("g",r.request,i=>{delete this.outstandingGets_[t],this.outstandingGetCount_--,this.outstandingGetCount_===0&&(this.outstandingGets_=[]),r.onComplete&&r.onComplete(i)})}sendListen_(t){let r=t.query,i=r._path.toString(),s=r._queryIdentifier;this.log_("Listen on "+i+" for "+s);let o={p:i},a="q";t.tag&&(o.q=r._queryObject,o.t=t.tag),o.h=t.hashFn(),this.sendRequest(a,o,c=>{let l=c.d,u=c.s;e.warnOnListenWarnings_(l,r),(this.listens.get(i)&&this.listens.get(i).get(s))===t&&(this.log_("listen response",c),u!=="ok"&&this.removeListen_(i,s),t.onComplete&&t.onComplete(u,l))})}static warnOnListenWarnings_(t,r){if(t&&typeof t=="object"&&rr(t,"w")){let i=ts(t,"w");if(Array.isArray(i)&&~i.indexOf("no_index")){let s='".indexOn": "'+r._queryParams.getIndex().toString()+'"',o=r._path.toString();Vn(`Using an unspecified index. Your data will be downloaded and filtered on the client. Consider adding ${s} at ${o} to your security rules for better performance.`)}}}refreshAuthToken(t){this.authToken_=t,this.log_("Auth token refreshed"),this.authToken_?this.tryAuth():this.connected_&&this.sendRequest("unauth",{},()=>{}),this.reduceReconnectDelayIfAdminCredential_(t)}reduceReconnectDelayIfAdminCredential_(t){(t&&t.length===40||dS(t))&&(this.log_("Admin auth credential detected.  Reducing max reconnect time."),this.maxReconnectDelay_=cD)}refreshAppCheckToken(t){this.appCheckToken_=t,this.log_("App check token refreshed"),this.appCheckToken_?this.tryAppCheck():this.connected_&&this.sendRequest("unappeck",{},()=>{})}tryAuth(){if(this.connected_&&this.authToken_){let t=this.authToken_,r=fS(t)?"auth":"gauth",i={cred:t};this.authOverride_===null?i.noauth=!0:typeof this.authOverride_=="object"&&(i.authvar=this.authOverride_),this.sendRequest(r,i,s=>{let o=s.s,a=s.d||"error";this.authToken_===t&&(o==="ok"?this.invalidAuthTokenCount_=0:this.onAuthRevoked_(o,a))})}}tryAppCheck(){this.connected_&&this.appCheckToken_&&this.sendRequest("appcheck",{token:this.appCheckToken_},t=>{let r=t.s,i=t.d||"error";r==="ok"?this.invalidAppCheckTokenCount_=0:this.onAppCheckRevoked_(r,i)})}unlisten(t,r){let i=t._path.toString(),s=t._queryIdentifier;this.log_("Unlisten called for "+i+" "+s),X(t._queryParams.isDefault()||!t._queryParams.loadsAllData(),"unlisten() called for non-default but complete query"),this.removeListen_(i,s)&&this.connected_&&this.sendUnlisten_(i,s,t._queryObject,r)}sendUnlisten_(t,r,i,s){this.log_("Unlisten on "+t+" for "+r);let o={p:t},a="n";s&&(o.q=i,o.t=s),this.sendRequest(a,o)}onDisconnectPut(t,r,i){this.initConnection_(),this.connected_?this.sendOnDisconnect_("o",t,r,i):this.onDisconnectRequestQueue_.push({pathString:t,action:"o",data:r,onComplete:i})}onDisconnectMerge(t,r,i){this.initConnection_(),this.connected_?this.sendOnDisconnect_("om",t,r,i):this.onDisconnectRequestQueue_.push({pathString:t,action:"om",data:r,onComplete:i})}onDisconnectCancel(t,r){this.initConnection_(),this.connected_?this.sendOnDisconnect_("oc",t,null,r):this.onDisconnectRequestQueue_.push({pathString:t,action:"oc",data:null,onComplete:r})}sendOnDisconnect_(t,r,i,s){let o={p:r,d:i};this.log_("onDisconnect "+t,o),this.sendRequest(t,o,a=>{s&&setTimeout(()=>{s(a.s,a.d)},Math.floor(0))})}put(t,r,i,s){this.putInternal("p",t,r,i,s)}merge(t,r,i,s){this.putInternal("m",t,r,i,s)}putInternal(t,r,i,s,o){this.initConnection_();let a={p:r,d:i};o!==void 0&&(a.h=o),this.outstandingPuts_.push({action:t,request:a,onComplete:s}),this.outstandingPutCount_++;let c=this.outstandingPuts_.length-1;this.connected_?this.sendPut_(c):this.log_("Buffering put: "+r)}sendPut_(t){let r=this.outstandingPuts_[t].action,i=this.outstandingPuts_[t].request,s=this.outstandingPuts_[t].onComplete;this.outstandingPuts_[t].queued=this.connected_,this.sendRequest(r,i,o=>{this.log_(r+" response",o),delete this.outstandingPuts_[t],this.outstandingPutCount_--,this.outstandingPutCount_===0&&(this.outstandingPuts_=[]),s&&s(o.s,o.d)})}reportStats(t){if(this.connected_){let r={c:t};this.log_("reportStats",r),this.sendRequest("s",r,i=>{if(i.s!=="ok"){let o=i.d;this.log_("reportStats","Error sending stats: "+o)}})}}onDataMessage_(t){if("r"in t){this.log_("from server: "+Rt(t));let r=t.r,i=this.requestCBHash_[r];i&&(delete this.requestCBHash_[r],i(t.b))}else{if("error"in t)throw"A server-side error has occurred: "+t.error;"a"in t&&this.onDataPush_(t.a,t.b)}}onDataPush_(t,r){this.log_("handleServerMessage",t,r),t==="d"?this.onDataUpdate_(r.p,r.d,!1,r.t):t==="m"?this.onDataUpdate_(r.p,r.d,!0,r.t):t==="c"?this.onListenRevoked_(r.p,r.q):t==="ac"?this.onAuthRevoked_(r.s,r.d):t==="apc"?this.onAppCheckRevoked_(r.s,r.d):t==="sd"?this.onSecurityDebugPacket_(r):Kv("Unrecognized action received from server: "+Rt(t)+`
Are you using the latest client?`)}onReady_(t,r){this.log_("connection ready"),this.connected_=!0,this.lastConnectionEstablishedTime_=new Date().getTime(),this.handleTimestamp_(t),this.lastSessionId=r,this.firstConnection_&&this.sendConnectStats_(),this.restoreState_(),this.firstConnection_=!1,this.onConnectStatus_(!0)}scheduleConnect_(t){X(!this.realtime_,"Scheduling a connect when we're already connected/ing?"),this.establishConnectionTimer_&&clearTimeout(this.establishConnectionTimer_),this.establishConnectionTimer_=setTimeout(()=>{this.establishConnectionTimer_=null,this.establishConnection_()},Math.floor(t))}initConnection_(){!this.realtime_&&this.firstConnection_&&this.scheduleConnect_(0)}onVisible_(t){t&&!this.visible_&&this.reconnectDelay_===this.maxReconnectDelay_&&(this.log_("Window became visible.  Reducing delay."),this.reconnectDelay_=Fl,this.realtime_||this.scheduleConnect_(0)),this.visible_=t}onOnline_(t){t?(this.log_("Browser went online."),this.reconnectDelay_=Fl,this.realtime_||this.scheduleConnect_(0)):(this.log_("Browser went offline.  Killing connection."),this.realtime_&&this.realtime_.close())}onRealtimeDisconnect_(){if(this.log_("data client disconnected"),this.connected_=!1,this.realtime_=null,this.cancelSentTransactions_(),this.requestCBHash_={},this.shouldReconnect_()){this.visible_?this.lastConnectionEstablishedTime_&&(new Date().getTime()-this.lastConnectionEstablishedTime_>z9&&(this.reconnectDelay_=Fl),this.lastConnectionEstablishedTime_=null):(this.log_("Window isn't visible.  Delaying reconnect."),this.reconnectDelay_=this.maxReconnectDelay_,this.lastConnectionAttemptTime_=new Date().getTime());let t=new Date().getTime()-this.lastConnectionAttemptTime_,r=Math.max(0,this.reconnectDelay_-t);r=Math.random()*r,this.log_("Trying to reconnect in "+r+"ms"),this.scheduleConnect_(r),this.reconnectDelay_=Math.min(this.maxReconnectDelay_,this.reconnectDelay_*W9)}this.onConnectStatus_(!1)}establishConnection_(){return Z(this,null,function*(){if(this.shouldReconnect_()){this.log_("Making a connection attempt"),this.lastConnectionAttemptTime_=new Date().getTime(),this.lastConnectionEstablishedTime_=null;let t=this.onDataMessage_.bind(this),r=this.onReady_.bind(this),i=this.onRealtimeDisconnect_.bind(this),s=this.id+":"+e.nextConnectionId_++,o=this.lastSessionId,a=!1,c=null,l=function(){c?c.close():(a=!0,i())},u=function(d){X(c,"sendRequest call when we're not connected not allowed."),c.sendRequest(d)};this.realtime_={close:l,sendRequest:u};let f=this.forceTokenRefresh_;this.forceTokenRefresh_=!1;try{let[d,h]=yield Promise.all([this.authTokenProvider_.getToken(f),this.appCheckTokenProvider_.getToken(f)]);a?pn("getToken() completed but was canceled"):(pn("getToken() completed. Creating connection."),this.authToken_=d&&d.accessToken,this.appCheckToken_=h&&h.token,c=new n_(s,this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,t,r,i,m=>{Vn(m+" ("+this.repoInfo_.toString()+")"),this.interrupt(G9)},o))}catch(d){this.log_("Failed to get token: "+d),a||(this.repoInfo_.nodeAdmin&&Vn(d),l())}}})}interrupt(t){pn("Interrupting connection for reason: "+t),this.interruptReasons_[t]=!0,this.realtime_?this.realtime_.close():(this.establishConnectionTimer_&&(clearTimeout(this.establishConnectionTimer_),this.establishConnectionTimer_=null),this.connected_&&this.onRealtimeDisconnect_())}resume(t){pn("Resuming connection for reason: "+t),delete this.interruptReasons_[t],Ld(this.interruptReasons_)&&(this.reconnectDelay_=Fl,this.realtime_||this.scheduleConnect_(0))}handleTimestamp_(t){let r=t-new Date().getTime();this.onServerInfoUpdate_({serverTimeOffset:r})}cancelSentTransactions_(){for(let t=0;t<this.outstandingPuts_.length;t++){let r=this.outstandingPuts_[t];r&&"h"in r.request&&r.queued&&(r.onComplete&&r.onComplete("disconnect"),delete this.outstandingPuts_[t],this.outstandingPutCount_--)}this.outstandingPutCount_===0&&(this.outstandingPuts_=[])}onListenRevoked_(t,r){let i;r?i=r.map(o=>V_(o)).join("$"):i="default";let s=this.removeListen_(t,i);s&&s.onComplete&&s.onComplete("permission_denied")}removeListen_(t,r){let i=new it(t).toString(),s;if(this.listens.has(i)){let o=this.listens.get(i);s=o.get(r),o.delete(r),o.size===0&&this.listens.delete(i)}else s=void 0;return s}onAuthRevoked_(t,r){pn("Auth token revoked: "+t+"/"+r),this.authToken_=null,this.forceTokenRefresh_=!0,this.realtime_.close(),(t==="invalid_token"||t==="permission_denied")&&(this.invalidAuthTokenCount_++,this.invalidAuthTokenCount_>=lD&&(this.reconnectDelay_=cD,this.authTokenProvider_.notifyForInvalidToken()))}onAppCheckRevoked_(t,r){pn("App check token revoked: "+t+"/"+r),this.appCheckToken_=null,this.forceTokenRefresh_=!0,(t==="invalid_token"||t==="permission_denied")&&(this.invalidAppCheckTokenCount_++,this.invalidAppCheckTokenCount_>=lD&&this.appCheckTokenProvider_.notifyForInvalidToken())}onSecurityDebugPacket_(t){this.securityDebugCallback_?this.securityDebugCallback_(t):"msg"in t&&console.log("FIREBASE: "+t.msg.replace(`
`,`
FIREBASE: `))}restoreState_(){this.tryAuth(),this.tryAppCheck();for(let t of this.listens.values())for(let r of t.values())this.sendListen_(r);for(let t=0;t<this.outstandingPuts_.length;t++)this.outstandingPuts_[t]&&this.sendPut_(t);for(;this.onDisconnectRequestQueue_.length;){let t=this.onDisconnectRequestQueue_.shift();this.sendOnDisconnect_(t.action,t.pathString,t.data,t.onComplete)}for(let t=0;t<this.outstandingGets_.length;t++)this.outstandingGets_[t]&&this.sendGet_(t)}sendConnectStats_(){let t={},r="js";Yr()&&(this.repoInfo_.nodeAdmin?r="admin_node":r="node"),t["sdk."+r+"."+U_.replace(/\./g,"-")]=1,ml()?t["framework.cordova"]=1:Pd()&&(t["framework.reactnative"]=1),this.reportStats(t)}shouldReconnect_(){let t=oh.getInstance().currentlyOnline();return Ld(this.interruptReasons_)&&t}}e.nextPersistentConnectionId_=0,e.nextConnectionId_=0;return e})(),Fe=class e{constructor(n,t){this.name=n,this.node=t}static Wrap(n,t){return new e(n,t)}};var Ca=class{getCompare(){return this.compare.bind(this)}indexedValueChanged(n,t){let r=new Fe(Ia,n),i=new Fe(Ia,t);return this.compare(r,i)!==0}minPost(){return Fe.MIN}};var eh,ah=class extends Ca{static get __EMPTY_NODE(){return eh}static set __EMPTY_NODE(n){eh=n}compare(n,t){return Ra(n.name,t.name)}isDefinedOn(n){throw qs("KeyIndex.isDefinedOn not expected to be called.")}indexedValueChanged(n,t){return!1}minPost(){return Fe.MIN}maxPost(){return new Fe(no,eh)}makePost(n,t){return X(typeof n=="string","KeyIndex indexValue must always be a string."),new Fe(n,eh)}toString(){return".key"}},Ta=new ah;var ya=class{constructor(n,t,r,i,s=null){this.isReverse_=i,this.resultGenerator_=s,this.nodeStack_=[];let o=1;for(;!n.isEmpty();)if(n=n,o=t?r(n.key,t):1,i&&(o*=-1),o<0)this.isReverse_?n=n.left:n=n.right;else if(o===0){this.nodeStack_.push(n);break}else this.nodeStack_.push(n),this.isReverse_?n=n.right:n=n.left}getNext(){if(this.nodeStack_.length===0)return null;let n=this.nodeStack_.pop(),t;if(this.resultGenerator_?t=this.resultGenerator_(n.key,n.value):t={key:n.key,value:n.value},this.isReverse_)for(n=n.left;!n.isEmpty();)this.nodeStack_.push(n),n=n.right;else for(n=n.right;!n.isEmpty();)this.nodeStack_.push(n),n=n.left;return t}hasNext(){return this.nodeStack_.length>0}peek(){if(this.nodeStack_.length===0)return null;let n=this.nodeStack_[this.nodeStack_.length-1];return this.resultGenerator_?this.resultGenerator_(n.key,n.value):{key:n.key,value:n.value}}},Tr=(()=>{class e{constructor(t,r,i,s,o){this.key=t,this.value=r,this.color=i??e.RED,this.left=s??or.EMPTY_NODE,this.right=o??or.EMPTY_NODE}copy(t,r,i,s,o){return new e(t??this.key,r??this.value,i??this.color,s??this.left,o??this.right)}count(){return this.left.count()+1+this.right.count()}isEmpty(){return!1}inorderTraversal(t){return this.left.inorderTraversal(t)||!!t(this.key,this.value)||this.right.inorderTraversal(t)}reverseTraversal(t){return this.right.reverseTraversal(t)||t(this.key,this.value)||this.left.reverseTraversal(t)}min_(){return this.left.isEmpty()?this:this.left.min_()}minKey(){return this.min_().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(t,r,i){let s=this,o=i(t,s.key);return o<0?s=s.copy(null,null,null,s.left.insert(t,r,i),null):o===0?s=s.copy(null,r,null,null,null):s=s.copy(null,null,null,null,s.right.insert(t,r,i)),s.fixUp_()}removeMin_(){if(this.left.isEmpty())return or.EMPTY_NODE;let t=this;return!t.left.isRed_()&&!t.left.left.isRed_()&&(t=t.moveRedLeft_()),t=t.copy(null,null,null,t.left.removeMin_(),null),t.fixUp_()}remove(t,r){let i,s;if(i=this,r(t,i.key)<0)!i.left.isEmpty()&&!i.left.isRed_()&&!i.left.left.isRed_()&&(i=i.moveRedLeft_()),i=i.copy(null,null,null,i.left.remove(t,r),null);else{if(i.left.isRed_()&&(i=i.rotateRight_()),!i.right.isEmpty()&&!i.right.isRed_()&&!i.right.left.isRed_()&&(i=i.moveRedRight_()),r(t,i.key)===0){if(i.right.isEmpty())return or.EMPTY_NODE;s=i.right.min_(),i=i.copy(s.key,s.value,null,null,i.right.removeMin_())}i=i.copy(null,null,null,null,i.right.remove(t,r))}return i.fixUp_()}isRed_(){return this.color}fixUp_(){let t=this;return t.right.isRed_()&&!t.left.isRed_()&&(t=t.rotateLeft_()),t.left.isRed_()&&t.left.left.isRed_()&&(t=t.rotateRight_()),t.left.isRed_()&&t.right.isRed_()&&(t=t.colorFlip_()),t}moveRedLeft_(){let t=this.colorFlip_();return t.right.left.isRed_()&&(t=t.copy(null,null,null,null,t.right.rotateRight_()),t=t.rotateLeft_(),t=t.colorFlip_()),t}moveRedRight_(){let t=this.colorFlip_();return t.left.left.isRed_()&&(t=t.rotateRight_(),t=t.colorFlip_()),t}rotateLeft_(){let t=this.copy(null,null,e.RED,null,this.right.left);return this.right.copy(null,null,this.color,t,null)}rotateRight_(){let t=this.copy(null,null,e.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,t)}colorFlip_(){let t=this.left.copy(null,null,!this.left.color,null,null),r=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,t,r)}checkMaxDepth_(){let t=this.check_();return Math.pow(2,t)<=this.count()+1}check_(){if(this.isRed_()&&this.left.isRed_())throw new Error("Red node has red child("+this.key+","+this.value+")");if(this.right.isRed_())throw new Error("Right child of ("+this.key+","+this.value+") is red");let t=this.left.check_();if(t!==this.right.check_())throw new Error("Black depths differ");return t+(this.isRed_()?0:1)}}return e.RED=!0,e.BLACK=!1,e})(),s_=class{copy(n,t,r,i,s){return this}insert(n,t,r){return new Tr(n,t,null)}remove(n,t){return this}count(){return 0}isEmpty(){return!0}inorderTraversal(n){return!1}reverseTraversal(n){return!1}minKey(){return null}maxKey(){return null}check_(){return 0}isRed_(){return!1}},or=class e{constructor(n,t=e.EMPTY_NODE){this.comparator_=n,this.root_=t}insert(n,t){return new e(this.comparator_,this.root_.insert(n,t,this.comparator_).copy(null,null,Tr.BLACK,null,null))}remove(n){return new e(this.comparator_,this.root_.remove(n,this.comparator_).copy(null,null,Tr.BLACK,null,null))}get(n){let t,r=this.root_;for(;!r.isEmpty();){if(t=this.comparator_(n,r.key),t===0)return r.value;t<0?r=r.left:t>0&&(r=r.right)}return null}getPredecessorKey(n){let t,r=this.root_,i=null;for(;!r.isEmpty();)if(t=this.comparator_(n,r.key),t===0){if(r.left.isEmpty())return i?i.key:null;for(r=r.left;!r.right.isEmpty();)r=r.right;return r.key}else t<0?r=r.left:t>0&&(i=r,r=r.right);throw new Error("Attempted to find predecessor key for a nonexistent key.  What gives?")}isEmpty(){return this.root_.isEmpty()}count(){return this.root_.count()}minKey(){return this.root_.minKey()}maxKey(){return this.root_.maxKey()}inorderTraversal(n){return this.root_.inorderTraversal(n)}reverseTraversal(n){return this.root_.reverseTraversal(n)}getIterator(n){return new ya(this.root_,null,this.comparator_,!1,n)}getIteratorFrom(n,t){return new ya(this.root_,n,this.comparator_,!1,t)}getReverseIteratorFrom(n,t){return new ya(this.root_,n,this.comparator_,!0,t)}getReverseIterator(n){return new ya(this.root_,null,this.comparator_,!0,n)}};or.EMPTY_NODE=new s_;function q9(e,n){return Ra(e.name,n.name)}function z_(e,n){return Ra(e,n)}var o_;function K9(e){o_=e}var ZD=function(e){return typeof e=="number"?"number:"+RD(e):"string:"+e},JD=function(e){if(e.isLeafNode()){let n=e.val();X(typeof n=="string"||typeof n=="number"||typeof n=="object"&&rr(n,".sv"),"Priority must be a string or number.")}else X(e===o_||e.isEmpty(),"priority of unexpected type.");X(e===o_||e.getPriority().isEmpty(),"Priority nodes can't have a priority of their own.")};var uD,Sa=(()=>{class e{constructor(t,r=e.__childrenNodeConstructor.EMPTY_NODE){this.value_=t,this.priorityNode_=r,this.lazyHash_=null,X(this.value_!==void 0&&this.value_!==null,"LeafNode shouldn't be created with null/undefined value."),JD(this.priorityNode_)}static set __childrenNodeConstructor(t){uD=t}static get __childrenNodeConstructor(){return uD}isLeafNode(){return!0}getPriority(){return this.priorityNode_}updatePriority(t){return new e(this.value_,t)}getImmediateChild(t){return t===".priority"?this.priorityNode_:e.__childrenNodeConstructor.EMPTY_NODE}getChild(t){return Be(t)?this:Oe(t)===".priority"?this.priorityNode_:e.__childrenNodeConstructor.EMPTY_NODE}hasChild(){return!1}getPredecessorChildName(t,r){return null}updateImmediateChild(t,r){return t===".priority"?this.updatePriority(r):r.isEmpty()&&t!==".priority"?this:e.__childrenNodeConstructor.EMPTY_NODE.updateImmediateChild(t,r).updatePriority(this.priorityNode_)}updateChild(t,r){let i=Oe(t);return i===null?r:r.isEmpty()&&i!==".priority"?this:(X(i!==".priority"||ls(t)===1,".priority must be the last token in a path"),this.updateImmediateChild(i,e.__childrenNodeConstructor.EMPTY_NODE.updateChild(lt(t),r)))}isEmpty(){return!1}numChildren(){return 0}forEachChild(t,r){return!1}val(t){return t&&!this.getPriority().isEmpty()?{".value":this.getValue(),".priority":this.getPriority().val()}:this.getValue()}hash(){if(this.lazyHash_===null){let t="";this.priorityNode_.isEmpty()||(t+="priority:"+ZD(this.priorityNode_.val())+":");let r=typeof this.value_;t+=r+":",r==="number"?t+=RD(this.value_):t+=this.value_,this.lazyHash_=kD(t)}return this.lazyHash_}getValue(){return this.value_}compareTo(t){return t===e.__childrenNodeConstructor.EMPTY_NODE?1:t instanceof e.__childrenNodeConstructor?-1:(X(t.isLeafNode(),"Unknown node type"),this.compareToLeafNode_(t))}compareToLeafNode_(t){let r=typeof t.value_,i=typeof this.value_,s=e.VALUE_TYPE_ORDER.indexOf(r),o=e.VALUE_TYPE_ORDER.indexOf(i);return X(s>=0,"Unknown leaf type: "+r),X(o>=0,"Unknown leaf type: "+i),s===o?i==="object"?0:this.value_<t.value_?-1:this.value_===t.value_?0:1:o-s}withIndex(){return this}isIndexed(){return!0}equals(t){if(t===this)return!0;if(t.isLeafNode()){let r=t;return this.value_===r.value_&&this.priorityNode_.equals(r.priorityNode_)}else return!1}}e.VALUE_TYPE_ORDER=["object","boolean","number","string"];return e})(),eb,tb;function Y9(e){eb=e}function X9(e){tb=e}var a_=class extends Ca{compare(n,t){let r=n.node.getPriority(),i=t.node.getPriority(),s=r.compareTo(i);return s===0?Ra(n.name,t.name):s}isDefinedOn(n){return!n.getPriority().isEmpty()}indexedValueChanged(n,t){return!n.getPriority().equals(t.getPriority())}minPost(){return Fe.MIN}maxPost(){return new Fe(no,new Sa("[PRIORITY-POST]",tb))}makePost(n,t){let r=eb(n);return new Fe(t,new Sa("[PRIORITY-POST]",r))}toString(){return".priority"}},mt=new a_;var Q9=Math.log(2),c_=class{constructor(n){let t=s=>parseInt(Math.log(s)/Q9,10),r=s=>parseInt(Array(s+1).join("1"),2);this.count=t(n+1),this.current_=this.count-1;let i=r(this.count);this.bits_=n+1&i}nextBitIsOne(){let n=!(this.bits_&1<<this.current_);return this.current_--,n}},ch=function(e,n,t,r){e.sort(n);let i=function(c,l){let u=l-c,f,d;if(u===0)return null;if(u===1)return f=e[c],d=t?t(f):f,new Tr(d,f.node,Tr.BLACK,null,null);{let h=parseInt(u/2,10)+c,m=i(c,h),p=i(h+1,l);return f=e[h],d=t?t(f):f,new Tr(d,f.node,Tr.BLACK,m,p)}},s=function(c){let l=null,u=null,f=e.length,d=function(m,p){let g=f-m,w=f;f-=m;let C=i(g+1,w),_=e[g],M=t?t(_):_;h(new Tr(M,_.node,p,null,C))},h=function(m){l?(l.left=m,l=m):(u=m,l=m)};for(let m=0;m<c.count;++m){let p=c.nextBitIsOne(),g=Math.pow(2,c.count-(m+1));p?d(g,Tr.BLACK):(d(g,Tr.BLACK),d(g,Tr.RED))}return u},o=new c_(e.length),a=s(o);return new or(r||n,a)};var Vv,xa={},Da=class e{constructor(n,t){this.indexes_=n,this.indexSet_=t}static get Default(){return X(xa&&mt,"ChildrenNode.ts has not been loaded"),Vv=Vv||new e({".priority":xa},{".priority":mt}),Vv}get(n){let t=ts(this.indexes_,n);if(!t)throw new Error("No index defined for "+n);return t instanceof or?t:null}hasIndex(n){return rr(this.indexSet_,n.toString())}addIndex(n,t){X(n!==Ta,"KeyIndex always exists and isn't meant to be added to the IndexMap.");let r=[],i=!1,s=t.getIterator(Fe.Wrap),o=s.getNext();for(;o;)i=i||n.isDefinedOn(o.node),r.push(o),o=s.getNext();let a;i?a=ch(r,n.getCompare()):a=xa;let c=n.toString(),l=Object.assign({},this.indexSet_);l[c]=n;let u=Object.assign({},this.indexes_);return u[c]=a,new e(u,l)}addToIndexes(n,t){let r=gl(this.indexes_,(i,s)=>{let o=ts(this.indexSet_,s);if(X(o,"Missing index implementation for "+s),i===xa)if(o.isDefinedOn(n.node)){let a=[],c=t.getIterator(Fe.Wrap),l=c.getNext();for(;l;)l.name!==n.name&&a.push(l),l=c.getNext();return a.push(n),ch(a,o.getCompare())}else return xa;else{let a=t.get(n.name),c=i;return a&&(c=c.remove(new Fe(n.name,a))),c.insert(n,n.node)}});return new e(r,this.indexSet_)}removeFromIndexes(n,t){let r=gl(this.indexes_,i=>{if(i===xa)return i;{let s=t.get(n.name);return s?i.remove(new Fe(n.name,s)):i}});return new e(r,this.indexSet_)}};var Pl,De=(()=>{class e{constructor(t,r,i){this.children_=t,this.priorityNode_=r,this.indexMap_=i,this.lazyHash_=null,this.priorityNode_&&JD(this.priorityNode_),this.children_.isEmpty()&&X(!this.priorityNode_||this.priorityNode_.isEmpty(),"An empty node cannot have a priority")}static get EMPTY_NODE(){return Pl||(Pl=new e(new or(z_),null,Da.Default))}isLeafNode(){return!1}getPriority(){return this.priorityNode_||Pl}updatePriority(t){return this.children_.isEmpty()?this:new e(this.children_,t,this.indexMap_)}getImmediateChild(t){if(t===".priority")return this.getPriority();{let r=this.children_.get(t);return r===null?Pl:r}}getChild(t){let r=Oe(t);return r===null?this:this.getImmediateChild(r).getChild(lt(t))}hasChild(t){return this.children_.get(t)!==null}updateImmediateChild(t,r){if(X(r,"We should always be passing snapshot nodes"),t===".priority")return this.updatePriority(r);{let i=new Fe(t,r),s,o;r.isEmpty()?(s=this.children_.remove(t),o=this.indexMap_.removeFromIndexes(i,this.children_)):(s=this.children_.insert(t,r),o=this.indexMap_.addToIndexes(i,this.children_));let a=s.isEmpty()?Pl:this.priorityNode_;return new e(s,a,o)}}updateChild(t,r){let i=Oe(t);if(i===null)return r;{X(Oe(t)!==".priority"||ls(t)===1,".priority must be the last token in a path");let s=this.getImmediateChild(i).updateChild(lt(t),r);return this.updateImmediateChild(i,s)}}isEmpty(){return this.children_.isEmpty()}numChildren(){return this.children_.count()}val(t){if(this.isEmpty())return null;let r={},i=0,s=0,o=!0;if(this.forEachChild(mt,(a,c)=>{r[a]=c.val(t),i++,o&&e.INTEGER_REGEXP_.test(a)?s=Math.max(s,Number(a)):o=!1}),!t&&o&&s<2*i){let a=[];for(let c in r)a[c]=r[c];return a}else return t&&!this.getPriority().isEmpty()&&(r[".priority"]=this.getPriority().val()),r}hash(){if(this.lazyHash_===null){let t="";this.getPriority().isEmpty()||(t+="priority:"+ZD(this.getPriority().val())+":"),this.forEachChild(mt,(r,i)=>{let s=i.hash();s!==""&&(t+=":"+r+":"+s)}),this.lazyHash_=t===""?"":kD(t)}return this.lazyHash_}getPredecessorChildName(t,r,i){let s=this.resolveIndex_(i);if(s){let o=s.getPredecessorKey(new Fe(t,r));return o?o.name:null}else return this.children_.getPredecessorKey(t)}getFirstChildName(t){let r=this.resolveIndex_(t);if(r){let i=r.minKey();return i&&i.name}else return this.children_.minKey()}getFirstChild(t){let r=this.getFirstChildName(t);return r?new Fe(r,this.children_.get(r)):null}getLastChildName(t){let r=this.resolveIndex_(t);if(r){let i=r.maxKey();return i&&i.name}else return this.children_.maxKey()}getLastChild(t){let r=this.getLastChildName(t);return r?new Fe(r,this.children_.get(r)):null}forEachChild(t,r){let i=this.resolveIndex_(t);return i?i.inorderTraversal(s=>r(s.name,s.node)):this.children_.inorderTraversal(r)}getIterator(t){return this.getIteratorFrom(t.minPost(),t)}getIteratorFrom(t,r){let i=this.resolveIndex_(r);if(i)return i.getIteratorFrom(t,s=>s);{let s=this.children_.getIteratorFrom(t.name,Fe.Wrap),o=s.peek();for(;o!=null&&r.compare(o,t)<0;)s.getNext(),o=s.peek();return s}}getReverseIterator(t){return this.getReverseIteratorFrom(t.maxPost(),t)}getReverseIteratorFrom(t,r){let i=this.resolveIndex_(r);if(i)return i.getReverseIteratorFrom(t,s=>s);{let s=this.children_.getReverseIteratorFrom(t.name,Fe.Wrap),o=s.peek();for(;o!=null&&r.compare(o,t)>0;)s.getNext(),o=s.peek();return s}}compareTo(t){return this.isEmpty()?t.isEmpty()?0:-1:t.isLeafNode()||t.isEmpty()?1:t===Jl?-1:0}withIndex(t){if(t===Ta||this.indexMap_.hasIndex(t))return this;{let r=this.indexMap_.addIndex(t,this.children_);return new e(this.children_,this.priorityNode_,r)}}isIndexed(t){return t===Ta||this.indexMap_.hasIndex(t)}equals(t){if(t===this)return!0;if(t.isLeafNode())return!1;{let r=t;if(this.getPriority().equals(r.getPriority()))if(this.children_.count()===r.children_.count()){let i=this.getIterator(mt),s=r.getIterator(mt),o=i.getNext(),a=s.getNext();for(;o&&a;){if(o.name!==a.name||!o.node.equals(a.node))return!1;o=i.getNext(),a=s.getNext()}return o===null&&a===null}else return!1;else return!1}}resolveIndex_(t){return t===Ta?null:this.indexMap_.get(t.toString())}}return e.INTEGER_REGEXP_=/^(0|[1-9]\d*)$/,e})(),l_=class extends De{constructor(){super(new or(z_),De.EMPTY_NODE,Da.Default)}compareTo(n){return n===this?0:1}equals(n){return n===this}getPriority(){return this}getImmediateChild(n){return De.EMPTY_NODE}isEmpty(){return!1}},Jl=new l_;Object.defineProperties(Fe,{MIN:{value:new Fe(Ia,De.EMPTY_NODE)},MAX:{value:new Fe(no,Jl)}});ah.__EMPTY_NODE=De.EMPTY_NODE;Sa.__childrenNodeConstructor=De;K9(Jl);X9(Jl);var Z9=!0;function Gt(e,n=null){if(e===null)return De.EMPTY_NODE;if(typeof e=="object"&&".priority"in e&&(n=e[".priority"]),X(n===null||typeof n=="string"||typeof n=="number"||typeof n=="object"&&".sv"in n,"Invalid priority type found: "+typeof n),typeof e=="object"&&".value"in e&&e[".value"]!==null&&(e=e[".value"]),typeof e!="object"||".sv"in e){let t=e;return new Sa(t,Gt(n))}if(!(e instanceof Array)&&Z9){let t=[],r=!1;if(Nn(e,(o,a)=>{if(o.substring(0,1)!=="."){let c=Gt(a);c.isEmpty()||(r=r||!c.getPriority().isEmpty(),t.push(new Fe(o,c)))}}),t.length===0)return De.EMPTY_NODE;let s=ch(t,q9,o=>o.name,z_);if(r){let o=ch(t,mt.getCompare());return new De(s,Gt(n),new Da({".priority":o},{".priority":mt}))}else return new De(s,Gt(n),Da.Default)}else{let t=De.EMPTY_NODE;return Nn(e,(r,i)=>{if(rr(e,r)&&r.substring(0,1)!=="."){let s=Gt(i);(s.isLeafNode()||!s.isEmpty())&&(t=t.updateImmediateChild(r,s))}}),t.updatePriority(Gt(n))}}Y9(Gt);var u_=class extends Ca{constructor(n){super(),this.indexPath_=n,X(!Be(n)&&Oe(n)!==".priority","Can't create PathIndex with empty path or .priority key")}extractChild(n){return n.getChild(this.indexPath_)}isDefinedOn(n){return!n.getChild(this.indexPath_).isEmpty()}compare(n,t){let r=this.extractChild(n.node),i=this.extractChild(t.node),s=r.compareTo(i);return s===0?Ra(n.name,t.name):s}makePost(n,t){let r=Gt(n),i=De.EMPTY_NODE.updateChild(this.indexPath_,r);return new Fe(t,i)}maxPost(){let n=De.EMPTY_NODE.updateChild(this.indexPath_,Jl);return new Fe(no,n)}toString(){return YD(this.indexPath_,0).join("/")}};var f_=class extends Ca{compare(n,t){let r=n.node.compareTo(t.node);return r===0?Ra(n.name,t.name):r}isDefinedOn(n){return!0}indexedValueChanged(n,t){return!n.equals(t)}minPost(){return Fe.MIN}maxPost(){return Fe.MAX}makePost(n,t){let r=Gt(n);return new Fe(t,r)}toString(){return".value"}},J9=new f_;function nb(e){return{type:"value",snapshotNode:e}}function ba(e,n){return{type:"child_added",snapshotNode:n,childName:e}}function $l(e,n){return{type:"child_removed",snapshotNode:n,childName:e}}function Wl(e,n,t){return{type:"child_changed",snapshotNode:n,childName:e,oldSnap:t}}function e7(e,n){return{type:"child_moved",snapshotNode:n,childName:e}}var zl=class{constructor(n){this.index_=n}updateChild(n,t,r,i,s,o){X(n.isIndexed(this.index_),"A node must be indexed if only a child is updated");let a=n.getImmediateChild(t);return a.getChild(i).equals(r.getChild(i))&&a.isEmpty()===r.isEmpty()||(o!=null&&(r.isEmpty()?n.hasChild(t)?o.trackChildChange($l(t,a)):X(n.isLeafNode(),"A child remove without an old child only makes sense on a leaf node"):a.isEmpty()?o.trackChildChange(ba(t,r)):o.trackChildChange(Wl(t,r,a))),n.isLeafNode()&&r.isEmpty())?n:n.updateImmediateChild(t,r).withIndex(this.index_)}updateFullNode(n,t,r){return r!=null&&(n.isLeafNode()||n.forEachChild(mt,(i,s)=>{t.hasChild(i)||r.trackChildChange($l(i,s))}),t.isLeafNode()||t.forEachChild(mt,(i,s)=>{if(n.hasChild(i)){let o=n.getImmediateChild(i);o.equals(s)||r.trackChildChange(Wl(i,s,o))}else r.trackChildChange(ba(i,s))})),t.withIndex(this.index_)}updatePriority(n,t){return n.isEmpty()?De.EMPTY_NODE:n.updatePriority(t)}filtersNodes(){return!1}getIndexedFilter(){return this}getIndex(){return this.index_}};var lh=class e{constructor(n){this.indexedFilter_=new zl(n.getIndex()),this.index_=n.getIndex(),this.startPost_=e.getStartPost_(n),this.endPost_=e.getEndPost_(n),this.startIsInclusive_=!n.startAfterSet_,this.endIsInclusive_=!n.endBeforeSet_}getStartPost(){return this.startPost_}getEndPost(){return this.endPost_}matches(n){let t=this.startIsInclusive_?this.index_.compare(this.getStartPost(),n)<=0:this.index_.compare(this.getStartPost(),n)<0,r=this.endIsInclusive_?this.index_.compare(n,this.getEndPost())<=0:this.index_.compare(n,this.getEndPost())<0;return t&&r}updateChild(n,t,r,i,s,o){return this.matches(new Fe(t,r))||(r=De.EMPTY_NODE),this.indexedFilter_.updateChild(n,t,r,i,s,o)}updateFullNode(n,t,r){t.isLeafNode()&&(t=De.EMPTY_NODE);let i=t.withIndex(this.index_);i=i.updatePriority(De.EMPTY_NODE);let s=this;return t.forEachChild(mt,(o,a)=>{s.matches(new Fe(o,a))||(i=i.updateImmediateChild(o,De.EMPTY_NODE))}),this.indexedFilter_.updateFullNode(n,i,r)}updatePriority(n,t){return n}filtersNodes(){return!0}getIndexedFilter(){return this.indexedFilter_}getIndex(){return this.index_}static getStartPost_(n){if(n.hasStart()){let t=n.getIndexStartName();return n.getIndex().makePost(n.getIndexStartValue(),t)}else return n.getIndex().minPost()}static getEndPost_(n){if(n.hasEnd()){let t=n.getIndexEndName();return n.getIndex().makePost(n.getIndexEndValue(),t)}else return n.getIndex().maxPost()}};var d_=class{constructor(n){this.withinDirectionalStart=t=>this.reverse_?this.withinEndPost(t):this.withinStartPost(t),this.withinDirectionalEnd=t=>this.reverse_?this.withinStartPost(t):this.withinEndPost(t),this.withinStartPost=t=>{let r=this.index_.compare(this.rangedFilter_.getStartPost(),t);return this.startIsInclusive_?r<=0:r<0},this.withinEndPost=t=>{let r=this.index_.compare(t,this.rangedFilter_.getEndPost());return this.endIsInclusive_?r<=0:r<0},this.rangedFilter_=new lh(n),this.index_=n.getIndex(),this.limit_=n.getLimit(),this.reverse_=!n.isViewFromLeft(),this.startIsInclusive_=!n.startAfterSet_,this.endIsInclusive_=!n.endBeforeSet_}updateChild(n,t,r,i,s,o){return this.rangedFilter_.matches(new Fe(t,r))||(r=De.EMPTY_NODE),n.getImmediateChild(t).equals(r)?n:n.numChildren()<this.limit_?this.rangedFilter_.getIndexedFilter().updateChild(n,t,r,i,s,o):this.fullLimitUpdateChild_(n,t,r,s,o)}updateFullNode(n,t,r){let i;if(t.isLeafNode()||t.isEmpty())i=De.EMPTY_NODE.withIndex(this.index_);else if(this.limit_*2<t.numChildren()&&t.isIndexed(this.index_)){i=De.EMPTY_NODE.withIndex(this.index_);let s;this.reverse_?s=t.getReverseIteratorFrom(this.rangedFilter_.getEndPost(),this.index_):s=t.getIteratorFrom(this.rangedFilter_.getStartPost(),this.index_);let o=0;for(;s.hasNext()&&o<this.limit_;){let a=s.getNext();if(this.withinDirectionalStart(a))if(this.withinDirectionalEnd(a))i=i.updateImmediateChild(a.name,a.node),o++;else break;else continue}}else{i=t.withIndex(this.index_),i=i.updatePriority(De.EMPTY_NODE);let s;this.reverse_?s=i.getReverseIterator(this.index_):s=i.getIterator(this.index_);let o=0;for(;s.hasNext();){let a=s.getNext();o<this.limit_&&this.withinDirectionalStart(a)&&this.withinDirectionalEnd(a)?o++:i=i.updateImmediateChild(a.name,De.EMPTY_NODE)}}return this.rangedFilter_.getIndexedFilter().updateFullNode(n,i,r)}updatePriority(n,t){return n}filtersNodes(){return!0}getIndexedFilter(){return this.rangedFilter_.getIndexedFilter()}getIndex(){return this.index_}fullLimitUpdateChild_(n,t,r,i,s){let o;if(this.reverse_){let f=this.index_.getCompare();o=(d,h)=>f(h,d)}else o=this.index_.getCompare();let a=n;X(a.numChildren()===this.limit_,"");let c=new Fe(t,r),l=this.reverse_?a.getFirstChild(this.index_):a.getLastChild(this.index_),u=this.rangedFilter_.matches(c);if(a.hasChild(t)){let f=a.getImmediateChild(t),d=i.getChildAfterChild(this.index_,l,this.reverse_);for(;d!=null&&(d.name===t||a.hasChild(d.name));)d=i.getChildAfterChild(this.index_,d,this.reverse_);let h=d==null?1:o(d,c);if(u&&!r.isEmpty()&&h>=0)return s?.trackChildChange(Wl(t,r,f)),a.updateImmediateChild(t,r);{s?.trackChildChange($l(t,f));let p=a.updateImmediateChild(t,De.EMPTY_NODE);return d!=null&&this.rangedFilter_.matches(d)?(s?.trackChildChange(ba(d.name,d.node)),p.updateImmediateChild(d.name,d.node)):p}}else return r.isEmpty()?n:u&&o(l,c)>=0?(s!=null&&(s.trackChildChange($l(l.name,l.node)),s.trackChildChange(ba(t,r))),a.updateImmediateChild(t,r).updateImmediateChild(l.name,De.EMPTY_NODE)):n}};var h_=class e{constructor(){this.limitSet_=!1,this.startSet_=!1,this.startNameSet_=!1,this.startAfterSet_=!1,this.endSet_=!1,this.endNameSet_=!1,this.endBeforeSet_=!1,this.limit_=0,this.viewFrom_="",this.indexStartValue_=null,this.indexStartName_="",this.indexEndValue_=null,this.indexEndName_="",this.index_=mt}hasStart(){return this.startSet_}isViewFromLeft(){return this.viewFrom_===""?this.startSet_:this.viewFrom_==="l"}getIndexStartValue(){return X(this.startSet_,"Only valid if start has been set"),this.indexStartValue_}getIndexStartName(){return X(this.startSet_,"Only valid if start has been set"),this.startNameSet_?this.indexStartName_:Ia}hasEnd(){return this.endSet_}getIndexEndValue(){return X(this.endSet_,"Only valid if end has been set"),this.indexEndValue_}getIndexEndName(){return X(this.endSet_,"Only valid if end has been set"),this.endNameSet_?this.indexEndName_:no}hasLimit(){return this.limitSet_}hasAnchoredLimit(){return this.limitSet_&&this.viewFrom_!==""}getLimit(){return X(this.limitSet_,"Only valid if limit has been set"),this.limit_}getIndex(){return this.index_}loadsAllData(){return!(this.startSet_||this.endSet_||this.limitSet_)}isDefault(){return this.loadsAllData()&&this.index_===mt}copy(){let n=new e;return n.limitSet_=this.limitSet_,n.limit_=this.limit_,n.startSet_=this.startSet_,n.startAfterSet_=this.startAfterSet_,n.indexStartValue_=this.indexStartValue_,n.startNameSet_=this.startNameSet_,n.indexStartName_=this.indexStartName_,n.endSet_=this.endSet_,n.endBeforeSet_=this.endBeforeSet_,n.indexEndValue_=this.indexEndValue_,n.endNameSet_=this.endNameSet_,n.indexEndName_=this.indexEndName_,n.index_=this.index_,n.viewFrom_=this.viewFrom_,n}};function t7(e){return e.loadsAllData()?new zl(e.getIndex()):e.hasLimit()?new d_(e):new lh(e)}function fD(e){let n={};if(e.isDefault())return n;let t;if(e.index_===mt?t="$priority":e.index_===J9?t="$value":e.index_===Ta?t="$key":(X(e.index_ instanceof u_,"Unrecognized index type!"),t=e.index_.toString()),n.orderBy=Rt(t),e.startSet_){let r=e.startAfterSet_?"startAfter":"startAt";n[r]=Rt(e.indexStartValue_),e.startNameSet_&&(n[r]+=","+Rt(e.indexStartName_))}if(e.endSet_){let r=e.endBeforeSet_?"endBefore":"endAt";n[r]=Rt(e.indexEndValue_),e.endNameSet_&&(n[r]+=","+Rt(e.indexEndName_))}return e.limitSet_&&(e.isViewFromLeft()?n.limitToFirst=e.limit_:n.limitToLast=e.limit_),n}function dD(e){let n={};if(e.startSet_&&(n.sp=e.indexStartValue_,e.startNameSet_&&(n.sn=e.indexStartName_),n.sin=!e.startAfterSet_),e.endSet_&&(n.ep=e.indexEndValue_,e.endNameSet_&&(n.en=e.indexEndName_),n.ein=!e.endBeforeSet_),e.limitSet_){n.l=e.limit_;let t=e.viewFrom_;t===""&&(e.isViewFromLeft()?t="l":t="r"),n.vf=t}return e.index_!==mt&&(n.i=e.index_.toString()),n}var p_=class e extends ih{constructor(n,t,r,i){super(),this.repoInfo_=n,this.onDataUpdate_=t,this.authTokenProvider_=r,this.appCheckTokenProvider_=i,this.log_=Ql("p:rest:"),this.listens_={}}reportStats(n){throw new Error("Method not implemented.")}static getListenId_(n,t){return t!==void 0?"tag$"+t:(X(n._queryParams.isDefault(),"should have a tag if it's not a default query."),n._path.toString())}listen(n,t,r,i){let s=n._path.toString();this.log_("Listen called for "+s+" "+n._queryIdentifier);let o=e.getListenId_(n,r),a={};this.listens_[o]=a;let c=fD(n._queryParams);this.restRequest_(s+".json",c,(l,u)=>{let f=u;if(l===404&&(f=null,l=null),l===null&&this.onDataUpdate_(s,f,!1,r),ts(this.listens_,o)===a){let d;l?l===401?d="permission_denied":d="rest_error:"+l:d="ok",i(d,null)}})}unlisten(n,t){let r=e.getListenId_(n,t);delete this.listens_[r]}get(n){let t=fD(n._queryParams),r=n._path.toString(),i=new es;return this.restRequest_(r+".json",t,(s,o)=>{let a=o;s===404&&(a=null,s=null),s===null?(this.onDataUpdate_(r,a,!1,null),i.resolve(a)):i.reject(new Error(a))}),i.promise}refreshAuthToken(n){}restRequest_(n,t={},r){return t.format="export",Promise.all([this.authTokenProvider_.getToken(!1),this.appCheckTokenProvider_.getToken(!1)]).then(([i,s])=>{i&&i.accessToken&&(t.auth=i.accessToken),s&&s.token&&(t.ac=s.token);let o=(this.repoInfo_.secure?"https://":"http://")+this.repoInfo_.host+n+"?ns="+this.repoInfo_.namespace+_l(t);this.log_("Sending REST request for "+o);let a=new XMLHttpRequest;a.onreadystatechange=()=>{if(r&&a.readyState===4){this.log_("REST Response for "+o+" received. status:",a.status,"response:",a.responseText);let c=null;if(a.status>=200&&a.status<300){try{c=pa(a.responseText)}catch{Vn("Failed to parse JSON response for "+o+": "+a.responseText)}r(null,c)}else a.status!==401&&a.status!==404&&Vn("Got unsuccessful REST response for "+o+" Status: "+a.status),r(a.status);r=null}},a.open("GET",o,!0),a.send()})}};var m_=class{constructor(){this.rootNode_=De.EMPTY_NODE}getNode(n){return this.rootNode_.getChild(n)}updateSnapshot(n,t){this.rootNode_=this.rootNode_.updateChild(n,t)}};function uh(){return{value:null,children:new Map}}function rb(e,n,t){if(Be(n))e.value=t,e.children.clear();else if(e.value!==null)e.value=e.value.updateChild(n,t);else{let r=Oe(n);e.children.has(r)||e.children.set(r,uh());let i=e.children.get(r);n=lt(n),rb(i,n,t)}}function g_(e,n,t){e.value!==null?t(n,e.value):n7(e,(r,i)=>{let s=new it(n.toString()+"/"+r);g_(i,s,t)})}function n7(e,n){e.children.forEach((t,r)=>{n(r,t)})}var v_=class{constructor(n){this.collection_=n,this.last_=null}get(){let n=this.collection_.get(),t=Object.assign({},n);return this.last_&&Nn(this.last_,(r,i)=>{t[r]=t[r]-i}),this.last_=n,t}};var hD=10*1e3,r7=30*1e3,i7=5*60*1e3,__=class{constructor(n,t){this.server_=t,this.statsToReport_={},this.statsListener_=new v_(n);let r=hD+(r7-hD)*Math.random();Bl(this.reportStats_.bind(this),Math.floor(r))}reportStats_(){let n=this.statsListener_.get(),t={},r=!1;Nn(n,(i,s)=>{s>0&&rr(this.statsToReport_,i)&&(t[i]=s,r=!0)}),r&&this.server_.reportStats(t),Bl(this.reportStats_.bind(this),Math.floor(Math.random()*2*i7))}};var Qr=function(e){return e[e.OVERWRITE=0]="OVERWRITE",e[e.MERGE=1]="MERGE",e[e.ACK_USER_WRITE=2]="ACK_USER_WRITE",e[e.LISTEN_COMPLETE=3]="LISTEN_COMPLETE",e}(Qr||{});function ib(){return{fromUser:!0,fromServer:!1,queryId:null,tagged:!1}}function G_(){return{fromUser:!1,fromServer:!0,queryId:null,tagged:!1}}function q_(e){return{fromUser:!1,fromServer:!0,queryId:e,tagged:!0}}var x_=class e{constructor(n,t,r){this.path=n,this.affectedTree=t,this.revert=r,this.type=Qr.ACK_USER_WRITE,this.source=ib()}operationForChild(n){if(Be(this.path)){if(this.affectedTree.value!=null)return X(this.affectedTree.children.isEmpty(),"affectedTree should not have overlapping affected paths."),this;{let t=this.affectedTree.subtree(new it(n));return new e(Qe(),t,this.revert)}}else return X(Oe(this.path)===n,"operationForChild called for unrelated child."),new e(lt(this.path),this.affectedTree,this.revert)}};var fh=class e{constructor(n,t){this.source=n,this.path=t,this.type=Qr.LISTEN_COMPLETE}operationForChild(n){return Be(this.path)?new e(this.source,Qe()):new e(this.source,lt(this.path))}};var Aa=class e{constructor(n,t,r){this.source=n,this.path=t,this.snap=r,this.type=Qr.OVERWRITE}operationForChild(n){return Be(this.path)?new e(this.source,Qe(),this.snap.getImmediateChild(n)):new e(this.source,lt(this.path),this.snap)}};var dh=class e{constructor(n,t,r){this.source=n,this.path=t,this.children=r,this.type=Qr.MERGE}operationForChild(n){if(Be(this.path)){let t=this.children.subtree(new it(n));return t.isEmpty()?null:t.value?new Aa(this.source,Qe(),t.value):new e(this.source,Qe(),t)}else return X(Oe(this.path)===n,"Can't get a merge for a child not on the path of the operation"),new e(this.source,lt(this.path),this.children)}toString(){return"Operation("+this.path+": "+this.source.toString()+" merge: "+this.children.toString()+")"}};var Zr=class{constructor(n,t,r){this.node_=n,this.fullyInitialized_=t,this.filtered_=r}isFullyInitialized(){return this.fullyInitialized_}isFiltered(){return this.filtered_}isCompleteForPath(n){if(Be(n))return this.isFullyInitialized()&&!this.filtered_;let t=Oe(n);return this.isCompleteForChild(t)}isCompleteForChild(n){return this.isFullyInitialized()&&!this.filtered_||this.node_.hasChild(n)}getNode(){return this.node_}};var y_=class{constructor(n){this.query_=n,this.index_=this.query_._queryParams.getIndex()}};function s7(e,n,t,r){let i=[],s=[];return n.forEach(o=>{o.type==="child_changed"&&e.index_.indexedValueChanged(o.oldSnap,o.snapshotNode)&&s.push(e7(o.childName,o.snapshotNode))}),Ll(e,i,"child_removed",n,r,t),Ll(e,i,"child_added",n,r,t),Ll(e,i,"child_moved",s,r,t),Ll(e,i,"child_changed",n,r,t),Ll(e,i,"value",n,r,t),i}function Ll(e,n,t,r,i,s){let o=r.filter(a=>a.type===t);o.sort((a,c)=>a7(e,a,c)),o.forEach(a=>{let c=o7(e,a,s);i.forEach(l=>{l.respondsTo(a.type)&&n.push(l.createEvent(c,e.query_))})})}function o7(e,n,t){return n.type==="value"||n.type==="child_removed"||(n.prevName=t.getPredecessorChildName(n.childName,n.snapshotNode,e.index_)),n}function a7(e,n,t){if(n.childName==null||t.childName==null)throw qs("Should only compare child_ events.");let r=new Fe(n.childName,n.snapshotNode),i=new Fe(t.childName,t.snapshotNode);return e.index_.compare(r,i)}function Sh(e,n){return{eventCache:e,serverCache:n}}function jl(e,n,t,r){return Sh(new Zr(n,t,r),e.serverCache)}function sb(e,n,t,r){return Sh(e.eventCache,new Zr(n,t,r))}function hh(e){return e.eventCache.isFullyInitialized()?e.eventCache.getNode():null}function ro(e){return e.serverCache.isFullyInitialized()?e.serverCache.getNode():null}var Hv,c7=()=>(Hv||(Hv=new or(l9)),Hv),Rn=class e{constructor(n,t=c7()){this.value=n,this.children=t}static fromObject(n){let t=new e(null);return Nn(n,(r,i)=>{t=t.set(new it(r),i)}),t}isEmpty(){return this.value===null&&this.children.isEmpty()}findRootMostMatchingPathAndValue(n,t){if(this.value!=null&&t(this.value))return{path:Qe(),value:this.value};if(Be(n))return null;{let r=Oe(n),i=this.children.get(r);if(i!==null){let s=i.findRootMostMatchingPathAndValue(lt(n),t);return s!=null?{path:Pt(new it(r),s.path),value:s.value}:null}else return null}}findRootMostValueAndPath(n){return this.findRootMostMatchingPathAndValue(n,()=>!0)}subtree(n){if(Be(n))return this;{let t=Oe(n),r=this.children.get(t);return r!==null?r.subtree(lt(n)):new e(null)}}set(n,t){if(Be(n))return new e(t,this.children);{let r=Oe(n),s=(this.children.get(r)||new e(null)).set(lt(n),t),o=this.children.insert(r,s);return new e(this.value,o)}}remove(n){if(Be(n))return this.children.isEmpty()?new e(null):new e(null,this.children);{let t=Oe(n),r=this.children.get(t);if(r){let i=r.remove(lt(n)),s;return i.isEmpty()?s=this.children.remove(t):s=this.children.insert(t,i),this.value===null&&s.isEmpty()?new e(null):new e(this.value,s)}else return this}}get(n){if(Be(n))return this.value;{let t=Oe(n),r=this.children.get(t);return r?r.get(lt(n)):null}}setTree(n,t){if(Be(n))return t;{let r=Oe(n),s=(this.children.get(r)||new e(null)).setTree(lt(n),t),o;return s.isEmpty()?o=this.children.remove(r):o=this.children.insert(r,s),new e(this.value,o)}}fold(n){return this.fold_(Qe(),n)}fold_(n,t){let r={};return this.children.inorderTraversal((i,s)=>{r[i]=s.fold_(Pt(n,i),t)}),t(n,this.value,r)}findOnPath(n,t){return this.findOnPath_(n,Qe(),t)}findOnPath_(n,t,r){let i=this.value?r(t,this.value):!1;if(i)return i;if(Be(n))return null;{let s=Oe(n),o=this.children.get(s);return o?o.findOnPath_(lt(n),Pt(t,s),r):null}}foreachOnPath(n,t){return this.foreachOnPath_(n,Qe(),t)}foreachOnPath_(n,t,r){if(Be(n))return this;{this.value&&r(t,this.value);let i=Oe(n),s=this.children.get(i);return s?s.foreachOnPath_(lt(n),Pt(t,i),r):new e(null)}}foreach(n){this.foreach_(Qe(),n)}foreach_(n,t){this.children.inorderTraversal((r,i)=>{i.foreach_(Pt(n,r),t)}),this.value&&t(n,this.value)}foreachChild(n){this.children.inorderTraversal((t,r)=>{r.value&&n(t,r.value)})}};var Cr=class e{constructor(n){this.writeTree_=n}static empty(){return new e(new Rn(null))}};function Vl(e,n,t){if(Be(n))return new Cr(new Rn(t));{let r=e.writeTree_.findRootMostValueAndPath(n);if(r!=null){let i=r.path,s=r.value,o=Tn(i,n);return s=s.updateChild(o,t),new Cr(e.writeTree_.set(i,s))}else{let i=new Rn(t),s=e.writeTree_.setTree(n,i);return new Cr(s)}}}function pD(e,n,t){let r=e;return Nn(t,(i,s)=>{r=Vl(r,Pt(n,i),s)}),r}function mD(e,n){if(Be(n))return Cr.empty();{let t=e.writeTree_.setTree(n,new Rn(null));return new Cr(t)}}function w_(e,n){return io(e,n)!=null}function io(e,n){let t=e.writeTree_.findRootMostValueAndPath(n);return t!=null?e.writeTree_.get(t.path).getChild(Tn(t.path,n)):null}function gD(e){let n=[],t=e.writeTree_.value;return t!=null?t.isLeafNode()||t.forEachChild(mt,(r,i)=>{n.push(new Fe(r,i))}):e.writeTree_.children.inorderTraversal((r,i)=>{i.value!=null&&n.push(new Fe(r,i.value))}),n}function as(e,n){if(Be(n))return e;{let t=io(e,n);return t!=null?new Cr(new Rn(t)):new Cr(e.writeTree_.subtree(n))}}function E_(e){return e.writeTree_.isEmpty()}function ka(e,n){return ob(Qe(),e.writeTree_,n)}function ob(e,n,t){if(n.value!=null)return t.updateChild(e,n.value);{let r=null;return n.children.inorderTraversal((i,s)=>{i===".priority"?(X(s.value!==null,"Priority writes must always be leaf nodes"),r=s.value):t=ob(Pt(e,i),s,t)}),!t.getChild(e).isEmpty()&&r!==null&&(t=t.updateChild(Pt(e,".priority"),r)),t}}function Dh(e,n){return ub(n,e)}function l7(e,n,t,r,i){X(r>e.lastWriteId,"Stacking an older write on top of newer ones"),i===void 0&&(i=!0),e.allWrites.push({path:n,snap:t,writeId:r,visible:i}),i&&(e.visibleWrites=Vl(e.visibleWrites,n,t)),e.lastWriteId=r}function u7(e,n){for(let t=0;t<e.allWrites.length;t++){let r=e.allWrites[t];if(r.writeId===n)return r}return null}function f7(e,n){let t=e.allWrites.findIndex(a=>a.writeId===n);X(t>=0,"removeWrite called with nonexistent writeId.");let r=e.allWrites[t];e.allWrites.splice(t,1);let i=r.visible,s=!1,o=e.allWrites.length-1;for(;i&&o>=0;){let a=e.allWrites[o];a.visible&&(o>=t&&d7(a,r.path)?i=!1:Ir(r.path,a.path)&&(s=!0)),o--}if(i){if(s)return h7(e),!0;if(r.snap)e.visibleWrites=mD(e.visibleWrites,r.path);else{let a=r.children;Nn(a,c=>{e.visibleWrites=mD(e.visibleWrites,Pt(r.path,c))})}return!0}else return!1}function d7(e,n){if(e.snap)return Ir(e.path,n);for(let t in e.children)if(e.children.hasOwnProperty(t)&&Ir(Pt(e.path,t),n))return!0;return!1}function h7(e){e.visibleWrites=ab(e.allWrites,p7,Qe()),e.allWrites.length>0?e.lastWriteId=e.allWrites[e.allWrites.length-1].writeId:e.lastWriteId=-1}function p7(e){return e.visible}function ab(e,n,t){let r=Cr.empty();for(let i=0;i<e.length;++i){let s=e[i];if(n(s)){let o=s.path,a;if(s.snap)Ir(t,o)?(a=Tn(t,o),r=Vl(r,a,s.snap)):Ir(o,t)&&(a=Tn(o,t),r=Vl(r,Qe(),s.snap.getChild(a)));else if(s.children){if(Ir(t,o))a=Tn(t,o),r=pD(r,a,s.children);else if(Ir(o,t))if(a=Tn(o,t),Be(a))r=pD(r,Qe(),s.children);else{let c=ts(s.children,Oe(a));if(c){let l=c.getChild(lt(a));r=Vl(r,Qe(),l)}}}else throw qs("WriteRecord should have .snap or .children")}}return r}function cb(e,n,t,r,i){if(!r&&!i){let s=io(e.visibleWrites,n);if(s!=null)return s;{let o=as(e.visibleWrites,n);if(E_(o))return t;if(t==null&&!w_(o,Qe()))return null;{let a=t||De.EMPTY_NODE;return ka(o,a)}}}else{let s=as(e.visibleWrites,n);if(!i&&E_(s))return t;if(!i&&t==null&&!w_(s,Qe()))return null;{let o=function(l){return(l.visible||i)&&(!r||!~r.indexOf(l.writeId))&&(Ir(l.path,n)||Ir(n,l.path))},a=ab(e.allWrites,o,n),c=t||De.EMPTY_NODE;return ka(a,c)}}}function m7(e,n,t){let r=De.EMPTY_NODE,i=io(e.visibleWrites,n);if(i)return i.isLeafNode()||i.forEachChild(mt,(s,o)=>{r=r.updateImmediateChild(s,o)}),r;if(t){let s=as(e.visibleWrites,n);return t.forEachChild(mt,(o,a)=>{let c=ka(as(s,new it(o)),a);r=r.updateImmediateChild(o,c)}),gD(s).forEach(o=>{r=r.updateImmediateChild(o.name,o.node)}),r}else{let s=as(e.visibleWrites,n);return gD(s).forEach(o=>{r=r.updateImmediateChild(o.name,o.node)}),r}}function g7(e,n,t,r,i){X(r||i,"Either existingEventSnap or existingServerSnap must exist");let s=Pt(n,t);if(w_(e.visibleWrites,s))return null;{let o=as(e.visibleWrites,s);return E_(o)?i.getChild(t):ka(o,i.getChild(t))}}function v7(e,n,t,r){let i=Pt(n,t),s=io(e.visibleWrites,i);if(s!=null)return s;if(r.isCompleteForChild(t)){let o=as(e.visibleWrites,i);return ka(o,r.getNode().getImmediateChild(t))}else return null}function _7(e,n){return io(e.visibleWrites,n)}function x7(e,n,t,r,i,s,o){let a,c=as(e.visibleWrites,n),l=io(c,Qe());if(l!=null)a=l;else if(t!=null)a=ka(c,t);else return[];if(a=a.withIndex(o),!a.isEmpty()&&!a.isLeafNode()){let u=[],f=o.getCompare(),d=s?a.getReverseIteratorFrom(r,o):a.getIteratorFrom(r,o),h=d.getNext();for(;h&&u.length<i;)f(h,r)!==0&&u.push(h),h=d.getNext();return u}else return[]}function y7(){return{visibleWrites:Cr.empty(),allWrites:[],lastWriteId:-1}}function ph(e,n,t,r){return cb(e.writeTree,e.treePath,n,t,r)}function K_(e,n){return m7(e.writeTree,e.treePath,n)}function vD(e,n,t,r){return g7(e.writeTree,e.treePath,n,t,r)}function mh(e,n){return _7(e.writeTree,Pt(e.treePath,n))}function w7(e,n,t,r,i,s){return x7(e.writeTree,e.treePath,n,t,r,i,s)}function Y_(e,n,t){return v7(e.writeTree,e.treePath,n,t)}function lb(e,n){return ub(Pt(e.treePath,n),e.writeTree)}function ub(e,n){return{treePath:e,writeTree:n}}var T_=class{constructor(){this.changeMap=new Map}trackChildChange(n){let t=n.type,r=n.childName;X(t==="child_added"||t==="child_changed"||t==="child_removed","Only child changes supported for tracking"),X(r!==".priority","Only non-priority child changes can be tracked.");let i=this.changeMap.get(r);if(i){let s=i.type;if(t==="child_added"&&s==="child_removed")this.changeMap.set(r,Wl(r,n.snapshotNode,i.snapshotNode));else if(t==="child_removed"&&s==="child_added")this.changeMap.delete(r);else if(t==="child_removed"&&s==="child_changed")this.changeMap.set(r,$l(r,i.oldSnap));else if(t==="child_changed"&&s==="child_added")this.changeMap.set(r,ba(r,n.snapshotNode));else if(t==="child_changed"&&s==="child_changed")this.changeMap.set(r,Wl(r,n.snapshotNode,i.oldSnap));else throw qs("Illegal combination of changes: "+n+" occurred after "+i)}else this.changeMap.set(r,n)}getChanges(){return Array.from(this.changeMap.values())}};var I_=class{getCompleteChild(n){return null}getChildAfterChild(n,t,r){return null}},fb=new I_,Gl=class{constructor(n,t,r=null){this.writes_=n,this.viewCache_=t,this.optCompleteServerCache_=r}getCompleteChild(n){let t=this.viewCache_.eventCache;if(t.isCompleteForChild(n))return t.getNode().getImmediateChild(n);{let r=this.optCompleteServerCache_!=null?new Zr(this.optCompleteServerCache_,!0,!1):this.viewCache_.serverCache;return Y_(this.writes_,n,r)}}getChildAfterChild(n,t,r){let i=this.optCompleteServerCache_!=null?this.optCompleteServerCache_:ro(this.viewCache_),s=w7(this.writes_,i,t,1,r,n);return s.length===0?null:s[0]}};function E7(e){return{filter:e}}function T7(e,n){X(n.eventCache.getNode().isIndexed(e.filter.getIndex()),"Event snap not indexed"),X(n.serverCache.getNode().isIndexed(e.filter.getIndex()),"Server snap not indexed")}function I7(e,n,t,r,i){let s=new T_,o,a;if(t.type===Qr.OVERWRITE){let l=t;l.source.fromUser?o=C_(e,n,l.path,l.snap,r,i,s):(X(l.source.fromServer,"Unknown source."),a=l.source.tagged||n.serverCache.isFiltered()&&!Be(l.path),o=gh(e,n,l.path,l.snap,r,i,a,s))}else if(t.type===Qr.MERGE){let l=t;l.source.fromUser?o=S7(e,n,l.path,l.children,r,i,s):(X(l.source.fromServer,"Unknown source."),a=l.source.tagged||n.serverCache.isFiltered(),o=S_(e,n,l.path,l.children,r,i,a,s))}else if(t.type===Qr.ACK_USER_WRITE){let l=t;l.revert?o=A7(e,n,l.path,r,i,s):o=D7(e,n,l.path,l.affectedTree,r,i,s)}else if(t.type===Qr.LISTEN_COMPLETE)o=b7(e,n,t.path,r,s);else throw qs("Unknown operation type: "+t.type);let c=s.getChanges();return C7(n,o,c),{viewCache:o,changes:c}}function C7(e,n,t){let r=n.eventCache;if(r.isFullyInitialized()){let i=r.getNode().isLeafNode()||r.getNode().isEmpty(),s=hh(e);(t.length>0||!e.eventCache.isFullyInitialized()||i&&!r.getNode().equals(s)||!r.getNode().getPriority().equals(s.getPriority()))&&t.push(nb(hh(n)))}}function db(e,n,t,r,i,s){let o=n.eventCache;if(mh(r,t)!=null)return n;{let a,c;if(Be(t))if(X(n.serverCache.isFullyInitialized(),"If change path is empty, we must have complete server data"),n.serverCache.isFiltered()){let l=ro(n),u=l instanceof De?l:De.EMPTY_NODE,f=K_(r,u);a=e.filter.updateFullNode(n.eventCache.getNode(),f,s)}else{let l=ph(r,ro(n));a=e.filter.updateFullNode(n.eventCache.getNode(),l,s)}else{let l=Oe(t);if(l===".priority"){X(ls(t)===1,"Can't have a priority with additional path components");let u=o.getNode();c=n.serverCache.getNode();let f=vD(r,t,u,c);f!=null?a=e.filter.updatePriority(u,f):a=o.getNode()}else{let u=lt(t),f;if(o.isCompleteForChild(l)){c=n.serverCache.getNode();let d=vD(r,t,o.getNode(),c);d!=null?f=o.getNode().getImmediateChild(l).updateChild(u,d):f=o.getNode().getImmediateChild(l)}else f=Y_(r,l,n.serverCache);f!=null?a=e.filter.updateChild(o.getNode(),l,f,u,i,s):a=o.getNode()}}return jl(n,a,o.isFullyInitialized()||Be(t),e.filter.filtersNodes())}}function gh(e,n,t,r,i,s,o,a){let c=n.serverCache,l,u=o?e.filter:e.filter.getIndexedFilter();if(Be(t))l=u.updateFullNode(c.getNode(),r,null);else if(u.filtersNodes()&&!c.isFiltered()){let h=c.getNode().updateChild(t,r);l=u.updateFullNode(c.getNode(),h,null)}else{let h=Oe(t);if(!c.isCompleteForPath(t)&&ls(t)>1)return n;let m=lt(t),g=c.getNode().getImmediateChild(h).updateChild(m,r);h===".priority"?l=u.updatePriority(c.getNode(),g):l=u.updateChild(c.getNode(),h,g,m,fb,null)}let f=sb(n,l,c.isFullyInitialized()||Be(t),u.filtersNodes()),d=new Gl(i,f,s);return db(e,f,t,i,d,a)}function C_(e,n,t,r,i,s,o){let a=n.eventCache,c,l,u=new Gl(i,n,s);if(Be(t))l=e.filter.updateFullNode(n.eventCache.getNode(),r,o),c=jl(n,l,!0,e.filter.filtersNodes());else{let f=Oe(t);if(f===".priority")l=e.filter.updatePriority(n.eventCache.getNode(),r),c=jl(n,l,a.isFullyInitialized(),a.isFiltered());else{let d=lt(t),h=a.getNode().getImmediateChild(f),m;if(Be(d))m=r;else{let p=u.getCompleteChild(f);p!=null?KD(d)===".priority"&&p.getChild(XD(d)).isEmpty()?m=p:m=p.updateChild(d,r):m=De.EMPTY_NODE}if(h.equals(m))c=n;else{let p=e.filter.updateChild(a.getNode(),f,m,d,u,o);c=jl(n,p,a.isFullyInitialized(),e.filter.filtersNodes())}}}return c}function _D(e,n){return e.eventCache.isCompleteForChild(n)}function S7(e,n,t,r,i,s,o){let a=n;return r.foreach((c,l)=>{let u=Pt(t,c);_D(n,Oe(u))&&(a=C_(e,a,u,l,i,s,o))}),r.foreach((c,l)=>{let u=Pt(t,c);_D(n,Oe(u))||(a=C_(e,a,u,l,i,s,o))}),a}function xD(e,n,t){return t.foreach((r,i)=>{n=n.updateChild(r,i)}),n}function S_(e,n,t,r,i,s,o,a){if(n.serverCache.getNode().isEmpty()&&!n.serverCache.isFullyInitialized())return n;let c=n,l;Be(t)?l=r:l=new Rn(null).setTree(t,r);let u=n.serverCache.getNode();return l.children.inorderTraversal((f,d)=>{if(u.hasChild(f)){let h=n.serverCache.getNode().getImmediateChild(f),m=xD(e,h,d);c=gh(e,c,new it(f),m,i,s,o,a)}}),l.children.inorderTraversal((f,d)=>{let h=!n.serverCache.isCompleteForChild(f)&&d.value===null;if(!u.hasChild(f)&&!h){let m=n.serverCache.getNode().getImmediateChild(f),p=xD(e,m,d);c=gh(e,c,new it(f),p,i,s,o,a)}}),c}function D7(e,n,t,r,i,s,o){if(mh(i,t)!=null)return n;let a=n.serverCache.isFiltered(),c=n.serverCache;if(r.value!=null){if(Be(t)&&c.isFullyInitialized()||c.isCompleteForPath(t))return gh(e,n,t,c.getNode().getChild(t),i,s,a,o);if(Be(t)){let l=new Rn(null);return c.getNode().forEachChild(Ta,(u,f)=>{l=l.set(new it(u),f)}),S_(e,n,t,l,i,s,a,o)}else return n}else{let l=new Rn(null);return r.foreach((u,f)=>{let d=Pt(t,u);c.isCompleteForPath(d)&&(l=l.set(u,c.getNode().getChild(d)))}),S_(e,n,t,l,i,s,a,o)}}function b7(e,n,t,r,i){let s=n.serverCache,o=sb(n,s.getNode(),s.isFullyInitialized()||Be(t),s.isFiltered());return db(e,o,t,r,fb,i)}function A7(e,n,t,r,i,s){let o;if(mh(r,t)!=null)return n;{let a=new Gl(r,n,i),c=n.eventCache.getNode(),l;if(Be(t)||Oe(t)===".priority"){let u;if(n.serverCache.isFullyInitialized())u=ph(r,ro(n));else{let f=n.serverCache.getNode();X(f instanceof De,"serverChildren would be complete if leaf node"),u=K_(r,f)}u=u,l=e.filter.updateFullNode(c,u,s)}else{let u=Oe(t),f=Y_(r,u,n.serverCache);f==null&&n.serverCache.isCompleteForChild(u)&&(f=c.getImmediateChild(u)),f!=null?l=e.filter.updateChild(c,u,f,lt(t),a,s):n.eventCache.getNode().hasChild(u)?l=e.filter.updateChild(c,u,De.EMPTY_NODE,lt(t),a,s):l=c,l.isEmpty()&&n.serverCache.isFullyInitialized()&&(o=ph(r,ro(n)),o.isLeafNode()&&(l=e.filter.updateFullNode(l,o,s)))}return o=n.serverCache.isFullyInitialized()||mh(r,Qe())!=null,jl(n,l,o,e.filter.filtersNodes())}}var D_=class{constructor(n,t){this.query_=n,this.eventRegistrations_=[];let r=this.query_._queryParams,i=new zl(r.getIndex()),s=t7(r);this.processor_=E7(s);let o=t.serverCache,a=t.eventCache,c=i.updateFullNode(De.EMPTY_NODE,o.getNode(),null),l=s.updateFullNode(De.EMPTY_NODE,a.getNode(),null),u=new Zr(c,o.isFullyInitialized(),i.filtersNodes()),f=new Zr(l,a.isFullyInitialized(),s.filtersNodes());this.viewCache_=Sh(f,u),this.eventGenerator_=new y_(this.query_)}get query(){return this.query_}};function k7(e){return e.viewCache_.serverCache.getNode()}function N7(e){return hh(e.viewCache_)}function R7(e,n){let t=ro(e.viewCache_);return t&&(e.query._queryParams.loadsAllData()||!Be(n)&&!t.getImmediateChild(Oe(n)).isEmpty())?t.getChild(n):null}function yD(e){return e.eventRegistrations_.length===0}function M7(e,n){e.eventRegistrations_.push(n)}function wD(e,n,t){let r=[];if(t){X(n==null,"A cancel should cancel all event registrations.");let i=e.query._path;e.eventRegistrations_.forEach(s=>{let o=s.createCancelEvent(t,i);o&&r.push(o)})}if(n){let i=[];for(let s=0;s<e.eventRegistrations_.length;++s){let o=e.eventRegistrations_[s];if(!o.matches(n))i.push(o);else if(n.hasAnyCallback()){i=i.concat(e.eventRegistrations_.slice(s+1));break}}e.eventRegistrations_=i}else e.eventRegistrations_=[];return r}function ED(e,n,t,r){n.type===Qr.MERGE&&n.source.queryId!==null&&(X(ro(e.viewCache_),"We should always have a full cache before handling merges"),X(hh(e.viewCache_),"Missing event cache, even though we have a server cache"));let i=e.viewCache_,s=I7(e.processor_,i,n,t,r);return T7(e.processor_,s.viewCache),X(s.viewCache.serverCache.isFullyInitialized()||!i.serverCache.isFullyInitialized(),"Once a server snap is complete, it should never go back"),e.viewCache_=s.viewCache,hb(e,s.changes,s.viewCache.eventCache.getNode(),null)}function O7(e,n){let t=e.viewCache_.eventCache,r=[];return t.getNode().isLeafNode()||t.getNode().forEachChild(mt,(s,o)=>{r.push(ba(s,o))}),t.isFullyInitialized()&&r.push(nb(t.getNode())),hb(e,r,t.getNode(),n)}function hb(e,n,t,r){let i=r?[r]:e.eventRegistrations_;return s7(e.eventGenerator_,n,t,i)}var vh,_h=class{constructor(){this.views=new Map}};function F7(e){X(!vh,"__referenceConstructor has already been defined"),vh=e}function P7(){return X(vh,"Reference.ts has not been loaded"),vh}function L7(e){return e.views.size===0}function X_(e,n,t,r){let i=n.source.queryId;if(i!==null){let s=e.views.get(i);return X(s!=null,"SyncTree gave us an op for an invalid query."),ED(s,n,t,r)}else{let s=[];for(let o of e.views.values())s=s.concat(ED(o,n,t,r));return s}}function pb(e,n,t,r,i){let s=n._queryIdentifier,o=e.views.get(s);if(!o){let a=ph(t,i?r:null),c=!1;a?c=!0:r instanceof De?(a=K_(t,r),c=!1):(a=De.EMPTY_NODE,c=!1);let l=Sh(new Zr(a,c,!1),new Zr(r,i,!1));return new D_(n,l)}return o}function B7(e,n,t,r,i,s){let o=pb(e,n,r,i,s);return e.views.has(n._queryIdentifier)||e.views.set(n._queryIdentifier,o),M7(o,t),O7(o,t)}function U7(e,n,t,r){let i=n._queryIdentifier,s=[],o=[],a=us(e);if(i==="default")for(let[c,l]of e.views.entries())o=o.concat(wD(l,t,r)),yD(l)&&(e.views.delete(c),l.query._queryParams.loadsAllData()||s.push(l.query));else{let c=e.views.get(i);c&&(o=o.concat(wD(c,t,r)),yD(c)&&(e.views.delete(i),c.query._queryParams.loadsAllData()||s.push(c.query)))}return a&&!us(e)&&s.push(new(P7())(n._repo,n._path)),{removed:s,events:o}}function mb(e){let n=[];for(let t of e.views.values())t.query._queryParams.loadsAllData()||n.push(t);return n}function cs(e,n){let t=null;for(let r of e.views.values())t=t||R7(r,n);return t}function gb(e,n){if(n._queryParams.loadsAllData())return bh(e);{let r=n._queryIdentifier;return e.views.get(r)}}function vb(e,n){return gb(e,n)!=null}function us(e){return bh(e)!=null}function bh(e){for(let n of e.views.values())if(n.query._queryParams.loadsAllData())return n;return null}var xh;function j7(e){X(!xh,"__referenceConstructor has already been defined"),xh=e}function V7(){return X(xh,"Reference.ts has not been loaded"),xh}var H7=1,yh=class{constructor(n){this.listenProvider_=n,this.syncPointTree_=new Rn(null),this.pendingWriteTree_=y7(),this.tagToQueryMap=new Map,this.queryToTagMap=new Map}};function _b(e,n,t,r,i){return l7(e.pendingWriteTree_,n,t,r,i),i?tu(e,new Aa(ib(),n,t)):[]}function wa(e,n,t=!1){let r=u7(e.pendingWriteTree_,n);if(f7(e.pendingWriteTree_,n)){let s=new Rn(null);return r.snap!=null?s=s.set(Qe(),!0):Nn(r.children,o=>{s=s.set(new it(o),!0)}),tu(e,new x_(r.path,s,t))}else return[]}function eu(e,n,t){return tu(e,new Aa(G_(),n,t))}function $7(e,n,t){let r=Rn.fromObject(t);return tu(e,new dh(G_(),n,r))}function W7(e,n){return tu(e,new fh(G_(),n))}function z7(e,n,t){let r=Z_(e,t);if(r){let i=J_(r),s=i.path,o=i.queryId,a=Tn(s,n),c=new fh(q_(o),a);return ex(e,s,c)}else return[]}function wh(e,n,t,r,i=!1){let s=n._path,o=e.syncPointTree_.get(s),a=[];if(o&&(n._queryIdentifier==="default"||vb(o,n))){let c=U7(o,n,t,r);L7(o)&&(e.syncPointTree_=e.syncPointTree_.remove(s));let l=c.removed;if(a=c.events,!i){let u=l.findIndex(d=>d._queryParams.loadsAllData())!==-1,f=e.syncPointTree_.findOnPath(s,(d,h)=>us(h));if(u&&!f){let d=e.syncPointTree_.subtree(s);if(!d.isEmpty()){let h=K7(d);for(let m=0;m<h.length;++m){let p=h[m],g=p.query,w=Eb(e,p);e.listenProvider_.startListening(Hl(g),ql(e,g),w.hashFn,w.onComplete)}}}!f&&l.length>0&&!r&&(u?e.listenProvider_.stopListening(Hl(n),null):l.forEach(d=>{let h=e.queryToTagMap.get(Ah(d));e.listenProvider_.stopListening(Hl(d),h)}))}Y7(e,l)}return a}function xb(e,n,t,r){let i=Z_(e,r);if(i!=null){let s=J_(i),o=s.path,a=s.queryId,c=Tn(o,n),l=new Aa(q_(a),c,t);return ex(e,o,l)}else return[]}function G7(e,n,t,r){let i=Z_(e,r);if(i){let s=J_(i),o=s.path,a=s.queryId,c=Tn(o,n),l=Rn.fromObject(t),u=new dh(q_(a),c,l);return ex(e,o,u)}else return[]}function b_(e,n,t,r=!1){let i=n._path,s=null,o=!1;e.syncPointTree_.foreachOnPath(i,(d,h)=>{let m=Tn(d,i);s=s||cs(h,m),o=o||us(h)});let a=e.syncPointTree_.get(i);a?(o=o||us(a),s=s||cs(a,Qe())):(a=new _h,e.syncPointTree_=e.syncPointTree_.set(i,a));let c;s!=null?c=!0:(c=!1,s=De.EMPTY_NODE,e.syncPointTree_.subtree(i).foreachChild((h,m)=>{let p=cs(m,Qe());p&&(s=s.updateImmediateChild(h,p))}));let l=vb(a,n);if(!l&&!n._queryParams.loadsAllData()){let d=Ah(n);X(!e.queryToTagMap.has(d),"View does not exist, but we have a tag");let h=X7();e.queryToTagMap.set(d,h),e.tagToQueryMap.set(h,d)}let u=Dh(e.pendingWriteTree_,i),f=B7(a,n,t,u,s,c);if(!l&&!o&&!r){let d=gb(a,n);f=f.concat(Q7(e,n,d))}return f}function Q_(e,n,t){let i=e.pendingWriteTree_,s=e.syncPointTree_.findOnPath(n,(o,a)=>{let c=Tn(o,n),l=cs(a,c);if(l)return l});return cb(i,n,s,t,!0)}function q7(e,n){let t=n._path,r=null;e.syncPointTree_.foreachOnPath(t,(l,u)=>{let f=Tn(l,t);r=r||cs(u,f)});let i=e.syncPointTree_.get(t);i?r=r||cs(i,Qe()):(i=new _h,e.syncPointTree_=e.syncPointTree_.set(t,i));let s=r!=null,o=s?new Zr(r,!0,!1):null,a=Dh(e.pendingWriteTree_,n._path),c=pb(i,n,a,s?o.getNode():De.EMPTY_NODE,s);return N7(c)}function tu(e,n){return yb(n,e.syncPointTree_,null,Dh(e.pendingWriteTree_,Qe()))}function yb(e,n,t,r){if(Be(e.path))return wb(e,n,t,r);{let i=n.get(Qe());t==null&&i!=null&&(t=cs(i,Qe()));let s=[],o=Oe(e.path),a=e.operationForChild(o),c=n.children.get(o);if(c&&a){let l=t?t.getImmediateChild(o):null,u=lb(r,o);s=s.concat(yb(a,c,l,u))}return i&&(s=s.concat(X_(i,e,r,t))),s}}function wb(e,n,t,r){let i=n.get(Qe());t==null&&i!=null&&(t=cs(i,Qe()));let s=[];return n.children.inorderTraversal((o,a)=>{let c=t?t.getImmediateChild(o):null,l=lb(r,o),u=e.operationForChild(o);u&&(s=s.concat(wb(u,a,c,l)))}),i&&(s=s.concat(X_(i,e,r,t))),s}function Eb(e,n){let t=n.query,r=ql(e,t);return{hashFn:()=>(k7(n)||De.EMPTY_NODE).hash(),onComplete:i=>{if(i==="ok")return r?z7(e,t._path,r):W7(e,t._path);{let s=d9(i,t);return wh(e,t,null,s)}}}}function ql(e,n){let t=Ah(n);return e.queryToTagMap.get(t)}function Ah(e){return e._path.toString()+"$"+e._queryIdentifier}function Z_(e,n){return e.tagToQueryMap.get(n)}function J_(e){let n=e.indexOf("$");return X(n!==-1&&n<e.length-1,"Bad queryKey."),{queryId:e.substr(n+1),path:new it(e.substr(0,n))}}function ex(e,n,t){let r=e.syncPointTree_.get(n);X(r,"Missing sync point for query tag that we're tracking");let i=Dh(e.pendingWriteTree_,n);return X_(r,t,i,null)}function K7(e){return e.fold((n,t,r)=>{if(t&&us(t))return[bh(t)];{let i=[];return t&&(i=mb(t)),Nn(r,(s,o)=>{i=i.concat(o)}),i}})}function Hl(e){return e._queryParams.loadsAllData()&&!e._queryParams.isDefault()?new(V7())(e._repo,e._path):e}function Y7(e,n){for(let t=0;t<n.length;++t){let r=n[t];if(!r._queryParams.loadsAllData()){let i=Ah(r),s=e.queryToTagMap.get(i);e.queryToTagMap.delete(i),e.tagToQueryMap.delete(s)}}}function X7(){return H7++}function Q7(e,n,t){let r=n._path,i=ql(e,n),s=Eb(e,t),o=e.listenProvider_.startListening(Hl(n),i,s.hashFn,s.onComplete),a=e.syncPointTree_.subtree(r);if(i)X(!us(a.value),"If we're adding a query, it shouldn't be shadowed");else{let c=a.fold((l,u,f)=>{if(!Be(l)&&u&&us(u))return[bh(u).query];{let d=[];return u&&(d=d.concat(mb(u).map(h=>h.query))),Nn(f,(h,m)=>{d=d.concat(m)}),d}});for(let l=0;l<c.length;++l){let u=c[l];e.listenProvider_.stopListening(Hl(u),ql(e,u))}}return o}var A_=class e{constructor(n){this.node_=n}getImmediateChild(n){let t=this.node_.getImmediateChild(n);return new e(t)}node(){return this.node_}},k_=class e{constructor(n,t){this.syncTree_=n,this.path_=t}getImmediateChild(n){let t=Pt(this.path_,n);return new e(this.syncTree_,t)}node(){return Q_(this.syncTree_,this.path_)}},Z7=function(e){return e=e||{},e.timestamp=e.timestamp||new Date().getTime(),e},TD=function(e,n,t){if(!e||typeof e!="object")return e;if(X(".sv"in e,"Unexpected leaf node or priority contents"),typeof e[".sv"]=="string")return J7(e[".sv"],n,t);if(typeof e[".sv"]=="object")return eW(e[".sv"],n);X(!1,"Unexpected server value: "+JSON.stringify(e,null,2))},J7=function(e,n,t){switch(e){case"timestamp":return t.timestamp;default:X(!1,"Unexpected server value: "+e)}},eW=function(e,n,t){e.hasOwnProperty("increment")||X(!1,"Unexpected server value: "+JSON.stringify(e,null,2));let r=e.increment;typeof r!="number"&&X(!1,"Unexpected increment value: "+r);let i=n.node();if(X(i!==null&&typeof i<"u","Expected ChildrenNode.EMPTY_NODE for nulls"),!i.isLeafNode())return r;let o=i.getValue();return typeof o!="number"?r:o+r},tW=function(e,n,t,r){return tx(n,new k_(t,e),r)},Tb=function(e,n,t){return tx(e,new A_(n),t)};function tx(e,n,t){let r=e.getPriority().val(),i=TD(r,n.getImmediateChild(".priority"),t),s;if(e.isLeafNode()){let o=e,a=TD(o.getValue(),n,t);return a!==o.getValue()||i!==o.getPriority().val()?new Sa(a,Gt(i)):e}else{let o=e;return s=o,i!==o.getPriority().val()&&(s=s.updatePriority(new Sa(i))),o.forEachChild(mt,(a,c)=>{let l=tx(c,n.getImmediateChild(a),t);l!==c&&(s=s.updateImmediateChild(a,l))}),s}}var Kl=class{constructor(n="",t=null,r={children:{},childCount:0}){this.name=n,this.parent=t,this.node=r}};function kh(e,n){let t=n instanceof it?n:new it(n),r=e,i=Oe(t);for(;i!==null;){let s=ts(r.node.children,i)||{children:{},childCount:0};r=new Kl(i,r,s),t=lt(t),i=Oe(t)}return r}function so(e){return e.node.value}function nx(e,n){e.node.value=n,N_(e)}function Ib(e){return e.node.childCount>0}function nW(e){return so(e)===void 0&&!Ib(e)}function Nh(e,n){Nn(e.node.children,(t,r)=>{n(new Kl(t,e,r))})}function Cb(e,n,t,r){t&&!r&&n(e),Nh(e,i=>{Cb(i,n,!0,r)}),t&&r&&n(e)}function rW(e,n,t){let r=t?e:e.parent;for(;r!==null;){if(n(r))return!0;r=r.parent}return!1}function nu(e){return new it(e.parent===null?e.name:nu(e.parent)+"/"+e.name)}function N_(e){e.parent!==null&&iW(e.parent,e.name,e)}function iW(e,n,t){let r=nW(t),i=rr(e.node.children,n);r&&i?(delete e.node.children[n],e.node.childCount--,N_(e)):!r&&!i&&(e.node.children[n]=t.node,e.node.childCount++,N_(e))}var sW=/[\[\].#$\/\u0000-\u001F\u007F]/,oW=/[\[\].#$\u0000-\u001F\u007F]/,$v=10*1024*1024,Sb=function(e){return typeof e=="string"&&e.length!==0&&!sW.test(e)},Db=function(e){return typeof e=="string"&&e.length!==0&&!oW.test(e)},aW=function(e){return e&&(e=e.replace(/^\/*\.info(\/|$)/,"/")),Db(e)},cW=function(e){return e===null||typeof e=="string"||typeof e=="number"&&!j_(e)||e&&typeof e=="object"&&rr(e,".sv")};var rx=function(e,n,t){let r=t instanceof it?new r_(t,e):t;if(n===void 0)throw new Error(e+"contains undefined "+Js(r));if(typeof n=="function")throw new Error(e+"contains a function "+Js(r)+" with contents = "+n.toString());if(j_(n))throw new Error(e+"contains "+n.toString()+" "+Js(r));if(typeof n=="string"&&n.length>$v/3&&xl(n)>$v)throw new Error(e+"contains a string greater than "+$v+" utf8 bytes "+Js(r)+" ('"+n.substring(0,50)+"...')");if(n&&typeof n=="object"){let i=!1,s=!1;if(Nn(n,(o,a)=>{if(o===".value")i=!0;else if(o!==".priority"&&o!==".sv"&&(s=!0,!Sb(o)))throw new Error(e+" contains an invalid key ("+o+") "+Js(r)+`.  Keys must be non-empty strings and can't contain ".", "#", "$", "/", "[", or "]"`);V9(r,o),rx(e,a,r),H9(r)}),i&&s)throw new Error(e+' contains ".value" child '+Js(r)+" in addition to actual children.")}};var bb=function(e,n,t,r){if(!(r&&t===void 0)&&!Db(t))throw new Error(sv(e,n)+'was an invalid path = "'+t+`". Paths must be non-empty strings and can't contain ".", "#", "$", "[", or "]"`)},lW=function(e,n,t,r){t&&(t=t.replace(/^\/*\.info(\/|$)/,"/")),bb(e,n,t,r)},uW=function(e,n){if(Oe(n)===".info")throw new Error(e+" failed = Can't modify data under /.info/")},fW=function(e,n){let t=n.path.toString();if(typeof n.repoInfo.host!="string"||n.repoInfo.host.length===0||!Sb(n.repoInfo.namespace)&&n.repoInfo.host.split(":")[0]!=="localhost"||t.length!==0&&!aW(t))throw new Error(sv(e,"url")+`must be a valid firebase URL and the path can't contain ".", "#", "$", "[", or "]".`)};var R_=class{constructor(){this.eventLists_=[],this.recursionDepth_=0}};function Ab(e,n){let t=null;for(let r=0;r<n.length;r++){let i=n[r],s=i.getPath();t!==null&&!$_(s,t.path)&&(e.eventLists_.push(t),t=null),t===null&&(t={events:[],path:s}),t.events.push(i)}t&&e.eventLists_.push(t)}function kb(e,n,t){Ab(e,t),Nb(e,r=>$_(r,n))}function Ei(e,n,t){Ab(e,t),Nb(e,r=>Ir(r,n)||Ir(n,r))}function Nb(e,n){e.recursionDepth_++;let t=!0;for(let r=0;r<e.eventLists_.length;r++){let i=e.eventLists_[r];if(i){let s=i.path;n(s)?(dW(e.eventLists_[r]),e.eventLists_[r]=null):t=!1}}t&&(e.eventLists_=[]),e.recursionDepth_--}function dW(e){for(let n=0;n<e.events.length;n++){let t=e.events[n];if(t!==null){e.events[n]=null;let r=t.getEventRunner();to&&pn("event: "+t.toString()),Zl(r)}}}var hW="repo_interrupt",pW=25,M_=class{constructor(n,t,r,i){this.repoInfo_=n,this.forceRestClient_=t,this.authTokenProvider_=r,this.appCheckProvider_=i,this.dataUpdateCount=0,this.statsListener_=null,this.eventQueue_=new R_,this.nextWriteId_=1,this.interceptServerDataCallback_=null,this.onDisconnect_=uh(),this.transactionQueueTree_=new Kl,this.persistentConnection_=null,this.key=this.repoInfo_.toURLString()}toString(){return(this.repoInfo_.secure?"https://":"http://")+this.repoInfo_.host}};function mW(e,n,t){if(e.stats_=H_(e.repoInfo_),e.forceRestClient_||g9())e.server_=new p_(e.repoInfo_,(r,i,s,o)=>{ID(e,r,i,s,o)},e.authTokenProvider_,e.appCheckProvider_),setTimeout(()=>CD(e,!0),0);else{if(typeof t<"u"&&t!==null){if(typeof t!="object")throw new Error("Only objects are supported for option databaseAuthVariableOverride");try{Rt(t)}catch(r){throw new Error("Invalid authOverride provided: "+r)}}e.persistentConnection_=new W_(e.repoInfo_,n,(r,i,s,o)=>{ID(e,r,i,s,o)},r=>{CD(e,r)},r=>{vW(e,r)},e.authTokenProvider_,e.appCheckProvider_,t),e.server_=e.persistentConnection_}e.authTokenProvider_.addTokenChangeListener(r=>{e.server_.refreshAuthToken(r)}),e.appCheckProvider_.addTokenChangeListener(r=>{e.server_.refreshAppCheckToken(r.token)}),e.statsReporter_=_9(e.repoInfo_,()=>new __(e.stats_,e.server_)),e.infoData_=new m_,e.infoSyncTree_=new yh({startListening:(r,i,s,o)=>{let a=[],c=e.infoData_.getNode(r._path);return c.isEmpty()||(a=eu(e.infoSyncTree_,r._path,c),setTimeout(()=>{o("ok")},0)),a},stopListening:()=>{}}),sx(e,"connected",!1),e.serverSyncTree_=new yh({startListening:(r,i,s,o)=>(e.server_.listen(r,s,i,(a,c)=>{let l=o(a,c);Ei(e.eventQueue_,r._path,l)}),[]),stopListening:(r,i)=>{e.server_.unlisten(r,i)}})}function gW(e){let t=e.infoData_.getNode(new it(".info/serverTimeOffset")).val()||0;return new Date().getTime()+t}function ix(e){return Z7({timestamp:gW(e)})}function ID(e,n,t,r,i){e.dataUpdateCount++;let s=new it(n);t=e.interceptServerDataCallback_?e.interceptServerDataCallback_(n,t):t;let o=[];if(i)if(r){let c=gl(t,l=>Gt(l));o=G7(e.serverSyncTree_,s,c,i)}else{let c=Gt(t);o=xb(e.serverSyncTree_,s,c,i)}else if(r){let c=gl(t,l=>Gt(l));o=$7(e.serverSyncTree_,s,c)}else{let c=Gt(t);o=eu(e.serverSyncTree_,s,c)}let a=s;o.length>0&&(a=ax(e,s)),Ei(e.eventQueue_,a,o)}function CD(e,n){sx(e,"connected",n),n===!1&&xW(e)}function vW(e,n){Nn(n,(t,r)=>{sx(e,t,r)})}function sx(e,n,t){let r=new it("/.info/"+n),i=Gt(t);e.infoData_.updateSnapshot(r,i);let s=eu(e.infoSyncTree_,r,i);Ei(e.eventQueue_,r,s)}function Rb(e){return e.nextWriteId_++}function _W(e,n,t){let r=q7(e.serverSyncTree_,n);return r!=null?Promise.resolve(r):e.server_.get(n).then(i=>{let s=Gt(i).withIndex(n._queryParams.getIndex());b_(e.serverSyncTree_,n,t,!0);let o;if(n._queryParams.loadsAllData())o=eu(e.serverSyncTree_,n._path,s);else{let a=ql(e.serverSyncTree_,n);o=xb(e.serverSyncTree_,n._path,s,a)}return Ei(e.eventQueue_,n._path,o),wh(e.serverSyncTree_,n,t,null,!0),s},i=>(Rh(e,"get for query "+Rt(n)+" failed: "+i),Promise.reject(new Error(i))))}function xW(e){Rh(e,"onDisconnectEvents");let n=ix(e),t=uh();g_(e.onDisconnect_,Qe(),(i,s)=>{let o=tW(i,s,e.serverSyncTree_,n);rb(t,i,o)});let r=[];g_(t,Qe(),(i,s)=>{r=r.concat(eu(e.serverSyncTree_,i,s));let o=CW(e,i);ax(e,o)}),e.onDisconnect_=uh(),Ei(e.eventQueue_,Qe(),r)}function yW(e,n,t){let r;Oe(n._path)===".info"?r=b_(e.infoSyncTree_,n,t):r=b_(e.serverSyncTree_,n,t),kb(e.eventQueue_,n._path,r)}function SD(e,n,t){let r;Oe(n._path)===".info"?r=wh(e.infoSyncTree_,n,t):r=wh(e.serverSyncTree_,n,t),kb(e.eventQueue_,n._path,r)}function wW(e){e.persistentConnection_&&e.persistentConnection_.interrupt(hW)}function Rh(e,...n){let t="";e.persistentConnection_&&(t=e.persistentConnection_.id+":"),pn(t,...n)}function EW(e,n,t,r,i,s){Rh(e,"transaction on "+n);let o={path:n,update:t,onComplete:r,status:null,order:AD(),applyLocally:s,retryCount:0,unwatcher:i,abortReason:null,currentWriteId:null,currentInputSnapshot:null,currentOutputSnapshotRaw:null,currentOutputSnapshotResolved:null},a=ox(e,n,void 0);o.currentInputSnapshot=a;let c=o.update(a.val());if(c===void 0)o.unwatcher(),o.currentOutputSnapshotRaw=null,o.currentOutputSnapshotResolved=null,o.onComplete&&o.onComplete(null,!1,o.currentInputSnapshot);else{rx("transaction failed: Data returned ",c,o.path),o.status=0;let l=kh(e.transactionQueueTree_,n),u=so(l)||[];u.push(o),nx(l,u);let f;typeof c=="object"&&c!==null&&rr(c,".priority")?(f=ts(c,".priority"),X(cW(f),"Invalid priority returned by transaction. Priority must be a valid string, finite number, server value, or null.")):f=(Q_(e.serverSyncTree_,n)||De.EMPTY_NODE).getPriority().val();let d=ix(e),h=Gt(c,f),m=Tb(h,a,d);o.currentOutputSnapshotRaw=h,o.currentOutputSnapshotResolved=m,o.currentWriteId=Rb(e);let p=_b(e.serverSyncTree_,n,m,o.currentWriteId,o.applyLocally);Ei(e.eventQueue_,n,p),Mh(e,e.transactionQueueTree_)}}function ox(e,n,t){return Q_(e.serverSyncTree_,n,t)||De.EMPTY_NODE}function Mh(e,n=e.transactionQueueTree_){if(n||Oh(e,n),so(n)){let t=Ob(e,n);X(t.length>0,"Sending zero length transaction queue"),t.every(i=>i.status===0)&&TW(e,nu(n),t)}else Ib(n)&&Nh(n,t=>{Mh(e,t)})}function TW(e,n,t){let r=t.map(l=>l.currentWriteId),i=ox(e,n,r),s=i,o=i.hash();for(let l=0;l<t.length;l++){let u=t[l];X(u.status===0,"tryToSendTransactionQueue_: items in queue should all be run."),u.status=1,u.retryCount++;let f=Tn(n,u.path);s=s.updateChild(f,u.currentOutputSnapshotRaw)}let a=s.val(!0),c=n;e.server_.put(c.toString(),a,l=>{Rh(e,"transaction put response",{path:c.toString(),status:l});let u=[];if(l==="ok"){let f=[];for(let d=0;d<t.length;d++)t[d].status=2,u=u.concat(wa(e.serverSyncTree_,t[d].currentWriteId)),t[d].onComplete&&f.push(()=>t[d].onComplete(null,!0,t[d].currentOutputSnapshotResolved)),t[d].unwatcher();Oh(e,kh(e.transactionQueueTree_,n)),Mh(e,e.transactionQueueTree_),Ei(e.eventQueue_,n,u);for(let d=0;d<f.length;d++)Zl(f[d])}else{if(l==="datastale")for(let f=0;f<t.length;f++)t[f].status===3?t[f].status=4:t[f].status=0;else{Vn("transaction at "+c.toString()+" failed: "+l);for(let f=0;f<t.length;f++)t[f].status=4,t[f].abortReason=l}ax(e,n)}},o)}function ax(e,n){let t=Mb(e,n),r=nu(t),i=Ob(e,t);return IW(e,i,r),r}function IW(e,n,t){if(n.length===0)return;let r=[],i=[],o=n.filter(a=>a.status===0).map(a=>a.currentWriteId);for(let a=0;a<n.length;a++){let c=n[a],l=Tn(t,c.path),u=!1,f;if(X(l!==null,"rerunTransactionsUnderNode_: relativePath should not be null."),c.status===4)u=!0,f=c.abortReason,i=i.concat(wa(e.serverSyncTree_,c.currentWriteId,!0));else if(c.status===0)if(c.retryCount>=pW)u=!0,f="maxretry",i=i.concat(wa(e.serverSyncTree_,c.currentWriteId,!0));else{let d=ox(e,c.path,o);c.currentInputSnapshot=d;let h=n[a].update(d.val());if(h!==void 0){rx("transaction failed: Data returned ",h,c.path);let m=Gt(h);typeof h=="object"&&h!=null&&rr(h,".priority")||(m=m.updatePriority(d.getPriority()));let g=c.currentWriteId,w=ix(e),C=Tb(m,d,w);c.currentOutputSnapshotRaw=m,c.currentOutputSnapshotResolved=C,c.currentWriteId=Rb(e),o.splice(o.indexOf(g),1),i=i.concat(_b(e.serverSyncTree_,c.path,C,c.currentWriteId,c.applyLocally)),i=i.concat(wa(e.serverSyncTree_,g,!0))}else u=!0,f="nodata",i=i.concat(wa(e.serverSyncTree_,c.currentWriteId,!0))}Ei(e.eventQueue_,t,i),i=[],u&&(n[a].status=2,function(d){setTimeout(d,Math.floor(0))}(n[a].unwatcher),n[a].onComplete&&(f==="nodata"?r.push(()=>n[a].onComplete(null,!1,n[a].currentInputSnapshot)):r.push(()=>n[a].onComplete(new Error(f),!1,null))))}Oh(e,e.transactionQueueTree_);for(let a=0;a<r.length;a++)Zl(r[a]);Mh(e,e.transactionQueueTree_)}function Mb(e,n){let t,r=e.transactionQueueTree_;for(t=Oe(n);t!==null&&so(r)===void 0;)r=kh(r,t),n=lt(n),t=Oe(n);return r}function Ob(e,n){let t=[];return Fb(e,n,t),t.sort((r,i)=>r.order-i.order),t}function Fb(e,n,t){let r=so(n);if(r)for(let i=0;i<r.length;i++)t.push(r[i]);Nh(n,i=>{Fb(e,i,t)})}function Oh(e,n){let t=so(n);if(t){let r=0;for(let i=0;i<t.length;i++)t[i].status!==2&&(t[r]=t[i],r++);t.length=r,nx(n,t.length>0?t:void 0)}Nh(n,r=>{Oh(e,r)})}function CW(e,n){let t=nu(Mb(e,n)),r=kh(e.transactionQueueTree_,n);return rW(r,i=>{Wv(e,i)}),Wv(e,r),Cb(r,i=>{Wv(e,i)}),t}function Wv(e,n){let t=so(n);if(t){let r=[],i=[],s=-1;for(let o=0;o<t.length;o++)t[o].status===3||(t[o].status===1?(X(s===o-1,"All SENT items should be at beginning of queue."),s=o,t[o].status=3,t[o].abortReason="set"):(X(t[o].status===0,"Unexpected transaction status in abort"),t[o].unwatcher(),i=i.concat(wa(e.serverSyncTree_,t[o].currentWriteId,!0)),t[o].onComplete&&r.push(t[o].onComplete.bind(null,new Error("set"),!1,null))));s===-1?nx(n,void 0):t.length=s+1,Ei(e.eventQueue_,nu(n),i);for(let o=0;o<r.length;o++)Zl(r[o])}}function SW(e){let n="",t=e.split("/");for(let r=0;r<t.length;r++)if(t[r].length>0){let i=t[r];try{i=decodeURIComponent(i.replace(/\+/g," "))}catch{}n+="/"+i}return n}function DW(e){let n={};e.charAt(0)==="?"&&(e=e.substring(1));for(let t of e.split("&")){if(t.length===0)continue;let r=t.split("=");r.length===2?n[decodeURIComponent(r[0])]=decodeURIComponent(r[1]):Vn(`Invalid query segment '${t}' in query '${e}'`)}return n}var DD=function(e,n){let t=bW(e),r=t.namespace;t.domain==="firebase.com"&&wi(t.host+" is no longer supported. Please use <YOUR FIREBASE>.firebaseio.com instead"),(!r||r==="undefined")&&t.domain!=="localhost"&&wi("Cannot parse Firebase url. Please use https://<YOUR FIREBASE>.firebaseio.com"),t.secure||a9();let i=t.scheme==="ws"||t.scheme==="wss";return{repoInfo:new nh(t.host,t.secure,r,i,n,"",r!==t.subdomain),path:new it(t.pathString)}},bW=function(e){let n="",t="",r="",i="",s="",o=!0,a="https",c=443;if(typeof e=="string"){let l=e.indexOf("//");l>=0&&(a=e.substring(0,l-1),e=e.substring(l+2));let u=e.indexOf("/");u===-1&&(u=e.length);let f=e.indexOf("?");f===-1&&(f=e.length),n=e.substring(0,Math.min(u,f)),u<f&&(i=SW(e.substring(u,f)));let d=DW(e.substring(Math.min(e.length,f)));l=n.indexOf(":"),l>=0?(o=a==="https"||a==="wss",c=parseInt(n.substring(l+1),10)):l=n.length;let h=n.slice(0,l);if(h.toLowerCase()==="localhost")t="localhost";else if(h.split(".").length<=2)t=h;else{let m=n.indexOf(".");r=n.substring(0,m).toLowerCase(),t=n.substring(m+1),s=r}"ns"in d&&(s=d.ns)}return{host:n,port:c,domain:t,subdomain:r,secure:o,scheme:a,pathString:i,namespace:s}};var Eh=class{constructor(n,t,r,i){this.eventType=n,this.eventRegistration=t,this.snapshot=r,this.prevName=i}getPath(){let n=this.snapshot.ref;return this.eventType==="value"?n._path:n.parent._path}getEventType(){return this.eventType}getEventRunner(){return this.eventRegistration.getEventRunner(this)}toString(){return this.getPath().toString()+":"+this.eventType+":"+Rt(this.snapshot.exportVal())}},Th=class{constructor(n,t,r){this.eventRegistration=n,this.error=t,this.path=r}getPath(){return this.path}getEventType(){return"cancel"}getEventRunner(){return this.eventRegistration.getEventRunner(this)}toString(){return this.path.toString()+":cancel"}};var Ih=class{constructor(n,t){this.snapshotCallback=n,this.cancelCallback=t}onValue(n,t){this.snapshotCallback.call(null,n,t)}onCancel(n){return X(this.hasCancelCallback,"Raising a cancel event on a listener with no cancel callback"),this.cancelCallback.call(null,n)}get hasCancelCallback(){return!!this.cancelCallback}matches(n){return this.snapshotCallback===n.snapshotCallback||this.snapshotCallback.userCallback!==void 0&&this.snapshotCallback.userCallback===n.snapshotCallback.userCallback&&this.snapshotCallback.context===n.snapshotCallback.context}};var O_=class e{constructor(n,t,r,i){this._repo=n,this._path=t,this._queryParams=r,this._orderByCalled=i}get key(){return Be(this._path)?null:KD(this._path)}get ref(){return new Sr(this._repo,this._path)}get _queryIdentifier(){let n=dD(this._queryParams),t=V_(n);return t==="{}"?"default":t}get _queryObject(){return dD(this._queryParams)}isEqual(n){if(n=ir(n),!(n instanceof e))return!1;let t=this._repo===n._repo,r=$_(this._path,n._path),i=this._queryIdentifier===n._queryIdentifier;return t&&r&&i}toJSON(){return this.toString()}toString(){return this._repo.toString()+j9(this._path)}};var Sr=class e extends O_{constructor(n,t){super(n,t,new h_,!1)}get parent(){let n=XD(this._path);return n===null?null:new e(this._repo,n)}get root(){let n=this;for(;n.parent!==null;)n=n.parent;return n}},Na=class e{constructor(n,t,r){this._node=n,this.ref=t,this._index=r}get priority(){return this._node.getPriority().val()}get key(){return this.ref.key}get size(){return this._node.numChildren()}child(n){let t=new it(n),r=Yl(this.ref,n);return new e(this._node.getChild(t),r,mt)}exists(){return!this._node.isEmpty()}exportVal(){return this._node.val(!0)}forEach(n){return this._node.isLeafNode()?!1:!!this._node.forEachChild(this._index,(r,i)=>n(new e(i,Yl(this.ref,r),mt)))}hasChild(n){let t=new it(n);return!this._node.getChild(t).isEmpty()}hasChildren(){return this._node.isLeafNode()?!1:!this._node.isEmpty()}toJSON(){return this.exportVal()}val(){return this._node.val()}};function Pb(e,n){return e=ir(e),e._checkNotDeleted("ref"),n!==void 0?Yl(e._root,n):e._root}function Yl(e,n){return e=ir(e),Oe(e._path)===null?lW("child","path",n,!1):bb("child","path",n,!1),new Sr(e._repo,Pt(e._path,n))}function Lb(e){e=ir(e);let n=new Ih(()=>{}),t=new Ch(n);return _W(e._repo,e,t).then(r=>new Na(r,new Sr(e._repo,e._path),e._queryParams.getIndex()))}var Ch=class e{constructor(n){this.callbackContext=n}respondsTo(n){return n==="value"}createEvent(n,t){let r=t._queryParams.getIndex();return new Eh("value",this,new Na(n.snapshotNode,new Sr(t._repo,t._path),r))}getEventRunner(n){return n.getEventType()==="cancel"?()=>this.callbackContext.onCancel(n.error):()=>this.callbackContext.onValue(n.snapshot,null)}createCancelEvent(n,t){return this.callbackContext.hasCancelCallback?new Th(this,n,t):null}matches(n){return n instanceof e?!n.callbackContext||!this.callbackContext?!0:n.callbackContext.matches(this.callbackContext):!1}hasAnyCallback(){return this.callbackContext!==null}},F_=class e{constructor(n,t){this.eventType=n,this.callbackContext=t}respondsTo(n){let t=n==="children_added"?"child_added":n;return t=t==="children_removed"?"child_removed":t,this.eventType===t}createCancelEvent(n,t){return this.callbackContext.hasCancelCallback?new Th(this,n,t):null}createEvent(n,t){X(n.childName!=null,"Child events should have a childName.");let r=Yl(new Sr(t._repo,t._path),n.childName),i=t._queryParams.getIndex();return new Eh(n.type,this,new Na(n.snapshotNode,r,i),n.prevName)}getEventRunner(n){return n.getEventType()==="cancel"?()=>this.callbackContext.onCancel(n.error):()=>this.callbackContext.onValue(n.snapshot,n.prevName)}matches(n){return n instanceof e?this.eventType===n.eventType&&(!this.callbackContext||!n.callbackContext||this.callbackContext.matches(n.callbackContext)):!1}hasAnyCallback(){return!!this.callbackContext}};function AW(e,n,t,r,i){let s;if(typeof r=="object"&&(s=void 0,i=r),typeof r=="function"&&(s=r),i&&i.onlyOnce){let c=t,l=(u,f)=>{SD(e._repo,e,a),c(u,f)};l.userCallback=t.userCallback,l.context=t.context,t=l}let o=new Ih(t,s||void 0),a=n==="value"?new Ch(o):new F_(n,o);return yW(e._repo,e,a),()=>SD(e._repo,e,a)}function Bb(e,n,t,r){return AW(e,"value",n,t,r)}F7(Sr);j7(Sr);var kW="FIREBASE_DATABASE_EMULATOR_HOST",P_={},NW=!1;function RW(e,n,t,r){e.repoInfo_=new nh(`${n}:${t}`,!1,e.repoInfo_.namespace,e.repoInfo_.webSocketOnly,e.repoInfo_.nodeAdmin,e.repoInfo_.persistenceKey,e.repoInfo_.includeNamespaceInQueryParams,!0),r&&(e.authTokenProvider_=r)}function MW(e,n,t,r,i){let s=r||e.options.databaseURL;s===void 0&&(e.options.projectId||wi("Can't determine Firebase Database URL. Be sure to include  a Project ID when calling firebase.initializeApp()."),pn("Using default host for project ",e.options.projectId),s=`${e.options.projectId}-default-rtdb.firebaseio.com`);let o=DD(s,i),a=o.repoInfo,c,l;typeof process<"u"&&process.env&&(l=process.env[kW]),l?(c=!0,s=`http://${l}?ns=${a.namespace}`,o=DD(s,i),a=o.repoInfo):c=!o.repoInfo.secure;let u=i&&c?new Ul(Ul.OWNER):new Xv(e.name,e.options,n);fW("Invalid Firebase Database URL",o),Be(o.path)||wi("Database URL must point to the root of a Firebase Database (not including a child path).");let f=FW(a,e,u,new Yv(e.name,t));return new L_(f,e)}function OW(e,n){let t=P_[n];(!t||t[e.key]!==e)&&wi(`Database ${n}(${e.repoInfo_}) has already been deleted.`),wW(e),delete t[e.key]}function FW(e,n,t,r){let i=P_[n.name];i||(i={},P_[n.name]=i);let s=i[e.toURLString()];return s&&wi("Database initialized multiple times. Please make sure the format of the database URL matches with each database() call."),s=new M_(e,NW,t,r),i[e.toURLString()]=s,s}var L_=class{constructor(n,t){this._repoInternal=n,this.app=t,this.type="database",this._instanceStarted=!1}get _repo(){return this._instanceStarted||(mW(this._repoInternal,this.app.options.appId,this.app.options.databaseAuthVariableOverride),this._instanceStarted=!0),this._repoInternal}get _root(){return this._rootInternal||(this._rootInternal=new Sr(this._repo,Qe())),this._rootInternal}_delete(){return this._rootInternal!==null&&(OW(this._repo,this.app.name),this._repoInternal=null,this._rootInternal=null),Promise.resolve()}_checkNotDeleted(n){this._rootInternal===null&&wi("Cannot call "+n+" on a deleted database.")}};function Ub(e=Tl(),n){let t=xv(e,"database").getImmediate({identifier:n});if(!t._instanceStarted){let r=rS("database");r&&jb(t,...r)}return t}function jb(e,n,t,r={}){e=ir(e),e._checkNotDeleted("useEmulator"),e._instanceStarted&&wi("Cannot call useEmulator() after instance has already been initialized.");let i=e._repoInternal,s;if(i.repoInfo_.nodeAdmin)r.mockUserToken&&wi('mockUserToken is not supported by the Admin SDK. For client access with mock users, please use the "firebase" package instead of "firebase-admin".'),s=new Ul(Ul.OWNER);else if(r.mockUserToken){let o=typeof r.mockUserToken=="string"?r.mockUserToken:sS(r.mockUserToken,e.app.options.projectId);s=new Ul(o)}RW(i,n,t,s)}function PW(e){s9(ga),is(new sr("database",(n,{instanceIdentifier:t})=>{let r=n.getProvider("app").getImmediate(),i=n.getProvider("auth-internal"),s=n.getProvider("app-check-internal");return MW(r,i,s,t)},"PUBLIC").setMultipleInstances(!0)),zt(YS,XS,e),zt(YS,XS,"esm2017")}var B_=class{constructor(n,t){this.committed=n,this.snapshot=t}toJSON(){return{committed:this.committed,snapshot:this.snapshot.toJSON()}}};function Vb(e,n,t){var r;if(e=ir(e),uW("Reference.transaction",e._path),e.key===".length"||e.key===".keys")throw"Reference.transaction failed: "+e.key+" is a read-only object.";let i=(r=t?.applyLocally)!==null&&r!==void 0?r:!0,s=new es,o=(c,l,u)=>{let f=null;c?s.reject(c):(f=new Na(u,new Sr(e._repo,e._path),mt),s.resolve(new B_(l,f)))},a=Bb(e,()=>{});return EW(e._repo,e._path,n,o,a,i),s.promise}W_.prototype.simpleListen=function(e,n){this.sendRequest("q",{p:e},n)};W_.prototype.echo=function(e,n){this.sendRequest("echo",{d:e},n)};PW();var oo=class{constructor(n){return n}},Hb="database",cx=class{constructor(){return Cl(Hb)}};var lx=new ge("angularfire2.database-instances");function LW(e,n){let t=Ev(Hb,e,n);return t&&new oo(t)}function BW(e){return(n,t)=>{let r=n.runOutsideAngular(()=>e(t));return new oo(r)}}var UW={provide:cx,deps:[[new qn,lx]]},jW={provide:oo,useFactory:LW,deps:[[new qn,lx],Xs]},VW=(()=>{class e{constructor(){zt("angularfire",_a.full,"rtdb")}static \u0275fac=function(r){return new(r||e)};static \u0275mod=Xt({type:e});static \u0275inj=Yt({providers:[jW,UW]})}return e})();function $b(e,...n){return{ngModule:VW,providers:[{provide:lx,useFactory:BW(e),multi:!0,deps:[Ye,An,Sl,Dl,[new qn,Jd],[new qn,Il],...n]}]}}var Wb=ss(Lb,!0),zb=ss(Ub,!0);var ux=ss(Pb,!0);var Gb=ss(Vb,!0);var Fh=(()=>{class e{constructor(t){this.db=t}dodajPosetuZaDanas(){let r=`posete/${new Date().toISOString().substring(0,10)}/brojac`,i=ux(this.db,r);Gb(i,s=>(s||0)+1)}getPosetaZaDatum(t){return Z(this,null,function*(){let r=yield Wb(ux(this.db,`posete/${t}/brojac`));return r.exists()?r.val():0})}static{this.\u0275fac=function(r){return new(r||e)(ue(oo))}}static{this.\u0275prov=he({token:e,factory:e.\u0275fac,providedIn:"root"})}}return e})();function $W(e,n){if(e&1&&(ye(0,"ul")(1,"li"),Je(2),we(),ye(3,"li"),Je(4),we(),ye(5,"li"),Je(6),we(),ye(7,"li"),Je(8),we(),ye(9,"li"),Je(10),we(),ye(11,"li"),Je(12),we()()),e&2){let t=Qt();ke(2),jt("Poseta danas: ",t.posete.danas,""),ke(2),jt("Poseta ju\u010De: ",t.posete.juce,""),ke(2),jt("Poseta prekju\u010De: ",t.posete.prekjuce,""),ke(2),jt("Ove nedelje: ",t.posete.nedelja,""),ke(2),jt("Ovog meseca: ",t.posete.mesec,""),ke(2),jt("Ukupno poseta: ",t.posete.ukupno,"")}}var Kb=(()=>{class e{constructor(t,r,i){this.route=t,this.router=r,this.posetaService=i,this.posete={danas:0,juce:0,prekjuce:0,nedelja:0,mesec:0,ukupno:0},this.validKey="1982fsd93f92jsdf"}ngOnInit(){return Z(this,null,function*(){if(this.route.snapshot.paramMap.get("key")!==this.validKey){this.router.navigate(["/"]);return}setTimeout(()=>{this.ucitajStatistiku()},1e3)})}ucitajStatistiku(){return Z(this,null,function*(){let t=this.formatDateOffset(0),r=this.formatDateOffset(-1),i=this.formatDateOffset(-2),s=this.getDatumiUnazad(7),o=this.getDatumiTekucegMeseca();this.posete.danas=yield this.posetaService.getPosetaZaDatum(t),this.posete.juce=yield this.posetaService.getPosetaZaDatum(r),this.posete.prekjuce=yield this.posetaService.getPosetaZaDatum(i),this.posete.nedelja=yield this.sumirajPosete(s),this.posete.mesec=yield this.sumirajPosete(o),this.posete.ukupno=this.posete.mesec})}sumirajPosete(t){return Z(this,null,function*(){return(yield Promise.all(t.map(i=>this.posetaService.getPosetaZaDatum(i)))).reduce((i,s)=>i+s,0)})}formatDateOffset(t){let r=new Date;return r.setDate(r.getDate()+t),this.formatDateLocal(r)}getDatumiUnazad(t){let r=new Date,i=[];for(let s=0;s<t;s++){let o=new Date(r);o.setDate(o.getDate()-s),i.push(this.formatDateLocal(o))}return i}getDatumiTekucegMeseca(){let t=new Date,r=t.getMonth(),i=t.getFullYear(),s=[];for(let o=1;o<=t.getDate();o++){let a=new Date(i,r,o);s.push(this.formatDateLocal(a))}return s}formatDateLocal(t){return t.getFullYear()+"-"+String(t.getMonth()+1).padStart(2,"0")+"-"+String(t.getDate()).padStart(2,"0")}static{this.\u0275fac=function(r){return new(r||e)(at(di),at(Vr),at(Fh))}}static{this.\u0275cmp=bn({type:e,selectors:[["app-stats"]],decls:3,vars:1,consts:[[4,"ngIf"]],template:function(r,i){r&1&&(ye(0,"h2"),Je(1,"Statistika poseta"),we(),Ut(2,$W,13,6,"ul",0)),r&2&&(ke(2),Et("ngIf",i.posete))},dependencies:[Ui],styles:["[_nghost-%COMP%]{display:block;padding:2rem;font-family:Arial,sans-serif;background-color:#f7f8fa;min-height:100vh}h2[_ngcontent-%COMP%]{font-size:1.8rem;margin-bottom:1rem;color:#333}ul[_ngcontent-%COMP%]{list-style:none;padding:0;max-width:500px;margin:0 auto;background-color:#fff;border-radius:1rem;box-shadow:0 0 10px #0000000d}li[_ngcontent-%COMP%]{padding:1rem 1.5rem;border-bottom:1px solid #e0e0e0;font-size:1.1rem;display:flex;justify-content:space-between;align-items:center}li[_ngcontent-%COMP%]:last-child{border-bottom:none}@media (max-width: 600px){li[_ngcontent-%COMP%]{flex-direction:column;align-items:flex-start}}"]})}}return e})();var WW=[{path:"",component:KC},{path:"pages/drinks-alcohol",component:QC},{path:"pages/drinks-non-alcohol",component:XC},{path:"pages/food-category",component:YC},{path:"stats/:key",component:Kb}],Yb=(()=>{class e{static{this.\u0275fac=function(r){return new(r||e)}}static{this.\u0275mod=Xt({type:e})}static{this.\u0275inj=Yt({imports:[Zm.forRoot(WW),Zm]})}}return e})();var Xb=(()=>{class e{constructor(t){this.posetaService=t}ngOnInit(){this.posetaService.dodajPosetuZaDanas()}static{this.\u0275fac=function(r){return new(r||e)(at(Fh))}}static{this.\u0275cmp=bn({type:e,selectors:[["app-root"]],decls:6,vars:0,consts:[[1,"menu-screen"],[1,"header-image"],["src","assets/1.jpg","alt","Ambijent",1,"ambijent"],["routerLink","/","src","assets/nazivkafica1.jpg","alt","RA\u0160 KAFE logo",1,"logo-overlay"],[1,"menu-content"]],template:function(r,i){r&1&&(ye(0,"div",0)(1,"div",1),Pr(2,"img",2)(3,"img",3),we(),ye(4,"div",4),Pr(5,"router-outlet"),we()())},dependencies:[zm,od],styles:["body[_ngcontent-%COMP%], html[_ngcontent-%COMP%]{margin:0;padding:0;font-family:Segoe UI,sans-serif;background-color:#f2f2f2}.menu-screen[_ngcontent-%COMP%]{width:100%;height:100%}.header-image[_ngcontent-%COMP%]{position:relative;width:100%;height:160px;overflow:hidden}.header-image[_ngcontent-%COMP%]   .ambijent[_ngcontent-%COMP%]{width:100%;height:100%;object-fit:cover}.logo-overlay[_ngcontent-%COMP%]{position:absolute;top:50%;left:50%;transform:translate(-50%,-50%);height:45px;object-fit:contain;border-radius:10px}.menu-content[_ngcontent-%COMP%]{background-color:#fff;border-top-left-radius:1.5rem;border-top-right-radius:1.5rem;margin-top:-20px;padding:1.5rem 1rem 3rem;position:relative;z-index:10}"]})}}return e})();var Qb=(()=>{class e{static{this.\u0275fac=function(r){return new(r||e)}}static{this.\u0275mod=Xt({type:e,bootstrap:[Xb]})}static{this.\u0275inj=Yt({imports:[TE,Yb,pE,AS(()=>kS({apiKey:"AIzaSyAgBkiEK8MJA4P40UKRuI1CulbdheXks7g",authDomain:"rashcaffe-statistika.firebaseapp.com",databaseURL:"https://rashcaffe-statistika-default-rtdb.europe-west1.firebasedatabase.app",projectId:"rashcaffe-statistika",storageBucket:"rashcaffe-statistika.appspot.com",messagingSenderId:"607247697862",appId:"1:607247697862:web:a522f3ecc1084bb503d4c7",measurementId:"G-WZ8X09HT8B"})),$b(()=>zb())]})}}return e})();EE().bootstrapModule(Qb).catch(e=>console.error(e));
